import{s as c,j as e}from"./index-zDZ3Lj_p.js";import{u as L,r as l}from"./react-vendor-CTUriZ5h.js";import{M as p,P}from"./MerchantLayout-B4VsQmsY.js";import{C as X}from"./check-circle-CyNeZd0p.js";import{A}from"./alert-circle-_Iqic_ih.js";import{c as f}from"./createLucideIcon-CMjKDoEE.js";import{T as F}from"./trash-2-DAKlHNH6.js";import{P as R}from"./phone-BNQXnIac.js";import{M as T}from"./map-pin-DUtVdt2Q.js";import{S as q}from"./save-DeLrZxpc.js";import"./supabase-Bl4YWSQ9.js";import"./x-D4qrk5Qy.js";import"./menu-DP2azNEK.js";import"./store-B-5iV_wL.js";import"./layout-dashboard-CqNl1jWq.js";import"./package-ChDCFdB3.js";import"./users-4zMWxYqH.js";import"./printer-B3I1m1op.js";import"./message-square-B53yKzw3.js";import"./log-out-BX30H4-p.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=f("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=f("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function re(){const y=L(),n=l.useRef(null),[j,v]=l.useState(!0),[m,u]=l.useState(!1),[N,i]=l.useState(!1),[h,o]=l.useState(""),[_,k]=l.useState(""),[t,r]=l.useState({logo_base64:"",business_name:"",phone:"",business_address:"",business_city:"",business_postal_code:""});l.useEffect(()=>{w()},[]);const w=async()=>{try{const{data:{session:a}}=await c.auth.getSession();if(!a){y("/merchant/login");return}const{data:s}=await c.from("merchants").select("*").eq("email",a.user.email).maybeSingle();s&&(k(s.id),r({logo_base64:s.logo_base64||"",business_name:s.business_name||s.name||"",phone:s.phone||"",business_address:s.business_address||"",business_city:s.business_city||"",business_postal_code:s.business_postal_code||""}))}catch(a){console.error("Error fetching merchant data:",a),o("Erreur lors du chargement des donnees")}finally{v(!1)}},S=a=>{var x;const s=(x=a.target.files)==null?void 0:x[0];if(!s)return;if(s.size>5e5){o("L'image ne doit pas depasser 500 Ko");return}const d=new FileReader;d.onloadend=()=>{r(E=>({...E,logo_base64:d.result})),o("")},d.readAsDataURL(s)},M=()=>{r(a=>({...a,logo_base64:""})),n.current&&(n.current.value="")},C=async a=>{a.preventDefault(),u(!0),o(""),i(!1);try{const{error:s}=await c.from("merchants").update({logo_base64:t.logo_base64||null,business_name:t.business_name||null,phone:t.phone,business_address:t.business_address||null,business_city:t.business_city||null,business_postal_code:t.business_postal_code||null}).eq("id",_);if(s)throw s;i(!0),setTimeout(()=>i(!1),3e3)}catch(s){console.error("Error saving branding:",s),o("Erreur lors de la sauvegarde")}finally{u(!1)}};return j?e.jsx(p,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):e.jsx(p,{children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 flex items-center gap-3",children:[e.jsx(P,{className:"w-8 h-8 text-sky-600"}),"Parametres de Marque"]}),e.jsx("p",{className:"text-slate-600 mt-2",children:"Personnalisez votre logo et vos informations de contact pour les bordereaux"})]}),N&&e.jsxs("div",{className:"mb-6 p-4 bg-emerald-50 border border-emerald-200 rounded-lg flex items-center gap-3",children:[e.jsx(X,{className:"w-5 h-5 text-emerald-600"}),e.jsx("span",{className:"text-emerald-800",children:"Modifications enregistrees avec succes"})]}),h&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-red-800",children:h})]}),e.jsxs("form",{onSubmit:C,className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-sky-600"}),"Logo de l'entreprise"]}),e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"w-32 h-32 bg-slate-100 rounded-xl border-2 border-dashed border-slate-300 flex items-center justify-center overflow-hidden",children:t.logo_base64?e.jsx("img",{src:t.logo_base64,alt:"Logo",className:"w-full h-full object-contain"}):e.jsx(b,{className:"w-12 h-12 text-slate-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:S,className:"hidden",id:"logo-upload"}),e.jsxs("label",{htmlFor:"logo-upload",className:"inline-flex items-center gap-2 px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 cursor-pointer transition-colors",children:[e.jsx(g,{className:"w-4 h-4"}),"Telecharger une image"]}),t.logo_base64&&e.jsxs("button",{type:"button",onClick:M,className:"ml-3 inline-flex items-center gap-2 px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[e.jsx(F,{className:"w-4 h-4"}),"Supprimer"]}),e.jsx("p",{className:"text-sm text-slate-500 mt-3",children:"Format recommande: PNG ou JPG, max 500 Ko"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-sky-600"}),"Informations de l'entreprise"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nom commercial"}),e.jsx("input",{type:"text",value:t.business_name,onChange:a=>r(s=>({...s,business_name:a.target.value})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",placeholder:"Nom de votre entreprise"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[e.jsx(R,{className:"w-4 h-4 inline mr-1"}),"Telephone"]}),e.jsx("input",{type:"tel",value:t.phone,onChange:a=>r(s=>({...s,phone:a.target.value})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",placeholder:"+216 XX XXX XXX"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-sky-600"}),"Adresse"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Adresse"}),e.jsx("input",{type:"text",value:t.business_address,onChange:a=>r(s=>({...s,business_address:a.target.value})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",placeholder:"Rue, numero, etc."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Ville"}),e.jsx("input",{type:"text",value:t.business_city,onChange:a=>r(s=>({...s,business_city:a.target.value})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",placeholder:"Tunis"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Code postal"}),e.jsx("input",{type:"text",value:t.business_postal_code,onChange:a=>r(s=>({...s,business_postal_code:a.target.value})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",placeholder:"1000"})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:m,className:"flex items-center gap-2 px-6 py-3 bg-sky-600 text-white rounded-lg hover:bg-sky-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Enregistrement..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-5 h-5"}),"Enregistrer les modifications"]})})})]})]})})}export{re as default};
