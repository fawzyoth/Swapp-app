import{s as p,j as e}from"./index-DJR32chX.js";import{u as T,r,L as g}from"./react-vendor-CTUriZ5h.js";import{M as b}from"./MerchantLayout-DiPx1J-e.js";import{P as q}from"./play-rTm69v02.js";import{P as v}from"./package-ChDCFdB3.js";import{C as O}from"./clock-Dhxn45-3.js";import{C as w}from"./check-circle-CyNeZd0p.js";import{X as P}from"./x-circle-D3f66Y07.js";import{B as L}from"./bar-chart-3-DdlwYHtY.js";import{U as V}from"./users-4zMWxYqH.js";import{T as $}from"./truck-CgEV9F53.js";import"./supabase-Bl4YWSQ9.js";import"./x-D4qrk5Qy.js";import"./createLucideIcon-CMjKDoEE.js";import"./menu-DP2azNEK.js";import"./store-B-5iV_wL.js";import"./layout-dashboard-CqNl1jWq.js";import"./banknote-JI0QWWz-.js";import"./message-square-B53yKzw3.js";import"./log-out-BX30H4-p.js";const y={total:15,pending:3,validated:4,rejected:2,completed:5,validationRate:80},S=[{reason:"Taille incorrecte",count:3},{reason:"Couleur non conforme",count:2},{reason:"Produit defectueux",count:4},{reason:"Ne correspond pas a la description",count:3},{reason:"Changement d'avis",count:2},{reason:"Ecran defectueux",count:1}];function re(){const M=T(),[a,d]=r.useState({total:0,pending:0,validated:0,rejected:0,completed:0,validationRate:0}),[f,c]=r.useState([]),[D,n]=r.useState(!0),[i,m]=r.useState(!1);r.useEffect(()=>{const t=sessionStorage.getItem("demo_mode")==="true";m(t),t?(d(y),c(S),n(!1)):j()},[]);const _=()=>{sessionStorage.removeItem("demo_mode"),sessionStorage.removeItem("demo_merchant"),M("/merchant/login")},C=()=>{i?(sessionStorage.removeItem("demo_mode"),sessionStorage.removeItem("demo_merchant"),m(!1),n(!0),j()):(sessionStorage.setItem("demo_mode","true"),sessionStorage.setItem("demo_merchant",JSON.stringify({id:"demo-merchant-id",email:"demo@merchant.com",name:"Boutique Demo"})),m(!0),d(y),c(S))},j=async()=>{try{const{data:{session:t}}=await p.auth.getSession();if(!t){n(!1);return}const{data:o}=await p.from("merchants").select("id").eq("email",t.user.email).maybeSingle();if(!o){n(!1);return}const{data:l}=await p.from("exchanges").select("status, reason").eq("merchant_id",o.id);if(l){const x=l.length,k=l.filter(s=>s.status==="pending").length,N=l.filter(s=>s.status==="validated"||s.status==="ready_for_pickup"||s.status==="preparing"||s.status==="in_transit"||s.status==="completed").length,E=l.filter(s=>s.status==="rejected").length,R=l.filter(s=>s.status==="completed").length,A=x>0?Math.round(N/x*100):0;d({total:x,pending:k,validated:N,rejected:E,completed:R,validationRate:A});const h={};l.forEach(s=>{h[s.reason]=(h[s.reason]||0)+1});const I=Object.entries(h).map(([s,u])=>({reason:s,count:u})).sort((s,u)=>u.count-s.count).slice(0,5);c(I)}}catch(t){console.error("Error fetching stats:",t)}finally{n(!1)}};return D?e.jsx(b,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-sky-600"})})}):e.jsx(b,{children:e.jsxs("div",{children:[i&&e.jsx("div",{className:"mb-6 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-xl p-4 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold",children:"Mode Démonstration"}),e.jsx("p",{className:"text-purple-100 text-sm",children:"Vous visualisez des données fictives. Explorez librement la plateforme!"})]}),e.jsx("button",{onClick:_,className:"px-4 py-2 bg-white text-purple-600 rounded-lg font-semibold text-sm hover:bg-purple-50 transition-colors",children:"Quitter la Demo"})]})}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Vue d'ensemble"}),e.jsx("p",{className:"text-slate-600",children:"Statistiques et métriques de vos échanges"})]}),e.jsxs("button",{onClick:C,className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium text-sm transition-all ${i?"bg-purple-600 text-white shadow-lg shadow-purple-200":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${i?"bg-white animate-pulse":"bg-slate-400"}`}),i?"Mode Demo Actif":"Activer Mode Demo"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(v,{className:"w-6 h-6 text-blue-600"})}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:a.total})]}),e.jsx("h3",{className:"text-slate-600 text-sm",children:"Total des échanges"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(O,{className:"w-6 h-6 text-yellow-600"})}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:a.pending})]}),e.jsx("h3",{className:"text-slate-600 text-sm",children:"En attente"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(w,{className:"w-6 h-6 text-emerald-600"})}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:a.validated})]}),e.jsx("h3",{className:"text-slate-600 text-sm",children:"Validés"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-red-600"})}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:a.rejected})]}),e.jsx("h3",{className:"text-slate-600 text-sm",children:"Rejetés"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Taux de validation"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-4",children:e.jsx("div",{className:"bg-emerald-600 h-4 rounded-full transition-all",style:{width:`${a.validationRate}%`}})})}),e.jsxs("span",{className:"text-2xl font-bold text-slate-900",children:[a.validationRate,"%"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Échanges complétés"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(w,{className:"w-12 h-12 text-green-600"}),e.jsx("span",{className:"text-3xl font-bold text-slate-900",children:a.completed})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Raisons d'échange principales"]}),f.length>0?e.jsx("div",{className:"space-y-3",children:f.map((t,o)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-slate-700",children:t.reason}),e.jsx("span",{className:"font-medium text-slate-900",children:t.count})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-sky-600 h-2 rounded-full",style:{width:`${t.count/a.total*100}%`}})})]},o))}):e.jsx("p",{className:"text-slate-600 text-center py-8",children:"Aucune donnée disponible"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Accès rapide"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{to:"/merchant/exchanges",className:"flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors",children:[e.jsx(v,{className:"w-5 h-5 text-slate-600"}),e.jsx("span",{className:"font-medium text-slate-900",children:"Gérer les échanges"})]}),e.jsxs(g,{to:"/merchant/clients",className:"flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors",children:[e.jsx(V,{className:"w-5 h-5 text-slate-600"}),e.jsx("span",{className:"font-medium text-slate-900",children:"Voir les clients"})]}),e.jsxs(g,{to:"/merchant/pickups",className:"flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors",children:[e.jsx($,{className:"w-5 h-5 text-slate-600"}),e.jsx("span",{className:"font-medium text-slate-900",children:"Gestion des ramassages"})]})]})]})]})]})})}export{re as default};
