import{s as m,j as e}from"./index-CYPRHEJa.js";import{u as E,r as n,L as d}from"./react-vendor-CTUriZ5h.js";import{M as x}from"./MerchantLayout-CJmgIMDC.js";import{P as h}from"./package-ChDCFdB3.js";import{C as M}from"./clock-Dhxn45-3.js";import{C as j}from"./check-circle-CyNeZd0p.js";import{X as A}from"./x-circle-D3f66Y07.js";import{B as p}from"./bar-chart-3-DdlwYHtY.js";import{U as L}from"./users-4zMWxYqH.js";import"./supabase-Bl4YWSQ9.js";import"./x-D4qrk5Qy.js";import"./createLucideIcon-CMjKDoEE.js";import"./menu-DP2azNEK.js";import"./store-B-5iV_wL.js";import"./layout-dashboard-CqNl1jWq.js";import"./message-square-B53yKzw3.js";import"./log-out-BX30H4-p.js";function K(){const g=E(),[a,u]=n.useState({total:0,pending:0,validated:0,rejected:0,completed:0,validationRate:0}),[r,f]=n.useState([]),[N,b]=n.useState(!0);n.useEffect(()=>{v(),w()},[]);const v=async()=>{const{data:{session:t}}=await m.auth.getSession();t||g("/merchant/login")},w=async()=>{try{const{data:t}=await m.from("exchanges").select("*");if(t){const l=t.length,y=t.filter(s=>s.status==="pending").length,o=t.filter(s=>s.status==="validated"||s.status==="preparing"||s.status==="in_transit"||s.status==="completed").length,S=t.filter(s=>s.status==="rejected").length,C=t.filter(s=>s.status==="completed").length,R=l>0?Math.round(o/l*100):0;u({total:l,pending:y,validated:o,rejected:S,completed:C,validationRate:R});const i={};t.forEach(s=>{i[s.reason]=(i[s.reason]||0)+1});const k=Object.entries(i).map(([s,c])=>({reason:s,count:c})).sort((s,c)=>c.count-s.count).slice(0,5);f(k)}}catch(t){console.error("Error fetching stats:",t)}finally{b(!1)}};return N?e.jsx(x,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):e.jsx(x,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Vue d'ensemble"}),e.jsx("p",{className:"text-slate-600",children:"Statistiques et métriques de vos échanges"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(h,{className:"w-6 h-6 text-blue-600"})}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:a.total})]}),e.jsx("h3",{className:"text-slate-600 text-sm",children:"Total des échanges"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(M,{className:"w-6 h-6 text-yellow-600"})}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:a.pending})]}),e.jsx("h3",{className:"text-slate-600 text-sm",children:"En attente"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(j,{className:"w-6 h-6 text-emerald-600"})}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:a.validated})]}),e.jsx("h3",{className:"text-slate-600 text-sm",children:"Validés"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(A,{className:"w-6 h-6 text-red-600"})}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:a.rejected})]}),e.jsx("h3",{className:"text-slate-600 text-sm",children:"Rejetés"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Taux de validation"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-4",children:e.jsx("div",{className:"bg-emerald-600 h-4 rounded-full transition-all",style:{width:`${a.validationRate}%`}})})}),e.jsxs("span",{className:"text-2xl font-bold text-slate-900",children:[a.validationRate,"%"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Échanges complétés"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(j,{className:"w-12 h-12 text-green-600"}),e.jsx("span",{className:"text-3xl font-bold text-slate-900",children:a.completed})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5"}),"Raisons d'échange principales"]}),r.length>0?e.jsx("div",{className:"space-y-3",children:r.map((t,l)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-slate-700",children:t.reason}),e.jsx("span",{className:"font-medium text-slate-900",children:t.count})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-sky-600 h-2 rounded-full",style:{width:`${t.count/a.total*100}%`}})})]},l))}):e.jsx("p",{className:"text-slate-600 text-center py-8",children:"Aucune donnée disponible"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Accès rapide"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{to:"/merchant/exchanges",className:"flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors",children:[e.jsx(h,{className:"w-5 h-5 text-slate-600"}),e.jsx("span",{className:"font-medium text-slate-900",children:"Gérer les échanges"})]}),e.jsxs(d,{to:"/merchant/clients",className:"flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors",children:[e.jsx(L,{className:"w-5 h-5 text-slate-600"}),e.jsx("span",{className:"font-medium text-slate-900",children:"Voir les clients"})]}),e.jsxs(d,{to:"/merchant/simulation",className:"flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors",children:[e.jsx(p,{className:"w-5 h-5 text-slate-600"}),e.jsx("span",{className:"font-medium text-slate-900",children:"Mode simulation"})]})]})]})]})]})})}export{K as default};
