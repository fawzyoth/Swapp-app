import{u as g,d as v,r as d,s as h,j as e}from"./index-CGuTpfce.js";import{A as o}from"./AdminLayout-U_fO2Lid.js";import{A as b}from"./arrow-left-BpEP3EcE.js";import{T as w}from"./truck-T6aPcJoR.js";import{S as y}from"./square-pen-Q42XIdqE.js";import{M as _}from"./mail-BbBY_8oi.js";import{P as C}from"./phone-BtRXp_zB.js";import{C as D}from"./calendar-CNHCk6yJ.js";import{T as P}from"./trending-up-DgiTMxqX.js";import{P as R}from"./package-BUge56jo.js";import{C as S}from"./check-circle-C8LdpYcK.js";import{X as A}from"./x-circle-CzZ9yoQm.js";import{C as k}from"./clock-D5l6KAfG.js";import"./x-BDYXHXVZ.js";import"./createLucideIcon-D9R5Vyj_.js";import"./menu-BDfgw-7m.js";import"./shield-tj2Ggf38.js";import"./layout-dashboard-C14bcGdN.js";import"./users-B34gaGxt.js";import"./banknote-C3qg8fnc.js";import"./wallet-rOluuaMK.js";import"./store-B7RLKw5c.js";import"./file-text-CNKwjRK0.js";import"./home-Bw_Q-z1r.js";function te(){const c=g(),{id:a}=v(),[r,p]=d.useState(null),[l,j]=d.useState([]),[f,u]=d.useState(!0);d.useEffect(()=>{a&&N()},[a]);const N=async()=>{try{const{data:s,error:i}=await h.from("delivery_persons").select("*").eq("id",a).single();if(i)throw i;p(s);const{data:n,error:m}=await h.from("delivery_verifications").select("*, exchanges(*)").eq("delivery_person_id",a).order("created_at",{ascending:!1}).limit(10);if(m)throw m;j(n||[])}catch(s){console.error("Error fetching delivery person:",s),c("/admin/delivery-persons")}finally{u(!1)}};if(f)return e.jsx(o,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})})});if(!r)return e.jsx(o,{children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Livreur non trouvé"}),e.jsx("button",{onClick:()=>c("/admin/delivery-persons"),className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Retour aux livreurs"})]})});const t={total:l.length,accepted:l.filter(s=>s.status==="accepted").length,rejected:l.filter(s=>s.status==="rejected").length},x=t.total>0?Math.round(t.accepted/t.total*100):0;return e.jsx(o,{children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("button",{onClick:()=>c("/admin/delivery-persons"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 mb-6",children:[e.jsx(b,{className:"w-5 h-5"}),"Retour aux livreurs"]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-xl flex items-center justify-center",children:e.jsx(w,{className:"w-8 h-8 text-amber-600"})}),e.jsxs("button",{onClick:()=>c(`/admin/delivery-person/${a}/edit`),className:"flex items-center gap-2 px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",children:[e.jsx(y,{className:"w-4 h-4"}),"Modifier"]})]}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4",children:r.name}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[e.jsx(_,{className:"w-5 h-5"}),e.jsx("span",{children:r.email})]}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{children:r.phone})]}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[e.jsx(D,{className:"w-5 h-5"}),e.jsxs("span",{children:["Inscrit le ",new Date(r.created_at).toLocaleDateString("fr-FR")]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Statistiques"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:t.total}),e.jsx("div",{className:"text-xs text-slate-600",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:t.accepted}),e.jsx("div",{className:"text-xs text-slate-600",children:"Acceptés"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.rejected}),e.jsx("div",{className:"text-xs text-slate-600",children:"Refusés"})]})]}),t.total>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Taux d'acceptation"}),e.jsxs("span",{className:"text-sm font-bold text-slate-900",children:[x,"%"]})]}),e.jsx("div",{className:"bg-slate-100 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 rounded-full transition-all duration-500",style:{width:`${x}%`}})})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(P,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Dernières vérifications"})]}),l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(R,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Aucune vérification effectuée"})]}):e.jsx("div",{className:"space-y-4",children:l.map(s=>{var i,n;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"font-mono font-medium text-slate-900",children:((i=s.exchanges)==null?void 0:i.exchange_code)||"N/A"}),s.status==="accepted"?e.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded-full text-xs font-medium",children:[e.jsx(S,{className:"w-3 h-3"}),"Accepté"]}):e.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 bg-red-100 text-red-700 rounded-full text-xs font-medium",children:[e.jsx(A,{className:"w-3 h-3"}),"Refusé"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-slate-600",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Client:"})," ",((n=s.exchanges)==null?void 0:n.client_name)||"Inconnu"]}),s.bag_id&&e.jsxs("span",{children:[e.jsx("strong",{children:"Sac:"})," ",s.bag_id]})]}),s.rejection_reason&&e.jsxs("p",{className:"mt-2 text-sm text-red-600",children:["Raison: ",s.rejection_reason]})]}),e.jsx("div",{className:"text-right ml-4",children:e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-500",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})})]},s.id)})})]})})]})]})})}export{te as default};
