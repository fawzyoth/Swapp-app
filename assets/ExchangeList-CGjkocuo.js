import{s as g,j as e,S as N}from"./index-CYPRHEJa.js";import{u as y,r as s,L as v}from"./react-vendor-CTUriZ5h.js";import{M as d}from"./MerchantLayout-CJmgIMDC.js";import{S as b}from"./search-CPbK6Y1N.js";import{F as w}from"./filter-Cp7rfch8.js";import"./supabase-Bl4YWSQ9.js";import"./x-D4qrk5Qy.js";import"./createLucideIcon-CMjKDoEE.js";import"./menu-DP2azNEK.js";import"./store-B-5iV_wL.js";import"./layout-dashboard-CqNl1jWq.js";import"./package-ChDCFdB3.js";import"./users-4zMWxYqH.js";import"./message-square-B53yKzw3.js";import"./log-out-BX30H4-p.js";function B(){y();const[n,c]=s.useState([]),[i,o]=s.useState([]),[a,x]=s.useState(""),[r,m]=s.useState("all"),[h,p]=s.useState(!0);s.useEffect(()=>{u()},[]),s.useEffect(()=>{f()},[n,a,r]);const u=async()=>{try{const{data:t}=await g.from("exchanges").select("*").order("created_at",{ascending:!1});c(t||[])}catch(t){console.error("Error fetching exchanges:",t)}finally{p(!1)}},f=()=>{let t=[...n];r!=="all"&&(t=t.filter(l=>l.status===r)),a&&(t=t.filter(l=>l.client_name.toLowerCase().includes(a.toLowerCase())||l.client_phone.includes(a)||l.exchange_code.toLowerCase().includes(a.toLowerCase()))),o(t)},j=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-800";case"validated":return"bg-emerald-100 text-emerald-800";case"rejected":return"bg-red-100 text-red-800";case"completed":return"bg-green-100 text-green-800";default:return"bg-blue-100 text-blue-800"}};return h?e.jsx(d,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):e.jsx(d,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Demandes d'échange"}),e.jsx("p",{className:"text-slate-600",children:"Gérez et validez les demandes de vos clients"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow p-6 mb-6",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Rechercher par nom, téléphone ou code...",value:a,onChange:t=>x(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e.jsxs("select",{value:r,onChange:t=>m(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[e.jsx("option",{value:"all",children:"Tous les statuts"}),e.jsx("option",{value:"pending",children:"En attente"}),e.jsx("option",{value:"validated",children:"Validé"}),e.jsx("option",{value:"preparing",children:"En préparation"}),e.jsx("option",{value:"in_transit",children:"En route"}),e.jsx("option",{value:"completed",children:"Complété"}),e.jsx("option",{value:"rejected",children:"Rejeté"})]})]})]})}),i.length===0?e.jsx("div",{className:"bg-white rounded-xl shadow p-12 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Aucun échange trouvé"})}):e.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Code"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Client"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Téléphone"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Raison"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Statut"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:i.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-slate-900",children:t.exchange_code}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:t.client_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:t.client_phone}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:t.reason}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:new Date(t.created_at).toLocaleDateString("fr-FR")}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs ${j(t.status)}`,children:N[t.status]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(v,{to:`/merchant/exchange/${t.id}`,className:"text-sky-600 hover:text-sky-700 text-sm font-medium",children:"Voir détails"})})]},t.id))})]})})]})})}export{B as default};
