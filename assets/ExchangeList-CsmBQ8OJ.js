import{s as l,j as e,S as E}from"./index-DdAZvCql.js";import{u as C,r as s,L as I}from"./react-vendor-CTUriZ5h.js";import{M as h}from"./MerchantLayout-BoH8hDF2.js";import{P as O}from"./play-rTm69v02.js";import{S as L}from"./search-CPbK6Y1N.js";import{F as T}from"./filter-Cp7rfch8.js";import"./supabase-Bl4YWSQ9.js";import"./x-D4qrk5Qy.js";import"./createLucideIcon-CMjKDoEE.js";import"./menu-DP2azNEK.js";import"./store-B-5iV_wL.js";import"./layout-dashboard-CqNl1jWq.js";import"./package-ChDCFdB3.js";import"./truck-CgEV9F53.js";import"./users-4zMWxYqH.js";import"./banknote-JI0QWWz-.js";import"./message-square-B53yKzw3.js";import"./star-Cw7sdsKF.js";import"./video-Cwp6uQ4V.js";import"./log-out-BX30H4-p.js";const M=50,x=[{id:"demo-1",exchange_code:"EXC-2024-001",client_name:"Ahmed Ben Ali",client_phone:"+216 55 123 456",client_address:"15 Rue de la Liberte",client_city:"Tunis",product_name:"T-Shirt Nike - Taille L",reason:"Taille incorrecte",status:"pending",payment_amount:0,payment_status:"pending",created_at:new Date().toISOString()},{id:"demo-2",exchange_code:"EXC-2024-002",client_name:"Leila Mansouri",client_phone:"+216 98 111 222",client_address:"42 Avenue Habib Bourguiba",client_city:"Sfax",product_name:"Robe Zara - Rouge",reason:"Couleur non conforme",status:"pending",payment_amount:15,payment_status:"pending",created_at:new Date(Date.now()-36e5).toISOString()},{id:"demo-3",exchange_code:"EXC-2024-003",client_name:"Karim Bouzid",client_phone:"+216 22 333 444",client_address:"8 Rue Ibn Khaldoun",client_city:"Sousse",product_name:"Chaussures Adidas - 42",reason:"Produit defectueux",status:"pending",payment_amount:0,payment_status:"pending",created_at:new Date(Date.now()-72e5).toISOString()},{id:"demo-4",exchange_code:"EXC-2024-004",client_name:"Fatma Trabelsi",client_phone:"+216 22 987 654",client_address:"25 Rue de Marseille",client_city:"Tunis",product_name:"Sac a main Guess",reason:"Ne correspond pas a la description",status:"validated",payment_amount:0,payment_status:"free",validated_at:new Date(Date.now()-864e5).toISOString(),created_at:new Date(Date.now()-864e5*2).toISOString()},{id:"demo-5",exchange_code:"EXC-2024-005",client_name:"Slim Hamdi",client_phone:"+216 55 666 777",client_address:"12 Avenue de la Republique",client_city:"Bizerte",product_name:"Montre Casio G-Shock",reason:"Produit defectueux",status:"validated",payment_amount:25,payment_status:"pending",validated_at:new Date(Date.now()-432e5).toISOString(),created_at:new Date(Date.now()-864e5).toISOString()},{id:"demo-6",exchange_code:"EXC-2024-006",client_name:"Youssef Hammami",client_phone:"+216 23 456 789",client_address:"7 Rue de Paris",client_city:"La Marsa",product_name:"Veste en cuir - Taille M",reason:"Changement d'avis",status:"ready_for_pickup",payment_amount:0,payment_status:"free",pickup_scheduled_date:new Date(Date.now()+864e5).toISOString(),jax_ean:"JAX-TN-2024-123456",created_at:new Date(Date.now()-864e5*3).toISOString()},{id:"demo-7",exchange_code:"EXC-2024-007",client_name:"Nadia Gharbi",client_phone:"+216 50 888 999",client_address:"33 Rue de Carthage",client_city:"Tunis",product_name:"Parfum Dior - 100ml",reason:"Produit ne correspond pas",status:"ready_for_pickup",payment_amount:45,payment_status:"pending",pickup_scheduled_date:new Date(Date.now()+1728e5).toISOString(),jax_ean:"JAX-TN-2024-789012",created_at:new Date(Date.now()-864e5*2).toISOString()},{id:"demo-8",exchange_code:"EXC-2024-008",client_name:"Hichem Bouslama",client_phone:"+216 29 111 333",client_address:"18 Avenue Mohamed V",client_city:"Nabeul",product_name:"Laptop HP Pavilion",reason:"Ecran defectueux",status:"in_transit",payment_amount:0,payment_status:"free",delivery_person_id:"dp-demo-1",created_at:new Date(Date.now()-864e5*4).toISOString()},{id:"demo-9",exchange_code:"EXC-2024-009",client_name:"Mohamed Kacem",client_phone:"+216 98 456 123",client_address:"55 Rue de Rome",client_city:"Tunis",product_name:"Smartphone Samsung Galaxy",reason:"Batterie defectueuse",status:"completed",payment_amount:0,payment_status:"free",return_product_status:"accepted",return_product_notes:"Produit en bon etat, echange effectue",completed_at:new Date(Date.now()-864e5*2).toISOString(),created_at:new Date(Date.now()-864e5*5).toISOString()},{id:"demo-10",exchange_code:"EXC-2024-010",client_name:"Amira Khelifi",client_phone:"+216 21 444 555",client_address:"22 Rue Alain Savary",client_city:"Tunis",product_name:"Tablette iPad Pro",reason:"Ecran casse a la livraison",status:"completed",payment_amount:30,payment_status:"collected",return_product_status:"accepted",completed_at:new Date(Date.now()-864e5*3).toISOString(),created_at:new Date(Date.now()-864e5*6).toISOString()},{id:"demo-11",exchange_code:"EXC-2024-011",client_name:"Raouf Jebali",client_phone:"+216 58 777 888",client_address:"9 Rue de Hollande",client_city:"Sousse",product_name:"Casque Beats Solo",reason:"Son defectueux",status:"completed",payment_amount:0,payment_status:"free",return_product_status:"problem",return_product_notes:"Legere rayure sur le produit retourne",completed_at:new Date(Date.now()-864e5*4).toISOString(),created_at:new Date(Date.now()-864e5*7).toISOString()},{id:"demo-12",exchange_code:"EXC-2024-012",client_name:"Sarra Bouaziz",client_phone:"+216 50 789 012",client_address:"14 Rue de Grece",client_city:"Tunis",product_name:"Lunettes Ray-Ban",reason:"Ne me plait plus",status:"rejected",rejection_reason:"Delai de retour depasse (30 jours)",created_at:new Date(Date.now()-864e5*8).toISOString()},{id:"demo-13",exchange_code:"EXC-2024-013",client_name:"Walid Mejri",client_phone:"+216 27 222 333",client_address:"31 Avenue de France",client_city:"Sfax",product_name:"Chemise Hugo Boss",reason:"Taille trop grande",status:"rejected",rejection_reason:"Produit porte et lave, traces visibles",created_at:new Date(Date.now()-864e5*10).toISOString()},{id:"demo-14",exchange_code:"EXC-2024-014",client_name:"Ines Braham",client_phone:"+216 54 999 000",client_address:"6 Rue de Londres",client_city:"Tunis",product_name:"Jeans Levi's 501",reason:"Mauvaise taille",status:"completed",payment_amount:0,payment_status:"free",return_product_status:"accepted",completed_at:new Date(Date.now()-864e5*5).toISOString(),created_at:new Date(Date.now()-864e5*9).toISOString()},{id:"demo-15",exchange_code:"EXC-2024-015",client_name:"Fares Dridi",client_phone:"+216 92 666 777",client_address:"45 Rue du Lac",client_city:"Tunis",product_name:"Polo Lacoste",reason:"Couleur differente de la photo",status:"completed",payment_amount:20,payment_status:"collected",return_product_status:"accepted",completed_at:new Date(Date.now()-864e5*6).toISOString(),created_at:new Date(Date.now()-864e5*10).toISOString()}];function te(){const m=C(),[u,i]=s.useState([]),[p,g]=s.useState([]),[n,f]=s.useState(""),[r,y]=s.useState("all"),[S,d]=s.useState(!0),[R,w]=s.useState(null),[o,c]=s.useState(!1);s.useEffect(()=>{const t=sessionStorage.getItem("demo_mode")==="true";c(t),t?(i(x),d(!1)):_()},[]),s.useEffect(()=>{b()},[u,n,r]);const j=()=>{sessionStorage.removeItem("demo_mode"),sessionStorage.removeItem("demo_merchant"),m("/merchant/login")},v=()=>{o?(sessionStorage.removeItem("demo_mode"),sessionStorage.removeItem("demo_merchant"),c(!1),d(!0),_()):(sessionStorage.setItem("demo_mode","true"),sessionStorage.setItem("demo_merchant",JSON.stringify({id:"demo-merchant-id",email:"demo@merchant.com",name:"Boutique Demo"})),c(!0),i(x))},_=async()=>{try{const{data:{session:t}}=await l.auth.getSession();if(!t){m("/merchant/login");return}const{data:a}=await l.from("merchants").select("id").eq("email",t.user.email).maybeSingle();a&&(w(a.id),await D(a.id))}catch(t){console.error("Error:",t)}finally{d(!1)}},D=async t=>{try{const{data:a}=await l.from("exchanges").select("id, exchange_code, client_name, client_phone, reason, status, created_at").eq("merchant_id",t).order("created_at",{ascending:!1}).limit(M);i(a||[])}catch(a){console.error("Error fetching exchanges:",a)}},b=()=>{let t=[...u];r!=="all"&&(t=t.filter(a=>a.status===r)),n&&(t=t.filter(a=>a.client_name.toLowerCase().includes(n.toLowerCase())||a.client_phone.includes(n)||a.exchange_code.toLowerCase().includes(n.toLowerCase()))),g(t)},N=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-800";case"validated":return"bg-emerald-100 text-emerald-800";case"rejected":return"bg-red-100 text-red-800";case"completed":return"bg-green-100 text-green-800";default:return"bg-blue-100 text-blue-800"}};return S?e.jsx(h,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):e.jsx(h,{children:e.jsxs("div",{children:[o&&e.jsx("div",{className:"mb-6 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-xl p-4 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(O,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold",children:"Mode Démonstration"}),e.jsx("p",{className:"text-purple-100 text-sm",children:"Vous visualisez des données fictives. Cliquez sur un échange pour voir les détails."})]}),e.jsx("button",{onClick:j,className:"px-4 py-2 bg-white text-purple-600 rounded-lg font-semibold text-sm hover:bg-purple-50 transition-colors",children:"Quitter la Demo"})]})}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Demandes d'échange"}),e.jsx("p",{className:"text-slate-600",children:"Gérez et validez les demandes de vos clients"})]}),e.jsxs("button",{onClick:v,className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium text-sm transition-all ${o?"bg-purple-600 text-white shadow-lg shadow-purple-200":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${o?"bg-white animate-pulse":"bg-slate-400"}`}),o?"Mode Demo Actif":"Activer Mode Demo"]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow p-6 mb-6",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Rechercher par nom, téléphone ou code...",value:n,onChange:t=>f(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e.jsxs("select",{value:r,onChange:t=>y(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[e.jsx("option",{value:"all",children:"Tous les statuts"}),e.jsx("option",{value:"pending",children:"En attente"}),e.jsx("option",{value:"validated",children:"Validé"}),e.jsx("option",{value:"ready_for_pickup",children:"Prêt pour ramassage"}),e.jsx("option",{value:"preparing",children:"En préparation"}),e.jsx("option",{value:"in_transit",children:"En route"}),e.jsx("option",{value:"completed",children:"Complété"}),e.jsx("option",{value:"rejected",children:"Rejeté"})]})]})]})}),p.length===0?e.jsx("div",{className:"bg-white rounded-xl shadow p-12 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Aucun échange trouvé"})}):e.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Code"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Client"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Téléphone"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Raison"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Statut"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:p.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-slate-900",children:t.exchange_code}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:t.client_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:t.client_phone}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:t.reason}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:new Date(t.created_at).toLocaleDateString("fr-FR")}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs ${N(t.status)}`,children:E[t.status]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(I,{to:`/merchant/exchange/${t.id}`,className:"text-sky-600 hover:text-sky-700 text-sm font-medium",children:"Voir détails"})})]},t.id))})]})})]})})}export{te as default};
