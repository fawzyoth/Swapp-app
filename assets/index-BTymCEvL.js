function N1(t,e){for(var r=0;r<e.length;r++){const s=e[r];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in t)){const l=Object.getOwnPropertyDescriptor(s,o);l&&Object.defineProperty(t,o,l.get?l:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();var ha=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function qp(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var o=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(r,s,o.get?o:{enumerable:!0,get:function(){return t[s]}})}),r}var _1={exports:{}},Jl={},S1={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lo=Symbol.for("react.element"),Kp=Symbol.for("react.portal"),Qp=Symbol.for("react.fragment"),Zp=Symbol.for("react.strict_mode"),Jp=Symbol.for("react.profiler"),e2=Symbol.for("react.provider"),t2=Symbol.for("react.context"),r2=Symbol.for("react.forward_ref"),n2=Symbol.for("react.suspense"),s2=Symbol.for("react.memo"),i2=Symbol.for("react.lazy"),w0=Symbol.iterator;function a2(t){return t===null||typeof t!="object"?null:(t=w0&&t[w0]||t["@@iterator"],typeof t=="function"?t:null)}var A1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I1=Object.assign,T1={};function $i(t,e,r){this.props=t,this.context=e,this.refs=T1,this.updater=r||A1}$i.prototype.isReactComponent={};$i.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$i.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function j1(){}j1.prototype=$i.prototype;function Dd(t,e,r){this.props=t,this.context=e,this.refs=T1,this.updater=r||A1}var Ld=Dd.prototype=new j1;Ld.constructor=Dd;I1(Ld,$i.prototype);Ld.isPureReactComponent=!0;var y0=Array.isArray,R1=Object.prototype.hasOwnProperty,Pd={current:null},O1={key:!0,ref:!0,__self:!0,__source:!0};function k1(t,e,r){var s,o={},l=null,f=null;if(e!=null)for(s in e.ref!==void 0&&(f=e.ref),e.key!==void 0&&(l=""+e.key),e)R1.call(e,s)&&!O1.hasOwnProperty(s)&&(o[s]=e[s]);var g=arguments.length-2;if(g===1)o.children=r;else if(1<g){for(var w=Array(g),x=0;x<g;x++)w[x]=arguments[x+2];o.children=w}if(t&&t.defaultProps)for(s in g=t.defaultProps,g)o[s]===void 0&&(o[s]=g[s]);return{$$typeof:lo,type:t,key:l,ref:f,props:o,_owner:Pd.current}}function o2(t,e){return{$$typeof:lo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Bd(t){return typeof t=="object"&&t!==null&&t.$$typeof===lo}function l2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var v0=/\/+/g;function Uc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?l2(""+t.key):e.toString(36)}function sl(t,e,r,s,o){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var f=!1;if(t===null)f=!0;else switch(l){case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case lo:case Kp:f=!0}}if(f)return f=t,o=o(f),t=s===""?"."+Uc(f,0):s,y0(o)?(r="",t!=null&&(r=t.replace(v0,"$&/")+"/"),sl(o,e,r,"",function(x){return x})):o!=null&&(Bd(o)&&(o=o2(o,r+(!o.key||f&&f.key===o.key?"":(""+o.key).replace(v0,"$&/")+"/")+t)),e.push(o)),1;if(f=0,s=s===""?".":s+":",y0(t))for(var g=0;g<t.length;g++){l=t[g];var w=s+Uc(l,g);f+=sl(l,e,r,w,o)}else if(w=a2(t),typeof w=="function")for(t=w.call(t),g=0;!(l=t.next()).done;)l=l.value,w=s+Uc(l,g++),f+=sl(l,e,r,w,o);else if(l==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return f}function Ro(t,e,r){if(t==null)return t;var s=[],o=0;return sl(t,s,"","",function(l){return e.call(r,l,o++)}),s}function c2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ir={current:null},il={transition:null},u2={ReactCurrentDispatcher:ir,ReactCurrentBatchConfig:il,ReactCurrentOwner:Pd};function M1(){throw Error("act(...) is not supported in production builds of React.")}Te.Children={map:Ro,forEach:function(t,e,r){Ro(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ro(t,function(){e++}),e},toArray:function(t){return Ro(t,function(e){return e})||[]},only:function(t){if(!Bd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Te.Component=$i;Te.Fragment=Qp;Te.Profiler=Jp;Te.PureComponent=Dd;Te.StrictMode=Zp;Te.Suspense=n2;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=u2;Te.act=M1;Te.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=I1({},t.props),o=t.key,l=t.ref,f=t._owner;if(e!=null){if(e.ref!==void 0&&(l=e.ref,f=Pd.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var g=t.type.defaultProps;for(w in e)R1.call(e,w)&&!O1.hasOwnProperty(w)&&(s[w]=e[w]===void 0&&g!==void 0?g[w]:e[w])}var w=arguments.length-2;if(w===1)s.children=r;else if(1<w){g=Array(w);for(var x=0;x<w;x++)g[x]=arguments[x+2];s.children=g}return{$$typeof:lo,type:t.type,key:o,ref:l,props:s,_owner:f}};Te.createContext=function(t){return t={$$typeof:t2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:e2,_context:t},t.Consumer=t};Te.createElement=k1;Te.createFactory=function(t){var e=k1.bind(null,t);return e.type=t,e};Te.createRef=function(){return{current:null}};Te.forwardRef=function(t){return{$$typeof:r2,render:t}};Te.isValidElement=Bd;Te.lazy=function(t){return{$$typeof:i2,_payload:{_status:-1,_result:t},_init:c2}};Te.memo=function(t,e){return{$$typeof:s2,type:t,compare:e===void 0?null:e}};Te.startTransition=function(t){var e=il.transition;il.transition={};try{t()}finally{il.transition=e}};Te.unstable_act=M1;Te.useCallback=function(t,e){return ir.current.useCallback(t,e)};Te.useContext=function(t){return ir.current.useContext(t)};Te.useDebugValue=function(){};Te.useDeferredValue=function(t){return ir.current.useDeferredValue(t)};Te.useEffect=function(t,e){return ir.current.useEffect(t,e)};Te.useId=function(){return ir.current.useId()};Te.useImperativeHandle=function(t,e,r){return ir.current.useImperativeHandle(t,e,r)};Te.useInsertionEffect=function(t,e){return ir.current.useInsertionEffect(t,e)};Te.useLayoutEffect=function(t,e){return ir.current.useLayoutEffect(t,e)};Te.useMemo=function(t,e){return ir.current.useMemo(t,e)};Te.useReducer=function(t,e,r){return ir.current.useReducer(t,e,r)};Te.useRef=function(t){return ir.current.useRef(t)};Te.useState=function(t){return ir.current.useState(t)};Te.useSyncExternalStore=function(t,e,r){return ir.current.useSyncExternalStore(t,e,r)};Te.useTransition=function(){return ir.current.useTransition()};Te.version="18.3.1";S1.exports=Te;var P=S1.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d2=P,h2=Symbol.for("react.element"),f2=Symbol.for("react.fragment"),m2=Object.prototype.hasOwnProperty,g2=d2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x2={key:!0,ref:!0,__self:!0,__source:!0};function D1(t,e,r){var s,o={},l=null,f=null;r!==void 0&&(l=""+r),e.key!==void 0&&(l=""+e.key),e.ref!==void 0&&(f=e.ref);for(s in e)m2.call(e,s)&&!x2.hasOwnProperty(s)&&(o[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)o[s]===void 0&&(o[s]=e[s]);return{$$typeof:h2,type:t,key:l,ref:f,props:o,_owner:g2.current}}Jl.Fragment=f2;Jl.jsx=D1;Jl.jsxs=D1;_1.exports=Jl;var u=_1.exports,L1={exports:{}},Or={},P1={exports:{}},B1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ie,xe){var ye=ie.length;ie.push(xe);e:for(;0<ye;){var qe=ye-1>>>1,je=ie[qe];if(0<o(je,xe))ie[qe]=xe,ie[ye]=je,ye=qe;else break e}}function r(ie){return ie.length===0?null:ie[0]}function s(ie){if(ie.length===0)return null;var xe=ie[0],ye=ie.pop();if(ye!==xe){ie[0]=ye;e:for(var qe=0,je=ie.length,Dt=je>>>1;qe<Dt;){var Ie=2*(qe+1)-1,Q=ie[Ie],se=Ie+1,Mr=ie[se];if(0>o(Q,ye))se<je&&0>o(Mr,Q)?(ie[qe]=Mr,ie[se]=ye,qe=se):(ie[qe]=Q,ie[Ie]=ye,qe=Ie);else if(se<je&&0>o(Mr,ye))ie[qe]=Mr,ie[se]=ye,qe=se;else break e}}return xe}function o(ie,xe){var ye=ie.sortIndex-xe.sortIndex;return ye!==0?ye:ie.id-xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var f=Date,g=f.now();t.unstable_now=function(){return f.now()-g}}var w=[],x=[],v=1,E=null,S=3,I=!1,k=!1,j=!1,M=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(ie){for(var xe=r(x);xe!==null;){if(xe.callback===null)s(x);else if(xe.startTime<=ie)s(x),xe.sortIndex=xe.expirationTime,e(w,xe);else break;xe=r(x)}}function O(ie){if(j=!1,T(ie),!k)if(r(w)!==null)k=!0,Ye(V);else{var xe=r(x);xe!==null&&Ee(O,xe.startTime-ie)}}function V(ie,xe){k=!1,j&&(j=!1,A($),$=-1),I=!0;var ye=S;try{for(T(xe),E=r(w);E!==null&&(!(E.expirationTime>xe)||ie&&!be());){var qe=E.callback;if(typeof qe=="function"){E.callback=null,S=E.priorityLevel;var je=qe(E.expirationTime<=xe);xe=t.unstable_now(),typeof je=="function"?E.callback=je:E===r(w)&&s(w),T(xe)}else s(w);E=r(w)}if(E!==null)var Dt=!0;else{var Ie=r(x);Ie!==null&&Ee(O,Ie.startTime-xe),Dt=!1}return Dt}finally{E=null,S=ye,I=!1}}var z=!1,U=null,$=-1,G=5,te=-1;function be(){return!(t.unstable_now()-te<G)}function ue(){if(U!==null){var ie=t.unstable_now();te=ie;var xe=!0;try{xe=U(!0,ie)}finally{xe?Ne():(z=!1,U=null)}}else z=!1}var Ne;if(typeof C=="function")Ne=function(){C(ue)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,Y=We.port2;We.port1.onmessage=ue,Ne=function(){Y.postMessage(null)}}else Ne=function(){M(ue,0)};function Ye(ie){U=ie,z||(z=!0,Ne())}function Ee(ie,xe){$=M(function(){ie(t.unstable_now())},xe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_continueExecution=function(){k||I||(k=!0,Ye(V))},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return S},t.unstable_getFirstCallbackNode=function(){return r(w)},t.unstable_next=function(ie){switch(S){case 1:case 2:case 3:var xe=3;break;default:xe=S}var ye=S;S=xe;try{return ie()}finally{S=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ie,xe){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ye=S;S=ie;try{return xe()}finally{S=ye}},t.unstable_scheduleCallback=function(ie,xe,ye){var qe=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?qe+ye:qe):ye=qe,ie){case 1:var je=-1;break;case 2:je=250;break;case 5:je=1073741823;break;case 4:je=1e4;break;default:je=5e3}return je=ye+je,ie={id:v++,callback:xe,priorityLevel:ie,startTime:ye,expirationTime:je,sortIndex:-1},ye>qe?(ie.sortIndex=ye,e(x,ie),r(w)===null&&ie===r(x)&&(j?(A($),$=-1):j=!0,Ee(O,ye-qe))):(ie.sortIndex=je,e(w,ie),k||I||(k=!0,Ye(V))),ie},t.unstable_shouldYield=be,t.unstable_wrapCallback=function(ie){var xe=S;return function(){var ye=S;S=xe;try{return ie.apply(this,arguments)}finally{S=ye}}}})(B1);P1.exports=B1;var p2=P1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w2=P,Rr=p2;function J(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var F1=new Set,Fa={};function qs(t,e){Pi(t,e),Pi(t+"Capture",e)}function Pi(t,e){for(Fa[t]=e,t=0;t<e.length;t++)F1.add(e[t])}var Mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nu=Object.prototype.hasOwnProperty,y2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b0={},E0={};function v2(t){return Nu.call(E0,t)?!0:Nu.call(b0,t)?!1:y2.test(t)?E0[t]=!0:(b0[t]=!0,!1)}function b2(t,e,r,s){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function E2(t,e,r,s){if(e===null||typeof e>"u"||b2(t,e,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ar(t,e,r,s,o,l,f){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=l,this.removeEmptyString=f}var Ht={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ht[t]=new ar(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ht[e]=new ar(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ht[t]=new ar(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ht[t]=new ar(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ht[t]=new ar(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ht[t]=new ar(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ht[t]=new ar(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ht[t]=new ar(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ht[t]=new ar(t,5,!1,t.toLowerCase(),null,!1,!1)});var Fd=/[\-:]([a-z])/g;function Ud(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Fd,Ud);Ht[e]=new ar(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Fd,Ud);Ht[e]=new ar(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Fd,Ud);Ht[e]=new ar(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ht[t]=new ar(t,1,!1,t.toLowerCase(),null,!1,!1)});Ht.xlinkHref=new ar("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ht[t]=new ar(t,1,!1,t.toLowerCase(),null,!0,!0)});function zd(t,e,r,s){var o=Ht.hasOwnProperty(e)?Ht[e]:null;(o!==null?o.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(E2(e,r,o,s)&&(r=null),s||o===null?v2(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):o.mustUseProperty?t[o.propertyName]=r===null?o.type===3?!1:"":r:(e=o.attributeName,s=o.attributeNamespace,r===null?t.removeAttribute(e):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,s?t.setAttributeNS(s,e,r):t.setAttribute(e,r))))}var Un=w2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oo=Symbol.for("react.element"),pi=Symbol.for("react.portal"),wi=Symbol.for("react.fragment"),Vd=Symbol.for("react.strict_mode"),_u=Symbol.for("react.profiler"),U1=Symbol.for("react.provider"),z1=Symbol.for("react.context"),Hd=Symbol.for("react.forward_ref"),Su=Symbol.for("react.suspense"),Au=Symbol.for("react.suspense_list"),Wd=Symbol.for("react.memo"),Qn=Symbol.for("react.lazy"),V1=Symbol.for("react.offscreen"),C0=Symbol.iterator;function fa(t){return t===null||typeof t!="object"?null:(t=C0&&t[C0]||t["@@iterator"],typeof t=="function"?t:null)}var ht=Object.assign,zc;function Ea(t){if(zc===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);zc=e&&e[1]||""}return`
`+zc+t}var Vc=!1;function Hc(t,e){if(!t||Vc)return"";Vc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(x){var s=x}Reflect.construct(t,[],e)}else{try{e.call()}catch(x){s=x}t.call(e.prototype)}else{try{throw Error()}catch(x){s=x}t()}}catch(x){if(x&&s&&typeof x.stack=="string"){for(var o=x.stack.split(`
`),l=s.stack.split(`
`),f=o.length-1,g=l.length-1;1<=f&&0<=g&&o[f]!==l[g];)g--;for(;1<=f&&0<=g;f--,g--)if(o[f]!==l[g]){if(f!==1||g!==1)do if(f--,g--,0>g||o[f]!==l[g]){var w=`
`+o[f].replace(" at new "," at ");return t.displayName&&w.includes("<anonymous>")&&(w=w.replace("<anonymous>",t.displayName)),w}while(1<=f&&0<=g);break}}}finally{Vc=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ea(t):""}function C2(t){switch(t.tag){case 5:return Ea(t.type);case 16:return Ea("Lazy");case 13:return Ea("Suspense");case 19:return Ea("SuspenseList");case 0:case 2:case 15:return t=Hc(t.type,!1),t;case 11:return t=Hc(t.type.render,!1),t;case 1:return t=Hc(t.type,!0),t;default:return""}}function Iu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wi:return"Fragment";case pi:return"Portal";case _u:return"Profiler";case Vd:return"StrictMode";case Su:return"Suspense";case Au:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case z1:return(t.displayName||"Context")+".Consumer";case U1:return(t._context.displayName||"Context")+".Provider";case Hd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Wd:return e=t.displayName||null,e!==null?e:Iu(t.type)||"Memo";case Qn:e=t._payload,t=t._init;try{return Iu(t(e))}catch{}}return null}function N2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Iu(e);case 8:return e===Vd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ms(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function H1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _2(t){var e=H1(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,l=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(f){s=""+f,l.call(this,f)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(f){s=""+f},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ko(t){t._valueTracker||(t._valueTracker=_2(t))}function W1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),s="";return t&&(s=H1(t)?t.checked?"true":"false":t.value),t=s,t!==r?(e.setValue(t),!0):!1}function wl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tu(t,e){var r=e.checked;return ht({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function N0(t,e){var r=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;r=ms(e.value!=null?e.value:r),t._wrapperState={initialChecked:s,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function G1(t,e){e=e.checked,e!=null&&zd(t,"checked",e,!1)}function ju(t,e){G1(t,e);var r=ms(e.value),s=e.type;if(r!=null)s==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ru(t,e.type,r):e.hasOwnProperty("defaultValue")&&Ru(t,e.type,ms(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _0(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Ru(t,e,r){(e!=="number"||wl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ca=Array.isArray;function ji(t,e,r,s){if(t=t.options,e){e={};for(var o=0;o<r.length;o++)e["$"+r[o]]=!0;for(r=0;r<t.length;r++)o=e.hasOwnProperty("$"+t[r].value),t[r].selected!==o&&(t[r].selected=o),o&&s&&(t[r].defaultSelected=!0)}else{for(r=""+ms(r),e=null,o=0;o<t.length;o++){if(t[o].value===r){t[o].selected=!0,s&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function Ou(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(J(91));return ht({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function S0(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(J(92));if(Ca(r)){if(1<r.length)throw Error(J(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ms(r)}}function $1(t,e){var r=ms(e.value),s=ms(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),s!=null&&(t.defaultValue=""+s)}function A0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function X1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ku(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?X1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Mo,Y1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,s,o){MSApp.execUnsafeLocalFunction(function(){return t(e,r,s,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Mo=Mo||document.createElement("div"),Mo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Mo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ua(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Aa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},S2=["Webkit","ms","Moz","O"];Object.keys(Aa).forEach(function(t){S2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Aa[e]=Aa[t]})});function q1(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Aa.hasOwnProperty(t)&&Aa[t]?(""+e).trim():e+"px"}function K1(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var s=r.indexOf("--")===0,o=q1(r,e[r],s);r==="float"&&(r="cssFloat"),s?t.setProperty(r,o):t[r]=o}}var A2=ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mu(t,e){if(e){if(A2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(J(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(J(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(J(61))}if(e.style!=null&&typeof e.style!="object")throw Error(J(62))}}function Du(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lu=null;function Gd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Pu=null,Ri=null,Oi=null;function I0(t){if(t=ho(t)){if(typeof Pu!="function")throw Error(J(280));var e=t.stateNode;e&&(e=sc(e),Pu(t.stateNode,t.type,e))}}function Q1(t){Ri?Oi?Oi.push(t):Oi=[t]:Ri=t}function Z1(){if(Ri){var t=Ri,e=Oi;if(Oi=Ri=null,I0(t),e)for(t=0;t<e.length;t++)I0(e[t])}}function J1(t,e){return t(e)}function em(){}var Wc=!1;function tm(t,e,r){if(Wc)return t(e,r);Wc=!0;try{return J1(t,e,r)}finally{Wc=!1,(Ri!==null||Oi!==null)&&(em(),Z1())}}function za(t,e){var r=t.stateNode;if(r===null)return null;var s=sc(r);if(s===null)return null;r=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(J(231,e,typeof r));return r}var Bu=!1;if(Mn)try{var ma={};Object.defineProperty(ma,"passive",{get:function(){Bu=!0}}),window.addEventListener("test",ma,ma),window.removeEventListener("test",ma,ma)}catch{Bu=!1}function I2(t,e,r,s,o,l,f,g,w){var x=Array.prototype.slice.call(arguments,3);try{e.apply(r,x)}catch(v){this.onError(v)}}var Ia=!1,yl=null,vl=!1,Fu=null,T2={onError:function(t){Ia=!0,yl=t}};function j2(t,e,r,s,o,l,f,g,w){Ia=!1,yl=null,I2.apply(T2,arguments)}function R2(t,e,r,s,o,l,f,g,w){if(j2.apply(this,arguments),Ia){if(Ia){var x=yl;Ia=!1,yl=null}else throw Error(J(198));vl||(vl=!0,Fu=x)}}function Ks(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function rm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function T0(t){if(Ks(t)!==t)throw Error(J(188))}function O2(t){var e=t.alternate;if(!e){if(e=Ks(t),e===null)throw Error(J(188));return e!==t?null:t}for(var r=t,s=e;;){var o=r.return;if(o===null)break;var l=o.alternate;if(l===null){if(s=o.return,s!==null){r=s;continue}break}if(o.child===l.child){for(l=o.child;l;){if(l===r)return T0(o),t;if(l===s)return T0(o),e;l=l.sibling}throw Error(J(188))}if(r.return!==s.return)r=o,s=l;else{for(var f=!1,g=o.child;g;){if(g===r){f=!0,r=o,s=l;break}if(g===s){f=!0,s=o,r=l;break}g=g.sibling}if(!f){for(g=l.child;g;){if(g===r){f=!0,r=l,s=o;break}if(g===s){f=!0,s=l,r=o;break}g=g.sibling}if(!f)throw Error(J(189))}}if(r.alternate!==s)throw Error(J(190))}if(r.tag!==3)throw Error(J(188));return r.stateNode.current===r?t:e}function nm(t){return t=O2(t),t!==null?sm(t):null}function sm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=sm(t);if(e!==null)return e;t=t.sibling}return null}var im=Rr.unstable_scheduleCallback,j0=Rr.unstable_cancelCallback,k2=Rr.unstable_shouldYield,M2=Rr.unstable_requestPaint,bt=Rr.unstable_now,D2=Rr.unstable_getCurrentPriorityLevel,$d=Rr.unstable_ImmediatePriority,am=Rr.unstable_UserBlockingPriority,bl=Rr.unstable_NormalPriority,L2=Rr.unstable_LowPriority,om=Rr.unstable_IdlePriority,ec=null,En=null;function P2(t){if(En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(ec,t,void 0,(t.current.flags&128)===128)}catch{}}var sn=Math.clz32?Math.clz32:U2,B2=Math.log,F2=Math.LN2;function U2(t){return t>>>=0,t===0?32:31-(B2(t)/F2|0)|0}var Do=64,Lo=4194304;function Na(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function El(t,e){var r=t.pendingLanes;if(r===0)return 0;var s=0,o=t.suspendedLanes,l=t.pingedLanes,f=r&268435455;if(f!==0){var g=f&~o;g!==0?s=Na(g):(l&=f,l!==0&&(s=Na(l)))}else f=r&~o,f!==0?s=Na(f):l!==0&&(s=Na(l));if(s===0)return 0;if(e!==0&&e!==s&&!(e&o)&&(o=s&-s,l=e&-e,o>=l||o===16&&(l&4194240)!==0))return e;if(s&4&&(s|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)r=31-sn(e),o=1<<r,s|=t[r],e&=~o;return s}function z2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function V2(t,e){for(var r=t.suspendedLanes,s=t.pingedLanes,o=t.expirationTimes,l=t.pendingLanes;0<l;){var f=31-sn(l),g=1<<f,w=o[f];w===-1?(!(g&r)||g&s)&&(o[f]=z2(g,e)):w<=e&&(t.expiredLanes|=g),l&=~g}}function Uu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function lm(){var t=Do;return Do<<=1,!(Do&4194240)&&(Do=64),t}function Gc(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function co(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-sn(e),t[e]=r}function H2(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<r;){var o=31-sn(r),l=1<<o;e[o]=0,s[o]=-1,t[o]=-1,r&=~l}}function Xd(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var s=31-sn(r),o=1<<s;o&e|t[s]&e&&(t[s]|=e),r&=~o}}var Ve=0;function cm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var um,Yd,dm,hm,fm,zu=!1,Po=[],ss=null,is=null,as=null,Va=new Map,Ha=new Map,Jn=[],W2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function R0(t,e){switch(t){case"focusin":case"focusout":ss=null;break;case"dragenter":case"dragleave":is=null;break;case"mouseover":case"mouseout":as=null;break;case"pointerover":case"pointerout":Va.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ha.delete(e.pointerId)}}function ga(t,e,r,s,o,l){return t===null||t.nativeEvent!==l?(t={blockedOn:e,domEventName:r,eventSystemFlags:s,nativeEvent:l,targetContainers:[o]},e!==null&&(e=ho(e),e!==null&&Yd(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function G2(t,e,r,s,o){switch(e){case"focusin":return ss=ga(ss,t,e,r,s,o),!0;case"dragenter":return is=ga(is,t,e,r,s,o),!0;case"mouseover":return as=ga(as,t,e,r,s,o),!0;case"pointerover":var l=o.pointerId;return Va.set(l,ga(Va.get(l)||null,t,e,r,s,o)),!0;case"gotpointercapture":return l=o.pointerId,Ha.set(l,ga(Ha.get(l)||null,t,e,r,s,o)),!0}return!1}function mm(t){var e=Ps(t.target);if(e!==null){var r=Ks(e);if(r!==null){if(e=r.tag,e===13){if(e=rm(r),e!==null){t.blockedOn=e,fm(t.priority,function(){dm(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function al(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Vu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var s=new r.constructor(r.type,r);Lu=s,r.target.dispatchEvent(s),Lu=null}else return e=ho(r),e!==null&&Yd(e),t.blockedOn=r,!1;e.shift()}return!0}function O0(t,e,r){al(t)&&r.delete(e)}function $2(){zu=!1,ss!==null&&al(ss)&&(ss=null),is!==null&&al(is)&&(is=null),as!==null&&al(as)&&(as=null),Va.forEach(O0),Ha.forEach(O0)}function xa(t,e){t.blockedOn===e&&(t.blockedOn=null,zu||(zu=!0,Rr.unstable_scheduleCallback(Rr.unstable_NormalPriority,$2)))}function Wa(t){function e(o){return xa(o,t)}if(0<Po.length){xa(Po[0],t);for(var r=1;r<Po.length;r++){var s=Po[r];s.blockedOn===t&&(s.blockedOn=null)}}for(ss!==null&&xa(ss,t),is!==null&&xa(is,t),as!==null&&xa(as,t),Va.forEach(e),Ha.forEach(e),r=0;r<Jn.length;r++)s=Jn[r],s.blockedOn===t&&(s.blockedOn=null);for(;0<Jn.length&&(r=Jn[0],r.blockedOn===null);)mm(r),r.blockedOn===null&&Jn.shift()}var ki=Un.ReactCurrentBatchConfig,Cl=!0;function X2(t,e,r,s){var o=Ve,l=ki.transition;ki.transition=null;try{Ve=1,qd(t,e,r,s)}finally{Ve=o,ki.transition=l}}function Y2(t,e,r,s){var o=Ve,l=ki.transition;ki.transition=null;try{Ve=4,qd(t,e,r,s)}finally{Ve=o,ki.transition=l}}function qd(t,e,r,s){if(Cl){var o=Vu(t,e,r,s);if(o===null)tu(t,e,s,Nl,r),R0(t,s);else if(G2(o,t,e,r,s))s.stopPropagation();else if(R0(t,s),e&4&&-1<W2.indexOf(t)){for(;o!==null;){var l=ho(o);if(l!==null&&um(l),l=Vu(t,e,r,s),l===null&&tu(t,e,s,Nl,r),l===o)break;o=l}o!==null&&s.stopPropagation()}else tu(t,e,s,null,r)}}var Nl=null;function Vu(t,e,r,s){if(Nl=null,t=Gd(s),t=Ps(t),t!==null)if(e=Ks(t),e===null)t=null;else if(r=e.tag,r===13){if(t=rm(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nl=t,null}function gm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(D2()){case $d:return 1;case am:return 4;case bl:case L2:return 16;case om:return 536870912;default:return 16}default:return 16}}var rs=null,Kd=null,ol=null;function xm(){if(ol)return ol;var t,e=Kd,r=e.length,s,o="value"in rs?rs.value:rs.textContent,l=o.length;for(t=0;t<r&&e[t]===o[t];t++);var f=r-t;for(s=1;s<=f&&e[r-s]===o[l-s];s++);return ol=o.slice(t,1<s?1-s:void 0)}function ll(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Bo(){return!0}function k0(){return!1}function kr(t){function e(r,s,o,l,f){this._reactName=r,this._targetInst=o,this.type=s,this.nativeEvent=l,this.target=f,this.currentTarget=null;for(var g in t)t.hasOwnProperty(g)&&(r=t[g],this[g]=r?r(l):l[g]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Bo:k0,this.isPropagationStopped=k0,this}return ht(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Bo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Bo)},persist:function(){},isPersistent:Bo}),e}var Xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qd=kr(Xi),uo=ht({},Xi,{view:0,detail:0}),q2=kr(uo),$c,Xc,pa,tc=ht({},uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==pa&&(pa&&t.type==="mousemove"?($c=t.screenX-pa.screenX,Xc=t.screenY-pa.screenY):Xc=$c=0,pa=t),$c)},movementY:function(t){return"movementY"in t?t.movementY:Xc}}),M0=kr(tc),K2=ht({},tc,{dataTransfer:0}),Q2=kr(K2),Z2=ht({},uo,{relatedTarget:0}),Yc=kr(Z2),J2=ht({},Xi,{animationName:0,elapsedTime:0,pseudoElement:0}),ew=kr(J2),tw=ht({},Xi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),rw=kr(tw),nw=ht({},Xi,{data:0}),D0=kr(nw),sw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ow(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=aw[t])?!!e[t]:!1}function Zd(){return ow}var lw=ht({},uo,{key:function(t){if(t.key){var e=sw[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ll(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?iw[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zd,charCode:function(t){return t.type==="keypress"?ll(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ll(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cw=kr(lw),uw=ht({},tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),L0=kr(uw),dw=ht({},uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zd}),hw=kr(dw),fw=ht({},Xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),mw=kr(fw),gw=ht({},tc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xw=kr(gw),pw=[9,13,27,32],Jd=Mn&&"CompositionEvent"in window,Ta=null;Mn&&"documentMode"in document&&(Ta=document.documentMode);var ww=Mn&&"TextEvent"in window&&!Ta,pm=Mn&&(!Jd||Ta&&8<Ta&&11>=Ta),P0=" ",B0=!1;function wm(t,e){switch(t){case"keyup":return pw.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ym(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var yi=!1;function yw(t,e){switch(t){case"compositionend":return ym(e);case"keypress":return e.which!==32?null:(B0=!0,P0);case"textInput":return t=e.data,t===P0&&B0?null:t;default:return null}}function vw(t,e){if(yi)return t==="compositionend"||!Jd&&wm(t,e)?(t=xm(),ol=Kd=rs=null,yi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return pm&&e.locale!=="ko"?null:e.data;default:return null}}var bw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function F0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!bw[t.type]:e==="textarea"}function vm(t,e,r,s){Q1(s),e=_l(e,"onChange"),0<e.length&&(r=new Qd("onChange","change",null,r,s),t.push({event:r,listeners:e}))}var ja=null,Ga=null;function Ew(t){Rm(t,0)}function rc(t){var e=Ei(t);if(W1(e))return t}function Cw(t,e){if(t==="change")return e}var bm=!1;if(Mn){var qc;if(Mn){var Kc="oninput"in document;if(!Kc){var U0=document.createElement("div");U0.setAttribute("oninput","return;"),Kc=typeof U0.oninput=="function"}qc=Kc}else qc=!1;bm=qc&&(!document.documentMode||9<document.documentMode)}function z0(){ja&&(ja.detachEvent("onpropertychange",Em),Ga=ja=null)}function Em(t){if(t.propertyName==="value"&&rc(Ga)){var e=[];vm(e,Ga,t,Gd(t)),tm(Ew,e)}}function Nw(t,e,r){t==="focusin"?(z0(),ja=e,Ga=r,ja.attachEvent("onpropertychange",Em)):t==="focusout"&&z0()}function _w(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return rc(Ga)}function Sw(t,e){if(t==="click")return rc(e)}function Aw(t,e){if(t==="input"||t==="change")return rc(e)}function Iw(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var on=typeof Object.is=="function"?Object.is:Iw;function $a(t,e){if(on(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var o=r[s];if(!Nu.call(e,o)||!on(t[o],e[o]))return!1}return!0}function V0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function H0(t,e){var r=V0(t);t=0;for(var s;r;){if(r.nodeType===3){if(s=t+r.textContent.length,t<=e&&s>=e)return{node:r,offset:e-t};t=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=V0(r)}}function Cm(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Cm(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Nm(){for(var t=window,e=wl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=wl(t.document)}return e}function eh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Tw(t){var e=Nm(),r=t.focusedElem,s=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Cm(r.ownerDocument.documentElement,r)){if(s!==null&&eh(r)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=r.textContent.length,l=Math.min(s.start,o);s=s.end===void 0?l:Math.min(s.end,o),!t.extend&&l>s&&(o=s,s=l,l=o),o=H0(r,l);var f=H0(r,s);o&&f&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==f.node||t.focusOffset!==f.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),l>s?(t.addRange(e),t.extend(f.node,f.offset)):(e.setEnd(f.node,f.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var jw=Mn&&"documentMode"in document&&11>=document.documentMode,vi=null,Hu=null,Ra=null,Wu=!1;function W0(t,e,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Wu||vi==null||vi!==wl(s)||(s=vi,"selectionStart"in s&&eh(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Ra&&$a(Ra,s)||(Ra=s,s=_l(Hu,"onSelect"),0<s.length&&(e=new Qd("onSelect","select",null,e,r),t.push({event:e,listeners:s}),e.target=vi)))}function Fo(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var bi={animationend:Fo("Animation","AnimationEnd"),animationiteration:Fo("Animation","AnimationIteration"),animationstart:Fo("Animation","AnimationStart"),transitionend:Fo("Transition","TransitionEnd")},Qc={},_m={};Mn&&(_m=document.createElement("div").style,"AnimationEvent"in window||(delete bi.animationend.animation,delete bi.animationiteration.animation,delete bi.animationstart.animation),"TransitionEvent"in window||delete bi.transitionend.transition);function nc(t){if(Qc[t])return Qc[t];if(!bi[t])return t;var e=bi[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in _m)return Qc[t]=e[r];return t}var Sm=nc("animationend"),Am=nc("animationiteration"),Im=nc("animationstart"),Tm=nc("transitionend"),jm=new Map,G0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ws(t,e){jm.set(t,e),qs(e,[t])}for(var Zc=0;Zc<G0.length;Zc++){var Jc=G0[Zc],Rw=Jc.toLowerCase(),Ow=Jc[0].toUpperCase()+Jc.slice(1);ws(Rw,"on"+Ow)}ws(Sm,"onAnimationEnd");ws(Am,"onAnimationIteration");ws(Im,"onAnimationStart");ws("dblclick","onDoubleClick");ws("focusin","onFocus");ws("focusout","onBlur");ws(Tm,"onTransitionEnd");Pi("onMouseEnter",["mouseout","mouseover"]);Pi("onMouseLeave",["mouseout","mouseover"]);Pi("onPointerEnter",["pointerout","pointerover"]);Pi("onPointerLeave",["pointerout","pointerover"]);qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qs("onBeforeInput",["compositionend","keypress","textInput","paste"]);qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _a="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kw=new Set("cancel close invalid load scroll toggle".split(" ").concat(_a));function $0(t,e,r){var s=t.type||"unknown-event";t.currentTarget=r,R2(s,e,void 0,t),t.currentTarget=null}function Rm(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var s=t[r],o=s.event;s=s.listeners;e:{var l=void 0;if(e)for(var f=s.length-1;0<=f;f--){var g=s[f],w=g.instance,x=g.currentTarget;if(g=g.listener,w!==l&&o.isPropagationStopped())break e;$0(o,g,x),l=w}else for(f=0;f<s.length;f++){if(g=s[f],w=g.instance,x=g.currentTarget,g=g.listener,w!==l&&o.isPropagationStopped())break e;$0(o,g,x),l=w}}}if(vl)throw t=Fu,vl=!1,Fu=null,t}function tt(t,e){var r=e[qu];r===void 0&&(r=e[qu]=new Set);var s=t+"__bubble";r.has(s)||(Om(e,t,2,!1),r.add(s))}function eu(t,e,r){var s=0;e&&(s|=4),Om(r,t,s,e)}var Uo="_reactListening"+Math.random().toString(36).slice(2);function Xa(t){if(!t[Uo]){t[Uo]=!0,F1.forEach(function(r){r!=="selectionchange"&&(kw.has(r)||eu(r,!1,t),eu(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Uo]||(e[Uo]=!0,eu("selectionchange",!1,e))}}function Om(t,e,r,s){switch(gm(e)){case 1:var o=X2;break;case 4:o=Y2;break;default:o=qd}r=o.bind(null,e,r,t),o=void 0,!Bu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),s?o!==void 0?t.addEventListener(e,r,{capture:!0,passive:o}):t.addEventListener(e,r,!0):o!==void 0?t.addEventListener(e,r,{passive:o}):t.addEventListener(e,r,!1)}function tu(t,e,r,s,o){var l=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var f=s.tag;if(f===3||f===4){var g=s.stateNode.containerInfo;if(g===o||g.nodeType===8&&g.parentNode===o)break;if(f===4)for(f=s.return;f!==null;){var w=f.tag;if((w===3||w===4)&&(w=f.stateNode.containerInfo,w===o||w.nodeType===8&&w.parentNode===o))return;f=f.return}for(;g!==null;){if(f=Ps(g),f===null)return;if(w=f.tag,w===5||w===6){s=l=f;continue e}g=g.parentNode}}s=s.return}tm(function(){var x=l,v=Gd(r),E=[];e:{var S=jm.get(t);if(S!==void 0){var I=Qd,k=t;switch(t){case"keypress":if(ll(r)===0)break e;case"keydown":case"keyup":I=cw;break;case"focusin":k="focus",I=Yc;break;case"focusout":k="blur",I=Yc;break;case"beforeblur":case"afterblur":I=Yc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=M0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=Q2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=hw;break;case Sm:case Am:case Im:I=ew;break;case Tm:I=mw;break;case"scroll":I=q2;break;case"wheel":I=xw;break;case"copy":case"cut":case"paste":I=rw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=L0}var j=(e&4)!==0,M=!j&&t==="scroll",A=j?S!==null?S+"Capture":null:S;j=[];for(var C=x,T;C!==null;){T=C;var O=T.stateNode;if(T.tag===5&&O!==null&&(T=O,A!==null&&(O=za(C,A),O!=null&&j.push(Ya(C,O,T)))),M)break;C=C.return}0<j.length&&(S=new I(S,k,null,r,v),E.push({event:S,listeners:j}))}}if(!(e&7)){e:{if(S=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",S&&r!==Lu&&(k=r.relatedTarget||r.fromElement)&&(Ps(k)||k[Dn]))break e;if((I||S)&&(S=v.window===v?v:(S=v.ownerDocument)?S.defaultView||S.parentWindow:window,I?(k=r.relatedTarget||r.toElement,I=x,k=k?Ps(k):null,k!==null&&(M=Ks(k),k!==M||k.tag!==5&&k.tag!==6)&&(k=null)):(I=null,k=x),I!==k)){if(j=M0,O="onMouseLeave",A="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(j=L0,O="onPointerLeave",A="onPointerEnter",C="pointer"),M=I==null?S:Ei(I),T=k==null?S:Ei(k),S=new j(O,C+"leave",I,r,v),S.target=M,S.relatedTarget=T,O=null,Ps(v)===x&&(j=new j(A,C+"enter",k,r,v),j.target=T,j.relatedTarget=M,O=j),M=O,I&&k)t:{for(j=I,A=k,C=0,T=j;T;T=ci(T))C++;for(T=0,O=A;O;O=ci(O))T++;for(;0<C-T;)j=ci(j),C--;for(;0<T-C;)A=ci(A),T--;for(;C--;){if(j===A||A!==null&&j===A.alternate)break t;j=ci(j),A=ci(A)}j=null}else j=null;I!==null&&X0(E,S,I,j,!1),k!==null&&M!==null&&X0(E,M,k,j,!0)}}e:{if(S=x?Ei(x):window,I=S.nodeName&&S.nodeName.toLowerCase(),I==="select"||I==="input"&&S.type==="file")var V=Cw;else if(F0(S))if(bm)V=Aw;else{V=_w;var z=Nw}else(I=S.nodeName)&&I.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(V=Sw);if(V&&(V=V(t,x))){vm(E,V,r,v);break e}z&&z(t,S,x),t==="focusout"&&(z=S._wrapperState)&&z.controlled&&S.type==="number"&&Ru(S,"number",S.value)}switch(z=x?Ei(x):window,t){case"focusin":(F0(z)||z.contentEditable==="true")&&(vi=z,Hu=x,Ra=null);break;case"focusout":Ra=Hu=vi=null;break;case"mousedown":Wu=!0;break;case"contextmenu":case"mouseup":case"dragend":Wu=!1,W0(E,r,v);break;case"selectionchange":if(jw)break;case"keydown":case"keyup":W0(E,r,v)}var U;if(Jd)e:{switch(t){case"compositionstart":var $="onCompositionStart";break e;case"compositionend":$="onCompositionEnd";break e;case"compositionupdate":$="onCompositionUpdate";break e}$=void 0}else yi?wm(t,r)&&($="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&($="onCompositionStart");$&&(pm&&r.locale!=="ko"&&(yi||$!=="onCompositionStart"?$==="onCompositionEnd"&&yi&&(U=xm()):(rs=v,Kd="value"in rs?rs.value:rs.textContent,yi=!0)),z=_l(x,$),0<z.length&&($=new D0($,t,null,r,v),E.push({event:$,listeners:z}),U?$.data=U:(U=ym(r),U!==null&&($.data=U)))),(U=ww?yw(t,r):vw(t,r))&&(x=_l(x,"onBeforeInput"),0<x.length&&(v=new D0("onBeforeInput","beforeinput",null,r,v),E.push({event:v,listeners:x}),v.data=U))}Rm(E,e)})}function Ya(t,e,r){return{instance:t,listener:e,currentTarget:r}}function _l(t,e){for(var r=e+"Capture",s=[];t!==null;){var o=t,l=o.stateNode;o.tag===5&&l!==null&&(o=l,l=za(t,r),l!=null&&s.unshift(Ya(t,l,o)),l=za(t,e),l!=null&&s.push(Ya(t,l,o))),t=t.return}return s}function ci(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function X0(t,e,r,s,o){for(var l=e._reactName,f=[];r!==null&&r!==s;){var g=r,w=g.alternate,x=g.stateNode;if(w!==null&&w===s)break;g.tag===5&&x!==null&&(g=x,o?(w=za(r,l),w!=null&&f.unshift(Ya(r,w,g))):o||(w=za(r,l),w!=null&&f.push(Ya(r,w,g)))),r=r.return}f.length!==0&&t.push({event:e,listeners:f})}var Mw=/\r\n?/g,Dw=/\u0000|\uFFFD/g;function Y0(t){return(typeof t=="string"?t:""+t).replace(Mw,`
`).replace(Dw,"")}function zo(t,e,r){if(e=Y0(e),Y0(t)!==e&&r)throw Error(J(425))}function Sl(){}var Gu=null,$u=null;function Xu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Yu=typeof setTimeout=="function"?setTimeout:void 0,Lw=typeof clearTimeout=="function"?clearTimeout:void 0,q0=typeof Promise=="function"?Promise:void 0,Pw=typeof queueMicrotask=="function"?queueMicrotask:typeof q0<"u"?function(t){return q0.resolve(null).then(t).catch(Bw)}:Yu;function Bw(t){setTimeout(function(){throw t})}function ru(t,e){var r=e,s=0;do{var o=r.nextSibling;if(t.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(s===0){t.removeChild(o),Wa(e);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=o}while(r);Wa(e)}function os(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function K0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Yi=Math.random().toString(36).slice(2),bn="__reactFiber$"+Yi,qa="__reactProps$"+Yi,Dn="__reactContainer$"+Yi,qu="__reactEvents$"+Yi,Fw="__reactListeners$"+Yi,Uw="__reactHandles$"+Yi;function Ps(t){var e=t[bn];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Dn]||r[bn]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=K0(t);t!==null;){if(r=t[bn])return r;t=K0(t)}return e}t=r,r=t.parentNode}return null}function ho(t){return t=t[bn]||t[Dn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ei(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(J(33))}function sc(t){return t[qa]||null}var Ku=[],Ci=-1;function ys(t){return{current:t}}function nt(t){0>Ci||(t.current=Ku[Ci],Ku[Ci]=null,Ci--)}function Je(t,e){Ci++,Ku[Ci]=t.current,t.current=e}var gs={},Qt=ys(gs),gr=ys(!1),Hs=gs;function Bi(t,e){var r=t.type.contextTypes;if(!r)return gs;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var o={},l;for(l in r)o[l]=e[l];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function xr(t){return t=t.childContextTypes,t!=null}function Al(){nt(gr),nt(Qt)}function Q0(t,e,r){if(Qt.current!==gs)throw Error(J(168));Je(Qt,e),Je(gr,r)}function km(t,e,r){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var o in s)if(!(o in e))throw Error(J(108,N2(t)||"Unknown",o));return ht({},r,s)}function Il(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gs,Hs=Qt.current,Je(Qt,t),Je(gr,gr.current),!0}function Z0(t,e,r){var s=t.stateNode;if(!s)throw Error(J(169));r?(t=km(t,e,Hs),s.__reactInternalMemoizedMergedChildContext=t,nt(gr),nt(Qt),Je(Qt,t)):nt(gr),Je(gr,r)}var In=null,ic=!1,nu=!1;function Mm(t){In===null?In=[t]:In.push(t)}function zw(t){ic=!0,Mm(t)}function vs(){if(!nu&&In!==null){nu=!0;var t=0,e=Ve;try{var r=In;for(Ve=1;t<r.length;t++){var s=r[t];do s=s(!0);while(s!==null)}In=null,ic=!1}catch(o){throw In!==null&&(In=In.slice(t+1)),im($d,vs),o}finally{Ve=e,nu=!1}}return null}var Ni=[],_i=0,Tl=null,jl=0,Fr=[],Ur=0,Ws=null,Tn=1,jn="";function Rs(t,e){Ni[_i++]=jl,Ni[_i++]=Tl,Tl=t,jl=e}function Dm(t,e,r){Fr[Ur++]=Tn,Fr[Ur++]=jn,Fr[Ur++]=Ws,Ws=t;var s=Tn;t=jn;var o=32-sn(s)-1;s&=~(1<<o),r+=1;var l=32-sn(e)+o;if(30<l){var f=o-o%5;l=(s&(1<<f)-1).toString(32),s>>=f,o-=f,Tn=1<<32-sn(e)+o|r<<o|s,jn=l+t}else Tn=1<<l|r<<o|s,jn=t}function th(t){t.return!==null&&(Rs(t,1),Dm(t,1,0))}function rh(t){for(;t===Tl;)Tl=Ni[--_i],Ni[_i]=null,jl=Ni[--_i],Ni[_i]=null;for(;t===Ws;)Ws=Fr[--Ur],Fr[Ur]=null,jn=Fr[--Ur],Fr[Ur]=null,Tn=Fr[--Ur],Fr[Ur]=null}var Tr=null,Ir=null,it=!1,nn=null;function Lm(t,e){var r=zr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function J0(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Tr=t,Ir=os(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Tr=t,Ir=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ws!==null?{id:Tn,overflow:jn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=zr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Tr=t,Ir=null,!0):!1;default:return!1}}function Qu(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Zu(t){if(it){var e=Ir;if(e){var r=e;if(!J0(t,e)){if(Qu(t))throw Error(J(418));e=os(r.nextSibling);var s=Tr;e&&J0(t,e)?Lm(s,r):(t.flags=t.flags&-4097|2,it=!1,Tr=t)}}else{if(Qu(t))throw Error(J(418));t.flags=t.flags&-4097|2,it=!1,Tr=t}}}function ef(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Tr=t}function Vo(t){if(t!==Tr)return!1;if(!it)return ef(t),it=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Xu(t.type,t.memoizedProps)),e&&(e=Ir)){if(Qu(t))throw Pm(),Error(J(418));for(;e;)Lm(t,e),e=os(e.nextSibling)}if(ef(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(J(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ir=os(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ir=null}}else Ir=Tr?os(t.stateNode.nextSibling):null;return!0}function Pm(){for(var t=Ir;t;)t=os(t.nextSibling)}function Fi(){Ir=Tr=null,it=!1}function nh(t){nn===null?nn=[t]:nn.push(t)}var Vw=Un.ReactCurrentBatchConfig;function wa(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(J(309));var s=r.stateNode}if(!s)throw Error(J(147,t));var o=s,l=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===l?e.ref:(e=function(f){var g=o.refs;f===null?delete g[l]:g[l]=f},e._stringRef=l,e)}if(typeof t!="string")throw Error(J(284));if(!r._owner)throw Error(J(290,t))}return t}function Ho(t,e){throw t=Object.prototype.toString.call(e),Error(J(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function tf(t){var e=t._init;return e(t._payload)}function Bm(t){function e(A,C){if(t){var T=A.deletions;T===null?(A.deletions=[C],A.flags|=16):T.push(C)}}function r(A,C){if(!t)return null;for(;C!==null;)e(A,C),C=C.sibling;return null}function s(A,C){for(A=new Map;C!==null;)C.key!==null?A.set(C.key,C):A.set(C.index,C),C=C.sibling;return A}function o(A,C){return A=ds(A,C),A.index=0,A.sibling=null,A}function l(A,C,T){return A.index=T,t?(T=A.alternate,T!==null?(T=T.index,T<C?(A.flags|=2,C):T):(A.flags|=2,C)):(A.flags|=1048576,C)}function f(A){return t&&A.alternate===null&&(A.flags|=2),A}function g(A,C,T,O){return C===null||C.tag!==6?(C=uu(T,A.mode,O),C.return=A,C):(C=o(C,T),C.return=A,C)}function w(A,C,T,O){var V=T.type;return V===wi?v(A,C,T.props.children,O,T.key):C!==null&&(C.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Qn&&tf(V)===C.type)?(O=o(C,T.props),O.ref=wa(A,C,T),O.return=A,O):(O=gl(T.type,T.key,T.props,null,A.mode,O),O.ref=wa(A,C,T),O.return=A,O)}function x(A,C,T,O){return C===null||C.tag!==4||C.stateNode.containerInfo!==T.containerInfo||C.stateNode.implementation!==T.implementation?(C=du(T,A.mode,O),C.return=A,C):(C=o(C,T.children||[]),C.return=A,C)}function v(A,C,T,O,V){return C===null||C.tag!==7?(C=Vs(T,A.mode,O,V),C.return=A,C):(C=o(C,T),C.return=A,C)}function E(A,C,T){if(typeof C=="string"&&C!==""||typeof C=="number")return C=uu(""+C,A.mode,T),C.return=A,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Oo:return T=gl(C.type,C.key,C.props,null,A.mode,T),T.ref=wa(A,null,C),T.return=A,T;case pi:return C=du(C,A.mode,T),C.return=A,C;case Qn:var O=C._init;return E(A,O(C._payload),T)}if(Ca(C)||fa(C))return C=Vs(C,A.mode,T,null),C.return=A,C;Ho(A,C)}return null}function S(A,C,T,O){var V=C!==null?C.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return V!==null?null:g(A,C,""+T,O);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Oo:return T.key===V?w(A,C,T,O):null;case pi:return T.key===V?x(A,C,T,O):null;case Qn:return V=T._init,S(A,C,V(T._payload),O)}if(Ca(T)||fa(T))return V!==null?null:v(A,C,T,O,null);Ho(A,T)}return null}function I(A,C,T,O,V){if(typeof O=="string"&&O!==""||typeof O=="number")return A=A.get(T)||null,g(C,A,""+O,V);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Oo:return A=A.get(O.key===null?T:O.key)||null,w(C,A,O,V);case pi:return A=A.get(O.key===null?T:O.key)||null,x(C,A,O,V);case Qn:var z=O._init;return I(A,C,T,z(O._payload),V)}if(Ca(O)||fa(O))return A=A.get(T)||null,v(C,A,O,V,null);Ho(C,O)}return null}function k(A,C,T,O){for(var V=null,z=null,U=C,$=C=0,G=null;U!==null&&$<T.length;$++){U.index>$?(G=U,U=null):G=U.sibling;var te=S(A,U,T[$],O);if(te===null){U===null&&(U=G);break}t&&U&&te.alternate===null&&e(A,U),C=l(te,C,$),z===null?V=te:z.sibling=te,z=te,U=G}if($===T.length)return r(A,U),it&&Rs(A,$),V;if(U===null){for(;$<T.length;$++)U=E(A,T[$],O),U!==null&&(C=l(U,C,$),z===null?V=U:z.sibling=U,z=U);return it&&Rs(A,$),V}for(U=s(A,U);$<T.length;$++)G=I(U,A,$,T[$],O),G!==null&&(t&&G.alternate!==null&&U.delete(G.key===null?$:G.key),C=l(G,C,$),z===null?V=G:z.sibling=G,z=G);return t&&U.forEach(function(be){return e(A,be)}),it&&Rs(A,$),V}function j(A,C,T,O){var V=fa(T);if(typeof V!="function")throw Error(J(150));if(T=V.call(T),T==null)throw Error(J(151));for(var z=V=null,U=C,$=C=0,G=null,te=T.next();U!==null&&!te.done;$++,te=T.next()){U.index>$?(G=U,U=null):G=U.sibling;var be=S(A,U,te.value,O);if(be===null){U===null&&(U=G);break}t&&U&&be.alternate===null&&e(A,U),C=l(be,C,$),z===null?V=be:z.sibling=be,z=be,U=G}if(te.done)return r(A,U),it&&Rs(A,$),V;if(U===null){for(;!te.done;$++,te=T.next())te=E(A,te.value,O),te!==null&&(C=l(te,C,$),z===null?V=te:z.sibling=te,z=te);return it&&Rs(A,$),V}for(U=s(A,U);!te.done;$++,te=T.next())te=I(U,A,$,te.value,O),te!==null&&(t&&te.alternate!==null&&U.delete(te.key===null?$:te.key),C=l(te,C,$),z===null?V=te:z.sibling=te,z=te);return t&&U.forEach(function(ue){return e(A,ue)}),it&&Rs(A,$),V}function M(A,C,T,O){if(typeof T=="object"&&T!==null&&T.type===wi&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Oo:e:{for(var V=T.key,z=C;z!==null;){if(z.key===V){if(V=T.type,V===wi){if(z.tag===7){r(A,z.sibling),C=o(z,T.props.children),C.return=A,A=C;break e}}else if(z.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Qn&&tf(V)===z.type){r(A,z.sibling),C=o(z,T.props),C.ref=wa(A,z,T),C.return=A,A=C;break e}r(A,z);break}else e(A,z);z=z.sibling}T.type===wi?(C=Vs(T.props.children,A.mode,O,T.key),C.return=A,A=C):(O=gl(T.type,T.key,T.props,null,A.mode,O),O.ref=wa(A,C,T),O.return=A,A=O)}return f(A);case pi:e:{for(z=T.key;C!==null;){if(C.key===z)if(C.tag===4&&C.stateNode.containerInfo===T.containerInfo&&C.stateNode.implementation===T.implementation){r(A,C.sibling),C=o(C,T.children||[]),C.return=A,A=C;break e}else{r(A,C);break}else e(A,C);C=C.sibling}C=du(T,A.mode,O),C.return=A,A=C}return f(A);case Qn:return z=T._init,M(A,C,z(T._payload),O)}if(Ca(T))return k(A,C,T,O);if(fa(T))return j(A,C,T,O);Ho(A,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,C!==null&&C.tag===6?(r(A,C.sibling),C=o(C,T),C.return=A,A=C):(r(A,C),C=uu(T,A.mode,O),C.return=A,A=C),f(A)):r(A,C)}return M}var Ui=Bm(!0),Fm=Bm(!1),Rl=ys(null),Ol=null,Si=null,sh=null;function ih(){sh=Si=Ol=null}function ah(t){var e=Rl.current;nt(Rl),t._currentValue=e}function Ju(t,e,r){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===r)break;t=t.return}}function Mi(t,e){Ol=t,sh=Si=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(mr=!0),t.firstContext=null)}function Hr(t){var e=t._currentValue;if(sh!==t)if(t={context:t,memoizedValue:e,next:null},Si===null){if(Ol===null)throw Error(J(308));Si=t,Ol.dependencies={lanes:0,firstContext:t}}else Si=Si.next=t;return e}var Bs=null;function oh(t){Bs===null?Bs=[t]:Bs.push(t)}function Um(t,e,r,s){var o=e.interleaved;return o===null?(r.next=r,oh(e)):(r.next=o.next,o.next=r),e.interleaved=r,Ln(t,s)}function Ln(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Zn=!1;function lh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function On(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ls(t,e,r){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,De&2){var o=s.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),s.pending=e,Ln(t,r)}return o=s.interleaved,o===null?(e.next=e,oh(s)):(e.next=o.next,o.next=e),s.interleaved=e,Ln(t,r)}function cl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,Xd(t,r)}}function rf(t,e){var r=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var o=null,l=null;if(r=r.firstBaseUpdate,r!==null){do{var f={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};l===null?o=l=f:l=l.next=f,r=r.next}while(r!==null);l===null?o=l=e:l=l.next=e}else o=l=e;r={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:l,shared:s.shared,effects:s.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function kl(t,e,r,s){var o=t.updateQueue;Zn=!1;var l=o.firstBaseUpdate,f=o.lastBaseUpdate,g=o.shared.pending;if(g!==null){o.shared.pending=null;var w=g,x=w.next;w.next=null,f===null?l=x:f.next=x,f=w;var v=t.alternate;v!==null&&(v=v.updateQueue,g=v.lastBaseUpdate,g!==f&&(g===null?v.firstBaseUpdate=x:g.next=x,v.lastBaseUpdate=w))}if(l!==null){var E=o.baseState;f=0,v=x=w=null,g=l;do{var S=g.lane,I=g.eventTime;if((s&S)===S){v!==null&&(v=v.next={eventTime:I,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var k=t,j=g;switch(S=e,I=r,j.tag){case 1:if(k=j.payload,typeof k=="function"){E=k.call(I,E,S);break e}E=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=j.payload,S=typeof k=="function"?k.call(I,E,S):k,S==null)break e;E=ht({},E,S);break e;case 2:Zn=!0}}g.callback!==null&&g.lane!==0&&(t.flags|=64,S=o.effects,S===null?o.effects=[g]:S.push(g))}else I={eventTime:I,lane:S,tag:g.tag,payload:g.payload,callback:g.callback,next:null},v===null?(x=v=I,w=E):v=v.next=I,f|=S;if(g=g.next,g===null){if(g=o.shared.pending,g===null)break;S=g,g=S.next,S.next=null,o.lastBaseUpdate=S,o.shared.pending=null}}while(!0);if(v===null&&(w=E),o.baseState=w,o.firstBaseUpdate=x,o.lastBaseUpdate=v,e=o.shared.interleaved,e!==null){o=e;do f|=o.lane,o=o.next;while(o!==e)}else l===null&&(o.shared.lanes=0);$s|=f,t.lanes=f,t.memoizedState=E}}function nf(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],o=s.callback;if(o!==null){if(s.callback=null,s=r,typeof o!="function")throw Error(J(191,o));o.call(s)}}}var fo={},Cn=ys(fo),Ka=ys(fo),Qa=ys(fo);function Fs(t){if(t===fo)throw Error(J(174));return t}function ch(t,e){switch(Je(Qa,e),Je(Ka,t),Je(Cn,fo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ku(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ku(e,t)}nt(Cn),Je(Cn,e)}function zi(){nt(Cn),nt(Ka),nt(Qa)}function Vm(t){Fs(Qa.current);var e=Fs(Cn.current),r=ku(e,t.type);e!==r&&(Je(Ka,t),Je(Cn,r))}function uh(t){Ka.current===t&&(nt(Cn),nt(Ka))}var ut=ys(0);function Ml(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var su=[];function dh(){for(var t=0;t<su.length;t++)su[t]._workInProgressVersionPrimary=null;su.length=0}var ul=Un.ReactCurrentDispatcher,iu=Un.ReactCurrentBatchConfig,Gs=0,dt=null,Tt=null,kt=null,Dl=!1,Oa=!1,Za=0,Hw=0;function $t(){throw Error(J(321))}function hh(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!on(t[r],e[r]))return!1;return!0}function fh(t,e,r,s,o,l){if(Gs=l,dt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ul.current=t===null||t.memoizedState===null?Xw:Yw,t=r(s,o),Oa){l=0;do{if(Oa=!1,Za=0,25<=l)throw Error(J(301));l+=1,kt=Tt=null,e.updateQueue=null,ul.current=qw,t=r(s,o)}while(Oa)}if(ul.current=Ll,e=Tt!==null&&Tt.next!==null,Gs=0,kt=Tt=dt=null,Dl=!1,e)throw Error(J(300));return t}function mh(){var t=Za!==0;return Za=0,t}function yn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kt===null?dt.memoizedState=kt=t:kt=kt.next=t,kt}function Wr(){if(Tt===null){var t=dt.alternate;t=t!==null?t.memoizedState:null}else t=Tt.next;var e=kt===null?dt.memoizedState:kt.next;if(e!==null)kt=e,Tt=t;else{if(t===null)throw Error(J(310));Tt=t,t={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},kt===null?dt.memoizedState=kt=t:kt=kt.next=t}return kt}function Ja(t,e){return typeof e=="function"?e(t):e}function au(t){var e=Wr(),r=e.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=t;var s=Tt,o=s.baseQueue,l=r.pending;if(l!==null){if(o!==null){var f=o.next;o.next=l.next,l.next=f}s.baseQueue=o=l,r.pending=null}if(o!==null){l=o.next,s=s.baseState;var g=f=null,w=null,x=l;do{var v=x.lane;if((Gs&v)===v)w!==null&&(w=w.next={lane:0,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null}),s=x.hasEagerState?x.eagerState:t(s,x.action);else{var E={lane:v,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null};w===null?(g=w=E,f=s):w=w.next=E,dt.lanes|=v,$s|=v}x=x.next}while(x!==null&&x!==l);w===null?f=s:w.next=g,on(s,e.memoizedState)||(mr=!0),e.memoizedState=s,e.baseState=f,e.baseQueue=w,r.lastRenderedState=s}if(t=r.interleaved,t!==null){o=t;do l=o.lane,dt.lanes|=l,$s|=l,o=o.next;while(o!==t)}else o===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function ou(t){var e=Wr(),r=e.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=t;var s=r.dispatch,o=r.pending,l=e.memoizedState;if(o!==null){r.pending=null;var f=o=o.next;do l=t(l,f.action),f=f.next;while(f!==o);on(l,e.memoizedState)||(mr=!0),e.memoizedState=l,e.baseQueue===null&&(e.baseState=l),r.lastRenderedState=l}return[l,s]}function Hm(){}function Wm(t,e){var r=dt,s=Wr(),o=e(),l=!on(s.memoizedState,o);if(l&&(s.memoizedState=o,mr=!0),s=s.queue,gh(Xm.bind(null,r,s,t),[t]),s.getSnapshot!==e||l||kt!==null&&kt.memoizedState.tag&1){if(r.flags|=2048,eo(9,$m.bind(null,r,s,o,e),void 0,null),Mt===null)throw Error(J(349));Gs&30||Gm(r,e,o)}return o}function Gm(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=dt.updateQueue,e===null?(e={lastEffect:null,stores:null},dt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function $m(t,e,r,s){e.value=r,e.getSnapshot=s,Ym(e)&&qm(t)}function Xm(t,e,r){return r(function(){Ym(e)&&qm(t)})}function Ym(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!on(t,r)}catch{return!0}}function qm(t){var e=Ln(t,1);e!==null&&an(e,t,1,-1)}function sf(t){var e=yn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:t},e.queue=t,t=t.dispatch=$w.bind(null,dt,t),[e.memoizedState,t]}function eo(t,e,r,s){return t={tag:t,create:e,destroy:r,deps:s,next:null},e=dt.updateQueue,e===null?(e={lastEffect:null,stores:null},dt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(s=r.next,r.next=t,t.next=s,e.lastEffect=t)),t}function Km(){return Wr().memoizedState}function dl(t,e,r,s){var o=yn();dt.flags|=t,o.memoizedState=eo(1|e,r,void 0,s===void 0?null:s)}function ac(t,e,r,s){var o=Wr();s=s===void 0?null:s;var l=void 0;if(Tt!==null){var f=Tt.memoizedState;if(l=f.destroy,s!==null&&hh(s,f.deps)){o.memoizedState=eo(e,r,l,s);return}}dt.flags|=t,o.memoizedState=eo(1|e,r,l,s)}function af(t,e){return dl(8390656,8,t,e)}function gh(t,e){return ac(2048,8,t,e)}function Qm(t,e){return ac(4,2,t,e)}function Zm(t,e){return ac(4,4,t,e)}function Jm(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function eg(t,e,r){return r=r!=null?r.concat([t]):null,ac(4,4,Jm.bind(null,e,t),r)}function xh(){}function tg(t,e){var r=Wr();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&hh(e,s[1])?s[0]:(r.memoizedState=[t,e],t)}function rg(t,e){var r=Wr();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&hh(e,s[1])?s[0]:(t=t(),r.memoizedState=[t,e],t)}function ng(t,e,r){return Gs&21?(on(r,e)||(r=lm(),dt.lanes|=r,$s|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,mr=!0),t.memoizedState=r)}function Ww(t,e){var r=Ve;Ve=r!==0&&4>r?r:4,t(!0);var s=iu.transition;iu.transition={};try{t(!1),e()}finally{Ve=r,iu.transition=s}}function sg(){return Wr().memoizedState}function Gw(t,e,r){var s=us(t);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},ig(t))ag(e,r);else if(r=Um(t,e,r,s),r!==null){var o=nr();an(r,t,s,o),og(r,e,s)}}function $w(t,e,r){var s=us(t),o={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(ig(t))ag(e,o);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=e.lastRenderedReducer,l!==null))try{var f=e.lastRenderedState,g=l(f,r);if(o.hasEagerState=!0,o.eagerState=g,on(g,f)){var w=e.interleaved;w===null?(o.next=o,oh(e)):(o.next=w.next,w.next=o),e.interleaved=o;return}}catch{}finally{}r=Um(t,e,o,s),r!==null&&(o=nr(),an(r,t,s,o),og(r,e,s))}}function ig(t){var e=t.alternate;return t===dt||e!==null&&e===dt}function ag(t,e){Oa=Dl=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function og(t,e,r){if(r&4194240){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,Xd(t,r)}}var Ll={readContext:Hr,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},Xw={readContext:Hr,useCallback:function(t,e){return yn().memoizedState=[t,e===void 0?null:e],t},useContext:Hr,useEffect:af,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,dl(4194308,4,Jm.bind(null,e,t),r)},useLayoutEffect:function(t,e){return dl(4194308,4,t,e)},useInsertionEffect:function(t,e){return dl(4,2,t,e)},useMemo:function(t,e){var r=yn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var s=yn();return e=r!==void 0?r(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=Gw.bind(null,dt,t),[s.memoizedState,t]},useRef:function(t){var e=yn();return t={current:t},e.memoizedState=t},useState:sf,useDebugValue:xh,useDeferredValue:function(t){return yn().memoizedState=t},useTransition:function(){var t=sf(!1),e=t[0];return t=Ww.bind(null,t[1]),yn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var s=dt,o=yn();if(it){if(r===void 0)throw Error(J(407));r=r()}else{if(r=e(),Mt===null)throw Error(J(349));Gs&30||Gm(s,e,r)}o.memoizedState=r;var l={value:r,getSnapshot:e};return o.queue=l,af(Xm.bind(null,s,l,t),[t]),s.flags|=2048,eo(9,$m.bind(null,s,l,r,e),void 0,null),r},useId:function(){var t=yn(),e=Mt.identifierPrefix;if(it){var r=jn,s=Tn;r=(s&~(1<<32-sn(s)-1)).toString(32)+r,e=":"+e+"R"+r,r=Za++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Hw++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Yw={readContext:Hr,useCallback:tg,useContext:Hr,useEffect:gh,useImperativeHandle:eg,useInsertionEffect:Qm,useLayoutEffect:Zm,useMemo:rg,useReducer:au,useRef:Km,useState:function(){return au(Ja)},useDebugValue:xh,useDeferredValue:function(t){var e=Wr();return ng(e,Tt.memoizedState,t)},useTransition:function(){var t=au(Ja)[0],e=Wr().memoizedState;return[t,e]},useMutableSource:Hm,useSyncExternalStore:Wm,useId:sg,unstable_isNewReconciler:!1},qw={readContext:Hr,useCallback:tg,useContext:Hr,useEffect:gh,useImperativeHandle:eg,useInsertionEffect:Qm,useLayoutEffect:Zm,useMemo:rg,useReducer:ou,useRef:Km,useState:function(){return ou(Ja)},useDebugValue:xh,useDeferredValue:function(t){var e=Wr();return Tt===null?e.memoizedState=t:ng(e,Tt.memoizedState,t)},useTransition:function(){var t=ou(Ja)[0],e=Wr().memoizedState;return[t,e]},useMutableSource:Hm,useSyncExternalStore:Wm,useId:sg,unstable_isNewReconciler:!1};function Zr(t,e){if(t&&t.defaultProps){e=ht({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function ed(t,e,r,s){e=t.memoizedState,r=r(s,e),r=r==null?e:ht({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var oc={isMounted:function(t){return(t=t._reactInternals)?Ks(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var s=nr(),o=us(t),l=On(s,o);l.payload=e,r!=null&&(l.callback=r),e=ls(t,l,o),e!==null&&(an(e,t,o,s),cl(e,t,o))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var s=nr(),o=us(t),l=On(s,o);l.tag=1,l.payload=e,r!=null&&(l.callback=r),e=ls(t,l,o),e!==null&&(an(e,t,o,s),cl(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=nr(),s=us(t),o=On(r,s);o.tag=2,e!=null&&(o.callback=e),e=ls(t,o,s),e!==null&&(an(e,t,s,r),cl(e,t,s))}};function of(t,e,r,s,o,l,f){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,l,f):e.prototype&&e.prototype.isPureReactComponent?!$a(r,s)||!$a(o,l):!0}function lg(t,e,r){var s=!1,o=gs,l=e.contextType;return typeof l=="object"&&l!==null?l=Hr(l):(o=xr(e)?Hs:Qt.current,s=e.contextTypes,l=(s=s!=null)?Bi(t,o):gs),e=new e(r,l),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=oc,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=l),e}function lf(t,e,r,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,s),e.state!==t&&oc.enqueueReplaceState(e,e.state,null)}function td(t,e,r,s){var o=t.stateNode;o.props=r,o.state=t.memoizedState,o.refs={},lh(t);var l=e.contextType;typeof l=="object"&&l!==null?o.context=Hr(l):(l=xr(e)?Hs:Qt.current,o.context=Bi(t,l)),o.state=t.memoizedState,l=e.getDerivedStateFromProps,typeof l=="function"&&(ed(t,e,l,r),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&oc.enqueueReplaceState(o,o.state,null),kl(t,r,o,s),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function Vi(t,e){try{var r="",s=e;do r+=C2(s),s=s.return;while(s);var o=r}catch(l){o=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:e,stack:o,digest:null}}function lu(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function rd(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Kw=typeof WeakMap=="function"?WeakMap:Map;function cg(t,e,r){r=On(-1,r),r.tag=3,r.payload={element:null};var s=e.value;return r.callback=function(){Bl||(Bl=!0,hd=s),rd(t,e)},r}function ug(t,e,r){r=On(-1,r),r.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var o=e.value;r.payload=function(){return s(o)},r.callback=function(){rd(t,e)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(r.callback=function(){rd(t,e),typeof s!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var f=e.stack;this.componentDidCatch(e.value,{componentStack:f!==null?f:""})}),r}function cf(t,e,r){var s=t.pingCache;if(s===null){s=t.pingCache=new Kw;var o=new Set;s.set(e,o)}else o=s.get(e),o===void 0&&(o=new Set,s.set(e,o));o.has(r)||(o.add(r),t=uy.bind(null,t,e,r),e.then(t,t))}function uf(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function df(t,e,r,s,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=On(-1,1),e.tag=2,ls(r,e,1))),r.lanes|=1),t)}var Qw=Un.ReactCurrentOwner,mr=!1;function er(t,e,r,s){e.child=t===null?Fm(e,null,r,s):Ui(e,t.child,r,s)}function hf(t,e,r,s,o){r=r.render;var l=e.ref;return Mi(e,o),s=fh(t,e,r,s,l,o),r=mh(),t!==null&&!mr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,Pn(t,e,o)):(it&&r&&th(e),e.flags|=1,er(t,e,s,o),e.child)}function ff(t,e,r,s,o){if(t===null){var l=r.type;return typeof l=="function"&&!Nh(l)&&l.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=l,dg(t,e,l,s,o)):(t=gl(r.type,null,s,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(l=t.child,!(t.lanes&o)){var f=l.memoizedProps;if(r=r.compare,r=r!==null?r:$a,r(f,s)&&t.ref===e.ref)return Pn(t,e,o)}return e.flags|=1,t=ds(l,s),t.ref=e.ref,t.return=e,e.child=t}function dg(t,e,r,s,o){if(t!==null){var l=t.memoizedProps;if($a(l,s)&&t.ref===e.ref)if(mr=!1,e.pendingProps=s=l,(t.lanes&o)!==0)t.flags&131072&&(mr=!0);else return e.lanes=t.lanes,Pn(t,e,o)}return nd(t,e,r,s,o)}function hg(t,e,r){var s=e.pendingProps,o=s.children,l=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(Ii,Nr),Nr|=r;else{if(!(r&1073741824))return t=l!==null?l.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Je(Ii,Nr),Nr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=l!==null?l.baseLanes:r,Je(Ii,Nr),Nr|=s}else l!==null?(s=l.baseLanes|r,e.memoizedState=null):s=r,Je(Ii,Nr),Nr|=s;return er(t,e,o,r),e.child}function fg(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function nd(t,e,r,s,o){var l=xr(r)?Hs:Qt.current;return l=Bi(e,l),Mi(e,o),r=fh(t,e,r,s,l,o),s=mh(),t!==null&&!mr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,Pn(t,e,o)):(it&&s&&th(e),e.flags|=1,er(t,e,r,o),e.child)}function mf(t,e,r,s,o){if(xr(r)){var l=!0;Il(e)}else l=!1;if(Mi(e,o),e.stateNode===null)hl(t,e),lg(e,r,s),td(e,r,s,o),s=!0;else if(t===null){var f=e.stateNode,g=e.memoizedProps;f.props=g;var w=f.context,x=r.contextType;typeof x=="object"&&x!==null?x=Hr(x):(x=xr(r)?Hs:Qt.current,x=Bi(e,x));var v=r.getDerivedStateFromProps,E=typeof v=="function"||typeof f.getSnapshotBeforeUpdate=="function";E||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(g!==s||w!==x)&&lf(e,f,s,x),Zn=!1;var S=e.memoizedState;f.state=S,kl(e,s,f,o),w=e.memoizedState,g!==s||S!==w||gr.current||Zn?(typeof v=="function"&&(ed(e,r,v,s),w=e.memoizedState),(g=Zn||of(e,r,g,s,S,w,x))?(E||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(e.flags|=4194308)):(typeof f.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=w),f.props=s,f.state=w,f.context=x,s=g):(typeof f.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{f=e.stateNode,zm(t,e),g=e.memoizedProps,x=e.type===e.elementType?g:Zr(e.type,g),f.props=x,E=e.pendingProps,S=f.context,w=r.contextType,typeof w=="object"&&w!==null?w=Hr(w):(w=xr(r)?Hs:Qt.current,w=Bi(e,w));var I=r.getDerivedStateFromProps;(v=typeof I=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(g!==E||S!==w)&&lf(e,f,s,w),Zn=!1,S=e.memoizedState,f.state=S,kl(e,s,f,o);var k=e.memoizedState;g!==E||S!==k||gr.current||Zn?(typeof I=="function"&&(ed(e,r,I,s),k=e.memoizedState),(x=Zn||of(e,r,x,s,S,k,w)||!1)?(v||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(s,k,w),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(s,k,w)),typeof f.componentDidUpdate=="function"&&(e.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof f.componentDidUpdate!="function"||g===t.memoizedProps&&S===t.memoizedState||(e.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||g===t.memoizedProps&&S===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=k),f.props=s,f.state=k,f.context=w,s=x):(typeof f.componentDidUpdate!="function"||g===t.memoizedProps&&S===t.memoizedState||(e.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||g===t.memoizedProps&&S===t.memoizedState||(e.flags|=1024),s=!1)}return sd(t,e,r,s,l,o)}function sd(t,e,r,s,o,l){fg(t,e);var f=(e.flags&128)!==0;if(!s&&!f)return o&&Z0(e,r,!1),Pn(t,e,l);s=e.stateNode,Qw.current=e;var g=f&&typeof r.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&f?(e.child=Ui(e,t.child,null,l),e.child=Ui(e,null,g,l)):er(t,e,g,l),e.memoizedState=s.state,o&&Z0(e,r,!0),e.child}function mg(t){var e=t.stateNode;e.pendingContext?Q0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Q0(t,e.context,!1),ch(t,e.containerInfo)}function gf(t,e,r,s,o){return Fi(),nh(o),e.flags|=256,er(t,e,r,s),e.child}var id={dehydrated:null,treeContext:null,retryLane:0};function ad(t){return{baseLanes:t,cachePool:null,transitions:null}}function gg(t,e,r){var s=e.pendingProps,o=ut.current,l=!1,f=(e.flags&128)!==0,g;if((g=f)||(g=t!==null&&t.memoizedState===null?!1:(o&2)!==0),g?(l=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),Je(ut,o&1),t===null)return Zu(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(f=s.children,t=s.fallback,l?(s=e.mode,l=e.child,f={mode:"hidden",children:f},!(s&1)&&l!==null?(l.childLanes=0,l.pendingProps=f):l=uc(f,s,0,null),t=Vs(t,s,r,null),l.return=e,t.return=e,l.sibling=t,e.child=l,e.child.memoizedState=ad(r),e.memoizedState=id,t):ph(e,f));if(o=t.memoizedState,o!==null&&(g=o.dehydrated,g!==null))return Zw(t,e,f,s,g,o,r);if(l){l=s.fallback,f=e.mode,o=t.child,g=o.sibling;var w={mode:"hidden",children:s.children};return!(f&1)&&e.child!==o?(s=e.child,s.childLanes=0,s.pendingProps=w,e.deletions=null):(s=ds(o,w),s.subtreeFlags=o.subtreeFlags&14680064),g!==null?l=ds(g,l):(l=Vs(l,f,r,null),l.flags|=2),l.return=e,s.return=e,s.sibling=l,e.child=s,s=l,l=e.child,f=t.child.memoizedState,f=f===null?ad(r):{baseLanes:f.baseLanes|r,cachePool:null,transitions:f.transitions},l.memoizedState=f,l.childLanes=t.childLanes&~r,e.memoizedState=id,s}return l=t.child,t=l.sibling,s=ds(l,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=r),s.return=e,s.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=s,e.memoizedState=null,s}function ph(t,e){return e=uc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wo(t,e,r,s){return s!==null&&nh(s),Ui(e,t.child,null,r),t=ph(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Zw(t,e,r,s,o,l,f){if(r)return e.flags&256?(e.flags&=-257,s=lu(Error(J(422))),Wo(t,e,f,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(l=s.fallback,o=e.mode,s=uc({mode:"visible",children:s.children},o,0,null),l=Vs(l,o,f,null),l.flags|=2,s.return=e,l.return=e,s.sibling=l,e.child=s,e.mode&1&&Ui(e,t.child,null,f),e.child.memoizedState=ad(f),e.memoizedState=id,l);if(!(e.mode&1))return Wo(t,e,f,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var g=s.dgst;return s=g,l=Error(J(419)),s=lu(l,s,void 0),Wo(t,e,f,s)}if(g=(f&t.childLanes)!==0,mr||g){if(s=Mt,s!==null){switch(f&-f){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|f)?0:o,o!==0&&o!==l.retryLane&&(l.retryLane=o,Ln(t,o),an(s,t,o,-1))}return Ch(),s=lu(Error(J(421))),Wo(t,e,f,s)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=dy.bind(null,t),o._reactRetry=e,null):(t=l.treeContext,Ir=os(o.nextSibling),Tr=e,it=!0,nn=null,t!==null&&(Fr[Ur++]=Tn,Fr[Ur++]=jn,Fr[Ur++]=Ws,Tn=t.id,jn=t.overflow,Ws=e),e=ph(e,s.children),e.flags|=4096,e)}function xf(t,e,r){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Ju(t.return,e,r)}function cu(t,e,r,s,o){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:o}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=s,l.tail=r,l.tailMode=o)}function xg(t,e,r){var s=e.pendingProps,o=s.revealOrder,l=s.tail;if(er(t,e,s.children,r),s=ut.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xf(t,r,e);else if(t.tag===19)xf(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Je(ut,s),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(r=e.child,o=null;r!==null;)t=r.alternate,t!==null&&Ml(t)===null&&(o=r),r=r.sibling;r=o,r===null?(o=e.child,e.child=null):(o=r.sibling,r.sibling=null),cu(e,!1,o,r,l);break;case"backwards":for(r=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&Ml(t)===null){e.child=o;break}t=o.sibling,o.sibling=r,r=o,o=t}cu(e,!0,r,null,l);break;case"together":cu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function hl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Pn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),$s|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(J(153));if(e.child!==null){for(t=e.child,r=ds(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ds(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Jw(t,e,r){switch(e.tag){case 3:mg(e),Fi();break;case 5:Vm(e);break;case 1:xr(e.type)&&Il(e);break;case 4:ch(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,o=e.memoizedProps.value;Je(Rl,s._currentValue),s._currentValue=o;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Je(ut,ut.current&1),e.flags|=128,null):r&e.child.childLanes?gg(t,e,r):(Je(ut,ut.current&1),t=Pn(t,e,r),t!==null?t.sibling:null);Je(ut,ut.current&1);break;case 19:if(s=(r&e.childLanes)!==0,t.flags&128){if(s)return xg(t,e,r);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Je(ut,ut.current),s)break;return null;case 22:case 23:return e.lanes=0,hg(t,e,r)}return Pn(t,e,r)}var pg,od,wg,yg;pg=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};od=function(){};wg=function(t,e,r,s){var o=t.memoizedProps;if(o!==s){t=e.stateNode,Fs(Cn.current);var l=null;switch(r){case"input":o=Tu(t,o),s=Tu(t,s),l=[];break;case"select":o=ht({},o,{value:void 0}),s=ht({},s,{value:void 0}),l=[];break;case"textarea":o=Ou(t,o),s=Ou(t,s),l=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Sl)}Mu(r,s);var f;r=null;for(x in o)if(!s.hasOwnProperty(x)&&o.hasOwnProperty(x)&&o[x]!=null)if(x==="style"){var g=o[x];for(f in g)g.hasOwnProperty(f)&&(r||(r={}),r[f]="")}else x!=="dangerouslySetInnerHTML"&&x!=="children"&&x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(Fa.hasOwnProperty(x)?l||(l=[]):(l=l||[]).push(x,null));for(x in s){var w=s[x];if(g=o!=null?o[x]:void 0,s.hasOwnProperty(x)&&w!==g&&(w!=null||g!=null))if(x==="style")if(g){for(f in g)!g.hasOwnProperty(f)||w&&w.hasOwnProperty(f)||(r||(r={}),r[f]="");for(f in w)w.hasOwnProperty(f)&&g[f]!==w[f]&&(r||(r={}),r[f]=w[f])}else r||(l||(l=[]),l.push(x,r)),r=w;else x==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,g=g?g.__html:void 0,w!=null&&g!==w&&(l=l||[]).push(x,w)):x==="children"?typeof w!="string"&&typeof w!="number"||(l=l||[]).push(x,""+w):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&(Fa.hasOwnProperty(x)?(w!=null&&x==="onScroll"&&tt("scroll",t),l||g===w||(l=[])):(l=l||[]).push(x,w))}r&&(l=l||[]).push("style",r);var x=l;(e.updateQueue=x)&&(e.flags|=4)}};yg=function(t,e,r,s){r!==s&&(e.flags|=4)};function ya(t,e){if(!it)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Xt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,s=0;if(e)for(var o=t.child;o!==null;)r|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)r|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=s,t.childLanes=r,e}function ey(t,e,r){var s=e.pendingProps;switch(rh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(e),null;case 1:return xr(e.type)&&Al(),Xt(e),null;case 3:return s=e.stateNode,zi(),nt(gr),nt(Qt),dh(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Vo(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,nn!==null&&(gd(nn),nn=null))),od(t,e),Xt(e),null;case 5:uh(e);var o=Fs(Qa.current);if(r=e.type,t!==null&&e.stateNode!=null)wg(t,e,r,s,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(J(166));return Xt(e),null}if(t=Fs(Cn.current),Vo(e)){s=e.stateNode,r=e.type;var l=e.memoizedProps;switch(s[bn]=e,s[qa]=l,t=(e.mode&1)!==0,r){case"dialog":tt("cancel",s),tt("close",s);break;case"iframe":case"object":case"embed":tt("load",s);break;case"video":case"audio":for(o=0;o<_a.length;o++)tt(_a[o],s);break;case"source":tt("error",s);break;case"img":case"image":case"link":tt("error",s),tt("load",s);break;case"details":tt("toggle",s);break;case"input":N0(s,l),tt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!l.multiple},tt("invalid",s);break;case"textarea":S0(s,l),tt("invalid",s)}Mu(r,l),o=null;for(var f in l)if(l.hasOwnProperty(f)){var g=l[f];f==="children"?typeof g=="string"?s.textContent!==g&&(l.suppressHydrationWarning!==!0&&zo(s.textContent,g,t),o=["children",g]):typeof g=="number"&&s.textContent!==""+g&&(l.suppressHydrationWarning!==!0&&zo(s.textContent,g,t),o=["children",""+g]):Fa.hasOwnProperty(f)&&g!=null&&f==="onScroll"&&tt("scroll",s)}switch(r){case"input":ko(s),_0(s,l,!0);break;case"textarea":ko(s),A0(s);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(s.onclick=Sl)}s=o,e.updateQueue=s,s!==null&&(e.flags|=4)}else{f=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=X1(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=f.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=f.createElement(r,{is:s.is}):(t=f.createElement(r),r==="select"&&(f=t,s.multiple?f.multiple=!0:s.size&&(f.size=s.size))):t=f.createElementNS(t,r),t[bn]=e,t[qa]=s,pg(t,e,!1,!1),e.stateNode=t;e:{switch(f=Du(r,s),r){case"dialog":tt("cancel",t),tt("close",t),o=s;break;case"iframe":case"object":case"embed":tt("load",t),o=s;break;case"video":case"audio":for(o=0;o<_a.length;o++)tt(_a[o],t);o=s;break;case"source":tt("error",t),o=s;break;case"img":case"image":case"link":tt("error",t),tt("load",t),o=s;break;case"details":tt("toggle",t),o=s;break;case"input":N0(t,s),o=Tu(t,s),tt("invalid",t);break;case"option":o=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},o=ht({},s,{value:void 0}),tt("invalid",t);break;case"textarea":S0(t,s),o=Ou(t,s),tt("invalid",t);break;default:o=s}Mu(r,o),g=o;for(l in g)if(g.hasOwnProperty(l)){var w=g[l];l==="style"?K1(t,w):l==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,w!=null&&Y1(t,w)):l==="children"?typeof w=="string"?(r!=="textarea"||w!=="")&&Ua(t,w):typeof w=="number"&&Ua(t,""+w):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Fa.hasOwnProperty(l)?w!=null&&l==="onScroll"&&tt("scroll",t):w!=null&&zd(t,l,w,f))}switch(r){case"input":ko(t),_0(t,s,!1);break;case"textarea":ko(t),A0(t);break;case"option":s.value!=null&&t.setAttribute("value",""+ms(s.value));break;case"select":t.multiple=!!s.multiple,l=s.value,l!=null?ji(t,!!s.multiple,l,!1):s.defaultValue!=null&&ji(t,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Sl)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xt(e),null;case 6:if(t&&e.stateNode!=null)yg(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(J(166));if(r=Fs(Qa.current),Fs(Cn.current),Vo(e)){if(s=e.stateNode,r=e.memoizedProps,s[bn]=e,(l=s.nodeValue!==r)&&(t=Tr,t!==null))switch(t.tag){case 3:zo(s.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zo(s.nodeValue,r,(t.mode&1)!==0)}l&&(e.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[bn]=e,e.stateNode=s}return Xt(e),null;case 13:if(nt(ut),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(it&&Ir!==null&&e.mode&1&&!(e.flags&128))Pm(),Fi(),e.flags|=98560,l=!1;else if(l=Vo(e),s!==null&&s.dehydrated!==null){if(t===null){if(!l)throw Error(J(318));if(l=e.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(J(317));l[bn]=e}else Fi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xt(e),l=!1}else nn!==null&&(gd(nn),nn=null),l=!0;if(!l)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||ut.current&1?jt===0&&(jt=3):Ch())),e.updateQueue!==null&&(e.flags|=4),Xt(e),null);case 4:return zi(),od(t,e),t===null&&Xa(e.stateNode.containerInfo),Xt(e),null;case 10:return ah(e.type._context),Xt(e),null;case 17:return xr(e.type)&&Al(),Xt(e),null;case 19:if(nt(ut),l=e.memoizedState,l===null)return Xt(e),null;if(s=(e.flags&128)!==0,f=l.rendering,f===null)if(s)ya(l,!1);else{if(jt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(f=Ml(t),f!==null){for(e.flags|=128,ya(l,!1),s=f.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=r,r=e.child;r!==null;)l=r,t=s,l.flags&=14680066,f=l.alternate,f===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=f.childLanes,l.lanes=f.lanes,l.child=f.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=f.memoizedProps,l.memoizedState=f.memoizedState,l.updateQueue=f.updateQueue,l.type=f.type,t=f.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Je(ut,ut.current&1|2),e.child}t=t.sibling}l.tail!==null&&bt()>Hi&&(e.flags|=128,s=!0,ya(l,!1),e.lanes=4194304)}else{if(!s)if(t=Ml(f),t!==null){if(e.flags|=128,s=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ya(l,!0),l.tail===null&&l.tailMode==="hidden"&&!f.alternate&&!it)return Xt(e),null}else 2*bt()-l.renderingStartTime>Hi&&r!==1073741824&&(e.flags|=128,s=!0,ya(l,!1),e.lanes=4194304);l.isBackwards?(f.sibling=e.child,e.child=f):(r=l.last,r!==null?r.sibling=f:e.child=f,l.last=f)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=bt(),e.sibling=null,r=ut.current,Je(ut,s?r&1|2:r&1),e):(Xt(e),null);case 22:case 23:return Eh(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Nr&1073741824&&(Xt(e),e.subtreeFlags&6&&(e.flags|=8192)):Xt(e),null;case 24:return null;case 25:return null}throw Error(J(156,e.tag))}function ty(t,e){switch(rh(e),e.tag){case 1:return xr(e.type)&&Al(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zi(),nt(gr),nt(Qt),dh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return uh(e),null;case 13:if(nt(ut),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(J(340));Fi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return nt(ut),null;case 4:return zi(),null;case 10:return ah(e.type._context),null;case 22:case 23:return Eh(),null;case 24:return null;default:return null}}var Go=!1,Yt=!1,ry=typeof WeakSet=="function"?WeakSet:Set,ce=null;function Ai(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){pt(t,e,s)}else r.current=null}function ld(t,e,r){try{r()}catch(s){pt(t,e,s)}}var pf=!1;function ny(t,e){if(Gu=Cl,t=Nm(),eh(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var o=s.anchorOffset,l=s.focusNode;s=s.focusOffset;try{r.nodeType,l.nodeType}catch{r=null;break e}var f=0,g=-1,w=-1,x=0,v=0,E=t,S=null;t:for(;;){for(var I;E!==r||o!==0&&E.nodeType!==3||(g=f+o),E!==l||s!==0&&E.nodeType!==3||(w=f+s),E.nodeType===3&&(f+=E.nodeValue.length),(I=E.firstChild)!==null;)S=E,E=I;for(;;){if(E===t)break t;if(S===r&&++x===o&&(g=f),S===l&&++v===s&&(w=f),(I=E.nextSibling)!==null)break;E=S,S=E.parentNode}E=I}r=g===-1||w===-1?null:{start:g,end:w}}else r=null}r=r||{start:0,end:0}}else r=null;for($u={focusedElem:t,selectionRange:r},Cl=!1,ce=e;ce!==null;)if(e=ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ce=t;else for(;ce!==null;){e=ce;try{var k=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var j=k.memoizedProps,M=k.memoizedState,A=e.stateNode,C=A.getSnapshotBeforeUpdate(e.elementType===e.type?j:Zr(e.type,j),M);A.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(O){pt(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,ce=t;break}ce=e.return}return k=pf,pf=!1,k}function ka(t,e,r){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&t)===t){var l=o.destroy;o.destroy=void 0,l!==void 0&&ld(e,r,l)}o=o.next}while(o!==s)}}function lc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var s=r.create;r.destroy=s()}r=r.next}while(r!==e)}}function cd(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function vg(t){var e=t.alternate;e!==null&&(t.alternate=null,vg(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[bn],delete e[qa],delete e[qu],delete e[Fw],delete e[Uw])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function bg(t){return t.tag===5||t.tag===3||t.tag===4}function wf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||bg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ud(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Sl));else if(s!==4&&(t=t.child,t!==null))for(ud(t,e,r),t=t.sibling;t!==null;)ud(t,e,r),t=t.sibling}function dd(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(dd(t,e,r),t=t.sibling;t!==null;)dd(t,e,r),t=t.sibling}var zt=null,en=!1;function Yn(t,e,r){for(r=r.child;r!==null;)Eg(t,e,r),r=r.sibling}function Eg(t,e,r){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(ec,r)}catch{}switch(r.tag){case 5:Yt||Ai(r,e);case 6:var s=zt,o=en;zt=null,Yn(t,e,r),zt=s,en=o,zt!==null&&(en?(t=zt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):zt.removeChild(r.stateNode));break;case 18:zt!==null&&(en?(t=zt,r=r.stateNode,t.nodeType===8?ru(t.parentNode,r):t.nodeType===1&&ru(t,r),Wa(t)):ru(zt,r.stateNode));break;case 4:s=zt,o=en,zt=r.stateNode.containerInfo,en=!0,Yn(t,e,r),zt=s,en=o;break;case 0:case 11:case 14:case 15:if(!Yt&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var l=o,f=l.destroy;l=l.tag,f!==void 0&&(l&2||l&4)&&ld(r,e,f),o=o.next}while(o!==s)}Yn(t,e,r);break;case 1:if(!Yt&&(Ai(r,e),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(g){pt(r,e,g)}Yn(t,e,r);break;case 21:Yn(t,e,r);break;case 22:r.mode&1?(Yt=(s=Yt)||r.memoizedState!==null,Yn(t,e,r),Yt=s):Yn(t,e,r);break;default:Yn(t,e,r)}}function yf(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new ry),e.forEach(function(s){var o=hy.bind(null,t,s);r.has(s)||(r.add(s),s.then(o,o))})}}function qr(t,e){var r=e.deletions;if(r!==null)for(var s=0;s<r.length;s++){var o=r[s];try{var l=t,f=e,g=f;e:for(;g!==null;){switch(g.tag){case 5:zt=g.stateNode,en=!1;break e;case 3:zt=g.stateNode.containerInfo,en=!0;break e;case 4:zt=g.stateNode.containerInfo,en=!0;break e}g=g.return}if(zt===null)throw Error(J(160));Eg(l,f,o),zt=null,en=!1;var w=o.alternate;w!==null&&(w.return=null),o.return=null}catch(x){pt(o,e,x)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Cg(e,t),e=e.sibling}function Cg(t,e){var r=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(qr(e,t),wn(t),s&4){try{ka(3,t,t.return),lc(3,t)}catch(j){pt(t,t.return,j)}try{ka(5,t,t.return)}catch(j){pt(t,t.return,j)}}break;case 1:qr(e,t),wn(t),s&512&&r!==null&&Ai(r,r.return);break;case 5:if(qr(e,t),wn(t),s&512&&r!==null&&Ai(r,r.return),t.flags&32){var o=t.stateNode;try{Ua(o,"")}catch(j){pt(t,t.return,j)}}if(s&4&&(o=t.stateNode,o!=null)){var l=t.memoizedProps,f=r!==null?r.memoizedProps:l,g=t.type,w=t.updateQueue;if(t.updateQueue=null,w!==null)try{g==="input"&&l.type==="radio"&&l.name!=null&&G1(o,l),Du(g,f);var x=Du(g,l);for(f=0;f<w.length;f+=2){var v=w[f],E=w[f+1];v==="style"?K1(o,E):v==="dangerouslySetInnerHTML"?Y1(o,E):v==="children"?Ua(o,E):zd(o,v,E,x)}switch(g){case"input":ju(o,l);break;case"textarea":$1(o,l);break;case"select":var S=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!l.multiple;var I=l.value;I!=null?ji(o,!!l.multiple,I,!1):S!==!!l.multiple&&(l.defaultValue!=null?ji(o,!!l.multiple,l.defaultValue,!0):ji(o,!!l.multiple,l.multiple?[]:"",!1))}o[qa]=l}catch(j){pt(t,t.return,j)}}break;case 6:if(qr(e,t),wn(t),s&4){if(t.stateNode===null)throw Error(J(162));o=t.stateNode,l=t.memoizedProps;try{o.nodeValue=l}catch(j){pt(t,t.return,j)}}break;case 3:if(qr(e,t),wn(t),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Wa(e.containerInfo)}catch(j){pt(t,t.return,j)}break;case 4:qr(e,t),wn(t);break;case 13:qr(e,t),wn(t),o=t.child,o.flags&8192&&(l=o.memoizedState!==null,o.stateNode.isHidden=l,!l||o.alternate!==null&&o.alternate.memoizedState!==null||(vh=bt())),s&4&&yf(t);break;case 22:if(v=r!==null&&r.memoizedState!==null,t.mode&1?(Yt=(x=Yt)||v,qr(e,t),Yt=x):qr(e,t),wn(t),s&8192){if(x=t.memoizedState!==null,(t.stateNode.isHidden=x)&&!v&&t.mode&1)for(ce=t,v=t.child;v!==null;){for(E=ce=v;ce!==null;){switch(S=ce,I=S.child,S.tag){case 0:case 11:case 14:case 15:ka(4,S,S.return);break;case 1:Ai(S,S.return);var k=S.stateNode;if(typeof k.componentWillUnmount=="function"){s=S,r=S.return;try{e=s,k.props=e.memoizedProps,k.state=e.memoizedState,k.componentWillUnmount()}catch(j){pt(s,r,j)}}break;case 5:Ai(S,S.return);break;case 22:if(S.memoizedState!==null){bf(E);continue}}I!==null?(I.return=S,ce=I):bf(E)}v=v.sibling}e:for(v=null,E=t;;){if(E.tag===5){if(v===null){v=E;try{o=E.stateNode,x?(l=o.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(g=E.stateNode,w=E.memoizedProps.style,f=w!=null&&w.hasOwnProperty("display")?w.display:null,g.style.display=q1("display",f))}catch(j){pt(t,t.return,j)}}}else if(E.tag===6){if(v===null)try{E.stateNode.nodeValue=x?"":E.memoizedProps}catch(j){pt(t,t.return,j)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===t)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===t)break e;for(;E.sibling===null;){if(E.return===null||E.return===t)break e;v===E&&(v=null),E=E.return}v===E&&(v=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:qr(e,t),wn(t),s&4&&yf(t);break;case 21:break;default:qr(e,t),wn(t)}}function wn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(bg(r)){var s=r;break e}r=r.return}throw Error(J(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(Ua(o,""),s.flags&=-33);var l=wf(t);dd(t,l,o);break;case 3:case 4:var f=s.stateNode.containerInfo,g=wf(t);ud(t,g,f);break;default:throw Error(J(161))}}catch(w){pt(t,t.return,w)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function sy(t,e,r){ce=t,Ng(t)}function Ng(t,e,r){for(var s=(t.mode&1)!==0;ce!==null;){var o=ce,l=o.child;if(o.tag===22&&s){var f=o.memoizedState!==null||Go;if(!f){var g=o.alternate,w=g!==null&&g.memoizedState!==null||Yt;g=Go;var x=Yt;if(Go=f,(Yt=w)&&!x)for(ce=o;ce!==null;)f=ce,w=f.child,f.tag===22&&f.memoizedState!==null?Ef(o):w!==null?(w.return=f,ce=w):Ef(o);for(;l!==null;)ce=l,Ng(l),l=l.sibling;ce=o,Go=g,Yt=x}vf(t)}else o.subtreeFlags&8772&&l!==null?(l.return=o,ce=l):vf(t)}}function vf(t){for(;ce!==null;){var e=ce;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yt||lc(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Yt)if(r===null)s.componentDidMount();else{var o=e.elementType===e.type?r.memoizedProps:Zr(e.type,r.memoizedProps);s.componentDidUpdate(o,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;l!==null&&nf(e,l,s);break;case 3:var f=e.updateQueue;if(f!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}nf(e,f,r)}break;case 5:var g=e.stateNode;if(r===null&&e.flags&4){r=g;var w=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":w.autoFocus&&r.focus();break;case"img":w.src&&(r.src=w.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var x=e.alternate;if(x!==null){var v=x.memoizedState;if(v!==null){var E=v.dehydrated;E!==null&&Wa(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}Yt||e.flags&512&&cd(e)}catch(S){pt(e,e.return,S)}}if(e===t){ce=null;break}if(r=e.sibling,r!==null){r.return=e.return,ce=r;break}ce=e.return}}function bf(t){for(;ce!==null;){var e=ce;if(e===t){ce=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ce=r;break}ce=e.return}}function Ef(t){for(;ce!==null;){var e=ce;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{lc(4,e)}catch(w){pt(e,r,w)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var o=e.return;try{s.componentDidMount()}catch(w){pt(e,o,w)}}var l=e.return;try{cd(e)}catch(w){pt(e,l,w)}break;case 5:var f=e.return;try{cd(e)}catch(w){pt(e,f,w)}}}catch(w){pt(e,e.return,w)}if(e===t){ce=null;break}var g=e.sibling;if(g!==null){g.return=e.return,ce=g;break}ce=e.return}}var iy=Math.ceil,Pl=Un.ReactCurrentDispatcher,wh=Un.ReactCurrentOwner,Vr=Un.ReactCurrentBatchConfig,De=0,Mt=null,Nt=null,Vt=0,Nr=0,Ii=ys(0),jt=0,to=null,$s=0,cc=0,yh=0,Ma=null,fr=null,vh=0,Hi=1/0,Sn=null,Bl=!1,hd=null,cs=null,$o=!1,ns=null,Fl=0,Da=0,fd=null,fl=-1,ml=0;function nr(){return De&6?bt():fl!==-1?fl:fl=bt()}function us(t){return t.mode&1?De&2&&Vt!==0?Vt&-Vt:Vw.transition!==null?(ml===0&&(ml=lm()),ml):(t=Ve,t!==0||(t=window.event,t=t===void 0?16:gm(t.type)),t):1}function an(t,e,r,s){if(50<Da)throw Da=0,fd=null,Error(J(185));co(t,r,s),(!(De&2)||t!==Mt)&&(t===Mt&&(!(De&2)&&(cc|=r),jt===4&&es(t,Vt)),pr(t,s),r===1&&De===0&&!(e.mode&1)&&(Hi=bt()+500,ic&&vs()))}function pr(t,e){var r=t.callbackNode;V2(t,e);var s=El(t,t===Mt?Vt:0);if(s===0)r!==null&&j0(r),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(r!=null&&j0(r),e===1)t.tag===0?zw(Cf.bind(null,t)):Mm(Cf.bind(null,t)),Pw(function(){!(De&6)&&vs()}),r=null;else{switch(cm(s)){case 1:r=$d;break;case 4:r=am;break;case 16:r=bl;break;case 536870912:r=om;break;default:r=bl}r=Og(r,_g.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function _g(t,e){if(fl=-1,ml=0,De&6)throw Error(J(327));var r=t.callbackNode;if(Di()&&t.callbackNode!==r)return null;var s=El(t,t===Mt?Vt:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Ul(t,s);else{e=s;var o=De;De|=2;var l=Ag();(Mt!==t||Vt!==e)&&(Sn=null,Hi=bt()+500,zs(t,e));do try{ly();break}catch(g){Sg(t,g)}while(!0);ih(),Pl.current=l,De=o,Nt!==null?e=0:(Mt=null,Vt=0,e=jt)}if(e!==0){if(e===2&&(o=Uu(t),o!==0&&(s=o,e=md(t,o))),e===1)throw r=to,zs(t,0),es(t,s),pr(t,bt()),r;if(e===6)es(t,s);else{if(o=t.current.alternate,!(s&30)&&!ay(o)&&(e=Ul(t,s),e===2&&(l=Uu(t),l!==0&&(s=l,e=md(t,l))),e===1))throw r=to,zs(t,0),es(t,s),pr(t,bt()),r;switch(t.finishedWork=o,t.finishedLanes=s,e){case 0:case 1:throw Error(J(345));case 2:Os(t,fr,Sn);break;case 3:if(es(t,s),(s&130023424)===s&&(e=vh+500-bt(),10<e)){if(El(t,0)!==0)break;if(o=t.suspendedLanes,(o&s)!==s){nr(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Yu(Os.bind(null,t,fr,Sn),e);break}Os(t,fr,Sn);break;case 4:if(es(t,s),(s&4194240)===s)break;for(e=t.eventTimes,o=-1;0<s;){var f=31-sn(s);l=1<<f,f=e[f],f>o&&(o=f),s&=~l}if(s=o,s=bt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*iy(s/1960))-s,10<s){t.timeoutHandle=Yu(Os.bind(null,t,fr,Sn),s);break}Os(t,fr,Sn);break;case 5:Os(t,fr,Sn);break;default:throw Error(J(329))}}}return pr(t,bt()),t.callbackNode===r?_g.bind(null,t):null}function md(t,e){var r=Ma;return t.current.memoizedState.isDehydrated&&(zs(t,e).flags|=256),t=Ul(t,e),t!==2&&(e=fr,fr=r,e!==null&&gd(e)),t}function gd(t){fr===null?fr=t:fr.push.apply(fr,t)}function ay(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var o=r[s],l=o.getSnapshot;o=o.value;try{if(!on(l(),o))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function es(t,e){for(e&=~yh,e&=~cc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-sn(e),s=1<<r;t[r]=-1,e&=~s}}function Cf(t){if(De&6)throw Error(J(327));Di();var e=El(t,0);if(!(e&1))return pr(t,bt()),null;var r=Ul(t,e);if(t.tag!==0&&r===2){var s=Uu(t);s!==0&&(e=s,r=md(t,s))}if(r===1)throw r=to,zs(t,0),es(t,e),pr(t,bt()),r;if(r===6)throw Error(J(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Os(t,fr,Sn),pr(t,bt()),null}function bh(t,e){var r=De;De|=1;try{return t(e)}finally{De=r,De===0&&(Hi=bt()+500,ic&&vs())}}function Xs(t){ns!==null&&ns.tag===0&&!(De&6)&&Di();var e=De;De|=1;var r=Vr.transition,s=Ve;try{if(Vr.transition=null,Ve=1,t)return t()}finally{Ve=s,Vr.transition=r,De=e,!(De&6)&&vs()}}function Eh(){Nr=Ii.current,nt(Ii)}function zs(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Lw(r)),Nt!==null)for(r=Nt.return;r!==null;){var s=r;switch(rh(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Al();break;case 3:zi(),nt(gr),nt(Qt),dh();break;case 5:uh(s);break;case 4:zi();break;case 13:nt(ut);break;case 19:nt(ut);break;case 10:ah(s.type._context);break;case 22:case 23:Eh()}r=r.return}if(Mt=t,Nt=t=ds(t.current,null),Vt=Nr=e,jt=0,to=null,yh=cc=$s=0,fr=Ma=null,Bs!==null){for(e=0;e<Bs.length;e++)if(r=Bs[e],s=r.interleaved,s!==null){r.interleaved=null;var o=s.next,l=r.pending;if(l!==null){var f=l.next;l.next=o,s.next=f}r.pending=s}Bs=null}return t}function Sg(t,e){do{var r=Nt;try{if(ih(),ul.current=Ll,Dl){for(var s=dt.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Dl=!1}if(Gs=0,kt=Tt=dt=null,Oa=!1,Za=0,wh.current=null,r===null||r.return===null){jt=1,to=e,Nt=null;break}e:{var l=t,f=r.return,g=r,w=e;if(e=Vt,g.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){var x=w,v=g,E=v.tag;if(!(v.mode&1)&&(E===0||E===11||E===15)){var S=v.alternate;S?(v.updateQueue=S.updateQueue,v.memoizedState=S.memoizedState,v.lanes=S.lanes):(v.updateQueue=null,v.memoizedState=null)}var I=uf(f);if(I!==null){I.flags&=-257,df(I,f,g,l,e),I.mode&1&&cf(l,x,e),e=I,w=x;var k=e.updateQueue;if(k===null){var j=new Set;j.add(w),e.updateQueue=j}else k.add(w);break e}else{if(!(e&1)){cf(l,x,e),Ch();break e}w=Error(J(426))}}else if(it&&g.mode&1){var M=uf(f);if(M!==null){!(M.flags&65536)&&(M.flags|=256),df(M,f,g,l,e),nh(Vi(w,g));break e}}l=w=Vi(w,g),jt!==4&&(jt=2),Ma===null?Ma=[l]:Ma.push(l),l=f;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e;var A=cg(l,w,e);rf(l,A);break e;case 1:g=w;var C=l.type,T=l.stateNode;if(!(l.flags&128)&&(typeof C.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(cs===null||!cs.has(T)))){l.flags|=65536,e&=-e,l.lanes|=e;var O=ug(l,g,e);rf(l,O);break e}}l=l.return}while(l!==null)}Tg(r)}catch(V){e=V,Nt===r&&r!==null&&(Nt=r=r.return);continue}break}while(!0)}function Ag(){var t=Pl.current;return Pl.current=Ll,t===null?Ll:t}function Ch(){(jt===0||jt===3||jt===2)&&(jt=4),Mt===null||!($s&268435455)&&!(cc&268435455)||es(Mt,Vt)}function Ul(t,e){var r=De;De|=2;var s=Ag();(Mt!==t||Vt!==e)&&(Sn=null,zs(t,e));do try{oy();break}catch(o){Sg(t,o)}while(!0);if(ih(),De=r,Pl.current=s,Nt!==null)throw Error(J(261));return Mt=null,Vt=0,jt}function oy(){for(;Nt!==null;)Ig(Nt)}function ly(){for(;Nt!==null&&!k2();)Ig(Nt)}function Ig(t){var e=Rg(t.alternate,t,Nr);t.memoizedProps=t.pendingProps,e===null?Tg(t):Nt=e,wh.current=null}function Tg(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=ty(r,e),r!==null){r.flags&=32767,Nt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{jt=6,Nt=null;return}}else if(r=ey(r,e,Nr),r!==null){Nt=r;return}if(e=e.sibling,e!==null){Nt=e;return}Nt=e=t}while(e!==null);jt===0&&(jt=5)}function Os(t,e,r){var s=Ve,o=Vr.transition;try{Vr.transition=null,Ve=1,cy(t,e,r,s)}finally{Vr.transition=o,Ve=s}return null}function cy(t,e,r,s){do Di();while(ns!==null);if(De&6)throw Error(J(327));r=t.finishedWork;var o=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(J(177));t.callbackNode=null,t.callbackPriority=0;var l=r.lanes|r.childLanes;if(H2(t,l),t===Mt&&(Nt=Mt=null,Vt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||$o||($o=!0,Og(bl,function(){return Di(),null})),l=(r.flags&15990)!==0,r.subtreeFlags&15990||l){l=Vr.transition,Vr.transition=null;var f=Ve;Ve=1;var g=De;De|=4,wh.current=null,ny(t,r),Cg(r,t),Tw($u),Cl=!!Gu,$u=Gu=null,t.current=r,sy(r),M2(),De=g,Ve=f,Vr.transition=l}else t.current=r;if($o&&($o=!1,ns=t,Fl=o),l=t.pendingLanes,l===0&&(cs=null),P2(r.stateNode),pr(t,bt()),e!==null)for(s=t.onRecoverableError,r=0;r<e.length;r++)o=e[r],s(o.value,{componentStack:o.stack,digest:o.digest});if(Bl)throw Bl=!1,t=hd,hd=null,t;return Fl&1&&t.tag!==0&&Di(),l=t.pendingLanes,l&1?t===fd?Da++:(Da=0,fd=t):Da=0,vs(),null}function Di(){if(ns!==null){var t=cm(Fl),e=Vr.transition,r=Ve;try{if(Vr.transition=null,Ve=16>t?16:t,ns===null)var s=!1;else{if(t=ns,ns=null,Fl=0,De&6)throw Error(J(331));var o=De;for(De|=4,ce=t.current;ce!==null;){var l=ce,f=l.child;if(ce.flags&16){var g=l.deletions;if(g!==null){for(var w=0;w<g.length;w++){var x=g[w];for(ce=x;ce!==null;){var v=ce;switch(v.tag){case 0:case 11:case 15:ka(8,v,l)}var E=v.child;if(E!==null)E.return=v,ce=E;else for(;ce!==null;){v=ce;var S=v.sibling,I=v.return;if(vg(v),v===x){ce=null;break}if(S!==null){S.return=I,ce=S;break}ce=I}}}var k=l.alternate;if(k!==null){var j=k.child;if(j!==null){k.child=null;do{var M=j.sibling;j.sibling=null,j=M}while(j!==null)}}ce=l}}if(l.subtreeFlags&2064&&f!==null)f.return=l,ce=f;else e:for(;ce!==null;){if(l=ce,l.flags&2048)switch(l.tag){case 0:case 11:case 15:ka(9,l,l.return)}var A=l.sibling;if(A!==null){A.return=l.return,ce=A;break e}ce=l.return}}var C=t.current;for(ce=C;ce!==null;){f=ce;var T=f.child;if(f.subtreeFlags&2064&&T!==null)T.return=f,ce=T;else e:for(f=C;ce!==null;){if(g=ce,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:lc(9,g)}}catch(V){pt(g,g.return,V)}if(g===f){ce=null;break e}var O=g.sibling;if(O!==null){O.return=g.return,ce=O;break e}ce=g.return}}if(De=o,vs(),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(ec,t)}catch{}s=!0}return s}finally{Ve=r,Vr.transition=e}}return!1}function Nf(t,e,r){e=Vi(r,e),e=cg(t,e,1),t=ls(t,e,1),e=nr(),t!==null&&(co(t,1,e),pr(t,e))}function pt(t,e,r){if(t.tag===3)Nf(t,t,r);else for(;e!==null;){if(e.tag===3){Nf(e,t,r);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(cs===null||!cs.has(s))){t=Vi(r,t),t=ug(e,t,1),e=ls(e,t,1),t=nr(),e!==null&&(co(e,1,t),pr(e,t));break}}e=e.return}}function uy(t,e,r){var s=t.pingCache;s!==null&&s.delete(e),e=nr(),t.pingedLanes|=t.suspendedLanes&r,Mt===t&&(Vt&r)===r&&(jt===4||jt===3&&(Vt&130023424)===Vt&&500>bt()-vh?zs(t,0):yh|=r),pr(t,e)}function jg(t,e){e===0&&(t.mode&1?(e=Lo,Lo<<=1,!(Lo&130023424)&&(Lo=4194304)):e=1);var r=nr();t=Ln(t,e),t!==null&&(co(t,e,r),pr(t,r))}function dy(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),jg(t,r)}function hy(t,e){var r=0;switch(t.tag){case 13:var s=t.stateNode,o=t.memoizedState;o!==null&&(r=o.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(J(314))}s!==null&&s.delete(e),jg(t,r)}var Rg;Rg=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||gr.current)mr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return mr=!1,Jw(t,e,r);mr=!!(t.flags&131072)}else mr=!1,it&&e.flags&1048576&&Dm(e,jl,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;hl(t,e),t=e.pendingProps;var o=Bi(e,Qt.current);Mi(e,r),o=fh(null,e,s,t,o,r);var l=mh();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,xr(s)?(l=!0,Il(e)):l=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,lh(e),o.updater=oc,e.stateNode=o,o._reactInternals=e,td(e,s,t,r),e=sd(null,e,s,!0,l,r)):(e.tag=0,it&&l&&th(e),er(null,e,o,r),e=e.child),e;case 16:s=e.elementType;e:{switch(hl(t,e),t=e.pendingProps,o=s._init,s=o(s._payload),e.type=s,o=e.tag=my(s),t=Zr(s,t),o){case 0:e=nd(null,e,s,t,r);break e;case 1:e=mf(null,e,s,t,r);break e;case 11:e=hf(null,e,s,t,r);break e;case 14:e=ff(null,e,s,Zr(s.type,t),r);break e}throw Error(J(306,s,""))}return e;case 0:return s=e.type,o=e.pendingProps,o=e.elementType===s?o:Zr(s,o),nd(t,e,s,o,r);case 1:return s=e.type,o=e.pendingProps,o=e.elementType===s?o:Zr(s,o),mf(t,e,s,o,r);case 3:e:{if(mg(e),t===null)throw Error(J(387));s=e.pendingProps,l=e.memoizedState,o=l.element,zm(t,e),kl(e,s,null,r);var f=e.memoizedState;if(s=f.element,l.isDehydrated)if(l={element:s,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},e.updateQueue.baseState=l,e.memoizedState=l,e.flags&256){o=Vi(Error(J(423)),e),e=gf(t,e,s,r,o);break e}else if(s!==o){o=Vi(Error(J(424)),e),e=gf(t,e,s,r,o);break e}else for(Ir=os(e.stateNode.containerInfo.firstChild),Tr=e,it=!0,nn=null,r=Fm(e,null,s,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Fi(),s===o){e=Pn(t,e,r);break e}er(t,e,s,r)}e=e.child}return e;case 5:return Vm(e),t===null&&Zu(e),s=e.type,o=e.pendingProps,l=t!==null?t.memoizedProps:null,f=o.children,Xu(s,o)?f=null:l!==null&&Xu(s,l)&&(e.flags|=32),fg(t,e),er(t,e,f,r),e.child;case 6:return t===null&&Zu(e),null;case 13:return gg(t,e,r);case 4:return ch(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Ui(e,null,s,r):er(t,e,s,r),e.child;case 11:return s=e.type,o=e.pendingProps,o=e.elementType===s?o:Zr(s,o),hf(t,e,s,o,r);case 7:return er(t,e,e.pendingProps,r),e.child;case 8:return er(t,e,e.pendingProps.children,r),e.child;case 12:return er(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(s=e.type._context,o=e.pendingProps,l=e.memoizedProps,f=o.value,Je(Rl,s._currentValue),s._currentValue=f,l!==null)if(on(l.value,f)){if(l.children===o.children&&!gr.current){e=Pn(t,e,r);break e}}else for(l=e.child,l!==null&&(l.return=e);l!==null;){var g=l.dependencies;if(g!==null){f=l.child;for(var w=g.firstContext;w!==null;){if(w.context===s){if(l.tag===1){w=On(-1,r&-r),w.tag=2;var x=l.updateQueue;if(x!==null){x=x.shared;var v=x.pending;v===null?w.next=w:(w.next=v.next,v.next=w),x.pending=w}}l.lanes|=r,w=l.alternate,w!==null&&(w.lanes|=r),Ju(l.return,r,e),g.lanes|=r;break}w=w.next}}else if(l.tag===10)f=l.type===e.type?null:l.child;else if(l.tag===18){if(f=l.return,f===null)throw Error(J(341));f.lanes|=r,g=f.alternate,g!==null&&(g.lanes|=r),Ju(f,r,e),f=l.sibling}else f=l.child;if(f!==null)f.return=l;else for(f=l;f!==null;){if(f===e){f=null;break}if(l=f.sibling,l!==null){l.return=f.return,f=l;break}f=f.return}l=f}er(t,e,o.children,r),e=e.child}return e;case 9:return o=e.type,s=e.pendingProps.children,Mi(e,r),o=Hr(o),s=s(o),e.flags|=1,er(t,e,s,r),e.child;case 14:return s=e.type,o=Zr(s,e.pendingProps),o=Zr(s.type,o),ff(t,e,s,o,r);case 15:return dg(t,e,e.type,e.pendingProps,r);case 17:return s=e.type,o=e.pendingProps,o=e.elementType===s?o:Zr(s,o),hl(t,e),e.tag=1,xr(s)?(t=!0,Il(e)):t=!1,Mi(e,r),lg(e,s,o),td(e,s,o,r),sd(null,e,s,!0,t,r);case 19:return xg(t,e,r);case 22:return hg(t,e,r)}throw Error(J(156,e.tag))};function Og(t,e){return im(t,e)}function fy(t,e,r,s){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zr(t,e,r,s){return new fy(t,e,r,s)}function Nh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function my(t){if(typeof t=="function")return Nh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Hd)return 11;if(t===Wd)return 14}return 2}function ds(t,e){var r=t.alternate;return r===null?(r=zr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function gl(t,e,r,s,o,l){var f=2;if(s=t,typeof t=="function")Nh(t)&&(f=1);else if(typeof t=="string")f=5;else e:switch(t){case wi:return Vs(r.children,o,l,e);case Vd:f=8,o|=8;break;case _u:return t=zr(12,r,e,o|2),t.elementType=_u,t.lanes=l,t;case Su:return t=zr(13,r,e,o),t.elementType=Su,t.lanes=l,t;case Au:return t=zr(19,r,e,o),t.elementType=Au,t.lanes=l,t;case V1:return uc(r,o,l,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case U1:f=10;break e;case z1:f=9;break e;case Hd:f=11;break e;case Wd:f=14;break e;case Qn:f=16,s=null;break e}throw Error(J(130,t==null?t:typeof t,""))}return e=zr(f,r,e,o),e.elementType=t,e.type=s,e.lanes=l,e}function Vs(t,e,r,s){return t=zr(7,t,s,e),t.lanes=r,t}function uc(t,e,r,s){return t=zr(22,t,s,e),t.elementType=V1,t.lanes=r,t.stateNode={isHidden:!1},t}function uu(t,e,r){return t=zr(6,t,null,e),t.lanes=r,t}function du(t,e,r){return e=zr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function gy(t,e,r,s,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gc(0),this.expirationTimes=Gc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gc(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function _h(t,e,r,s,o,l,f,g,w){return t=new gy(t,e,r,g,w),e===1?(e=1,l===!0&&(e|=8)):e=0,l=zr(3,null,null,e),t.current=l,l.stateNode=t,l.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},lh(l),t}function xy(t,e,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pi,key:s==null?null:""+s,children:t,containerInfo:e,implementation:r}}function kg(t){if(!t)return gs;t=t._reactInternals;e:{if(Ks(t)!==t||t.tag!==1)throw Error(J(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(xr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(J(171))}if(t.tag===1){var r=t.type;if(xr(r))return km(t,r,e)}return e}function Mg(t,e,r,s,o,l,f,g,w){return t=_h(r,s,!0,t,o,l,f,g,w),t.context=kg(null),r=t.current,s=nr(),o=us(r),l=On(s,o),l.callback=e??null,ls(r,l,o),t.current.lanes=o,co(t,o,s),pr(t,s),t}function dc(t,e,r,s){var o=e.current,l=nr(),f=us(o);return r=kg(r),e.context===null?e.context=r:e.pendingContext=r,e=On(l,f),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=ls(o,e,f),t!==null&&(an(t,o,f,l),cl(t,o,f)),f}function zl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function _f(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Sh(t,e){_f(t,e),(t=t.alternate)&&_f(t,e)}function py(){return null}var Dg=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ah(t){this._internalRoot=t}hc.prototype.render=Ah.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(J(409));dc(t,e,null,null)};hc.prototype.unmount=Ah.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Xs(function(){dc(null,t,null,null)}),e[Dn]=null}};function hc(t){this._internalRoot=t}hc.prototype.unstable_scheduleHydration=function(t){if(t){var e=hm();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Jn.length&&e!==0&&e<Jn[r].priority;r++);Jn.splice(r,0,t),r===0&&mm(t)}};function Ih(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function fc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Sf(){}function wy(t,e,r,s,o){if(o){if(typeof s=="function"){var l=s;s=function(){var x=zl(f);l.call(x)}}var f=Mg(e,s,t,0,null,!1,!1,"",Sf);return t._reactRootContainer=f,t[Dn]=f.current,Xa(t.nodeType===8?t.parentNode:t),Xs(),f}for(;o=t.lastChild;)t.removeChild(o);if(typeof s=="function"){var g=s;s=function(){var x=zl(w);g.call(x)}}var w=_h(t,0,!1,null,null,!1,!1,"",Sf);return t._reactRootContainer=w,t[Dn]=w.current,Xa(t.nodeType===8?t.parentNode:t),Xs(function(){dc(e,w,r,s)}),w}function mc(t,e,r,s,o){var l=r._reactRootContainer;if(l){var f=l;if(typeof o=="function"){var g=o;o=function(){var w=zl(f);g.call(w)}}dc(e,f,t,o)}else f=wy(r,e,t,o,s);return zl(f)}um=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Na(e.pendingLanes);r!==0&&(Xd(e,r|1),pr(e,bt()),!(De&6)&&(Hi=bt()+500,vs()))}break;case 13:Xs(function(){var s=Ln(t,1);if(s!==null){var o=nr();an(s,t,1,o)}}),Sh(t,1)}};Yd=function(t){if(t.tag===13){var e=Ln(t,134217728);if(e!==null){var r=nr();an(e,t,134217728,r)}Sh(t,134217728)}};dm=function(t){if(t.tag===13){var e=us(t),r=Ln(t,e);if(r!==null){var s=nr();an(r,t,e,s)}Sh(t,e)}};hm=function(){return Ve};fm=function(t,e){var r=Ve;try{return Ve=t,e()}finally{Ve=r}};Pu=function(t,e,r){switch(e){case"input":if(ju(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var s=r[e];if(s!==t&&s.form===t.form){var o=sc(s);if(!o)throw Error(J(90));W1(s),ju(s,o)}}}break;case"textarea":$1(t,r);break;case"select":e=r.value,e!=null&&ji(t,!!r.multiple,e,!1)}};J1=bh;em=Xs;var yy={usingClientEntryPoint:!1,Events:[ho,Ei,sc,Q1,Z1,bh]},va={findFiberByHostInstance:Ps,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vy={bundleType:va.bundleType,version:va.version,rendererPackageName:va.rendererPackageName,rendererConfig:va.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Un.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=nm(t),t===null?null:t.stateNode},findFiberByHostInstance:va.findFiberByHostInstance||py,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xo.isDisabled&&Xo.supportsFiber)try{ec=Xo.inject(vy),En=Xo}catch{}}Or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yy;Or.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ih(e))throw Error(J(200));return xy(t,e,null,r)};Or.createRoot=function(t,e){if(!Ih(t))throw Error(J(299));var r=!1,s="",o=Dg;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=_h(t,1,!1,null,null,r,!1,s,o),t[Dn]=e.current,Xa(t.nodeType===8?t.parentNode:t),new Ah(e)};Or.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(J(188)):(t=Object.keys(t).join(","),Error(J(268,t)));return t=nm(e),t=t===null?null:t.stateNode,t};Or.flushSync=function(t){return Xs(t)};Or.hydrate=function(t,e,r){if(!fc(e))throw Error(J(200));return mc(null,t,e,!0,r)};Or.hydrateRoot=function(t,e,r){if(!Ih(t))throw Error(J(405));var s=r!=null&&r.hydratedSources||null,o=!1,l="",f=Dg;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(f=r.onRecoverableError)),e=Mg(e,null,t,1,r??null,o,!1,l,f),t[Dn]=e.current,Xa(t),s)for(t=0;t<s.length;t++)r=s[t],o=r._getVersion,o=o(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,o]:e.mutableSourceEagerHydrationData.push(r,o);return new hc(e)};Or.render=function(t,e,r){if(!fc(e))throw Error(J(200));return mc(null,t,e,!1,r)};Or.unmountComponentAtNode=function(t){if(!fc(t))throw Error(J(40));return t._reactRootContainer?(Xs(function(){mc(null,null,t,!1,function(){t._reactRootContainer=null,t[Dn]=null})}),!0):!1};Or.unstable_batchedUpdates=bh;Or.unstable_renderSubtreeIntoContainer=function(t,e,r,s){if(!fc(r))throw Error(J(200));if(t==null||t._reactInternals===void 0)throw Error(J(38));return mc(t,e,r,!1,s)};Or.version="18.3.1-next-f1338f8080-20240426";function Lg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Lg)}catch(t){console.error(t)}}Lg(),L1.exports=Or;var by=L1.exports,Pg,Af=by;Pg=Af.createRoot,Af.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var If="popstate";function Ey(t={}){function e(o,l){let{pathname:f="/",search:g="",hash:w=""}=Qs(o.location.hash.substring(1));return!f.startsWith("/")&&!f.startsWith(".")&&(f="/"+f),xd("",{pathname:f,search:g,hash:w},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function r(o,l){let f=o.document.querySelector("base"),g="";if(f&&f.getAttribute("href")){let w=o.location.href,x=w.indexOf("#");g=x===-1?w:w.slice(0,x)}return g+"#"+(typeof l=="string"?l:ro(l))}function s(o,l){yr(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(l)})`)}return Ny(e,r,s,t)}function ot(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function yr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Cy(){return Math.random().toString(36).substring(2,10)}function Tf(t,e){return{usr:t.state,key:t.key,idx:e}}function xd(t,e,r=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Qs(e):e,state:r,key:e&&e.key||s||Cy()}}function ro({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Qs(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function Ny(t,e,r,s={}){let{window:o=document.defaultView,v5Compat:l=!1}=s,f=o.history,g="POP",w=null,x=v();x==null&&(x=0,f.replaceState({...f.state,idx:x},""));function v(){return(f.state||{idx:null}).idx}function E(){g="POP";let M=v(),A=M==null?null:M-x;x=M,w&&w({action:g,location:j.location,delta:A})}function S(M,A){g="PUSH";let C=xd(j.location,M,A);r&&r(C,M),x=v()+1;let T=Tf(C,x),O=j.createHref(C);try{f.pushState(T,"",O)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;o.location.assign(O)}l&&w&&w({action:g,location:j.location,delta:1})}function I(M,A){g="REPLACE";let C=xd(j.location,M,A);r&&r(C,M),x=v();let T=Tf(C,x),O=j.createHref(C);f.replaceState(T,"",O),l&&w&&w({action:g,location:j.location,delta:0})}function k(M){return _y(M)}let j={get action(){return g},get location(){return t(o,f)},listen(M){if(w)throw new Error("A history only accepts one active listener");return o.addEventListener(If,E),w=M,()=>{o.removeEventListener(If,E),w=null}},createHref(M){return e(o,M)},createURL:k,encodeLocation(M){let A=k(M);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:S,replace:I,go(M){return f.go(M)}};return j}function _y(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),ot(r,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:ro(t);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=r+s),new URL(s,r)}function Bg(t,e,r="/"){return Sy(t,e,r,!1)}function Sy(t,e,r,s){let o=typeof e=="string"?Qs(e):e,l=Bn(o.pathname||"/",r);if(l==null)return null;let f=Fg(t);Ay(f);let g=null;for(let w=0;g==null&&w<f.length;++w){let x=By(l);g=Ly(f[w],x,s)}return g}function Fg(t,e=[],r=[],s="",o=!1){let l=(f,g,w=o,x)=>{let v={relativePath:x===void 0?f.path||"":x,caseSensitive:f.caseSensitive===!0,childrenIndex:g,route:f};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(s)&&w)return;ot(v.relativePath.startsWith(s),`Absolute route path "${v.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(s.length)}let E=kn([s,v.relativePath]),S=r.concat(v);f.children&&f.children.length>0&&(ot(f.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),Fg(f.children,e,S,E,w)),!(f.path==null&&!f.index)&&e.push({path:E,score:My(E,f.index),routesMeta:S})};return t.forEach((f,g)=>{var w;if(f.path===""||!((w=f.path)!=null&&w.includes("?")))l(f,g);else for(let x of Ug(f.path))l(f,g,!0,x)}),e}function Ug(t){let e=t.split("/");if(e.length===0)return[];let[r,...s]=e,o=r.endsWith("?"),l=r.replace(/\?$/,"");if(s.length===0)return o?[l,""]:[l];let f=Ug(s.join("/")),g=[];return g.push(...f.map(w=>w===""?l:[l,w].join("/"))),o&&g.push(...f),g.map(w=>t.startsWith("/")&&w===""?"/":w)}function Ay(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Dy(e.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}var Iy=/^:[\w-]+$/,Ty=3,jy=2,Ry=1,Oy=10,ky=-2,jf=t=>t==="*";function My(t,e){let r=t.split("/"),s=r.length;return r.some(jf)&&(s+=ky),e&&(s+=jy),r.filter(o=>!jf(o)).reduce((o,l)=>o+(Iy.test(l)?Ty:l===""?Ry:Oy),s)}function Dy(t,e){return t.length===e.length&&t.slice(0,-1).every((s,o)=>s===e[o])?t[t.length-1]-e[e.length-1]:0}function Ly(t,e,r=!1){let{routesMeta:s}=t,o={},l="/",f=[];for(let g=0;g<s.length;++g){let w=s[g],x=g===s.length-1,v=l==="/"?e:e.slice(l.length)||"/",E=Vl({path:w.relativePath,caseSensitive:w.caseSensitive,end:x},v),S=w.route;if(!E&&x&&r&&!s[s.length-1].route.index&&(E=Vl({path:w.relativePath,caseSensitive:w.caseSensitive,end:!1},v)),!E)return null;Object.assign(o,E.params),f.push({params:o,pathname:kn([l,E.pathname]),pathnameBase:Hy(kn([l,E.pathnameBase])),route:S}),E.pathnameBase!=="/"&&(l=kn([l,E.pathnameBase]))}return f}function Vl(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,s]=Py(t.path,t.caseSensitive,t.end),o=e.match(r);if(!o)return null;let l=o[0],f=l.replace(/(.)\/+$/,"$1"),g=o.slice(1);return{params:s.reduce((x,{paramName:v,isOptional:E},S)=>{if(v==="*"){let k=g[S]||"";f=l.slice(0,l.length-k.length).replace(/(.)\/+$/,"$1")}const I=g[S];return E&&!I?x[v]=void 0:x[v]=(I||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:f,pattern:t}}function Py(t,e=!1,r=!0){yr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,g,w)=>(s.push({paramName:g,isOptional:w!=null}),w?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(s.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function By(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return yr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Bn(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,s=t.charAt(r);return s&&s!=="/"?null:t.slice(r)||"/"}var Fy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Uy=t=>Fy.test(t);function zy(t,e="/"){let{pathname:r,search:s="",hash:o=""}=typeof t=="string"?Qs(t):t,l;if(r)if(Uy(r))l=r;else{if(r.includes("//")){let f=r;r=r.replace(/\/\/+/g,"/"),yr(!1,`Pathnames cannot have embedded double slashes - normalizing ${f} -> ${r}`)}r.startsWith("/")?l=Rf(r.substring(1),"/"):l=Rf(r,e)}else l=e;return{pathname:l,search:Wy(s),hash:Gy(o)}}function Rf(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?r.length>1&&r.pop():o!=="."&&r.push(o)}),r.length>1?r.join("/"):"/"}function hu(t,e,r,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Vy(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Th(t){let e=Vy(t);return e.map((r,s)=>s===e.length-1?r.pathname:r.pathnameBase)}function jh(t,e,r,s=!1){let o;typeof t=="string"?o=Qs(t):(o={...t},ot(!o.pathname||!o.pathname.includes("?"),hu("?","pathname","search",o)),ot(!o.pathname||!o.pathname.includes("#"),hu("#","pathname","hash",o)),ot(!o.search||!o.search.includes("#"),hu("#","search","hash",o)));let l=t===""||o.pathname==="",f=l?"/":o.pathname,g;if(f==null)g=r;else{let E=e.length-1;if(!s&&f.startsWith("..")){let S=f.split("/");for(;S[0]==="..";)S.shift(),E-=1;o.pathname=S.join("/")}g=E>=0?e[E]:"/"}let w=zy(o,g),x=f&&f!=="/"&&f.endsWith("/"),v=(l||f===".")&&r.endsWith("/");return!w.pathname.endsWith("/")&&(x||v)&&(w.pathname+="/"),w}var kn=t=>t.join("/").replace(/\/\/+/g,"/"),Hy=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Wy=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Gy=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function $y(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var zg=["POST","PUT","PATCH","DELETE"];new Set(zg);var Xy=["GET",...zg];new Set(Xy);var qi=P.createContext(null);qi.displayName="DataRouter";var gc=P.createContext(null);gc.displayName="DataRouterState";P.createContext(!1);var Vg=P.createContext({isTransitioning:!1});Vg.displayName="ViewTransition";var Yy=P.createContext(new Map);Yy.displayName="Fetchers";var qy=P.createContext(null);qy.displayName="Await";var ln=P.createContext(null);ln.displayName="Navigation";var mo=P.createContext(null);mo.displayName="Location";var cn=P.createContext({outlet:null,matches:[],isDataRoute:!1});cn.displayName="Route";var Rh=P.createContext(null);Rh.displayName="RouteError";function Ky(t,{relative:e}={}){ot(Ki(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:s}=P.useContext(ln),{hash:o,pathname:l,search:f}=go(t,{relative:e}),g=l;return r!=="/"&&(g=l==="/"?r:kn([r,l])),s.createHref({pathname:g,search:f,hash:o})}function Ki(){return P.useContext(mo)!=null}function un(){return ot(Ki(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(mo).location}var Hg="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Wg(t){P.useContext(ln).static||P.useLayoutEffect(t)}function wt(){let{isDataRoute:t}=P.useContext(cn);return t?cv():Qy()}function Qy(){ot(Ki(),"useNavigate() may be used only in the context of a <Router> component.");let t=P.useContext(qi),{basename:e,navigator:r}=P.useContext(ln),{matches:s}=P.useContext(cn),{pathname:o}=un(),l=JSON.stringify(Th(s)),f=P.useRef(!1);return Wg(()=>{f.current=!0}),P.useCallback((w,x={})=>{if(yr(f.current,Hg),!f.current)return;if(typeof w=="number"){r.go(w);return}let v=jh(w,JSON.parse(l),o,x.relative==="path");t==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:kn([e,v.pathname])),(x.replace?r.replace:r.push)(v,x.state,x)},[e,r,l,o,t])}P.createContext(null);function Qi(){let{matches:t}=P.useContext(cn),e=t[t.length-1];return e?e.params:{}}function go(t,{relative:e}={}){let{matches:r}=P.useContext(cn),{pathname:s}=un(),o=JSON.stringify(Th(r));return P.useMemo(()=>jh(t,JSON.parse(o),s,e==="path"),[t,o,s,e])}function Zy(t,e){return Gg(t,e)}function Gg(t,e,r,s,o){var C;ot(Ki(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=P.useContext(ln),{matches:f}=P.useContext(cn),g=f[f.length-1],w=g?g.params:{},x=g?g.pathname:"/",v=g?g.pathnameBase:"/",E=g&&g.route;{let T=E&&E.path||"";$g(x,!E||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${x}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let S=un(),I;if(e){let T=typeof e=="string"?Qs(e):e;ot(v==="/"||((C=T.pathname)==null?void 0:C.startsWith(v)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${T.pathname}" was given in the \`location\` prop.`),I=T}else I=S;let k=I.pathname||"/",j=k;if(v!=="/"){let T=v.replace(/^\//,"").split("/");j="/"+k.replace(/^\//,"").split("/").slice(T.length).join("/")}let M=Bg(t,{pathname:j});yr(E||M!=null,`No routes matched location "${I.pathname}${I.search}${I.hash}" `),yr(M==null||M[M.length-1].route.element!==void 0||M[M.length-1].route.Component!==void 0||M[M.length-1].route.lazy!==void 0,`Matched leaf route at location "${I.pathname}${I.search}${I.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=nv(M&&M.map(T=>Object.assign({},T,{params:Object.assign({},w,T.params),pathname:kn([v,l.encodeLocation?l.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?v:kn([v,l.encodeLocation?l.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),f,r,s,o);return e&&A?P.createElement(mo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...I},navigationType:"POP"}},A):A}function Jy(){let t=lv(),e=$y(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},f=null;return console.error("Error handled by React Router default ErrorBoundary:",t),f=P.createElement(P.Fragment,null,P.createElement("p",null," Hey developer "),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:l},"ErrorBoundary")," or"," ",P.createElement("code",{style:l},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),r?P.createElement("pre",{style:o},r):null,f)}var ev=P.createElement(Jy,null),tv=class extends P.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?P.createElement(cn.Provider,{value:this.props.routeContext},P.createElement(Rh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function rv({routeContext:t,match:e,children:r}){let s=P.useContext(qi);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement(cn.Provider,{value:t},r)}function nv(t,e=[],r=null,s=null,o=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let l=t,f=r==null?void 0:r.errors;if(f!=null){let v=l.findIndex(E=>E.route.id&&(f==null?void 0:f[E.route.id])!==void 0);ot(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(f).join(",")}`),l=l.slice(0,Math.min(l.length,v+1))}let g=!1,w=-1;if(r)for(let v=0;v<l.length;v++){let E=l[v];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(w=v),E.route.id){let{loaderData:S,errors:I}=r,k=E.route.loader&&!S.hasOwnProperty(E.route.id)&&(!I||I[E.route.id]===void 0);if(E.route.lazy||k){g=!0,w>=0?l=l.slice(0,w+1):l=[l[0]];break}}}let x=r&&s?(v,E)=>{var S,I;s(v,{location:r.location,params:((I=(S=r.matches)==null?void 0:S[0])==null?void 0:I.params)??{},errorInfo:E})}:void 0;return l.reduceRight((v,E,S)=>{let I,k=!1,j=null,M=null;r&&(I=f&&E.route.id?f[E.route.id]:void 0,j=E.route.errorElement||ev,g&&(w<0&&S===0?($g("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),k=!0,M=null):w===S&&(k=!0,M=E.route.hydrateFallbackElement||null)));let A=e.concat(l.slice(0,S+1)),C=()=>{let T;return I?T=j:k?T=M:E.route.Component?T=P.createElement(E.route.Component,null):E.route.element?T=E.route.element:T=v,P.createElement(rv,{match:E,routeContext:{outlet:v,matches:A,isDataRoute:r!=null},children:T})};return r&&(E.route.ErrorBoundary||E.route.errorElement||S===0)?P.createElement(tv,{location:r.location,revalidation:r.revalidation,component:j,error:I,children:C(),routeContext:{outlet:null,matches:A,isDataRoute:!0},onError:x}):C()},null)}function Oh(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sv(t){let e=P.useContext(qi);return ot(e,Oh(t)),e}function iv(t){let e=P.useContext(gc);return ot(e,Oh(t)),e}function av(t){let e=P.useContext(cn);return ot(e,Oh(t)),e}function kh(t){let e=av(t),r=e.matches[e.matches.length-1];return ot(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function ov(){return kh("useRouteId")}function lv(){var s;let t=P.useContext(Rh),e=iv("useRouteError"),r=kh("useRouteError");return t!==void 0?t:(s=e.errors)==null?void 0:s[r]}function cv(){let{router:t}=sv("useNavigate"),e=kh("useNavigate"),r=P.useRef(!1);return Wg(()=>{r.current=!0}),P.useCallback(async(o,l={})=>{yr(r.current,Hg),r.current&&(typeof o=="number"?t.navigate(o):await t.navigate(o,{fromRouteId:e,...l}))},[t,e])}var Of={};function $g(t,e,r){!e&&!Of[t]&&(Of[t]=!0,yr(!1,r))}P.memo(uv);function uv({routes:t,future:e,state:r,unstable_onError:s}){return Gg(t,void 0,r,s,e)}function Kr({to:t,replace:e,state:r,relative:s}){ot(Ki(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=P.useContext(ln);yr(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=P.useContext(cn),{pathname:f}=un(),g=wt(),w=jh(t,Th(l),f,s==="path"),x=JSON.stringify(w);return P.useEffect(()=>{g(JSON.parse(x),{replace:e,state:r,relative:s})},[g,x,s,e,r]),null}function vt(t){ot(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function dv({basename:t="/",children:e=null,location:r,navigationType:s="POP",navigator:o,static:l=!1}){ot(!Ki(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=t.replace(/^\/*/,"/"),g=P.useMemo(()=>({basename:f,navigator:o,static:l,future:{}}),[f,o,l]);typeof r=="string"&&(r=Qs(r));let{pathname:w="/",search:x="",hash:v="",state:E=null,key:S="default"}=r,I=P.useMemo(()=>{let k=Bn(w,f);return k==null?null:{location:{pathname:k,search:x,hash:v,state:E,key:S},navigationType:s}},[f,w,x,v,E,S,s]);return yr(I!=null,`<Router basename="${f}"> is not able to match the URL "${w}${x}${v}" because it does not start with the basename, so the <Router> won't render anything.`),I==null?null:P.createElement(ln.Provider,{value:g},P.createElement(mo.Provider,{children:e,value:I}))}function hv({children:t,location:e}){return Zy(pd(t),e)}function pd(t,e=[]){let r=[];return P.Children.forEach(t,(s,o)=>{if(!P.isValidElement(s))return;let l=[...e,o];if(s.type===P.Fragment){r.push.apply(r,pd(s.props.children,l));return}ot(s.type===vt,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ot(!s.props.index||!s.props.children,"An index route cannot have child routes.");let f={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(f.children=pd(s.props.children,l)),r.push(f)}),r}var xl="get",pl="application/x-www-form-urlencoded";function xc(t){return t!=null&&typeof t.tagName=="string"}function fv(t){return xc(t)&&t.tagName.toLowerCase()==="button"}function mv(t){return xc(t)&&t.tagName.toLowerCase()==="form"}function gv(t){return xc(t)&&t.tagName.toLowerCase()==="input"}function xv(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function pv(t,e){return t.button===0&&(!e||e==="_self")&&!xv(t)}function wd(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let s=t[r];return e.concat(Array.isArray(s)?s.map(o=>[r,o]):[[r,s]])},[]))}function wv(t,e){let r=wd(t);return e&&e.forEach((s,o)=>{r.has(o)||e.getAll(o).forEach(l=>{r.append(o,l)})}),r}var Yo=null;function yv(){if(Yo===null)try{new FormData(document.createElement("form"),0),Yo=!1}catch{Yo=!0}return Yo}var vv=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function fu(t){return t!=null&&!vv.has(t)?(yr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${pl}"`),null):t}function bv(t,e){let r,s,o,l,f;if(mv(t)){let g=t.getAttribute("action");s=g?Bn(g,e):null,r=t.getAttribute("method")||xl,o=fu(t.getAttribute("enctype"))||pl,l=new FormData(t)}else if(fv(t)||gv(t)&&(t.type==="submit"||t.type==="image")){let g=t.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let w=t.getAttribute("formaction")||g.getAttribute("action");if(s=w?Bn(w,e):null,r=t.getAttribute("formmethod")||g.getAttribute("method")||xl,o=fu(t.getAttribute("formenctype"))||fu(g.getAttribute("enctype"))||pl,l=new FormData(g,t),!yv()){let{name:x,type:v,value:E}=t;if(v==="image"){let S=x?`${x}.`:"";l.append(`${S}x`,"0"),l.append(`${S}y`,"0")}else x&&l.append(x,E)}}else{if(xc(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=xl,s=null,o=pl,f=t}return l&&o==="text/plain"&&(f=l,l=void 0),{action:s,method:r.toLowerCase(),encType:o,formData:l,body:f}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Mh(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ev(t,e,r){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s.pathname==="/"?s.pathname=`_root.${r}`:e&&Bn(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${r}`,s}async function Cv(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Nv(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function _v(t,e,r){let s=await Promise.all(t.map(async o=>{let l=e.routes[o.route.id];if(l){let f=await Cv(l,r);return f.links?f.links():[]}return[]}));return Tv(s.flat(1).filter(Nv).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function kf(t,e,r,s,o,l){let f=(w,x)=>r[x]?w.route.id!==r[x].route.id:!0,g=(w,x)=>{var v;return r[x].pathname!==w.pathname||((v=r[x].route.path)==null?void 0:v.endsWith("*"))&&r[x].params["*"]!==w.params["*"]};return l==="assets"?e.filter((w,x)=>f(w,x)||g(w,x)):l==="data"?e.filter((w,x)=>{var E;let v=s.routes[w.route.id];if(!v||!v.hasLoader)return!1;if(f(w,x)||g(w,x))return!0;if(w.route.shouldRevalidate){let S=w.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((E=r[0])==null?void 0:E.params)||{},nextUrl:new URL(t,window.origin),nextParams:w.params,defaultShouldRevalidate:!0});if(typeof S=="boolean")return S}return!0}):[]}function Sv(t,e,{includeHydrateFallback:r}={}){return Av(t.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),r&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function Av(t){return[...new Set(t)]}function Iv(t){let e={},r=Object.keys(t).sort();for(let s of r)e[s]=t[s];return e}function Tv(t,e){let r=new Set;return new Set(e),t.reduce((s,o)=>{let l=JSON.stringify(Iv(o));return r.has(l)||(r.add(l),s.push({key:l,link:o})),s},[])}function Xg(){let t=P.useContext(qi);return Mh(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function jv(){let t=P.useContext(gc);return Mh(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Dh=P.createContext(void 0);Dh.displayName="FrameworkContext";function Yg(){let t=P.useContext(Dh);return Mh(t,"You must render this element inside a <HydratedRouter> element"),t}function Rv(t,e){let r=P.useContext(Dh),[s,o]=P.useState(!1),[l,f]=P.useState(!1),{onFocus:g,onBlur:w,onMouseEnter:x,onMouseLeave:v,onTouchStart:E}=e,S=P.useRef(null);P.useEffect(()=>{if(t==="render"&&f(!0),t==="viewport"){let j=A=>{A.forEach(C=>{f(C.isIntersecting)})},M=new IntersectionObserver(j,{threshold:.5});return S.current&&M.observe(S.current),()=>{M.disconnect()}}},[t]),P.useEffect(()=>{if(s){let j=setTimeout(()=>{f(!0)},100);return()=>{clearTimeout(j)}}},[s]);let I=()=>{o(!0)},k=()=>{o(!1),f(!1)};return r?t!=="intent"?[l,S,{}]:[l,S,{onFocus:ba(g,I),onBlur:ba(w,k),onMouseEnter:ba(x,I),onMouseLeave:ba(v,k),onTouchStart:ba(E,I)}]:[!1,S,{}]}function ba(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function Ov({page:t,...e}){let{router:r}=Xg(),s=P.useMemo(()=>Bg(r.routes,t,r.basename),[r.routes,t,r.basename]);return s?P.createElement(Mv,{page:t,matches:s,...e}):null}function kv(t){let{manifest:e,routeModules:r}=Yg(),[s,o]=P.useState([]);return P.useEffect(()=>{let l=!1;return _v(t,e,r).then(f=>{l||o(f)}),()=>{l=!0}},[t,e,r]),s}function Mv({page:t,matches:e,...r}){let s=un(),{manifest:o,routeModules:l}=Yg(),{basename:f}=Xg(),{loaderData:g,matches:w}=jv(),x=P.useMemo(()=>kf(t,e,w,o,s,"data"),[t,e,w,o,s]),v=P.useMemo(()=>kf(t,e,w,o,s,"assets"),[t,e,w,o,s]),E=P.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let k=new Set,j=!1;if(e.forEach(A=>{var T;let C=o.routes[A.route.id];!C||!C.hasLoader||(!x.some(O=>O.route.id===A.route.id)&&A.route.id in g&&((T=l[A.route.id])!=null&&T.shouldRevalidate)||C.hasClientLoader?j=!0:k.add(A.route.id))}),k.size===0)return[];let M=Ev(t,f,"data");return j&&k.size>0&&M.searchParams.set("_routes",e.filter(A=>k.has(A.route.id)).map(A=>A.route.id).join(",")),[M.pathname+M.search]},[f,g,s,o,x,e,t,l]),S=P.useMemo(()=>Sv(v,o),[v,o]),I=kv(v);return P.createElement(P.Fragment,null,E.map(k=>P.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...r})),S.map(k=>P.createElement("link",{key:k,rel:"modulepreload",href:k,...r})),I.map(({key:k,link:j})=>P.createElement("link",{key:k,nonce:r.nonce,...j})))}function Dv(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var qg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{qg&&(window.__reactRouterVersion="7.9.6")}catch{}function Lv({basename:t,children:e,window:r}){let s=P.useRef();s.current==null&&(s.current=Ey({window:r,v5Compat:!0}));let o=s.current,[l,f]=P.useState({action:o.action,location:o.location}),g=P.useCallback(w=>{P.startTransition(()=>f(w))},[f]);return P.useLayoutEffect(()=>o.listen(g),[o,g]),P.createElement(dv,{basename:t,children:e,location:l.location,navigationType:l.action,navigator:o})}var Kg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qt=P.forwardRef(function({onClick:e,discover:r="render",prefetch:s="none",relative:o,reloadDocument:l,replace:f,state:g,target:w,to:x,preventScrollReset:v,viewTransition:E,...S},I){let{basename:k}=P.useContext(ln),j=typeof x=="string"&&Kg.test(x),M,A=!1;if(typeof x=="string"&&j&&(M=x,qg))try{let G=new URL(window.location.href),te=x.startsWith("//")?new URL(G.protocol+x):new URL(x),be=Bn(te.pathname,k);te.origin===G.origin&&be!=null?x=be+te.search+te.hash:A=!0}catch{yr(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=Ky(x,{relative:o}),[T,O,V]=Rv(s,S),z=Uv(x,{replace:f,state:g,target:w,preventScrollReset:v,relative:o,viewTransition:E});function U(G){e&&e(G),G.defaultPrevented||z(G)}let $=P.createElement("a",{...S,...V,href:M||C,onClick:A||l?e:U,ref:Dv(I,O),target:w,"data-discover":!j&&r==="render"?"true":void 0});return T&&!j?P.createElement(P.Fragment,null,$,P.createElement(Ov,{page:C})):$});qt.displayName="Link";var Pv=P.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:s="",end:o=!1,style:l,to:f,viewTransition:g,children:w,...x},v){let E=go(f,{relative:x.relative}),S=un(),I=P.useContext(gc),{navigator:k,basename:j}=P.useContext(ln),M=I!=null&&Gv(E)&&g===!0,A=k.encodeLocation?k.encodeLocation(E).pathname:E.pathname,C=S.pathname,T=I&&I.navigation&&I.navigation.location?I.navigation.location.pathname:null;r||(C=C.toLowerCase(),T=T?T.toLowerCase():null,A=A.toLowerCase()),T&&j&&(T=Bn(T,j)||T);const O=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let V=C===A||!o&&C.startsWith(A)&&C.charAt(O)==="/",z=T!=null&&(T===A||!o&&T.startsWith(A)&&T.charAt(A.length)==="/"),U={isActive:V,isPending:z,isTransitioning:M},$=V?e:void 0,G;typeof s=="function"?G=s(U):G=[s,V?"active":null,z?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let te=typeof l=="function"?l(U):l;return P.createElement(qt,{...x,"aria-current":$,className:G,ref:v,style:te,to:f,viewTransition:g},typeof w=="function"?w(U):w)});Pv.displayName="NavLink";var Bv=P.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:s,replace:o,state:l,method:f=xl,action:g,onSubmit:w,relative:x,preventScrollReset:v,viewTransition:E,...S},I)=>{let k=Hv(),j=Wv(g,{relative:x}),M=f.toLowerCase()==="get"?"get":"post",A=typeof g=="string"&&Kg.test(g),C=T=>{if(w&&w(T),T.defaultPrevented)return;T.preventDefault();let O=T.nativeEvent.submitter,V=(O==null?void 0:O.getAttribute("formmethod"))||f;k(O||T.currentTarget,{fetcherKey:e,method:V,navigate:r,replace:o,state:l,relative:x,preventScrollReset:v,viewTransition:E})};return P.createElement("form",{ref:I,method:M,action:j,onSubmit:s?w:C,...S,"data-discover":!A&&t==="render"?"true":void 0})});Bv.displayName="Form";function Fv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Qg(t){let e=P.useContext(qi);return ot(e,Fv(t)),e}function Uv(t,{target:e,replace:r,state:s,preventScrollReset:o,relative:l,viewTransition:f}={}){let g=wt(),w=un(),x=go(t,{relative:l});return P.useCallback(v=>{if(pv(v,e)){v.preventDefault();let E=r!==void 0?r:ro(w)===ro(x);g(t,{replace:E,state:s,preventScrollReset:o,relative:l,viewTransition:f})}},[w,g,x,r,s,e,t,o,l,f])}function Zg(t){yr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=P.useRef(wd(t)),r=P.useRef(!1),s=un(),o=P.useMemo(()=>wv(s.search,r.current?null:e.current),[s.search]),l=wt(),f=P.useCallback((g,w)=>{const x=wd(typeof g=="function"?g(new URLSearchParams(o)):g);r.current=!0,l("?"+x,w)},[l,o]);return[o,f]}var zv=0,Vv=()=>`__${String(++zv)}__`;function Hv(){let{router:t}=Qg("useSubmit"),{basename:e}=P.useContext(ln),r=ov();return P.useCallback(async(s,o={})=>{let{action:l,method:f,encType:g,formData:w,body:x}=bv(s,e);if(o.navigate===!1){let v=o.fetcherKey||Vv();await t.fetch(v,r,o.action||l,{preventScrollReset:o.preventScrollReset,formData:w,body:x,formMethod:o.method||f,formEncType:o.encType||g,flushSync:o.flushSync})}else await t.navigate(o.action||l,{preventScrollReset:o.preventScrollReset,formData:w,body:x,formMethod:o.method||f,formEncType:o.encType||g,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[t,e,r])}function Wv(t,{relative:e}={}){let{basename:r}=P.useContext(ln),s=P.useContext(cn);ot(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),l={...go(t||".",{relative:e})},f=un();if(t==null){l.search=f.search;let g=new URLSearchParams(l.search),w=g.getAll("index");if(w.some(v=>v==="")){g.delete("index"),w.filter(E=>E).forEach(E=>g.append("index",E));let v=g.toString();l.search=v?`?${v}`:""}}return(!t||t===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:kn([r,l.pathname])),ro(l)}function Gv(t,{relative:e}={}){let r=P.useContext(Vg);ot(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Qg("useViewTransitionState"),o=go(t,{relative:e});if(!r.isTransitioning)return!1;let l=Bn(r.currentLocation.pathname,s)||r.currentLocation.pathname,f=Bn(r.nextLocation.pathname,s)||r.nextLocation.pathname;return Vl(o.pathname,f)!=null||Vl(o.pathname,l)!=null}var yd=function(t,e){return yd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(r[o]=s[o])},yd(t,e)};function Jg(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");yd(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Hl=function(){return Hl=Object.assign||function(e){for(var r,s=1,o=arguments.length;s<o;s++){r=arguments[s];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Hl.apply(this,arguments)};function Zi(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(t);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(t,s[o])&&(r[s[o]]=t[s[o]]);return r}function ex(t,e,r,s){var o=arguments.length,l=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(t,e,r,s);else for(var g=t.length-1;g>=0;g--)(f=t[g])&&(l=(o<3?f(l):o>3?f(e,r,l):f(e,r))||l);return o>3&&l&&Object.defineProperty(e,r,l),l}function tx(t,e){return function(r,s){e(r,s,t)}}function rx(t,e,r,s,o,l){function f(A){if(A!==void 0&&typeof A!="function")throw new TypeError("Function expected");return A}for(var g=s.kind,w=g==="getter"?"get":g==="setter"?"set":"value",x=!e&&t?s.static?t:t.prototype:null,v=e||(x?Object.getOwnPropertyDescriptor(x,s.name):{}),E,S=!1,I=r.length-1;I>=0;I--){var k={};for(var j in s)k[j]=j==="access"?{}:s[j];for(var j in s.access)k.access[j]=s.access[j];k.addInitializer=function(A){if(S)throw new TypeError("Cannot add initializers after decoration has completed");l.push(f(A||null))};var M=(0,r[I])(g==="accessor"?{get:v.get,set:v.set}:v[w],k);if(g==="accessor"){if(M===void 0)continue;if(M===null||typeof M!="object")throw new TypeError("Object expected");(E=f(M.get))&&(v.get=E),(E=f(M.set))&&(v.set=E),(E=f(M.init))&&o.unshift(E)}else(E=f(M))&&(g==="field"?o.unshift(E):v[w]=E)}x&&Object.defineProperty(x,s.name,v),S=!0}function nx(t,e,r){for(var s=arguments.length>2,o=0;o<e.length;o++)r=s?e[o].call(t,r):e[o].call(t);return s?r:void 0}function sx(t){return typeof t=="symbol"?t:"".concat(t)}function ix(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function ax(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function he(t,e,r,s){function o(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function g(v){try{x(s.next(v))}catch(E){f(E)}}function w(v){try{x(s.throw(v))}catch(E){f(E)}}function x(v){v.done?l(v.value):o(v.value).then(g,w)}x((s=s.apply(t,e||[])).next())})}function ox(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,o,l,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=g(0),f.throw=g(1),f.return=g(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(x){return function(v){return w([x,v])}}function w(x){if(s)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(r=0)),r;)try{if(s=1,o&&(l=x[0]&2?o.return:x[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,x[1])).done)return l;switch(o=0,l&&(x=[x[0]&2,l.value]),x[0]){case 0:case 1:l=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,o=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!l||x[1]>l[0]&&x[1]<l[3])){r.label=x[1];break}if(x[0]===6&&r.label<l[1]){r.label=l[1],l=x;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(x);break}l[2]&&r.ops.pop(),r.trys.pop();continue}x=e.call(t,r)}catch(v){x=[6,v],o=0}finally{s=l=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}}var pc=Object.create?function(t,e,r,s){s===void 0&&(s=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,s,o)}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]};function lx(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&pc(e,t,r)}function Wl(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],s=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Lh(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var s=r.call(t),o,l=[],f;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)l.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(f)throw f.error}}return l}function cx(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Lh(arguments[e]));return t}function ux(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var s=Array(t),o=0,e=0;e<r;e++)for(var l=arguments[e],f=0,g=l.length;f<g;f++,o++)s[o]=l[f];return s}function dx(t,e,r){if(r||arguments.length===2)for(var s=0,o=e.length,l;s<o;s++)(l||!(s in e))&&(l||(l=Array.prototype.slice.call(e,0,s)),l[s]=e[s]);return t.concat(l||Array.prototype.slice.call(e))}function Wi(t){return this instanceof Wi?(this.v=t,this):new Wi(t)}function hx(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(t,e||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",f),o[Symbol.asyncIterator]=function(){return this},o;function f(I){return function(k){return Promise.resolve(k).then(I,E)}}function g(I,k){s[I]&&(o[I]=function(j){return new Promise(function(M,A){l.push([I,j,M,A])>1||w(I,j)})},k&&(o[I]=k(o[I])))}function w(I,k){try{x(s[I](k))}catch(j){S(l[0][3],j)}}function x(I){I.value instanceof Wi?Promise.resolve(I.value.v).then(v,E):S(l[0][2],I)}function v(I){w("next",I)}function E(I){w("throw",I)}function S(I,k){I(k),l.shift(),l.length&&w(l[0][0],l[0][1])}}function fx(t){var e,r;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,l){e[o]=t[o]?function(f){return(r=!r)?{value:Wi(t[o](f)),done:!1}:l?l(f):f}:l}}function mx(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Wl=="function"?Wl(t):t[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(l){r[l]=t[l]&&function(f){return new Promise(function(g,w){f=t[l](f),o(g,w,f.done,f.value)})}}function o(l,f,g,w){Promise.resolve(w).then(function(x){l({value:x,done:g})},f)}}function gx(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var $v=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},vd=function(t){return vd=Object.getOwnPropertyNames||function(e){var r=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[r.length]=s);return r},vd(t)};function xx(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=vd(t),s=0;s<r.length;s++)r[s]!=="default"&&pc(e,t,r[s]);return $v(e,t),e}function px(t){return t&&t.__esModule?t:{default:t}}function wx(t,e,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(t):s?s.value:e.get(t)}function yx(t,e,r,s,o){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?o.call(t,r):o?o.value=r:e.set(t,r),r}function vx(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function bx(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=e[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose],r&&(o=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");o&&(s=function(){try{o.call(this)}catch(l){return Promise.reject(l)}}),t.stack.push({value:e,dispose:s,async:r})}else r&&t.stack.push({async:!0});return e}var Xv=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var s=new Error(r);return s.name="SuppressedError",s.error=t,s.suppressed=e,s};function Ex(t){function e(l){t.error=t.hasError?new Xv(l,t.error,"An error was suppressed during disposal."):l,t.hasError=!0}var r,s=0;function o(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(o);if(r.dispose){var l=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(l).then(o,function(f){return e(f),o()})}else s|=1}catch(f){e(f)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return o()}function Cx(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,s,o,l,f){return s?e?".jsx":".js":o&&(!l||!f)?r:o+l+"."+f.toLowerCase()+"js"}):t}const Yv={__extends:Jg,__assign:Hl,__rest:Zi,__decorate:ex,__param:tx,__esDecorate:rx,__runInitializers:nx,__propKey:sx,__setFunctionName:ix,__metadata:ax,__awaiter:he,__generator:ox,__createBinding:pc,__exportStar:lx,__values:Wl,__read:Lh,__spread:cx,__spreadArrays:ux,__spreadArray:dx,__await:Wi,__asyncGenerator:hx,__asyncDelegator:fx,__asyncValues:mx,__makeTemplateObject:gx,__importStar:xx,__importDefault:px,__classPrivateFieldGet:wx,__classPrivateFieldSet:yx,__classPrivateFieldIn:vx,__addDisposableResource:bx,__disposeResources:Ex,__rewriteRelativeImportExtension:Cx},qv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:bx,get __assign(){return Hl},__asyncDelegator:fx,__asyncGenerator:hx,__asyncValues:mx,__await:Wi,__awaiter:he,__classPrivateFieldGet:wx,__classPrivateFieldIn:vx,__classPrivateFieldSet:yx,__createBinding:pc,__decorate:ex,__disposeResources:Ex,__esDecorate:rx,__exportStar:lx,__extends:Jg,__generator:ox,__importDefault:px,__importStar:xx,__makeTemplateObject:gx,__metadata:ax,__param:tx,__propKey:sx,__read:Lh,__rest:Zi,__rewriteRelativeImportExtension:Cx,__runInitializers:nx,__setFunctionName:ix,__spread:cx,__spreadArray:dx,__spreadArrays:ux,__values:Wl,default:Yv},Symbol.toStringTag,{value:"Module"})),Kv=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Ph extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class Qv extends Ph{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Mf extends Ph{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Df extends Ph{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var bd;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(bd||(bd={}));class Zv{constructor(e,{headers:r={},customFetch:s,region:o=bd.Any}={}){this.url=e,this.headers=r,this.region=o,this.fetch=Kv(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return he(this,arguments,void 0,function*(r,s={}){var o;let l,f;try{const{headers:g,method:w,body:x,signal:v,timeout:E}=s;let S={},{region:I}=s;I||(I=this.region);const k=new URL(`${this.url}/${r}`);I&&I!=="any"&&(S["x-region"]=I,k.searchParams.set("forceFunctionRegion",I));let j;x&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&x instanceof Blob||x instanceof ArrayBuffer?(S["Content-Type"]="application/octet-stream",j=x):typeof x=="string"?(S["Content-Type"]="text/plain",j=x):typeof FormData<"u"&&x instanceof FormData?j=x:(S["Content-Type"]="application/json",j=JSON.stringify(x)):j=x;let M=v;E&&(f=new AbortController,l=setTimeout(()=>f.abort(),E),v?(M=f.signal,v.addEventListener("abort",()=>f.abort())):M=f.signal);const A=yield this.fetch(k.toString(),{method:w||"POST",headers:Object.assign(Object.assign(Object.assign({},S),this.headers),g),body:j,signal:M}).catch(V=>{throw new Qv(V)}),C=A.headers.get("x-relay-error");if(C&&C==="true")throw new Mf(A);if(!A.ok)throw new Df(A);let T=((o=A.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),O;return T==="application/json"?O=yield A.json():T==="application/octet-stream"||T==="application/pdf"?O=yield A.blob():T==="text/event-stream"?O=A:T==="multipart/form-data"?O=yield A.formData():O=yield A.text(),{data:O,error:null,response:A}}catch(g){return{data:null,error:g,response:g instanceof Df||g instanceof Mf?g.context:void 0}}finally{l&&clearTimeout(l)}})}}var tr={};const Ji=qp(qv);var qo={},Ko={},Qo={},Zo={},Jo={},el={},Lf;function Nx(){if(Lf)return el;Lf=1,Object.defineProperty(el,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return el.default=t,el}var Pf;function _x(){if(Pf)return Jo;Pf=1,Object.defineProperty(Jo,"__esModule",{value:!0});const e=Ji.__importDefault(Nx());class r{constructor(o){var l,f;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(l=o.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=o.signal,this.isMaybeSingle=(f=o.isMaybeSingle)!==null&&f!==void 0?f:!1,o.fetch?this.fetch=o.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,l){return this.headers=new Headers(this.headers),this.headers.set(o,l),this}then(o,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let g=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async w=>{var x,v,E,S;let I=null,k=null,j=null,M=w.status,A=w.statusText;if(w.ok){if(this.method!=="HEAD"){const V=await w.text();V===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((x=this.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?k=V:k=JSON.parse(V))}const T=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),O=(E=w.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");T&&O&&O.length>1&&(j=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(k)&&(k.length>1?(I={code:"PGRST116",details:`Results contain ${k.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},k=null,j=null,M=406,A="Not Acceptable"):k.length===1?k=k[0]:k=null)}else{const T=await w.text();try{I=JSON.parse(T),Array.isArray(I)&&w.status===404&&(k=[],I=null,M=200,A="OK")}catch{w.status===404&&T===""?(M=204,A="No Content"):I={message:T}}if(I&&this.isMaybeSingle&&(!((S=I==null?void 0:I.details)===null||S===void 0)&&S.includes("0 rows"))&&(I=null,M=200,A="OK"),I&&this.shouldThrowOnError)throw new e.default(I)}return{error:I,data:k,count:j,status:M,statusText:A}});return this.shouldThrowOnError||(g=g.catch(w=>{var x,v,E,S,I,k;let j="";const M=w==null?void 0:w.cause;if(M){const A=(x=M==null?void 0:M.message)!==null&&x!==void 0?x:"",C=(v=M==null?void 0:M.code)!==null&&v!==void 0?v:"";j=`${(E=w==null?void 0:w.name)!==null&&E!==void 0?E:"FetchError"}: ${w==null?void 0:w.message}`,j+=`

Caused by: ${(S=M==null?void 0:M.name)!==null&&S!==void 0?S:"Error"}: ${A}`,C&&(j+=` (${C})`),M!=null&&M.stack&&(j+=`
${M.stack}`)}else j=(I=w==null?void 0:w.stack)!==null&&I!==void 0?I:"";return{error:{message:`${(k=w==null?void 0:w.name)!==null&&k!==void 0?k:"FetchError"}: ${w==null?void 0:w.message}`,details:j,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),g.then(o,l)}returns(){return this}overrideTypes(){return this}}return Jo.default=r,Jo}var Bf;function Sx(){if(Bf)return Zo;Bf=1,Object.defineProperty(Zo,"__esModule",{value:!0});const e=Ji.__importDefault(_x());class r extends e.default{select(o){let l=!1;const f=(o??"*").split("").map(g=>/\s/.test(g)&&!l?"":(g==='"'&&(l=!l),g)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:l=!0,nullsFirst:f,foreignTable:g,referencedTable:w=g}={}){const x=w?`${w}.order`:"order",v=this.url.searchParams.get(x);return this.url.searchParams.set(x,`${v?`${v},`:""}${o}.${l?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:l,referencedTable:f=l}={}){const g=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(g,`${o}`),this}range(o,l,{foreignTable:f,referencedTable:g=f}={}){const w=typeof g>"u"?"offset":`${g}.offset`,x=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(w,`${o}`),this.url.searchParams.set(x,`${l-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:l=!1,settings:f=!1,buffers:g=!1,wal:w=!1,format:x="text"}={}){var v;const E=[o?"analyze":null,l?"verbose":null,f?"settings":null,g?"buffers":null,w?"wal":null].filter(Boolean).join("|"),S=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${x}; for="${S}"; options=${E};`),x==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return Zo.default=r,Zo}var Ff;function Bh(){if(Ff)return Qo;Ff=1,Object.defineProperty(Qo,"__esModule",{value:!0});const e=Ji.__importDefault(Sx()),r=new RegExp("[,()]");class s extends e.default{eq(l,f){return this.url.searchParams.append(l,`eq.${f}`),this}neq(l,f){return this.url.searchParams.append(l,`neq.${f}`),this}gt(l,f){return this.url.searchParams.append(l,`gt.${f}`),this}gte(l,f){return this.url.searchParams.append(l,`gte.${f}`),this}lt(l,f){return this.url.searchParams.append(l,`lt.${f}`),this}lte(l,f){return this.url.searchParams.append(l,`lte.${f}`),this}like(l,f){return this.url.searchParams.append(l,`like.${f}`),this}likeAllOf(l,f){return this.url.searchParams.append(l,`like(all).{${f.join(",")}}`),this}likeAnyOf(l,f){return this.url.searchParams.append(l,`like(any).{${f.join(",")}}`),this}ilike(l,f){return this.url.searchParams.append(l,`ilike.${f}`),this}ilikeAllOf(l,f){return this.url.searchParams.append(l,`ilike(all).{${f.join(",")}}`),this}ilikeAnyOf(l,f){return this.url.searchParams.append(l,`ilike(any).{${f.join(",")}}`),this}regexMatch(l,f){return this.url.searchParams.append(l,`match.${f}`),this}regexIMatch(l,f){return this.url.searchParams.append(l,`imatch.${f}`),this}is(l,f){return this.url.searchParams.append(l,`is.${f}`),this}isDistinct(l,f){return this.url.searchParams.append(l,`isdistinct.${f}`),this}in(l,f){const g=Array.from(new Set(f)).map(w=>typeof w=="string"&&r.test(w)?`"${w}"`:`${w}`).join(",");return this.url.searchParams.append(l,`in.(${g})`),this}contains(l,f){return typeof f=="string"?this.url.searchParams.append(l,`cs.${f}`):Array.isArray(f)?this.url.searchParams.append(l,`cs.{${f.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(f)}`),this}containedBy(l,f){return typeof f=="string"?this.url.searchParams.append(l,`cd.${f}`):Array.isArray(f)?this.url.searchParams.append(l,`cd.{${f.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(f)}`),this}rangeGt(l,f){return this.url.searchParams.append(l,`sr.${f}`),this}rangeGte(l,f){return this.url.searchParams.append(l,`nxl.${f}`),this}rangeLt(l,f){return this.url.searchParams.append(l,`sl.${f}`),this}rangeLte(l,f){return this.url.searchParams.append(l,`nxr.${f}`),this}rangeAdjacent(l,f){return this.url.searchParams.append(l,`adj.${f}`),this}overlaps(l,f){return typeof f=="string"?this.url.searchParams.append(l,`ov.${f}`):this.url.searchParams.append(l,`ov.{${f.join(",")}}`),this}textSearch(l,f,{config:g,type:w}={}){let x="";w==="plain"?x="pl":w==="phrase"?x="ph":w==="websearch"&&(x="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(l,`${x}fts${v}.${f}`),this}match(l){return Object.entries(l).forEach(([f,g])=>{this.url.searchParams.append(f,`eq.${g}`)}),this}not(l,f,g){return this.url.searchParams.append(l,`not.${f}.${g}`),this}or(l,{foreignTable:f,referencedTable:g=f}={}){const w=g?`${g}.or`:"or";return this.url.searchParams.append(w,`(${l})`),this}filter(l,f,g){return this.url.searchParams.append(l,`${f}.${g}`),this}}return Qo.default=s,Qo}var Uf;function Ax(){if(Uf)return Ko;Uf=1,Object.defineProperty(Ko,"__esModule",{value:!0});const e=Ji.__importDefault(Bh());class r{constructor(o,{headers:l={},schema:f,fetch:g}){this.url=o,this.headers=new Headers(l),this.schema=f,this.fetch=g}select(o,l){const{head:f=!1,count:g}=l??{},w=f?"HEAD":"GET";let x=!1;const v=(o??"*").split("").map(E=>/\s/.test(E)&&!x?"":(E==='"'&&(x=!x),E)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new e.default({method:w,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:l,defaultToNull:f=!0}={}){var g;const w="POST";if(l&&this.headers.append("Prefer",`count=${l}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const x=o.reduce((v,E)=>v.concat(Object.keys(E)),[]);if(x.length>0){const v=[...new Set(x)].map(E=>`"${E}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:w,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(o,{onConflict:l,ignoreDuplicates:f=!1,count:g,defaultToNull:w=!0}={}){var x;const v="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),g&&this.headers.append("Prefer",`count=${g}`),w||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const E=o.reduce((S,I)=>S.concat(Object.keys(I)),[]);if(E.length>0){const S=[...new Set(E)].map(I=>`"${I}"`);this.url.searchParams.set("columns",S.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(x=this.fetch)!==null&&x!==void 0?x:fetch})}update(o,{count:l}={}){var f;const g="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:o}={}){var l;const f="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return Ko.default=r,Ko}var zf;function Jv(){if(zf)return qo;zf=1,Object.defineProperty(qo,"__esModule",{value:!0});const t=Ji,e=t.__importDefault(Ax()),r=t.__importDefault(Bh());class s{constructor(l,{headers:f={},schema:g,fetch:w}={}){this.url=l,this.headers=new Headers(f),this.schemaName=g,this.fetch=w}from(l){if(!l||typeof l!="string"||l.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const f=new URL(`${this.url}/${l}`);return new e.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new s(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,f={},{head:g=!1,get:w=!1,count:x}={}){var v;let E;const S=new URL(`${this.url}/rpc/${l}`);let I;g||w?(E=g?"HEAD":"GET",Object.entries(f).filter(([j,M])=>M!==void 0).map(([j,M])=>[j,Array.isArray(M)?`{${M.join(",")}}`:`${M}`]).forEach(([j,M])=>{S.searchParams.append(j,M)})):(E="POST",I=f);const k=new Headers(this.headers);return x&&k.set("Prefer",`count=${x}`),new r.default({method:E,url:S,headers:k,schema:this.schemaName,body:I,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return qo.default=s,qo}Object.defineProperty(tr,"__esModule",{value:!0});var Ix=tr.PostgrestError=Bx=tr.PostgrestBuilder=Lx=tr.PostgrestTransformBuilder=Mx=tr.PostgrestFilterBuilder=Ox=tr.PostgrestQueryBuilder=jx=tr.PostgrestClient=void 0;const ea=Ji,Tx=ea.__importDefault(Jv());var jx=tr.PostgrestClient=Tx.default;const Rx=ea.__importDefault(Ax());var Ox=tr.PostgrestQueryBuilder=Rx.default;const kx=ea.__importDefault(Bh());var Mx=tr.PostgrestFilterBuilder=kx.default;const Dx=ea.__importDefault(Sx());var Lx=tr.PostgrestTransformBuilder=Dx.default;const Px=ea.__importDefault(_x());var Bx=tr.PostgrestBuilder=Px.default;const Fx=ea.__importDefault(Nx());Ix=tr.PostgrestError=Fx.default;var Ux=tr.default={PostgrestClient:Tx.default,PostgrestQueryBuilder:Rx.default,PostgrestFilterBuilder:kx.default,PostgrestTransformBuilder:Dx.default,PostgrestBuilder:Px.default,PostgrestError:Fx.default};const eb=N1({__proto__:null,get PostgrestBuilder(){return Bx},get PostgrestClient(){return jx},get PostgrestError(){return Ix},get PostgrestFilterBuilder(){return Mx},get PostgrestQueryBuilder(){return Ox},get PostgrestTransformBuilder(){return Lx},default:Ux},[tr]),{PostgrestClient:tb,PostgrestQueryBuilder:WC,PostgrestFilterBuilder:GC,PostgrestTransformBuilder:$C,PostgrestBuilder:XC,PostgrestError:YC}=Ux||eb;class rb{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,o=parseInt(s.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const nb="2.84.0",sb=`realtime-js/${nb}`,zx="1.0.0",ib="2.0.0",Vf=zx,Ed=1e4,ab=1e3,ob=100;var Ms;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ms||(Ms={}));var It;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(It||(It={}));var tn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(tn||(tn={}));var Cd;(function(t){t.websocket="websocket"})(Cd||(Cd={}));var Ds;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ds||(Ds={}));class lb{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast"}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,s,o,l;const f=e.topic,g=(r=e.ref)!==null&&r!==void 0?r:"",w=(s=e.join_ref)!==null&&s!==void 0?s:"",x=e.payload.event,v=(l=(o=e.payload)===null||o===void 0?void 0:o.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),E=this.USER_BROADCAST_PUSH_META_LENGTH+w.length+g.length+f.length+x.length,S=new ArrayBuffer(this.HEADER_LENGTH+E);let I=new DataView(S),k=0;I.setUint8(k++,this.KINDS.userBroadcastPush),I.setUint8(k++,w.length),I.setUint8(k++,g.length),I.setUint8(k++,f.length),I.setUint8(k++,x.length),I.setUint8(k++,this.BINARY_ENCODING),Array.from(w,M=>I.setUint8(k++,M.charCodeAt(0))),Array.from(g,M=>I.setUint8(k++,M.charCodeAt(0))),Array.from(f,M=>I.setUint8(k++,M.charCodeAt(0))),Array.from(x,M=>I.setUint8(k++,M.charCodeAt(0)));var j=new Uint8Array(S.byteLength+v.byteLength);return j.set(new Uint8Array(S),0),j.set(new Uint8Array(v),S.byteLength),j.buffer}_encodeJsonUserBroadcastPush(e){var r,s,o,l;const f=e.topic,g=(r=e.ref)!==null&&r!==void 0?r:"",w=(s=e.join_ref)!==null&&s!==void 0?s:"",x=e.payload.event,v=(l=(o=e.payload)===null||o===void 0?void 0:o.payload)!==null&&l!==void 0?l:{},S=new TextEncoder().encode(JSON.stringify(v)).buffer,I=this.USER_BROADCAST_PUSH_META_LENGTH+w.length+g.length+f.length+x.length,k=new ArrayBuffer(this.HEADER_LENGTH+I);let j=new DataView(k),M=0;j.setUint8(M++,this.KINDS.userBroadcastPush),j.setUint8(M++,w.length),j.setUint8(M++,g.length),j.setUint8(M++,f.length),j.setUint8(M++,x.length),j.setUint8(M++,this.JSON_ENCODING),Array.from(w,C=>j.setUint8(M++,C.charCodeAt(0))),Array.from(g,C=>j.setUint8(M++,C.charCodeAt(0))),Array.from(f,C=>j.setUint8(M++,C.charCodeAt(0))),Array.from(x,C=>j.setUint8(M++,C.charCodeAt(0)));var A=new Uint8Array(k.byteLength+S.byteLength);return A.set(new Uint8Array(k),0),A.set(new Uint8Array(S),k.byteLength),A.buffer}decode(e,r){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return r(s)}if(typeof e=="string"){const s=JSON.parse(e),[o,l,f,g,w]=s;return r({join_ref:o,ref:l,topic:f,event:g,payload:w})}return r({})}_binaryDecode(e){const r=new DataView(e),s=r.getUint8(0),o=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,o)}}_decodeUserBroadcast(e,r,s){const o=r.getUint8(1),l=r.getUint8(2),f=r.getUint8(3),g=r.getUint8(4);let w=this.HEADER_LENGTH+4;const x=s.decode(e.slice(w,w+o));w=w+o;const v=s.decode(e.slice(w,w+l));w=w+l;const E=s.decode(e.slice(w,w+f));w=w+f;const S=e.slice(w,e.byteLength),I=g===this.JSON_ENCODING?JSON.parse(s.decode(S)):S,k={type:this.BROADCAST_EVENT,event:v,payload:I};return f>0&&(k.meta=JSON.parse(E)),{join_ref:null,ref:null,topic:x,event:this.BROADCAST_EVENT,payload:k}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class Vx{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ze;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ze||(Ze={}));const Hf=(t,e,r={})=>{var s;const o=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((l,f)=>(l[f]=cb(f,t,e,o),l),{}):{}},cb=(t,e,r,s)=>{const o=e.find(g=>g.name===t),l=o==null?void 0:o.type,f=r[t];return l&&!s.includes(l)?Hx(l,f):Nd(f)},Hx=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return fb(e,r)}switch(t){case Ze.bool:return ub(e);case Ze.float4:case Ze.float8:case Ze.int2:case Ze.int4:case Ze.int8:case Ze.numeric:case Ze.oid:return db(e);case Ze.json:case Ze.jsonb:return hb(e);case Ze.timestamp:return mb(e);case Ze.abstime:case Ze.date:case Ze.daterange:case Ze.int4range:case Ze.int8range:case Ze.money:case Ze.reltime:case Ze.text:case Ze.time:case Ze.timestamptz:case Ze.timetz:case Ze.tsrange:case Ze.tstzrange:return Nd(e);default:return Nd(e)}},Nd=t=>t,ub=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},db=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},hb=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},fb=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let l;const f=t.slice(1,r);try{l=JSON.parse("["+f+"]")}catch{l=f?f.split(","):[]}return l.map(g=>Hx(e,g))}return t},mb=t=>typeof t=="string"?t.replace(" ","T"):t,Wx=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class mu{constructor(e,r,s={},o=Ed){this.channel=e,this.event=r,this.payload=s,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Wf;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Wf||(Wf={}));class La{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},o=>{const{onJoin:l,onLeave:f,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=La.syncState(this.state,o,l,f),this.pendingDiffs.forEach(w=>{this.state=La.syncDiff(this.state,w,l,f)}),this.pendingDiffs=[],g()}),this.channel._on(s.diff,{},o=>{const{onJoin:l,onLeave:f,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=La.syncDiff(this.state,o,l,f),g())}),this.onJoin((o,l,f)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:l,newPresences:f})}),this.onLeave((o,l,f)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:l,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,o){const l=this.cloneDeep(e),f=this.transformState(r),g={},w={};return this.map(l,(x,v)=>{f[x]||(w[x]=v)}),this.map(f,(x,v)=>{const E=l[x];if(E){const S=v.map(M=>M.presence_ref),I=E.map(M=>M.presence_ref),k=v.filter(M=>I.indexOf(M.presence_ref)<0),j=E.filter(M=>S.indexOf(M.presence_ref)<0);k.length>0&&(g[x]=k),j.length>0&&(w[x]=j)}else g[x]=v}),this.syncDiff(l,{joins:g,leaves:w},s,o)}static syncDiff(e,r,s,o){const{joins:l,leaves:f}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),o||(o=()=>{}),this.map(l,(g,w)=>{var x;const v=(x=e[g])!==null&&x!==void 0?x:[];if(e[g]=this.cloneDeep(w),v.length>0){const E=e[g].map(I=>I.presence_ref),S=v.filter(I=>E.indexOf(I.presence_ref)<0);e[g].unshift(...S)}s(g,v,w)}),this.map(f,(g,w)=>{let x=e[g];if(!x)return;const v=w.map(E=>E.presence_ref);x=x.filter(E=>v.indexOf(E.presence_ref)<0),e[g]=x,o(g,x,w),x.length===0&&delete e[g]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const o=e[s];return"metas"in o?r[s]=o.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[s]=o,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gf;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Gf||(Gf={}));var Pa;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Pa||(Pa={}));var An;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(An||(An={}));class Fh{constructor(e,r={config:{}},s){var o,l;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=It.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new mu(this,tn.join,this.params,this.timeout),this.rejoinTimer=new Vx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=It.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=It.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this._on(tn.reply,{},(f,g)=>{this._trigger(this._replyEventName(g),f)}),this.presence=new La(this),this.broadcastEndpointURL=Wx(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(o=this.params.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,o,l;if(this.socket.isConnected()||this.socket.connect(),this.state==It.closed){const{config:{broadcast:f,presence:g,private:w}}=this.params,x=(o=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(I=>I.filter))!==null&&o!==void 0?o:[],v=!!this.bindings[Pa.PRESENCE]&&this.bindings[Pa.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,E={},S={broadcast:f,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:x,private:w};this.socket.accessTokenValue&&(E.access_token=this.socket.accessTokenValue),this._onError(I=>e==null?void 0:e(An.CHANNEL_ERROR,I)),this._onClose(()=>e==null?void 0:e(An.CLOSED)),this.updateJoinPayload(Object.assign({config:S},E)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:I})=>{var k;if(this.socket.setAuth(),I===void 0){e==null||e(An.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,M=(k=j==null?void 0:j.length)!==null&&k!==void 0?k:0,A=[];for(let C=0;C<M;C++){const T=j[C],{filter:{event:O,schema:V,table:z,filter:U}}=T,$=I&&I[C];if($&&$.event===O&&$.schema===V&&$.table===z&&$.filter===U)A.push(Object.assign(Object.assign({},T),{id:$.id}));else{this.unsubscribe(),this.state=It.errored,e==null||e(An.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(An.SUBSCRIBED);return}}).receive("error",I=>{this.state=It.errored,e==null||e(An.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(I).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(An.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===It.joined&&e===Pa.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var o;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(o=s.timeout)!==null&&o!==void 0?o:this.timeout);if(g.status===202)return{success:!0};let w=g.statusText;try{const x=await g.json();w=x.error||x.message||w}catch{}return Promise.reject(new Error(w))}async send(e,r={}){var s,o;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:f}=e,w={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:f,private:this.private}]})};try{const x=await this._fetchWithTimeout(this.broadcastEndpointURL,w,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((o=x.body)===null||o===void 0?void 0:o.cancel()),x.ok?"ok":"error"}catch(x){return x.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var f,g,w;const x=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((w=(g=(f=this.params)===null||f===void 0?void 0:f.config)===null||g===void 0?void 0:g.broadcast)===null||w===void 0)&&w.ack)&&l("ok"),x.receive("ok",()=>l("ok")),x.receive("error",()=>l("error")),x.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=It.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(tn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(o=>{s=new mu(this,tn.leave,{},e),s.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=It.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const o=new AbortController,l=setTimeout(()=>o.abort(),s),f=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(l),f}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new mu(this,e,r,s);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ob){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var o,l;const f=e.toLocaleLowerCase(),{close:g,error:w,leave:x,join:v}=tn;if(s&&[g,w,x,v].indexOf(f)>=0&&s!==this._joinRef())return;let S=this._onMessage(f,r,s);if(r&&!S)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(I=>{var k,j,M;return((k=I.filter)===null||k===void 0?void 0:k.event)==="*"||((M=(j=I.filter)===null||j===void 0?void 0:j.event)===null||M===void 0?void 0:M.toLocaleLowerCase())===f}).map(I=>I.callback(S,s)):(l=this.bindings[f])===null||l===void 0||l.filter(I=>{var k,j,M,A,C,T;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in I){const O=I.id,V=(k=I.filter)===null||k===void 0?void 0:k.event;return O&&((j=r.ids)===null||j===void 0?void 0:j.includes(O))&&(V==="*"||(V==null?void 0:V.toLocaleLowerCase())===((M=r.data)===null||M===void 0?void 0:M.type.toLocaleLowerCase()))}else{const O=(C=(A=I==null?void 0:I.filter)===null||A===void 0?void 0:A.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return O==="*"||O===((T=r==null?void 0:r.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return I.type.toLocaleLowerCase()===f}).map(I=>{if(typeof S=="object"&&"ids"in S){const k=S.data,{schema:j,table:M,commit_timestamp:A,type:C,errors:T}=k;S=Object.assign(Object.assign({},{schema:j,table:M,commit_timestamp:A,eventType:C,new:{},old:{},errors:T}),this._getPayloadRecords(k))}I.callback(S,s)})}_isClosed(){return this.state===It.closed}_isJoined(){return this.state===It.joined}_isJoining(){return this.state===It.joining}_isLeaving(){return this.state===It.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const o=e.toLocaleLowerCase(),l={type:o,filter:r,callback:s};return this.bindings[o]?this.bindings[o].push(l):this.bindings[o]=[l],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(o=>{var l;return!(((l=o.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===s&&Fh.isEqual(o.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(tn.close,{},e)}_onError(e){this._on(tn.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=It.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Hf(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Hf(e.columns,e.old_record)),r}}const gu=()=>{},tl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},gb=[1e3,2e3,5e3,1e4],xb=1e4,pb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class wb{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ed,this.transport=null,this.heartbeatIntervalMs=tl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=gu,this.ref=0,this.reconnectTimer=null,this.vsn=Vf,this.logger=gu,this.conn=null,this.sendBuffer=[],this.serializer=new lb,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>o?(...l)=>o(...l):(...l)=>fetch(...l),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Cd.websocket}`,this.httpEndpoint=Wx(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rb.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ms.connecting:return Ds.Connecting;case Ms.open:return Ds.Open;case Ms.closing:return Ds.Closing;default:return Ds.Closed}}isConnected(){return this.connectionState()===Ds.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,o=this.getChannels().find(l=>l.topic===s);if(o)return o;{const l=new Fh(`realtime:${e}`,r,this);return this.channels.push(l),l}}push(e){const{topic:r,event:s,payload:o,ref:l}=e,f=()=>{this.encode(e,g=>{var w;(w=this.conn)===null||w===void 0||w.send(g)})};this.log("push",`${r} ${s} (${l})`,o),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(ab,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},tl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(x){this.log("error","error in heartbeat callback",x)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:o,payload:l,ref:f}=r,g=f?`(${f})`:"",w=l.status||"";this.log("receive",`${w} ${s} ${o} ${g}`.trim(),l),this.channels.filter(x=>x._isMember(s)).forEach(x=>x._trigger(o,l,f)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ms.open||this.conn.readyState===Ms.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(tn.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${e}${s}${o}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([pb],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const o={access_token:r,version:sb};r&&s.updateJoinPayload(o),s.joinedOnce&&s._isJoined()&&s._push(tn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Vx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},tl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,o,l,f,g,w,x,v,E,S,I;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Ed,this.heartbeatIntervalMs=(o=e==null?void 0:e.heartbeatIntervalMs)!==null&&o!==void 0?o:tl.HEARTBEAT_INTERVAL,this.worker=(l=e==null?void 0:e.worker)!==null&&l!==void 0?l:!1,this.accessToken=(f=e==null?void 0:e.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(g=e==null?void 0:e.heartbeatCallback)!==null&&g!==void 0?g:gu,this.vsn=(w=e==null?void 0:e.vsn)!==null&&w!==void 0?w:Vf,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(x=e==null?void 0:e.reconnectAfterMs)!==null&&x!==void 0?x:k=>gb[k-1]||xb,this.vsn){case zx:this.encode=(v=e==null?void 0:e.encode)!==null&&v!==void 0?v:(k,j)=>j(JSON.stringify(k)),this.decode=(E=e==null?void 0:e.decode)!==null&&E!==void 0?E:(k,j)=>j(JSON.parse(k));break;case ib:this.encode=(S=e==null?void 0:e.encode)!==null&&S!==void 0?S:this.serializer.encode.bind(this.serializer),this.decode=(I=e==null?void 0:e.decode)!==null&&I!==void 0?I:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Uh extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ct(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class yb extends Uh{constructor(e,r,s){super(e),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class _d extends Uh{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const zh=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),vb=()=>Response,Sd=t=>{if(Array.isArray(t))return t.map(r=>Sd(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const o=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[o]=Sd(s)}),e},bb=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},xu=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},Eb=(t,e,r)=>he(void 0,void 0,void 0,function*(){const s=yield vb();t instanceof s&&!(r!=null&&r.noResolveJson)?t.json().then(o=>{const l=t.status||500,f=(o==null?void 0:o.statusCode)||l+"";e(new yb(xu(o),l,f))}).catch(o=>{e(new _d(xu(o),o))}):e(new _d(xu(t),t))}),Cb=(t,e,r,s)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?o:(bb(s)?(o.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),o.body=JSON.stringify(s)):o.body=s,e!=null&&e.duplex&&(o.duplex=e.duplex),Object.assign(Object.assign({},o),r))};function xo(t,e,r,s,o,l){return he(this,void 0,void 0,function*(){return new Promise((f,g)=>{t(r,Cb(e,s,o,l)).then(w=>{if(!w.ok)throw w;return s!=null&&s.noResolveJson?w:w.json()}).then(w=>f(w)).catch(w=>Eb(w,g,s))})})}function no(t,e,r,s){return he(this,void 0,void 0,function*(){return xo(t,"GET",e,r,s)})}function Jr(t,e,r,s,o){return he(this,void 0,void 0,function*(){return xo(t,"POST",e,s,o,r)})}function Ad(t,e,r,s,o){return he(this,void 0,void 0,function*(){return xo(t,"PUT",e,s,o,r)})}function Nb(t,e,r,s){return he(this,void 0,void 0,function*(){return xo(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function Vh(t,e,r,s,o){return he(this,void 0,void 0,function*(){return xo(t,"DELETE",e,s,o,r)})}class _b{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return he(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ct(e))return{data:null,error:e};throw e}})}}var Gx;class Sb{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[Gx]="BlobDownloadBuilder",this.promise=null}asStream(){return new _b(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return he(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ct(e))return{data:null,error:e};throw e}})}}Gx=Symbol.toStringTag;const Ab={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$f={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ib{constructor(e,r={},s,o){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=s,this.fetch=zh(o)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,s,o){return he(this,void 0,void 0,function*(){try{let l;const f=Object.assign(Object.assign({},$f),o);let g=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(f.upsert)});const w=f.metadata;typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",f.cacheControl),w&&l.append("metadata",this.encodeMetadata(w)),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.has("cacheControl")||l.append("cacheControl",f.cacheControl),w&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(w))):(l=s,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,w&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(w))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!f.duplex&&(f.duplex="half")),o!=null&&o.headers&&(g=Object.assign(Object.assign({},g),o.headers));const x=this._removeEmptyFolders(r),v=this._getFinalPath(x),E=yield(e=="PUT"?Ad:Jr)(this.fetch,`${this.url}/object/${v}`,l,Object.assign({headers:g},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{data:{path:x,id:E.Id,fullPath:E.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ct(l))return{data:null,error:l};throw l}})}upload(e,r,s){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,o){return he(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),f=this._getFinalPath(l),g=new URL(this.url+`/object/upload/sign/${f}`);g.searchParams.set("token",r);try{let w;const x=Object.assign({upsert:$f.upsert},o),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(x.upsert)});typeof Blob<"u"&&s instanceof Blob?(w=new FormData,w.append("cacheControl",x.cacheControl),w.append("",s)):typeof FormData<"u"&&s instanceof FormData?(w=s,w.append("cacheControl",x.cacheControl)):(w=s,v["cache-control"]=`max-age=${x.cacheControl}`,v["content-type"]=x.contentType);const E=yield Ad(this.fetch,g.toString(),w,{headers:v});return{data:{path:l,fullPath:E.Key},error:null}}catch(w){if(this.shouldThrowOnError)throw w;if(ct(w))return{data:null,error:w};throw w}})}createSignedUploadUrl(e,r){return he(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const o=Object.assign({},this.headers);r!=null&&r.upsert&&(o["x-upsert"]="true");const l=yield Jr(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:o}),f=new URL(this.url+l.url),g=f.searchParams.get("token");if(!g)throw new Uh("No token returned by API");return{data:{signedUrl:f.toString(),path:e,token:g},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}update(e,r,s){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return he(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(ct(o))return{data:null,error:o};throw o}})}copy(e,r,s){return he(this,void 0,void 0,function*(){try{return{data:{path:(yield Jr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(ct(o))return{data:null,error:o};throw o}})}createSignedUrl(e,r,s){return he(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),l=yield Jr(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const f=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${f}`)},{data:l,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(ct(o))return{data:null,error:o};throw o}})}createSignedUrls(e,r,s){return he(this,void 0,void 0,function*(){try{const o=yield Jr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),l=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:o.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${l}`):null})),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(ct(o))return{data:null,error:o};throw o}})}download(e,r){const o=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),f=l?`?${l}`:"",g=this._getFinalPath(e),w=()=>no(this.fetch,`${this.url}/${o}/${g}${f}`,{headers:this.headers,noResolveJson:!0});return new Sb(w,this.shouldThrowOnError)}info(e){return he(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield no(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Sd(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}exists(e){return he(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Nb(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s)&&s instanceof _d){const o=s.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),o=[],l=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&o.push(l);const g=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",w=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});w!==""&&o.push(w);let x=o.join("&");return x!==""&&(x=`?${x}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${s}${x}`)}}}remove(e){return he(this,void 0,void 0,function*(){try{return{data:yield Vh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}list(e,r,s){return he(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},Ab),r),{prefix:e||""});return{data:yield Jr(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},s),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(ct(o))return{data:null,error:o};throw o}})}listV2(e,r){return he(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Jr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const $x="2.84.0",Xx={"X-Client-Info":`storage-js/${$x}`};class Tb{constructor(e,r={},s,o){this.shouldThrowOnError=!1;const l=new URL(e);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Xx),r),this.fetch=zh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return he(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield no(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}getBucket(e){return he(this,void 0,void 0,function*(){try{return{data:yield no(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}createBucket(e){return he(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield Jr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(ct(o))return{data:null,error:o};throw o}})}updateBucket(e,r){return he(this,void 0,void 0,function*(){try{return{data:yield Ad(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}emptyBucket(e){return he(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}deleteBucket(e){return he(this,void 0,void 0,function*(){try{return{data:yield Vh(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class jb{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Xx),r),this.fetch=zh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return he(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}listBuckets(e){return he(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const s=r.toString(),o=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield no(this.fetch,o,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}deleteBucket(e){return he(this,void 0,void 0,function*(){try{return{data:yield Vh(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}}const Hh={"X-Client-Info":`storage-js/${$x}`,"Content-Type":"application/json"};class Yx extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function _r(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class pu extends Yx{constructor(e,r,s){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Rb extends Yx{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var Xf;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Xf||(Xf={}));const Wh=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Ob=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Yf=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),kb=(t,e,r)=>he(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const o=t.status||500,l=t;if(typeof l.json=="function")l.json().then(f=>{const g=(f==null?void 0:f.statusCode)||(f==null?void 0:f.code)||o+"";e(new pu(Yf(f),o,g))}).catch(()=>{const f=o+"",g=l.statusText||`HTTP ${o} error`;e(new pu(g,o,f))});else{const f=o+"",g=l.statusText||`HTTP ${o} error`;e(new pu(g,o,f))}}else e(new Rb(Yf(t),t))}),Mb=(t,e,r,s)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(Ob(s)?(o.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),o.body=JSON.stringify(s)):o.body=s,Object.assign(Object.assign({},o),r)):o};function Db(t,e,r,s,o,l){return he(this,void 0,void 0,function*(){return new Promise((f,g)=>{t(r,Mb(e,s,o,l)).then(w=>{if(!w.ok)throw w;if(s!=null&&s.noResolveJson)return w;const x=w.headers.get("content-type");return!x||!x.includes("application/json")?{}:w.json()}).then(w=>f(w)).catch(w=>kb(w,g,s))})})}function Sr(t,e,r,s,o){return he(this,void 0,void 0,function*(){return Db(t,"POST",e,s,o,r)})}class Lb{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Hh),r),this.fetch=Wh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return he(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}getIndex(e,r){return he(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(_r(s))return{data:null,error:s};throw s}})}listIndexes(e){return he(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return he(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(_r(s))return{data:null,error:s};throw s}})}}class Pb{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Hh),r),this.fetch=Wh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return he(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Sr(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}getVectors(e){return he(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}listVectors(e){return he(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Sr(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}queryVectors(e){return he(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}deleteVectors(e){return he(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Sr(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}}class Bb{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Hh),r),this.fetch=Wh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return he(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}getBucket(e){return he(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}listBuckets(){return he(this,arguments,void 0,function*(e={}){try{return{data:yield Sr(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}deleteBucket(e){return he(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_r(r))return{data:null,error:r};throw r}})}}class Fb extends Bb{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new Ub(this.url,this.headers,e,this.fetch)}}class Ub extends Lb{constructor(e,r,s,o){super(e,r,o),this.vectorBucketName=s}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return he(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return he(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return he(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return he(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new zb(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class zb extends Pb{constructor(e,r,s,o,l){super(e,r,l),this.vectorBucketName=s,this.indexName=o}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return he(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return he(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return he(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return he(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return he(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Vb extends Tb{constructor(e,r={},s,o){super(e,r,s,o)}from(e){return new Ib(this.url,this.headers,e,this.fetch)}get vectors(){return new Fb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new jb(this.url+"/iceberg",this.headers,this.fetch)}}const Hb="2.84.0";let Sa="";typeof Deno<"u"?Sa="deno":typeof document<"u"?Sa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Sa="react-native":Sa="node";const Wb={"X-Client-Info":`supabase-js-${Sa}/${Hb}`},Gb={headers:Wb},$b={schema:"public"},Xb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Yb={},qb=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Kb=()=>Headers,Qb=(t,e,r)=>{const s=qb(r),o=Kb();return async(l,f)=>{var g;const w=(g=await e())!==null&&g!==void 0?g:t;let x=new o(f==null?void 0:f.headers);return x.has("apikey")||x.set("apikey",t),x.has("Authorization")||x.set("Authorization",`Bearer ${w}`),s(l,Object.assign(Object.assign({},f),{headers:x}))}};function Zb(t){return t.endsWith("/")?t:t+"/"}function Jb(t,e){var r,s;const{db:o,auth:l,realtime:f,global:g}=t,{db:w,auth:x,realtime:v,global:E}=e,S={db:Object.assign(Object.assign({},w),o),auth:Object.assign(Object.assign({},x),l),realtime:Object.assign(Object.assign({},v),f),storage:{},global:Object.assign(Object.assign(Object.assign({},E),g),{headers:Object.assign(Object.assign({},(r=E==null?void 0:E.headers)!==null&&r!==void 0?r:{}),(s=g==null?void 0:g.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?S.accessToken=t.accessToken:delete S.accessToken,S}function eE(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Zb(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const qx="2.84.0",gi=30*1e3,Id=3,wu=Id*gi,tE="http://localhost:9999",rE="supabase.auth.token",nE={"X-Client-Info":`gotrue-js/${qx}`},Td="X-Supabase-Api-Version",Kx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},sE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,iE=10*60*1e3;class so extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function fe(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class aE extends so{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function oE(t){return fe(t)&&t.name==="AuthApiError"}class Ls extends so{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class bs extends so{constructor(e,r,s,o){super(e,s,o),this.name=r,this.status=s}}class br extends bs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function lE(t){return fe(t)&&t.name==="AuthSessionMissingError"}class ui extends bs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class rl extends bs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class nl extends bs{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function cE(t){return fe(t)&&t.name==="AuthImplicitGrantRedirectError"}class qf extends bs{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jd extends bs{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function yu(t){return fe(t)&&t.name==="AuthRetryableFetchError"}class Kf extends bs{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Rd extends bs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Gl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Qf=` 	
\r=`.split(""),uE=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Qf.length;e+=1)t[Qf[e].charCodeAt(0)]=-2;for(let e=0;e<Gl.length;e+=1)t[Gl[e].charCodeAt(0)]=e;return t})();function Zf(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Gl[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Gl[s]),e.queuedBits-=6}}function Qx(t,e,r){const s=uE[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Jf(t){const e=[],r=f=>{e.push(String.fromCodePoint(f))},s={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},l=f=>{fE(f,s,r)};for(let f=0;f<t.length;f+=1)Qx(t.charCodeAt(f),o,l);return e.join("")}function dE(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function hE(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const o=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}dE(s,e)}}function fE(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Li(t){const e=[],r={queue:0,queuedBits:0},s=o=>{e.push(o)};for(let o=0;o<t.length;o+=1)Qx(t.charCodeAt(o),r,s);return new Uint8Array(e)}function mE(t){const e=[];return hE(t,r=>e.push(r)),new Uint8Array(e)}function Us(t){const e=[],r={queue:0,queuedBits:0},s=o=>{e.push(o)};return t.forEach(o=>Zf(o,r,s)),Zf(null,r,s),e.join("")}function gE(t){return Math.round(Date.now()/1e3)+t}function xE(){return Symbol("auth-callback")}const Ut=()=>typeof window<"u"&&typeof document<"u",Ts={tested:!1,writable:!1},Zx=()=>{if(!Ut())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ts.tested)return Ts.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ts.tested=!0,Ts.writable=!0}catch{Ts.tested=!0,Ts.writable=!1}return Ts.writable};function pE(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,l)=>{e[l]=o})}catch{}return r.searchParams.forEach((s,o)=>{e[o]=s}),e}const Jx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),wE=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",xi=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},js=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},qn=async(t,e)=>{await t.removeItem(e)};class wc{constructor(){this.promise=new wc.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}wc.promiseConstructor=Promise;function vu(t){const e=t.split(".");if(e.length!==3)throw new Rd("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!sE.test(e[s]))throw new Rd("JWT not in base64url format");return{header:JSON.parse(Jf(e[0])),payload:JSON.parse(Jf(e[1])),signature:Li(e[2]),raw:{header:e[0],payload:e[1]}}}async function yE(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function vE(t,e){return new Promise((s,o)=>{(async()=>{for(let l=0;l<1/0;l++)try{const f=await t(l);if(!e(l,null,f)){s(f);return}}catch(f){if(!e(l,f)){o(f);return}}})()})}function bE(t){return("0"+t.toString(16)).substr(-2)}function EE(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let o="";for(let l=0;l<56;l++)o+=r.charAt(Math.floor(Math.random()*s));return o}return crypto.getRandomValues(e),Array.from(e,bE).join("")}async function CE(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(s);return Array.from(o).map(l=>String.fromCharCode(l)).join("")}async function NE(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await CE(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function di(t,e,r=!1){const s=EE();let o=s;r&&(o+="/PASSWORD_RECOVERY"),await xi(t,`${e}-code-verifier`,o);const l=await NE(s);return[l,s===l?"plain":"s256"]}const _E=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function SE(t){const e=t.headers.get(Td);if(!e||!e.match(_E))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function AE(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function IE(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const TE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function hi(t){if(!TE.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function bu(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function jE(t,e){return new Proxy(t,{get:(r,s,o)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,o)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,o)}})}function e1(t){return JSON.parse(JSON.stringify(t))}const ks=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),RE=[502,503,504];async function t1(t){var e;if(!wE(t))throw new jd(ks(t),0);if(RE.includes(t.status))throw new jd(ks(t),t.status);let r;try{r=await t.json()}catch(l){throw new Ls(ks(l),l)}let s;const o=SE(t);if(o&&o.getTime()>=Kx["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Kf(ks(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new br}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,f)=>l&&typeof f=="string",!0))throw new Kf(ks(r),t.status,r.weak_password.reasons);throw new aE(ks(r),t.status||500,s)}const OE=(t,e,r,s)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),o.body=JSON.stringify(s),Object.assign(Object.assign({},o),r))};async function we(t,e,r,s){var o;const l=Object.assign({},s==null?void 0:s.headers);l[Td]||(l[Td]=Kx["2024-01-01"].name),s!=null&&s.jwt&&(l.Authorization=`Bearer ${s.jwt}`);const f=(o=s==null?void 0:s.query)!==null&&o!==void 0?o:{};s!=null&&s.redirectTo&&(f.redirect_to=s.redirectTo);const g=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",w=await kE(t,e,r+g,{headers:l,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(w):{data:Object.assign({},w),error:null}}async function kE(t,e,r,s,o,l){const f=OE(e,s,o,l);let g;try{g=await t(r,Object.assign({},f))}catch(w){throw console.error(w),new jd(ks(w),0)}if(g.ok||await t1(g),s!=null&&s.noResolveJson)return g;try{return await g.json()}catch(w){await t1(w)}}function Qr(t){var e;let r=null;LE(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=gE(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function r1(t){const e=Qr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ts(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function ME(t){return{data:t,error:null}}function DE(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:o,verification_type:l}=t,f=Zi(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:e,email_otp:r,hashed_token:s,redirect_to:o,verification_type:l},w=Object.assign({},f);return{data:{properties:g,user:w},error:null}}function n1(t){return t}function LE(t){return t.access_token&&t.refresh_token&&t.expires_in}const Eu=["global","local","others"];class PE{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=Jx(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Eu[0]){if(Eu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Eu.join(", ")}`);try{return await we(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(fe(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await we(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ts})}catch(s){if(fe(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=Zi(e,["options"]),o=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(o.new_email=s==null?void 0:s.newEmail,delete o.newEmail),await we(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:DE,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(fe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await we(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ts})}catch(r){if(fe(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,o,l,f,g,w;try{const x={nextPage:null,lastPage:0,total:0},v=await we(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(l=(o=e==null?void 0:e.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:n1});if(v.error)throw v.error;const E=await v.json(),S=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,I=(w=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&w!==void 0?w:[];return I.length>0&&(I.forEach(k=>{const j=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(k.split(";")[1].split("=")[1]);x[`${M}Page`]=j}),x.total=parseInt(S)),{data:Object.assign(Object.assign({},E),x),error:null}}catch(x){if(fe(x))return{data:{users:[]},error:x};throw x}}async getUserById(e){hi(e);try{return await we(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ts})}catch(r){if(fe(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){hi(e);try{return await we(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:ts})}catch(s){if(fe(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){hi(e);try{return await we(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:ts})}catch(s){if(fe(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){hi(e.userId);try{const{data:r,error:s}=await we(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:s}}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _deleteFactor(e){hi(e.userId),hi(e.id);try{return{data:await we(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,o,l,f,g,w;try{const x={nextPage:null,lastPage:0,total:0},v=await we(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(l=(o=e==null?void 0:e.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:n1});if(v.error)throw v.error;const E=await v.json(),S=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,I=(w=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&w!==void 0?w:[];return I.length>0&&(I.forEach(k=>{const j=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(k.split(";")[1].split("=")[1]);x[`${M}Page`]=j}),x.total=parseInt(S)),{data:Object.assign(Object.assign({},E),x),error:null}}catch(x){if(fe(x))return{data:{clients:[]},error:x};throw x}}async _createOAuthClient(e){try{return await we(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await we(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await we(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(fe(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await we(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await we(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(fe(r))return{data:null,error:r};throw r}}}function s1(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const fi={debug:!!(globalThis&&Zx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ep extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class BE extends ep{}async function FE(t,e,r){fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),fi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async o=>{if(o){fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await r()}finally{fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(e===0)throw fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new BE(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(fi.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function UE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function tp(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function zE(t){return parseInt(t,16)}function VE(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function HE(t){var e;const{chainId:r,domain:s,expirationTime:o,issuedAt:l=new Date,nonce:f,notBefore:g,requestId:w,resources:x,scheme:v,uri:E,version:S}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!E)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(S!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${S}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const I=tp(t.address),k=v?`${v}://${s}`:s,j=t.statement?`${t.statement}
`:"",M=`${k} wants you to sign in with your Ethereum account:
${I}

${j}`;let A=`URI: ${E}
Version: ${S}
Chain ID: ${r}${f?`
Nonce: ${f}`:""}
Issued At: ${l.toISOString()}`;if(o&&(A+=`
Expiration Time: ${o.toISOString()}`),g&&(A+=`
Not Before: ${g.toISOString()}`),w&&(A+=`
Request ID: ${w}`),x){let C=`
Resources:`;for(const T of x){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);C+=`
- ${T}`}A+=C}return`${M}
${A}`}class Ct extends Error{constructor({message:e,code:r,cause:s,name:o}){var l;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(l=o??(s instanceof Error?s.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class $l extends Ct{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function WE({error:t,options:e}){var r,s,o;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ct({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ct({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Ct({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((o=l.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new Ct({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Ct({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Ct({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return l.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new Ct({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Ct({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const f=window.location.hostname;if(rp(f)){if(l.rp.id!==f)return new Ct({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ct({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Ct({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Ct({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ct({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function GE({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ct({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Ct({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(rp(s)){if(r.rpId!==s)return new Ct({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ct({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Ct({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ct({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class $E{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const XE=new $E;function YE(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,o=Zi(t,["challenge","user","excludeCredentials"]),l=Li(e).buffer,f=Object.assign(Object.assign({},r),{id:Li(r.id).buffer}),g=Object.assign(Object.assign({},o),{challenge:l,user:f});if(s&&s.length>0){g.excludeCredentials=new Array(s.length);for(let w=0;w<s.length;w++){const x=s[w];g.excludeCredentials[w]=Object.assign(Object.assign({},x),{id:Li(x.id).buffer,type:x.type||"public-key",transports:x.transports})}}return g}function qE(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=Zi(t,["challenge","allowCredentials"]),o=Li(e).buffer,l=Object.assign(Object.assign({},s),{challenge:o});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let f=0;f<r.length;f++){const g=r[f];l.allowCredentials[f]=Object.assign(Object.assign({},g),{id:Li(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return l}function KE(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Us(new Uint8Array(t.response.attestationObject)),clientDataJSON:Us(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function QE(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),o=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Us(new Uint8Array(o.authenticatorData)),clientDataJSON:Us(new Uint8Array(o.clientDataJSON)),signature:Us(new Uint8Array(o.signature)),userHandle:o.userHandle?Us(new Uint8Array(o.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function rp(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function i1(){var t,e;return!!(Ut()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function ZE(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $l("Browser returned unexpected credential type",e)}:{data:null,error:new $l("Empty credential response",e)}}catch(e){return{data:null,error:WE({error:e,options:t})}}}async function JE(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $l("Browser returned unexpected credential type",e)}:{data:null,error:new $l("Empty credential response",e)}}catch(e){return{data:null,error:GE({error:e,options:t})}}}const e3={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},t3={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Xl(...t){const e=o=>o!==null&&typeof o=="object"&&!Array.isArray(o),r=o=>o instanceof ArrayBuffer||ArrayBuffer.isView(o),s={};for(const o of t)if(o)for(const l in o){const f=o[l];if(f!==void 0)if(Array.isArray(f))s[l]=f;else if(r(f))s[l]=f;else if(e(f)){const g=s[l];e(g)?s[l]=Xl(g,f):s[l]=Xl(f)}else s[l]=f}return s}function r3(t,e){return Xl(e3,t,e||{})}function n3(t,e){return Xl(t3,t,e||{})}class s3{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:o},l){try{const{data:f,error:g}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!f)return{data:null,error:g};const w=o??XE.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:x}=f.webauthn.credential_options.publicKey;x.name||(x.name=`${x.id}:${s}`),x.displayName||(x.displayName=x.name)}switch(f.webauthn.type){case"create":{const x=r3(f.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:v,error:E}=await ZE({publicKey:x,signal:w});return v?{data:{factorId:e,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:E}}case"request":{const x=n3(f.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:v,error:E}=await JE(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:x,signal:w}));return v?{data:{factorId:e,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:E}}}}catch(f){return fe(f)?{data:null,error:f}:{data:null,error:new Ls("Unexpected error in challenge",f)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},l){if(!r)return{data:null,error:new so("rpId is required for WebAuthn authentication")};try{if(!i1())return{data:null,error:new Ls("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:o},{request:l});if(!f)return{data:null,error:g};const{webauthn:w}=f;return this._verify({factorId:e,challengeId:f.challengeId,webauthn:{type:w.type,rpId:r,rpOrigins:s,credential_response:w.credential_response}})}catch(f){return fe(f)?{data:null,error:f}:{data:null,error:new Ls("Unexpected error in authenticate",f)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},l){if(!r)return{data:null,error:new so("rpId is required for WebAuthn registration")};try{if(!i1())return{data:null,error:new Ls("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this._enroll({friendlyName:e});if(!f)return await this.client.mfa.listFactors().then(v=>{var E;return(E=v.data)===null||E===void 0?void 0:E.all.find(S=>S.factor_type==="webauthn"&&S.friendly_name===e&&S.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v==null?void 0:v.id}):void 0),{data:null,error:g};const{data:w,error:x}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:o},{create:l});return w?this._verify({factorId:f.id,challengeId:w.challengeId,webauthn:{rpId:r,rpOrigins:s,type:w.webauthn.type,credential_response:w.webauthn.credential_response}}):{data:null,error:x}}catch(f){return fe(f)?{data:null,error:f}:{data:null,error:new Ls("Unexpected error in register",f)}}}}UE();const i3={url:tE,storageKey:rE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:nE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function a1(t,e,r){return await r()}const mi={};class io{get jwks(){var e,r;return(r=(e=mi[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){mi[this.storageKey]=Object.assign(Object.assign({},mi[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=mi[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){mi[this.storageKey]=Object.assign(Object.assign({},mi[this.storageKey]),{cachedAt:e})}constructor(e){var r,s,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},i3),e);if(this.storageKey=l.storageKey,this.instanceID=(r=io.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,io.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&Ut()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new PE({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=Jx(l.fetch),this.lock=l.lock||a1,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:Ut()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=FE:this.lock=a1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new s3(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:Zx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=s1(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=s1(this.memoryStorage)),Ut()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f),await this._notifyAllSubscribers(f.data.event,f.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${qx}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(Ut()&&(r=pE(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),Ut()&&this.detectSessionInUrl&&s!=="none"){const{data:o,error:l}=await this._getSessionFromURL(r,s);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),cE(l)){const w=(e=l.details)===null||e===void 0?void 0:e.code;if(w==="identity_already_exists"||w==="identity_not_found"||w==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:f,redirectType:g}=o;return this._debug("#_initialize()","detected session in URL",f,"redirect type",g),await this._saveSession(f),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return fe(r)?this._returnResult({error:r}):this._returnResult({error:new Ls("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,o;try{const l=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(o=e==null?void 0:e.options)===null||o===void 0?void 0:o.captchaToken}},xform:Qr}),{data:f,error:g}=l;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const w=f.session,x=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",w)),this._returnResult({data:{user:x,session:w},error:null})}catch(l){if(fe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var r,s,o;try{let l;if("email"in e){const{email:v,password:E,options:S}=e;let I=null,k=null;this.flowType==="pkce"&&([I,k]=await di(this.storage,this.storageKey)),l=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:S==null?void 0:S.emailRedirectTo,body:{email:v,password:E,data:(r=S==null?void 0:S.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:S==null?void 0:S.captchaToken},code_challenge:I,code_challenge_method:k},xform:Qr})}else if("phone"in e){const{phone:v,password:E,options:S}=e;l=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:E,data:(s=S==null?void 0:S.data)!==null&&s!==void 0?s:{},channel:(o=S==null?void 0:S.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:S==null?void 0:S.captchaToken}},xform:Qr})}else throw new rl("You must provide either an email or phone number and a password");const{data:f,error:g}=l;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const w=f.session,x=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",w)),this._returnResult({data:{user:x,session:w},error:null})}catch(l){if(fe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let r;if("email"in e){const{email:l,password:f,options:g}=e;r=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:f,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:r1})}else if("phone"in e){const{phone:l,password:f,options:g}=e;r=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:f,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:r1})}else throw new rl("You must provide either an email or phone number and a password");const{data:s,error:o}=r;if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!s||!s.session||!s.user){const l=new ui;return this._returnResult({data:{user:null,session:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:o})}catch(r){if(fe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,o,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,o,l,f,g,w,x,v,E,S;let I,k;if("message"in e)I=e.message,k=e.signature;else{const{chain:j,wallet:M,statement:A,options:C}=e;let T;if(Ut())if(typeof M=="object")T=M;else{const G=window;if("ethereum"in G&&typeof G.ethereum=="object"&&"request"in G.ethereum&&typeof G.ethereum.request=="function")T=G.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof M!="object"||!(C!=null&&C.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=M}const O=new URL((r=C==null?void 0:C.url)!==null&&r!==void 0?r:window.location.href),V=await T.request({method:"eth_requestAccounts"}).then(G=>G).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!V||V.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const z=tp(V[0]);let U=(s=C==null?void 0:C.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!U){const G=await T.request({method:"eth_chainId"});U=zE(G)}const $={domain:O.host,address:z,statement:A,uri:O.href,version:"1",chainId:U,nonce:(o=C==null?void 0:C.signInWithEthereum)===null||o===void 0?void 0:o.nonce,issuedAt:(f=(l=C==null?void 0:C.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(g=C==null?void 0:C.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(w=C==null?void 0:C.signInWithEthereum)===null||w===void 0?void 0:w.notBefore,requestId:(x=C==null?void 0:C.signInWithEthereum)===null||x===void 0?void 0:x.requestId,resources:(v=C==null?void 0:C.signInWithEthereum)===null||v===void 0?void 0:v.resources};I=HE($),k=await T.request({method:"personal_sign",params:[VE(I),z]})}try{const{data:j,error:M}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:I,signature:k},!((E=e.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(S=e.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:Qr});if(M)throw M;if(!j||!j.session||!j.user){const A=new ui;return this._returnResult({data:{user:null,session:null},error:A})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:M})}catch(j){if(fe(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async signInWithSolana(e){var r,s,o,l,f,g,w,x,v,E,S,I;let k,j;if("message"in e)k=e.message,j=e.signature;else{const{chain:M,wallet:A,statement:C,options:T}=e;let O;if(Ut())if(typeof A=="object")O=A;else{const z=window;if("solana"in z&&typeof z.solana=="object"&&("signIn"in z.solana&&typeof z.solana.signIn=="function"||"signMessage"in z.solana&&typeof z.solana.signMessage=="function"))O=z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!(T!=null&&T.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=A}const V=new URL((r=T==null?void 0:T.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in O&&O.signIn){const z=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T==null?void 0:T.signInWithSolana),{version:"1",domain:V.host,uri:V.href}),C?{statement:C}:null));let U;if(Array.isArray(z)&&z[0]&&typeof z[0]=="object")U=z[0];else if(z&&typeof z=="object"&&"signedMessage"in z&&"signature"in z)U=z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in U&&"signature"in U&&(typeof U.signedMessage=="string"||U.signedMessage instanceof Uint8Array)&&U.signature instanceof Uint8Array)k=typeof U.signedMessage=="string"?U.signedMessage:new TextDecoder().decode(U.signedMessage),j=U.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");k=[`${V.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${V.href}`,`Issued At: ${(o=(s=T==null?void 0:T.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((l=T==null?void 0:T.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((f=T==null?void 0:T.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((g=T==null?void 0:T.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((w=T==null?void 0:T.signInWithSolana)===null||w===void 0)&&w.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((x=T==null?void 0:T.signInWithSolana)===null||x===void 0)&&x.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((E=(v=T==null?void 0:T.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||E===void 0)&&E.length?["Resources",...T.signInWithSolana.resources.map(U=>`- ${U}`)]:[]].join(`
`);const z=await O.signMessage(new TextEncoder().encode(k),"utf8");if(!z||!(z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=z}}try{const{data:M,error:A}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:k,signature:Us(j)},!((S=e.options)===null||S===void 0)&&S.captchaToken?{gotrue_meta_security:{captcha_token:(I=e.options)===null||I===void 0?void 0:I.captchaToken}}:null),xform:Qr});if(A)throw A;if(!M||!M.session||!M.user){const C=new ui;return this._returnResult({data:{user:null,session:null},error:C})}return M.session&&(await this._saveSession(M.session),await this._notifyAllSubscribers("SIGNED_IN",M.session)),this._returnResult({data:Object.assign({},M),error:A})}catch(M){if(fe(M))return this._returnResult({data:{user:null,session:null},error:M});throw M}}async _exchangeCodeForSession(e){const r=await js(this.storage,`${this.storageKey}-code-verifier`),[s,o]=(r??"").split("/");try{const{data:l,error:f}=await we(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Qr});if(await qn(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!l||!l.session||!l.user){const g=new ui;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:o??null}),error:f})}catch(l){if(fe(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:r,provider:s,token:o,access_token:l,nonce:f}=e,g=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:o,access_token:l,nonce:f,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Qr}),{data:w,error:x}=g;if(x)return this._returnResult({data:{user:null,session:null},error:x});if(!w||!w.session||!w.user){const v=new ui;return this._returnResult({data:{user:null,session:null},error:v})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:w,error:x})}catch(r){if(fe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,o,l,f;try{if("email"in e){const{email:g,options:w}=e;let x=null,v=null;this.flowType==="pkce"&&([x,v]=await di(this.storage,this.storageKey));const{error:E}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(r=w==null?void 0:w.data)!==null&&r!==void 0?r:{},create_user:(s=w==null?void 0:w.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:w==null?void 0:w.captchaToken},code_challenge:x,code_challenge_method:v},redirectTo:w==null?void 0:w.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:E})}if("phone"in e){const{phone:g,options:w}=e,{data:x,error:v}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(o=w==null?void 0:w.data)!==null&&o!==void 0?o:{},create_user:(l=w==null?void 0:w.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:w==null?void 0:w.captchaToken},channel:(f=w==null?void 0:w.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:x==null?void 0:x.message_id},error:v})}throw new rl("You must provide either an email or phone number.")}catch(g){if(fe(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(e){var r,s;try{let o,l;"options"in e&&(o=(r=e.options)===null||r===void 0?void 0:r.redirectTo,l=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:f,error:g}=await we(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:o,xform:Qr});if(g)throw g;if(!f)throw new Error("An error occurred on token verification.");const w=f.session,x=f.user;return w!=null&&w.access_token&&(await this._saveSession(w),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",w)),this._returnResult({data:{user:x,session:w},error:null})}catch(o){if(fe(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithSSO(e){var r,s,o,l,f;try{let g=null,w=null;this.flowType==="pkce"&&([g,w]=await di(this.storage,this.storageKey));const x=await we(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((o=e==null?void 0:e.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:w}),headers:this.headers,xform:ME});return!((l=x.data)===null||l===void 0)&&l.url&&Ut()&&!(!((f=e.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(x.data.url),this._returnResult(x)}catch(g){if(fe(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new br;const{error:o}=await we(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:o})})}catch(e){if(fe(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:o,options:l}=e,{error:f}=await we(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in e){const{phone:s,type:o,options:l}=e,{data:f,error:g}=await we(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:g})}throw new rl("You must provide either an email or phone number and a type")}catch(r){if(fe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await js(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<wu:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const f=await js(this.userStorage,this.storageKey+"-user");f!=null&&f.user?e.user=f.user:e.user=bu()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};e.user=jE(e.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:o},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ts}):await this._useSession(async r=>{var s,o,l;const{data:f,error:g}=r;if(g)throw g;return!(!((s=f.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new br}:await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(o=f.session)===null||o===void 0?void 0:o.access_token)!==null&&l!==void 0?l:void 0,xform:ts})})}catch(r){if(fe(r))return lE(r)&&(await this._removeSession(),await qn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:o,error:l}=s;if(l)throw l;if(!o.session)throw new br;const f=o.session;let g=null,w=null;this.flowType==="pkce"&&e.email!=null&&([g,w]=await di(this.storage,this.storageKey));const{data:x,error:v}=await we(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:g,code_challenge_method:w}),jwt:f.access_token,xform:ts});if(v)throw v;return f.user=x.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(s){if(fe(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new br;const r=Date.now()/1e3;let s=r,o=!0,l=null;const{payload:f}=vu(e.access_token);if(f.exp&&(s=f.exp,o=s<=r),o){const{data:g,error:w}=await this._callRefreshToken(e.refresh_token);if(w)return this._returnResult({data:{user:null,session:null},error:w});if(!g)return{data:{user:null,session:null},error:null};l=g}else{const{data:g,error:w}=await this._getUser(e.access_token);if(w)throw w;l={access_token:e.access_token,refresh_token:e.refresh_token,user:g.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(fe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:f,error:g}=r;if(g)throw g;e=(s=f.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new br;const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):o?this._returnResult({data:{user:o.user,session:o},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(fe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!Ut())throw new nl("No browser detected.");if(e.error||e.error_description||e.error_code)throw new nl(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new qf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new nl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new qf("No code detected.");const{data:C,error:T}=await this._exchangeCodeForSession(e.code);if(T)throw T;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:o,access_token:l,refresh_token:f,expires_in:g,expires_at:w,token_type:x}=e;if(!l||!g||!f||!x)throw new nl("No session defined in URL");const v=Math.round(Date.now()/1e3),E=parseInt(g);let S=v+E;w&&(S=parseInt(w));const I=S-v;I*1e3<=gi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${I}s, should have been closer to ${E}s`);const k=S-E;v-k>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",k,S,v):v-k<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",k,S,v);const{data:j,error:M}=await this._getUser(l);if(M)throw M;const A={provider_token:s,provider_refresh_token:o,access_token:l,expires_in:E,expires_at:S,refresh_token:f,token_type:x,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:e.type},error:null})}catch(s){if(fe(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await js(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:o,error:l}=r;if(l)return this._returnResult({error:l});const f=(s=o.session)===null||s===void 0?void 0:s.access_token;if(f){const{error:g}=await this.admin.signOut(f,e);if(g&&!(oE(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return e!=="others"&&(await this._removeSession(),await qn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=xE(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,o;try{const{data:{session:l},error:f}=r;if(f)throw f;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,r={}){let s=null,o=null;this.flowType==="pkce"&&([s,o]=await di(this.storage,this.storageKey,!0));try{return await we(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(fe(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:o}=await this._useSession(async l=>{var f,g,w,x,v;const{data:E,error:S}=l;if(S)throw S;const I=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(f=e.options)===null||f===void 0?void 0:f.redirectTo,scopes:(g=e.options)===null||g===void 0?void 0:g.scopes,queryParams:(w=e.options)===null||w===void 0?void 0:w.queryParams,skipBrowserRedirect:!0});return await we(this.fetch,"GET",I,{headers:this.headers,jwt:(v=(x=E.session)===null||x===void 0?void 0:x.access_token)!==null&&v!==void 0?v:void 0})});if(o)throw o;return Ut()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(fe(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:o,data:{session:l}}=r;if(o)throw o;const{options:f,provider:g,token:w,access_token:x,nonce:v}=e,E=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=l==null?void 0:l.access_token)!==null&&s!==void 0?s:void 0,body:{provider:g,id_token:w,access_token:x,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Qr}),{data:S,error:I}=E;return I?this._returnResult({data:{user:null,session:null},error:I}):!S||!S.session||!S.user?this._returnResult({data:{user:null,session:null},error:new ui}):(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("USER_UPDATED",S.session)),this._returnResult({data:S,error:I}))}catch(o){if(fe(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,o;const{data:l,error:f}=r;if(f)throw f;return await we(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await vE(async o=>(o>0&&await yE(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await we(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Qr})),(o,l)=>{const f=200*Math.pow(2,o);return l&&yu(l)&&Date.now()+f-s<gi})}catch(s){if(this._debug(r,"error",s),fe(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),Ut()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const o=await js(this.storage,this.storageKey);if(o&&this.userStorage){let f=await js(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:o.user},await xi(this.userStorage,this.storageKey+"-user",f)),o.user=(e=f==null?void 0:f.user)!==null&&e!==void 0?e:bu()}else if(o&&!o.user&&!o.user){const f=await js(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(o.user=f.user,await qn(this.storage,this.storageKey+"-user"),await xi(this.storage,this.storageKey,o)):o.user=bu()}if(this._debug(s,"session from storage",o),!this._isValidSession(o)){this._debug(s,"session is not valid"),o!==null&&await this._removeSession();return}const l=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<wu;if(this._debug(s,`session has${l?"":" not"} expired with margin of ${wu}s`),l){if(this.autoRefreshToken&&o.refresh_token){const{error:f}=await this._callRefreshToken(o.refresh_token);f&&(console.error(f),yu(f)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:g}=await this._getUser(o.access_token);!g&&(f!=null&&f.user)?(o.user=f.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(s,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(s,"error",o),console.error(o);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new br;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new wc;const{data:l,error:f}=await this._refreshAccessToken(e);if(f)throw f;if(!l.session)throw new br;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const g={data:l.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(l){if(this._debug(o,"error",l),fe(l)){const f={data:null,error:l};return yu(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(f),f}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(l),l}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,r,s=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const l=[],f=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(e,r)}catch(w){l.push(w)}});if(await Promise.all(f),l.length>0){for(let g=0;g<l.length;g+=1)console.error(l[g]);throw l[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await xi(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const l=e1(o);await xi(this.storage,this.storageKey,l)}else{const o=e1(r);await xi(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await qn(this.storage,this.storageKey),await qn(this.storage,this.storageKey+"-code-verifier"),await qn(this.storage,this.storageKey+"-user"),this.userStorage&&await qn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ut()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),gi);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((s.expires_at*1e3-e)/gi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${gi}ms, refresh threshold is ${Id} ticks`),o<=Id&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ep)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ut()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const o=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&o.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&o.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[l,f]=await di(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(f)}`});o.push(g.toString())}if(s!=null&&s.queryParams){const l=new URLSearchParams(s.queryParams);o.push(l.toString())}return s!=null&&s.skipBrowserRedirect&&o.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:o,error:l}=r;return l?this._returnResult({data:null,error:l}):await we(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=o==null?void 0:o.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,o;const{data:l,error:f}=r;if(f)return this._returnResult({data:null,error:f});const g=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:w,error:x}=await we(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(s=l==null?void 0:l.session)===null||s===void 0?void 0:s.access_token});return x?this._returnResult({data:null,error:x}):(e.factorType==="totp"&&w.type==="totp"&&(!((o=w==null?void 0:w.totp)===null||o===void 0)&&o.qr_code)&&(w.totp.qr_code=`data:image/svg+xml;utf-8,${w.totp.qr_code}`),this._returnResult({data:w,error:null}))})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:o,error:l}=r;if(l)return this._returnResult({data:null,error:l});const f=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?KE(e.webauthn.credential_response):QE(e.webauthn.credential_response)})}:{code:e.code}),{data:g,error:w}=await we(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:f,headers:this.headers,jwt:(s=o==null?void 0:o.session)===null||s===void 0?void 0:s.access_token});return w?this._returnResult({data:null,error:w}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:w}))})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:o,error:l}=r;if(l)return this._returnResult({data:null,error:l});const f=await we(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=o==null?void 0:o.session)===null||s===void 0?void 0:s.access_token});if(f.error)return f;const{data:g}=f;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:YE(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:qE(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const o={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])o.all.push(l),l.status==="verified"&&o[l.factor_type].push(l);return{data:o,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:s},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=vu(s.access_token);let f=null;l.aal&&(f=l.aal);let g=f;((r=(e=s.user.factors)===null||e===void 0?void 0:e.filter(v=>v.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(g="aal2");const x=l.amr||[];return{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:x},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:o}=r;return o?this._returnResult({data:null,error:o}):s?await we(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new br})})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:o},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!o)return this._returnResult({data:null,error:new br});const f=await we(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&Ut()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(s){if(fe(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:o},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!o)return this._returnResult({data:null,error:new br});const f=await we(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&Ut()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(s){if(fe(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;return s?this._returnResult({data:null,error:s}):r?await we(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new br})})}catch(e){if(fe(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:s},error:o}=r;return o?this._returnResult({data:null,error:o}):s?await we(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new br})})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(g=>g.kid===e);if(s)return s;const o=Date.now();if(s=this.jwks.keys.find(g=>g.kid===e),s&&this.jwks_cached_at+iE>o)return s;const{data:l,error:f}=await we(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=o,s=l.keys.find(g=>g.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:I,error:k}=await this.getSession();if(k||!I.session)return this._returnResult({data:null,error:k});s=I.session.access_token}const{header:o,payload:l,signature:f,raw:{header:g,payload:w}}=vu(s);r!=null&&r.allowExpired||AE(l.exp);const x=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!x){const{error:I}=await this.getUser(s);if(I)throw I;return{data:{claims:l,header:o,signature:f},error:null}}const v=IE(o.alg),E=await crypto.subtle.importKey("jwk",x,v,!0,["verify"]);if(!await crypto.subtle.verify(v,E,f,mE(`${g}.${w}`)))throw new Rd("Invalid JWT signature");return{data:{claims:l,header:o,signature:f},error:null}}catch(s){if(fe(s))return this._returnResult({data:null,error:s});throw s}}}io.nextInstanceID={};const a3=io;class o3 extends a3{constructor(e){super(e)}}class l3{constructor(e,r,s){var o,l,f;this.supabaseUrl=e,this.supabaseKey=r;const g=eE(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const w=`sb-${g.hostname.split(".")[0]}-auth-token`,x={db:$b,realtime:Yb,auth:Object.assign(Object.assign({},Xb),{storageKey:w}),global:Gb},v=Jb(s??{},x);this.storageKey=(o=v.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(l=v.global.headers)!==null&&l!==void 0?l:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(E,S)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(S)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=v.auth)!==null&&f!==void 0?f:{},this.headers,v.global.fetch),this.fetch=Qb(r,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(E=>this.realtime.setAuth(E)).catch(E=>console.warn("Failed to set initial Realtime auth token:",E)),this.rest=new tb(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new Vb(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Zv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:o,userStorage:l,storageKey:f,flowType:g,lock:w,debug:x,throwOnError:v},E,S){const I={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new o3({url:this.authUrl.href,headers:Object.assign(Object.assign({},I),E),storageKey:f,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:o,userStorage:l,flowType:g,lock:w,debug:x,throwOnError:v,fetch:S,hasCustomAuthorizationHeader:Object.keys(this.headers).some(k=>k.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new wb(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const c3=(t,e,r)=>new l3(t,e,r);function u3(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}u3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const d3=void 0,h3=void 0,ae=c3(d3,h3),hs={pending:"En attente",validated:"Valid",preparing:"Prparation mini-dpt",in_transit:"En route",completed:"change effectu",returned:"Produit retourn",rejected:"Rejet"},f3={pending:"En attente",active:"En cours",completed:"Termin",expired:"Expir",cancelled:"Annul"};var le;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(le||(le={}));var o1=new Map([[le.QR_CODE,"QR_CODE"],[le.AZTEC,"AZTEC"],[le.CODABAR,"CODABAR"],[le.CODE_39,"CODE_39"],[le.CODE_93,"CODE_93"],[le.CODE_128,"CODE_128"],[le.DATA_MATRIX,"DATA_MATRIX"],[le.MAXICODE,"MAXICODE"],[le.ITF,"ITF"],[le.EAN_13,"EAN_13"],[le.EAN_8,"EAN_8"],[le.PDF_417,"PDF_417"],[le.RSS_14,"RSS_14"],[le.RSS_EXPANDED,"RSS_EXPANDED"],[le.UPC_A,"UPC_A"],[le.UPC_E,"UPC_E"],[le.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),l1;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(l1||(l1={}));function m3(t){return Object.values(le).includes(t)}var xs;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(xs||(xs={}));var rn=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[xs.SCAN_TYPE_CAMERA,xs.SCAN_TYPE_FILE],t}(),np=function(){function t(e,r){this.format=e,this.formatName=r}return t.prototype.toString=function(){return this.formatName},t.create=function(e){if(!o1.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new t(e,o1.get(e))},t}(),c1=function(){function t(){}return t.createFromText=function(e){var r={text:e};return{decodedText:e,result:r}},t.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},t}(),Od;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Od||(Od={}));var sp=function(){function t(){}return t.createFrom=function(e){return{errorMessage:e,type:Od.UNKWOWN_ERROR}},t}(),ip=function(){function t(e){this.verbose=e}return t.prototype.log=function(e){this.verbose&&console.log(e)},t.prototype.warn=function(e){this.verbose&&console.warn(e)},t.prototype.logError=function(e,r){(this.verbose||r===!0)&&console.error(e)},t.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},t}();function vn(t){return typeof t>"u"||t===null}function g3(t,e,r){return t>r?r:t<e?e:t}var Ti=function(){function t(){}return t.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},t.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),ze=function(){function t(){}return t.scanningStatus=function(){return"Scanning"},t.idleStatus=function(){return"Idle"},t.errorStatus=function(){return"Error"},t.permissionStatus=function(){return"Permission"},t.noCameraFoundErrorStatus=function(){return"No Cameras"},t.lastMatch=function(e){return"Last Match: ".concat(e)},t.codeScannerTitle=function(){return"Code Scanner"},t.cameraPermissionTitle=function(){return"Request Camera Permissions"},t.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},t.noCameraFound=function(){return"No camera found"},t.scanButtonStopScanningText=function(){return"Stop Scanning"},t.scanButtonStartScanningText=function(){return"Start Scanning"},t.torchOnButton=function(){return"Switch On Torch"},t.torchOffButton=function(){return"Switch Off Torch"},t.torchOnFailedMessage=function(){return"Failed to turn on torch"},t.torchOffFailedMessage=function(){return"Failed to turn off torch"},t.scanButtonScanningStarting=function(){return"Launching Camera..."},t.textIfCameraScanSelected=function(){return"Scan an Image File"},t.textIfFileScanSelected=function(){return"Scan using camera directly"},t.selectCamera=function(){return"Select Camera"},t.fileSelectionChooseImage=function(){return"Choose Image"},t.fileSelectionChooseAnother=function(){return"Choose Another"},t.fileSelectionNoImageSelected=function(){return"No image choosen"},t.anonymousCameraPrefix=function(){return"Anonymous Camera"},t.dragAndDropMessage=function(){return"Or drop an image to scan"},t.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},t.zoom=function(){return"zoom"},t.loadingImage=function(){return"Loading image..."},t.cameraScanAltText=function(){return"Camera based scan"},t.fileScanAltText=function(){return"Fule based scan"},t}(),u1=function(){function t(){}return t.poweredBy=function(){return"Powered by "},t.reportIssues=function(){return"Report issues"},t}(),ap=function(){function t(){}return t.isMediaStreamConstraintsValid=function(e,r){if(typeof e!="object"){var s=typeof e;return r.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(s,"."),!0),!1}for(var o=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],l=new Set(o),f=Object.keys(e),g=0,w=f;g<w.length;g++){var x=w[g];if(l.has(x))return r.logError("".concat(x," is not supported videoConstaints."),!0),!1}return!0},t}(),kd={exports:{}};(function(t,e){(function(r,s){s(e)})(ha,function(r){function s(N){return N==null}var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,n){N.__proto__=n}||function(N,n){for(var i in n)n.hasOwnProperty(i)&&(N[i]=n[i])};function l(N,n){o(N,n);function i(){this.constructor=N}N.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}function f(N,n){var i=Object.setPrototypeOf;i?i(N,n):N.__proto__=n}function g(N,n){n===void 0&&(n=N.constructor);var i=Error.captureStackTrace;i&&i(N,n)}var w=function(N){l(n,N);function n(i){var a=this.constructor,c=N.call(this,i)||this;return Object.defineProperty(c,"name",{value:a.name,enumerable:!1}),f(c,a.prototype),g(c),c}return n}(Error);class x extends w{constructor(n=void 0){super(n),this.message=n}getKind(){return this.constructor.kind}}x.kind="Exception";class v extends x{}v.kind="ArgumentException";class E extends x{}E.kind="IllegalArgumentException";class S{constructor(n){if(this.binarizer=n,n===null)throw new E("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(n,i){return this.binarizer.getBlackRow(n,i)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(n,i,a,c){const d=this.binarizer.getLuminanceSource().crop(n,i,a,c);return new S(this.binarizer.createBinarizer(d))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const n=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new S(this.binarizer.createBinarizer(n))}rotateCounterClockwise45(){const n=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new S(this.binarizer.createBinarizer(n))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class I extends x{static getChecksumInstance(){return new I}}I.kind="ChecksumException";class k{constructor(n){this.source=n}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class j{static arraycopy(n,i,a,c,d){for(;d--;)a[c++]=n[i++]}static currentTimeMillis(){return Date.now()}}class M extends x{}M.kind="IndexOutOfBoundsException";class A extends M{constructor(n=void 0,i=void 0){super(i),this.index=n,this.message=i}}A.kind="ArrayIndexOutOfBoundsException";class C{static fill(n,i){for(let a=0,c=n.length;a<c;a++)n[a]=i}static fillWithin(n,i,a,c){C.rangeCheck(n.length,i,a);for(let d=i;d<a;d++)n[d]=c}static rangeCheck(n,i,a){if(i>a)throw new E("fromIndex("+i+") > toIndex("+a+")");if(i<0)throw new A(i);if(a>n)throw new A(a)}static asList(...n){return n}static create(n,i,a){return Array.from({length:n}).map(d=>Array.from({length:i}).fill(a))}static createInt32Array(n,i,a){return Array.from({length:n}).map(d=>Int32Array.from({length:i}).fill(a))}static equals(n,i){if(!n||!i||!n.length||!i.length||n.length!==i.length)return!1;for(let a=0,c=n.length;a<c;a++)if(n[a]!==i[a])return!1;return!0}static hashCode(n){if(n===null)return 0;let i=1;for(const a of n)i=31*i+a;return i}static fillUint8Array(n,i){for(let a=0;a!==n.length;a++)n[a]=i}static copyOf(n,i){return n.slice(0,i)}static copyOfUint8Array(n,i){if(n.length<=i){const a=new Uint8Array(i);return a.set(n),a}return n.slice(0,i)}static copyOfRange(n,i,a){const c=a-i,d=new Int32Array(c);return j.arraycopy(n,i,d,0,c),d}static binarySearch(n,i,a){a===void 0&&(a=C.numberComparator);let c=0,d=n.length-1;for(;c<=d;){const h=d+c>>1,m=a(i,n[h]);if(m>0)c=h+1;else if(m<0)d=h-1;else return h}return-c-1}static numberComparator(n,i){return n-i}}class T{static numberOfTrailingZeros(n){let i;if(n===0)return 32;let a=31;return i=n<<16,i!==0&&(a-=16,n=i),i=n<<8,i!==0&&(a-=8,n=i),i=n<<4,i!==0&&(a-=4,n=i),i=n<<2,i!==0&&(a-=2,n=i),a-(n<<1>>>31)}static numberOfLeadingZeros(n){if(n===0)return 32;let i=1;return n>>>16||(i+=16,n<<=16),n>>>24||(i+=8,n<<=8),n>>>28||(i+=4,n<<=4),n>>>30||(i+=2,n<<=2),i-=n>>>31,i}static toHexString(n){return n.toString(16)}static toBinaryString(n){return String(parseInt(String(n),2))}static bitCount(n){return n=n-(n>>>1&1431655765),n=(n&858993459)+(n>>>2&858993459),n=n+(n>>>4)&252645135,n=n+(n>>>8),n=n+(n>>>16),n&63}static truncDivision(n,i){return Math.trunc(n/i)}static parseInt(n,i=void 0){return parseInt(n,i)}}T.MIN_VALUE_32_BITS=-2147483648,T.MAX_VALUE=Number.MAX_SAFE_INTEGER;class O{constructor(n,i){n===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=n,i==null?this.bits=O.makeArray(n):this.bits=i)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(n){if(n>this.bits.length*32){const i=O.makeArray(n);j.arraycopy(this.bits,0,i,0,this.bits.length),this.bits=i}}get(n){return(this.bits[Math.floor(n/32)]&1<<(n&31))!==0}set(n){this.bits[Math.floor(n/32)]|=1<<(n&31)}flip(n){this.bits[Math.floor(n/32)]^=1<<(n&31)}getNextSet(n){const i=this.size;if(n>=i)return i;const a=this.bits;let c=Math.floor(n/32),d=a[c];d&=~((1<<(n&31))-1);const h=a.length;for(;d===0;){if(++c===h)return i;d=a[c]}const m=c*32+T.numberOfTrailingZeros(d);return m>i?i:m}getNextUnset(n){const i=this.size;if(n>=i)return i;const a=this.bits;let c=Math.floor(n/32),d=~a[c];d&=~((1<<(n&31))-1);const h=a.length;for(;d===0;){if(++c===h)return i;d=~a[c]}const m=c*32+T.numberOfTrailingZeros(d);return m>i?i:m}setBulk(n,i){this.bits[Math.floor(n/32)]=i}setRange(n,i){if(i<n||n<0||i>this.size)throw new E;if(i===n)return;i--;const a=Math.floor(n/32),c=Math.floor(i/32),d=this.bits;for(let h=a;h<=c;h++){const m=h>a?0:n&31,y=(2<<(h<c?31:i&31))-(1<<m);d[h]|=y}}clear(){const n=this.bits.length,i=this.bits;for(let a=0;a<n;a++)i[a]=0}isRange(n,i,a){if(i<n||n<0||i>this.size)throw new E;if(i===n)return!0;i--;const c=Math.floor(n/32),d=Math.floor(i/32),h=this.bits;for(let m=c;m<=d;m++){const p=m>c?0:n&31,b=(2<<(m<d?31:i&31))-(1<<p)&4294967295;if((h[m]&b)!==(a?b:0))return!1}return!0}appendBit(n){this.ensureCapacity(this.size+1),n&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(n,i){if(i<0||i>32)throw new E("Num bits must be between 0 and 32");this.ensureCapacity(this.size+i);for(let a=i;a>0;a--)this.appendBit((n>>a-1&1)===1)}appendBitArray(n){const i=n.size;this.ensureCapacity(this.size+i);for(let a=0;a<i;a++)this.appendBit(n.get(a))}xor(n){if(this.size!==n.size)throw new E("Sizes don't match");const i=this.bits;for(let a=0,c=i.length;a<c;a++)i[a]^=n.bits[a]}toBytes(n,i,a,c){for(let d=0;d<c;d++){let h=0;for(let m=0;m<8;m++)this.get(n)&&(h|=1<<7-m),n++;i[a+d]=h}}getBitArray(){return this.bits}reverse(){const n=new Int32Array(this.bits.length),i=Math.floor((this.size-1)/32),a=i+1,c=this.bits;for(let d=0;d<a;d++){let h=c[d];h=h>>1&1431655765|(h&1431655765)<<1,h=h>>2&858993459|(h&858993459)<<2,h=h>>4&252645135|(h&252645135)<<4,h=h>>8&16711935|(h&16711935)<<8,h=h>>16&65535|(h&65535)<<16,n[i-d]=h}if(this.size!==a*32){const d=a*32-this.size;let h=n[0]>>>d;for(let m=1;m<a;m++){const p=n[m];h|=p<<32-d,n[m-1]=h,h=p>>>d}n[a-1]=h}this.bits=n}static makeArray(n){return new Int32Array(Math.floor((n+31)/32))}equals(n){if(!(n instanceof O))return!1;const i=n;return this.size===i.size&&C.equals(this.bits,i.bits)}hashCode(){return 31*this.size+C.hashCode(this.bits)}toString(){let n="";for(let i=0,a=this.size;i<a;i++)i&7||(n+=" "),n+=this.get(i)?"X":".";return n}clone(){return new O(this.size,this.bits.slice())}}var V;(function(N){N[N.OTHER=0]="OTHER",N[N.PURE_BARCODE=1]="PURE_BARCODE",N[N.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",N[N.TRY_HARDER=3]="TRY_HARDER",N[N.CHARACTER_SET=4]="CHARACTER_SET",N[N.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",N[N.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",N[N.ASSUME_GS1=7]="ASSUME_GS1",N[N.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",N[N.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",N[N.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(V||(V={}));var z=V;class U extends x{static getFormatInstance(){return new U}}U.kind="FormatException";var $;(function(N){N[N.Cp437=0]="Cp437",N[N.ISO8859_1=1]="ISO8859_1",N[N.ISO8859_2=2]="ISO8859_2",N[N.ISO8859_3=3]="ISO8859_3",N[N.ISO8859_4=4]="ISO8859_4",N[N.ISO8859_5=5]="ISO8859_5",N[N.ISO8859_6=6]="ISO8859_6",N[N.ISO8859_7=7]="ISO8859_7",N[N.ISO8859_8=8]="ISO8859_8",N[N.ISO8859_9=9]="ISO8859_9",N[N.ISO8859_10=10]="ISO8859_10",N[N.ISO8859_11=11]="ISO8859_11",N[N.ISO8859_13=12]="ISO8859_13",N[N.ISO8859_14=13]="ISO8859_14",N[N.ISO8859_15=14]="ISO8859_15",N[N.ISO8859_16=15]="ISO8859_16",N[N.SJIS=16]="SJIS",N[N.Cp1250=17]="Cp1250",N[N.Cp1251=18]="Cp1251",N[N.Cp1252=19]="Cp1252",N[N.Cp1256=20]="Cp1256",N[N.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",N[N.UTF8=22]="UTF8",N[N.ASCII=23]="ASCII",N[N.Big5=24]="Big5",N[N.GB18030=25]="GB18030",N[N.EUC_KR=26]="EUC_KR"})($||($={}));class G{constructor(n,i,a,...c){this.valueIdentifier=n,this.name=a,typeof i=="number"?this.values=Int32Array.from([i]):this.values=i,this.otherEncodingNames=c,G.VALUE_IDENTIFIER_TO_ECI.set(n,this),G.NAME_TO_ECI.set(a,this);const d=this.values;for(let h=0,m=d.length;h!==m;h++){const p=d[h];G.VALUES_TO_ECI.set(p,this)}for(const h of c)G.NAME_TO_ECI.set(h,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(n){if(n<0||n>=900)throw new U("incorect value");const i=G.VALUES_TO_ECI.get(n);if(i===void 0)throw new U("incorect value");return i}static getCharacterSetECIByName(n){const i=G.NAME_TO_ECI.get(n);if(i===void 0)throw new U("incorect value");return i}equals(n){if(!(n instanceof G))return!1;const i=n;return this.getName()===i.getName()}}G.VALUE_IDENTIFIER_TO_ECI=new Map,G.VALUES_TO_ECI=new Map,G.NAME_TO_ECI=new Map,G.Cp437=new G($.Cp437,Int32Array.from([0,2]),"Cp437"),G.ISO8859_1=new G($.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),G.ISO8859_2=new G($.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),G.ISO8859_3=new G($.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),G.ISO8859_4=new G($.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),G.ISO8859_5=new G($.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),G.ISO8859_6=new G($.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),G.ISO8859_7=new G($.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),G.ISO8859_8=new G($.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),G.ISO8859_9=new G($.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),G.ISO8859_10=new G($.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),G.ISO8859_11=new G($.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),G.ISO8859_13=new G($.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),G.ISO8859_14=new G($.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),G.ISO8859_15=new G($.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),G.ISO8859_16=new G($.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),G.SJIS=new G($.SJIS,20,"SJIS","Shift_JIS"),G.Cp1250=new G($.Cp1250,21,"Cp1250","windows-1250"),G.Cp1251=new G($.Cp1251,22,"Cp1251","windows-1251"),G.Cp1252=new G($.Cp1252,23,"Cp1252","windows-1252"),G.Cp1256=new G($.Cp1256,24,"Cp1256","windows-1256"),G.UnicodeBigUnmarked=new G($.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),G.UTF8=new G($.UTF8,26,"UTF8","UTF-8"),G.ASCII=new G($.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),G.Big5=new G($.Big5,28,"Big5"),G.GB18030=new G($.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),G.EUC_KR=new G($.EUC_KR,30,"EUC_KR","EUC-KR");class te extends x{}te.kind="UnsupportedOperationException";class be{static decode(n,i){const a=this.encodingName(i);return this.customDecoder?this.customDecoder(n,a):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(a)?this.decodeFallback(n,a):new TextDecoder(a).decode(n)}static shouldDecodeOnFallback(n){return!be.isBrowser()&&n==="ISO-8859-1"}static encode(n,i){const a=this.encodingName(i);return this.customEncoder?this.customEncoder(n,a):typeof TextEncoder>"u"?this.encodeFallback(n):new TextEncoder().encode(n)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(n){return typeof n=="string"?n:n.getName()}static encodingCharacterSet(n){return n instanceof G?n:G.getCharacterSetECIByName(n)}static decodeFallback(n,i){const a=this.encodingCharacterSet(i);if(be.isDecodeFallbackSupported(a)){let c="";for(let d=0,h=n.length;d<h;d++){let m=n[d].toString(16);m.length<2&&(m="0"+m),c+="%"+m}return decodeURIComponent(c)}if(a.equals(G.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(n.buffer));throw new te(`Encoding ${this.encodingName(i)} not supported by fallback.`)}static isDecodeFallbackSupported(n){return n.equals(G.UTF8)||n.equals(G.ISO8859_1)||n.equals(G.ASCII)}static encodeFallback(n){const a=btoa(unescape(encodeURIComponent(n))).split(""),c=[];for(let d=0;d<a.length;d++)c.push(a[d].charCodeAt(0));return new Uint8Array(c)}}class ue{static castAsNonUtf8Char(n,i=null){const a=i?i.getName():this.ISO88591;return be.decode(new Uint8Array([n]),a)}static guessEncoding(n,i){if(i!=null&&i.get(z.CHARACTER_SET)!==void 0)return i.get(z.CHARACTER_SET).toString();const a=n.length;let c=!0,d=!0,h=!0,m=0,p=0,y=0,b=0,_=0,R=0,L=0,B=0,F=0,H=0,q=0;const ee=n.length>3&&n[0]===239&&n[1]===187&&n[2]===191;for(let re=0;re<a&&(c||d||h);re++){const Z=n[re]&255;h&&(m>0?Z&128?m--:h=!1:Z&128&&(Z&64?(m++,Z&32?(m++,Z&16?(m++,Z&8?h=!1:b++):y++):p++):h=!1)),c&&(Z>127&&Z<160?c=!1:Z>159&&(Z<192||Z===215||Z===247)&&q++),d&&(_>0?Z<64||Z===127||Z>252?d=!1:_--:Z===128||Z===160||Z>239?d=!1:Z>160&&Z<224?(R++,B=0,L++,L>F&&(F=L)):Z>127?(_++,L=0,B++,B>H&&(H=B)):(L=0,B=0))}return h&&m>0&&(h=!1),d&&_>0&&(d=!1),h&&(ee||p+y+b>0)?ue.UTF8:d&&(ue.ASSUME_SHIFT_JIS||F>=3||H>=3)?ue.SHIFT_JIS:c&&d?F===2&&R===2||q*10>=a?ue.SHIFT_JIS:ue.ISO88591:c?ue.ISO88591:d?ue.SHIFT_JIS:h?ue.UTF8:ue.PLATFORM_DEFAULT_ENCODING}static format(n,...i){let a=-1;function c(h,m,p,y,b,_){if(h==="%%")return"%";if(i[++a]===void 0)return;h=y?parseInt(y.substr(1)):void 0;let R=b?parseInt(b.substr(1)):void 0,L;switch(_){case"s":L=i[a];break;case"c":L=i[a][0];break;case"f":L=parseFloat(i[a]).toFixed(h);break;case"p":L=parseFloat(i[a]).toPrecision(h);break;case"e":L=parseFloat(i[a]).toExponential(h);break;case"x":L=parseInt(i[a]).toString(R||16);break;case"d":L=parseFloat(parseInt(i[a],R||10).toPrecision(h)).toFixed(0);break}L=typeof L=="object"?JSON.stringify(L):(+L).toString(R);let B=parseInt(p),F=p&&p[0]+""=="0"?"0":" ";for(;L.length<B;)L=m!==void 0?L+F:F+L;return L}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return n.replace(d,c)}static getBytes(n,i){return be.encode(n,i)}static getCharCode(n,i=0){return n.charCodeAt(i)}static getCharAt(n){return String.fromCharCode(n)}}ue.SHIFT_JIS=G.SJIS.getName(),ue.GB2312="GB2312",ue.ISO88591=G.ISO8859_1.getName(),ue.EUC_JP="EUC_JP",ue.UTF8=G.UTF8.getName(),ue.PLATFORM_DEFAULT_ENCODING=ue.UTF8,ue.ASSUME_SHIFT_JIS=!1;class Ne{constructor(n=""){this.value=n}enableDecoding(n){return this.encoding=n,this}append(n){return typeof n=="string"?this.value+=n.toString():this.encoding?this.value+=ue.castAsNonUtf8Char(n,this.encoding):this.value+=String.fromCharCode(n),this}appendChars(n,i,a){for(let c=i;i<i+a;c++)this.append(n[c]);return this}length(){return this.value.length}charAt(n){return this.value.charAt(n)}deleteCharAt(n){this.value=this.value.substr(0,n)+this.value.substring(n+1)}setCharAt(n,i){this.value=this.value.substr(0,n)+i+this.value.substr(n+1)}substring(n,i){return this.value.substring(n,i)}setLengthToZero(){this.value=""}toString(){return this.value}insert(n,i){this.value=this.value.substr(0,n)+i+this.value.substr(n+i.length)}}class We{constructor(n,i,a,c){if(this.width=n,this.height=i,this.rowSize=a,this.bits=c,i==null&&(i=n),this.height=i,n<1||i<1)throw new E("Both dimensions must be greater than 0");a==null&&(a=Math.floor((n+31)/32)),this.rowSize=a,c==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(n){const i=n.length,a=n[0].length,c=new We(a,i);for(let d=0;d<i;d++){const h=n[d];for(let m=0;m<a;m++)h[m]&&c.set(m,d)}return c}static parseFromString(n,i,a){if(n===null)throw new E("stringRepresentation cannot be null");const c=new Array(n.length);let d=0,h=0,m=-1,p=0,y=0;for(;y<n.length;)if(n.charAt(y)===`
`||n.charAt(y)==="\r"){if(d>h){if(m===-1)m=d-h;else if(d-h!==m)throw new E("row lengths do not match");h=d,p++}y++}else if(n.substring(y,y+i.length)===i)y+=i.length,c[d]=!0,d++;else if(n.substring(y,y+a.length)===a)y+=a.length,c[d]=!1,d++;else throw new E("illegal character encountered: "+n.substring(y));if(d>h){if(m===-1)m=d-h;else if(d-h!==m)throw new E("row lengths do not match");p++}const b=new We(m,p);for(let _=0;_<d;_++)c[_]&&b.set(Math.floor(_%m),Math.floor(_/m));return b}get(n,i){const a=i*this.rowSize+Math.floor(n/32);return(this.bits[a]>>>(n&31)&1)!==0}set(n,i){const a=i*this.rowSize+Math.floor(n/32);this.bits[a]|=1<<(n&31)&4294967295}unset(n,i){const a=i*this.rowSize+Math.floor(n/32);this.bits[a]&=~(1<<(n&31)&4294967295)}flip(n,i){const a=i*this.rowSize+Math.floor(n/32);this.bits[a]^=1<<(n&31)&4294967295}xor(n){if(this.width!==n.getWidth()||this.height!==n.getHeight()||this.rowSize!==n.getRowSize())throw new E("input matrix dimensions do not match");const i=new O(Math.floor(this.width/32)+1),a=this.rowSize,c=this.bits;for(let d=0,h=this.height;d<h;d++){const m=d*a,p=n.getRow(d,i).getBitArray();for(let y=0;y<a;y++)c[m+y]^=p[y]}}clear(){const n=this.bits,i=n.length;for(let a=0;a<i;a++)n[a]=0}setRegion(n,i,a,c){if(i<0||n<0)throw new E("Left and top must be nonnegative");if(c<1||a<1)throw new E("Height and width must be at least 1");const d=n+a,h=i+c;if(h>this.height||d>this.width)throw new E("The region must fit inside the matrix");const m=this.rowSize,p=this.bits;for(let y=i;y<h;y++){const b=y*m;for(let _=n;_<d;_++)p[b+Math.floor(_/32)]|=1<<(_&31)&4294967295}}getRow(n,i){i==null||i.getSize()<this.width?i=new O(this.width):i.clear();const a=this.rowSize,c=this.bits,d=n*a;for(let h=0;h<a;h++)i.setBulk(h*32,c[d+h]);return i}setRow(n,i){j.arraycopy(i.getBitArray(),0,this.bits,n*this.rowSize,this.rowSize)}rotate180(){const n=this.getWidth(),i=this.getHeight();let a=new O(n),c=new O(n);for(let d=0,h=Math.floor((i+1)/2);d<h;d++)a=this.getRow(d,a),c=this.getRow(i-1-d,c),a.reverse(),c.reverse(),this.setRow(d,c),this.setRow(i-1-d,a)}getEnclosingRectangle(){const n=this.width,i=this.height,a=this.rowSize,c=this.bits;let d=n,h=i,m=-1,p=-1;for(let y=0;y<i;y++)for(let b=0;b<a;b++){const _=c[y*a+b];if(_!==0){if(y<h&&(h=y),y>p&&(p=y),b*32<d){let R=0;for(;!(_<<31-R&4294967295);)R++;b*32+R<d&&(d=b*32+R)}if(b*32+31>m){let R=31;for(;!(_>>>R);)R--;b*32+R>m&&(m=b*32+R)}}}return m<d||p<h?null:Int32Array.from([d,h,m-d+1,p-h+1])}getTopLeftOnBit(){const n=this.rowSize,i=this.bits;let a=0;for(;a<i.length&&i[a]===0;)a++;if(a===i.length)return null;const c=a/n;let d=a%n*32;const h=i[a];let m=0;for(;!(h<<31-m&4294967295);)m++;return d+=m,Int32Array.from([d,c])}getBottomRightOnBit(){const n=this.rowSize,i=this.bits;let a=i.length-1;for(;a>=0&&i[a]===0;)a--;if(a<0)return null;const c=Math.floor(a/n);let d=Math.floor(a%n)*32;const h=i[a];let m=31;for(;!(h>>>m);)m--;return d+=m,Int32Array.from([d,c])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(n){if(!(n instanceof We))return!1;const i=n;return this.width===i.width&&this.height===i.height&&this.rowSize===i.rowSize&&C.equals(this.bits,i.bits)}hashCode(){let n=this.width;return n=31*n+this.width,n=31*n+this.height,n=31*n+this.rowSize,n=31*n+C.hashCode(this.bits),n}toString(n="X ",i="  ",a=`
`){return this.buildToString(n,i,a)}buildToString(n,i,a){let c=new Ne;for(let d=0,h=this.height;d<h;d++){for(let m=0,p=this.width;m<p;m++)c.append(this.get(m,d)?n:i);c.append(a)}return c.toString()}clone(){return new We(this.width,this.height,this.rowSize,this.bits.slice())}}class Y extends x{static getNotFoundInstance(){return new Y}}Y.kind="NotFoundException";class Ye extends k{constructor(n){super(n),this.luminances=Ye.EMPTY,this.buckets=new Int32Array(Ye.LUMINANCE_BUCKETS)}getBlackRow(n,i){const a=this.getLuminanceSource(),c=a.getWidth();i==null||i.getSize()<c?i=new O(c):i.clear(),this.initArrays(c);const d=a.getRow(n,this.luminances),h=this.buckets;for(let p=0;p<c;p++)h[(d[p]&255)>>Ye.LUMINANCE_SHIFT]++;const m=Ye.estimateBlackPoint(h);if(c<3)for(let p=0;p<c;p++)(d[p]&255)<m&&i.set(p);else{let p=d[0]&255,y=d[1]&255;for(let b=1;b<c-1;b++){const _=d[b+1]&255;(y*4-p-_)/2<m&&i.set(b),p=y,y=_}}return i}getBlackMatrix(){const n=this.getLuminanceSource(),i=n.getWidth(),a=n.getHeight(),c=new We(i,a);this.initArrays(i);const d=this.buckets;for(let p=1;p<5;p++){const y=Math.floor(a*p/5),b=n.getRow(y,this.luminances),_=Math.floor(i*4/5);for(let R=Math.floor(i/5);R<_;R++){const L=b[R]&255;d[L>>Ye.LUMINANCE_SHIFT]++}}const h=Ye.estimateBlackPoint(d),m=n.getMatrix();for(let p=0;p<a;p++){const y=p*i;for(let b=0;b<i;b++)(m[y+b]&255)<h&&c.set(b,p)}return c}createBinarizer(n){return new Ye(n)}initArrays(n){this.luminances.length<n&&(this.luminances=new Uint8ClampedArray(n));const i=this.buckets;for(let a=0;a<Ye.LUMINANCE_BUCKETS;a++)i[a]=0}static estimateBlackPoint(n){const i=n.length;let a=0,c=0,d=0;for(let b=0;b<i;b++)n[b]>d&&(c=b,d=n[b]),n[b]>a&&(a=n[b]);let h=0,m=0;for(let b=0;b<i;b++){const _=b-c,R=n[b]*_*_;R>m&&(h=b,m=R)}if(c>h){const b=c;c=h,h=b}if(h-c<=i/16)throw new Y;let p=h-1,y=-1;for(let b=h-1;b>c;b--){const _=b-c,R=_*_*(h-b)*(a-n[b]);R>y&&(p=b,y=R)}return p<<Ye.LUMINANCE_SHIFT}}Ye.LUMINANCE_BITS=5,Ye.LUMINANCE_SHIFT=8-Ye.LUMINANCE_BITS,Ye.LUMINANCE_BUCKETS=1<<Ye.LUMINANCE_BITS,Ye.EMPTY=Uint8ClampedArray.from([0]);class Ee extends Ye{constructor(n){super(n),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const n=this.getLuminanceSource(),i=n.getWidth(),a=n.getHeight();if(i>=Ee.MINIMUM_DIMENSION&&a>=Ee.MINIMUM_DIMENSION){const c=n.getMatrix();let d=i>>Ee.BLOCK_SIZE_POWER;i&Ee.BLOCK_SIZE_MASK&&d++;let h=a>>Ee.BLOCK_SIZE_POWER;a&Ee.BLOCK_SIZE_MASK&&h++;const m=Ee.calculateBlackPoints(c,d,h,i,a),p=new We(i,a);Ee.calculateThresholdForBlock(c,d,h,i,a,m,p),this.matrix=p}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(n){return new Ee(n)}static calculateThresholdForBlock(n,i,a,c,d,h,m){const p=d-Ee.BLOCK_SIZE,y=c-Ee.BLOCK_SIZE;for(let b=0;b<a;b++){let _=b<<Ee.BLOCK_SIZE_POWER;_>p&&(_=p);const R=Ee.cap(b,2,a-3);for(let L=0;L<i;L++){let B=L<<Ee.BLOCK_SIZE_POWER;B>y&&(B=y);const F=Ee.cap(L,2,i-3);let H=0;for(let ee=-2;ee<=2;ee++){const re=h[R+ee];H+=re[F-2]+re[F-1]+re[F]+re[F+1]+re[F+2]}const q=H/25;Ee.thresholdBlock(n,B,_,q,c,m)}}}static cap(n,i,a){return n<i?i:n>a?a:n}static thresholdBlock(n,i,a,c,d,h){for(let m=0,p=a*d+i;m<Ee.BLOCK_SIZE;m++,p+=d)for(let y=0;y<Ee.BLOCK_SIZE;y++)(n[p+y]&255)<=c&&h.set(i+y,a+m)}static calculateBlackPoints(n,i,a,c,d){const h=d-Ee.BLOCK_SIZE,m=c-Ee.BLOCK_SIZE,p=new Array(a);for(let y=0;y<a;y++){p[y]=new Int32Array(i);let b=y<<Ee.BLOCK_SIZE_POWER;b>h&&(b=h);for(let _=0;_<i;_++){let R=_<<Ee.BLOCK_SIZE_POWER;R>m&&(R=m);let L=0,B=255,F=0;for(let q=0,ee=b*c+R;q<Ee.BLOCK_SIZE;q++,ee+=c){for(let re=0;re<Ee.BLOCK_SIZE;re++){const Z=n[ee+re]&255;L+=Z,Z<B&&(B=Z),Z>F&&(F=Z)}if(F-B>Ee.MIN_DYNAMIC_RANGE)for(q++,ee+=c;q<Ee.BLOCK_SIZE;q++,ee+=c)for(let re=0;re<Ee.BLOCK_SIZE;re++)L+=n[ee+re]&255}let H=L>>Ee.BLOCK_SIZE_POWER*2;if(F-B<=Ee.MIN_DYNAMIC_RANGE&&(H=B/2,y>0&&_>0)){const q=(p[y-1][_]+2*p[y][_-1]+p[y-1][_-1])/4;B<q&&(H=q)}p[y][_]=H}}return p}}Ee.BLOCK_SIZE_POWER=3,Ee.BLOCK_SIZE=1<<Ee.BLOCK_SIZE_POWER,Ee.BLOCK_SIZE_MASK=Ee.BLOCK_SIZE-1,Ee.MINIMUM_DIMENSION=Ee.BLOCK_SIZE*5,Ee.MIN_DYNAMIC_RANGE=24;class ie{constructor(n,i){this.width=n,this.height=i}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(n,i,a,c){throw new te("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new te("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new te("This luminance source does not support rotation by 45 degrees.")}toString(){const n=new Uint8ClampedArray(this.width);let i=new Ne;for(let a=0;a<this.height;a++){const c=this.getRow(a,n);for(let d=0;d<this.width;d++){const h=c[d]&255;let m;h<64?m="#":h<128?m="+":h<192?m=".":m=" ",i.append(m)}i.append(`
`)}return i.toString()}}class xe extends ie{constructor(n){super(n.getWidth(),n.getHeight()),this.delegate=n}getRow(n,i){const a=this.delegate.getRow(n,i),c=this.getWidth();for(let d=0;d<c;d++)a[d]=255-(a[d]&255);return a}getMatrix(){const n=this.delegate.getMatrix(),i=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(i);for(let c=0;c<i;c++)a[c]=255-(n[c]&255);return a}isCropSupported(){return this.delegate.isCropSupported()}crop(n,i,a,c){return new xe(this.delegate.crop(n,i,a,c))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new xe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new xe(this.delegate.rotateCounterClockwise45())}}class ye extends ie{constructor(n){super(n.width,n.height),this.canvas=n,this.tempCanvasElement=null,this.buffer=ye.makeBufferFromCanvasImageData(n)}static makeBufferFromCanvasImageData(n){const i=n.getContext("2d").getImageData(0,0,n.width,n.height);return ye.toGrayscaleBuffer(i.data,n.width,n.height)}static toGrayscaleBuffer(n,i,a){const c=new Uint8ClampedArray(i*a);for(let d=0,h=0,m=n.length;d<m;d+=4,h++){let p;if(n[d+3]===0)p=255;else{const b=n[d],_=n[d+1],R=n[d+2];p=306*b+601*_+117*R+512>>10}c[h]=p}return c}getRow(n,i){if(n<0||n>=this.getHeight())throw new E("Requested row is outside the image: "+n);const a=this.getWidth(),c=n*a;return i===null?i=this.buffer.slice(c,c+a):(i.length<a&&(i=new Uint8ClampedArray(a)),i.set(this.buffer.slice(c,c+a))),i}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(n,i,a,c){return super.crop(n,i,a,c),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const n=this.canvas.ownerDocument.createElement("canvas");n.width=this.canvas.width,n.height=this.canvas.height,this.tempCanvasElement=n}return this.tempCanvasElement}rotate(n){const i=this.getTempCanvasElement(),a=i.getContext("2d"),c=n*ye.DEGREE_TO_RADIANS,d=this.canvas.width,h=this.canvas.height,m=Math.ceil(Math.abs(Math.cos(c))*d+Math.abs(Math.sin(c))*h),p=Math.ceil(Math.abs(Math.sin(c))*d+Math.abs(Math.cos(c))*h);return i.width=m,i.height=p,a.translate(m/2,p/2),a.rotate(c),a.drawImage(this.canvas,d/-2,h/-2),this.buffer=ye.makeBufferFromCanvasImageData(i),this}invert(){return new xe(this)}}ye.DEGREE_TO_RADIANS=Math.PI/180;class qe{constructor(n,i,a){this.deviceId=n,this.label=i,this.kind="videoinput",this.groupId=a||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var je=(globalThis||ha||self||window||void 0)&&(globalThis||ha||self||window||void 0).__awaiter||function(N,n,i,a){function c(d){return d instanceof i?d:new i(function(h){h(d)})}return new(i||(i=Promise))(function(d,h){function m(b){try{y(a.next(b))}catch(_){h(_)}}function p(b){try{y(a.throw(b))}catch(_){h(_)}}function y(b){b.done?d(b.value):c(b.value).then(m,p)}y((a=a.apply(N,n||[])).next())})};class Dt{constructor(n,i=500,a){this.reader=n,this.timeBetweenScansMillis=i,this._hints=a,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(n){this._timeBetweenDecodingAttempts=n<0?0:n}set hints(n){this._hints=n||null}get hints(){return this._hints}listVideoInputDevices(){return je(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const n=yield navigator.mediaDevices.enumerateDevices(),i=[];for(const a of n){const c=a.kind==="video"?"videoinput":a.kind;if(c!=="videoinput")continue;const d=a.deviceId||a.id,h=a.label||`Video device ${i.length+1}`,m=a.groupId,p={deviceId:d,label:h,kind:c,groupId:m};i.push(p)}return i})}getVideoInputDevices(){return je(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(i=>new qe(i.deviceId,i.label))})}findDeviceById(n){return je(this,void 0,void 0,function*(){const i=yield this.listVideoInputDevices();return i?i.find(a=>a.deviceId===n):null})}decodeFromInputVideoDevice(n,i){return je(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(n,i)})}decodeOnceFromVideoDevice(n,i){return je(this,void 0,void 0,function*(){this.reset();let a;n?a={deviceId:{exact:n}}:a={facingMode:"environment"};const c={video:a};return yield this.decodeOnceFromConstraints(c,i)})}decodeOnceFromConstraints(n,i){return je(this,void 0,void 0,function*(){const a=yield navigator.mediaDevices.getUserMedia(n);return yield this.decodeOnceFromStream(a,i)})}decodeOnceFromStream(n,i){return je(this,void 0,void 0,function*(){this.reset();const a=yield this.attachStreamToVideo(n,i);return yield this.decodeOnce(a)})}decodeFromInputVideoDeviceContinuously(n,i,a){return je(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(n,i,a)})}decodeFromVideoDevice(n,i,a){return je(this,void 0,void 0,function*(){let c;n?c={deviceId:{exact:n}}:c={facingMode:"environment"};const d={video:c};return yield this.decodeFromConstraints(d,i,a)})}decodeFromConstraints(n,i,a){return je(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(n);return yield this.decodeFromStream(c,i,a)})}decodeFromStream(n,i,a){return je(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(n,i);return yield this.decodeContinuously(c,a)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(n,i){return je(this,void 0,void 0,function*(){const a=this.prepareVideoElement(i);return this.addVideoSource(a,n),this.videoElement=a,this.stream=n,yield this.playVideoOnLoadAsync(a),a})}playVideoOnLoadAsync(n){return new Promise((i,a)=>this.playVideoOnLoad(n,()=>i()))}playVideoOnLoad(n,i){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(n),n.addEventListener("ended",this.videoEndedListener),n.addEventListener("canplay",this.videoCanPlayListener),n.addEventListener("playing",i),this.tryPlayVideo(n)}isVideoPlaying(n){return n.currentTime>0&&!n.paused&&!n.ended&&n.readyState>2}tryPlayVideo(n){return je(this,void 0,void 0,function*(){if(this.isVideoPlaying(n)){console.warn("Trying to play video that is already playing.");return}try{yield n.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(n,i){const a=document.getElementById(n);if(!a)throw new v(`element with id '${n}' not found`);if(a.nodeName.toLowerCase()!==i.toLowerCase())throw new v(`element with id '${n}' must be an ${i} element`);return a}decodeFromImage(n,i){if(!n&&!i)throw new v("either imageElement with a src set or an url must be provided");return i&&!n?this.decodeFromImageUrl(i):this.decodeFromImageElement(n)}decodeFromVideo(n,i){if(!n&&!i)throw new v("Either an element with a src set or an URL must be provided");return i&&!n?this.decodeFromVideoUrl(i):this.decodeFromVideoElement(n)}decodeFromVideoContinuously(n,i,a){if(n===void 0&&i===void 0)throw new v("Either an element with a src set or an URL must be provided");return i&&!n?this.decodeFromVideoUrlContinuously(i,a):this.decodeFromVideoElementContinuously(n,a)}decodeFromImageElement(n){if(!n)throw new v("An image element must be provided.");this.reset();const i=this.prepareImageElement(n);this.imageElement=i;let a;return this.isImageLoaded(i)?a=this.decodeOnce(i,!1,!0):a=this._decodeOnLoadImage(i),a}decodeFromVideoElement(n){const i=this._decodeFromVideoElementSetup(n);return this._decodeOnLoadVideo(i)}decodeFromVideoElementContinuously(n,i){const a=this._decodeFromVideoElementSetup(n);return this._decodeOnLoadVideoContinuously(a,i)}_decodeFromVideoElementSetup(n){if(!n)throw new v("A video element must be provided.");this.reset();const i=this.prepareVideoElement(n);return this.videoElement=i,i}decodeFromImageUrl(n){if(!n)throw new v("An URL must be provided.");this.reset();const i=this.prepareImageElement();this.imageElement=i;const a=this._decodeOnLoadImage(i);return i.src=n,a}decodeFromVideoUrl(n){if(!n)throw new v("An URL must be provided.");this.reset();const i=this.prepareVideoElement(),a=this.decodeFromVideoElement(i);return i.src=n,a}decodeFromVideoUrlContinuously(n,i){if(!n)throw new v("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),c=this.decodeFromVideoElementContinuously(a,i);return a.src=n,c}_decodeOnLoadImage(n){return new Promise((i,a)=>{this.imageLoadedListener=()=>this.decodeOnce(n,!1,!0).then(i,a),n.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(n){return je(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(n),yield this.decodeOnce(n)})}_decodeOnLoadVideoContinuously(n,i){return je(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(n),this.decodeContinuously(n,i)})}isImageLoaded(n){return!(!n.complete||n.naturalWidth===0)}prepareImageElement(n){let i;return typeof n>"u"&&(i=document.createElement("img"),i.width=200,i.height=200),typeof n=="string"&&(i=this.getMediaElement(n,"img")),n instanceof HTMLImageElement&&(i=n),i}prepareVideoElement(n){let i;return!n&&typeof document<"u"&&(i=document.createElement("video"),i.width=200,i.height=200),typeof n=="string"&&(i=this.getMediaElement(n,"video")),n instanceof HTMLVideoElement&&(i=n),i.setAttribute("autoplay","true"),i.setAttribute("muted","true"),i.setAttribute("playsinline","true"),i}decodeOnce(n,i=!0,a=!0){this._stopAsyncDecode=!1;const c=(d,h)=>{if(this._stopAsyncDecode){h(new Y("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const m=this.decode(n);d(m)}catch(m){const p=i&&m instanceof Y,b=(m instanceof I||m instanceof U)&&a;if(p||b)return setTimeout(c,this._timeBetweenDecodingAttempts,d,h);h(m)}};return new Promise((d,h)=>c(d,h))}decodeContinuously(n,i){this._stopContinuousDecode=!1;const a=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const c=this.decode(n);i(c,null),setTimeout(a,this.timeBetweenScansMillis)}catch(c){i(null,c);const d=c instanceof I||c instanceof U,h=c instanceof Y;(d||h)&&setTimeout(a,this._timeBetweenDecodingAttempts)}};a()}decode(n){const i=this.createBinaryBitmap(n);return this.decodeBitmap(i)}_isHTMLVideoElement(n){return n.videoWidth!==0}drawFrameOnCanvas(n,i,a){i||(i={sx:0,sy:0,sWidth:n.videoWidth,sHeight:n.videoHeight,dx:0,dy:0,dWidth:n.videoWidth,dHeight:n.videoHeight}),a||(a=this.captureCanvasContext),a.drawImage(n,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}drawImageOnCanvas(n,i,a=this.captureCanvasContext){i||(i={sx:0,sy:0,sWidth:n.naturalWidth,sHeight:n.naturalHeight,dx:0,dy:0,dWidth:n.naturalWidth,dHeight:n.naturalHeight}),a||(a=this.captureCanvasContext),a.drawImage(n,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}createBinaryBitmap(n){this.getCaptureCanvasContext(n),this._isHTMLVideoElement(n)?this.drawFrameOnCanvas(n):this.drawImageOnCanvas(n);const i=this.getCaptureCanvas(n),a=new ye(i),c=new Ee(a);return new S(c)}getCaptureCanvasContext(n){if(!this.captureCanvasContext){const a=this.getCaptureCanvas(n).getContext("2d");this.captureCanvasContext=a}return this.captureCanvasContext}getCaptureCanvas(n){if(!this.captureCanvas){const i=this.createCaptureCanvas(n);this.captureCanvas=i}return this.captureCanvas}decodeBitmap(n){return this.reader.decode(n,this._hints)}createCaptureCanvas(n){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const i=document.createElement("canvas");let a,c;return typeof n<"u"&&(n instanceof HTMLVideoElement?(a=n.videoWidth,c=n.videoHeight):n instanceof HTMLImageElement&&(a=n.naturalWidth||n.width,c=n.naturalHeight||n.height)),i.style.width=a+"px",i.style.height=c+"px",i.width=a,i.height=c,i}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(n=>n.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(n,i){try{n.srcObject=i}catch{n.src=URL.createObjectURL(i)}}cleanVideoSource(n){try{n.srcObject=null}catch{n.src=""}this.videoElement.removeAttribute("src")}}class Ie{constructor(n,i,a=i==null?0:8*i.length,c,d,h=j.currentTimeMillis()){this.text=n,this.rawBytes=i,this.numBits=a,this.resultPoints=c,this.format=d,this.timestamp=h,this.text=n,this.rawBytes=i,a==null?this.numBits=i==null?0:8*i.length:this.numBits=a,this.resultPoints=c,this.format=d,this.resultMetadata=null,h==null?this.timestamp=j.currentTimeMillis():this.timestamp=h}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(n,i){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(n,i)}putAllMetadata(n){n!==null&&(this.resultMetadata===null?this.resultMetadata=n:this.resultMetadata=new Map(n))}addResultPoints(n){const i=this.resultPoints;if(i===null)this.resultPoints=n;else if(n!==null&&n.length>0){const a=new Array(i.length+n.length);j.arraycopy(i,0,a,0,i.length),j.arraycopy(n,0,a,i.length,n.length),this.resultPoints=a}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Q;(function(N){N[N.AZTEC=0]="AZTEC",N[N.CODABAR=1]="CODABAR",N[N.CODE_39=2]="CODE_39",N[N.CODE_93=3]="CODE_93",N[N.CODE_128=4]="CODE_128",N[N.DATA_MATRIX=5]="DATA_MATRIX",N[N.EAN_8=6]="EAN_8",N[N.EAN_13=7]="EAN_13",N[N.ITF=8]="ITF",N[N.MAXICODE=9]="MAXICODE",N[N.PDF_417=10]="PDF_417",N[N.QR_CODE=11]="QR_CODE",N[N.RSS_14=12]="RSS_14",N[N.RSS_EXPANDED=13]="RSS_EXPANDED",N[N.UPC_A=14]="UPC_A",N[N.UPC_E=15]="UPC_E",N[N.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Q||(Q={}));var se=Q,Mr;(function(N){N[N.OTHER=0]="OTHER",N[N.ORIENTATION=1]="ORIENTATION",N[N.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",N[N.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",N[N.ISSUE_NUMBER=4]="ISSUE_NUMBER",N[N.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",N[N.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",N[N.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",N[N.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",N[N.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",N[N.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Mr||(Mr={}));var Ue=Mr;class Gr{constructor(n,i,a,c,d=-1,h=-1){this.rawBytes=n,this.text=i,this.byteSegments=a,this.ecLevel=c,this.structuredAppendSequenceNumber=d,this.structuredAppendParity=h,this.numBits=n==null?0:8*n.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(n){this.numBits=n}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(n){this.errorsCorrected=n}getErasures(){return this.erasures}setErasures(n){this.erasures=n}getOther(){return this.other}setOther(n){this.other=n}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Es{exp(n){return this.expTable[n]}log(n){if(n===0)throw new E;return this.logTable[n]}static addOrSubtract(n,i){return n^i}}class or{constructor(n,i){if(i.length===0)throw new E;this.field=n;const a=i.length;if(a>1&&i[0]===0){let c=1;for(;c<a&&i[c]===0;)c++;c===a?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(a-c),j.arraycopy(i,c,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(n){return this.coefficients[this.coefficients.length-1-n]}evaluateAt(n){if(n===0)return this.getCoefficient(0);const i=this.coefficients;let a;if(n===1){a=0;for(let h=0,m=i.length;h!==m;h++){const p=i[h];a=Es.addOrSubtract(a,p)}return a}a=i[0];const c=i.length,d=this.field;for(let h=1;h<c;h++)a=Es.addOrSubtract(d.multiply(n,a),i[h]);return a}addOrSubtract(n){if(!this.field.equals(n.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero())return n;if(n.isZero())return this;let i=this.coefficients,a=n.coefficients;if(i.length>a.length){const h=i;i=a,a=h}let c=new Int32Array(a.length);const d=a.length-i.length;j.arraycopy(a,0,c,0,d);for(let h=d;h<a.length;h++)c[h]=Es.addOrSubtract(i[h-d],a[h]);return new or(this.field,c)}multiply(n){if(!this.field.equals(n.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero()||n.isZero())return this.field.getZero();const i=this.coefficients,a=i.length,c=n.coefficients,d=c.length,h=new Int32Array(a+d-1),m=this.field;for(let p=0;p<a;p++){const y=i[p];for(let b=0;b<d;b++)h[p+b]=Es.addOrSubtract(h[p+b],m.multiply(y,c[b]))}return new or(m,h)}multiplyScalar(n){if(n===0)return this.field.getZero();if(n===1)return this;const i=this.coefficients.length,a=this.field,c=new Int32Array(i),d=this.coefficients;for(let h=0;h<i;h++)c[h]=a.multiply(d[h],n);return new or(a,c)}multiplyByMonomial(n,i){if(n<0)throw new E;if(i===0)return this.field.getZero();const a=this.coefficients,c=a.length,d=new Int32Array(c+n),h=this.field;for(let m=0;m<c;m++)d[m]=h.multiply(a[m],i);return new or(h,d)}divide(n){if(!this.field.equals(n.field))throw new E("GenericGFPolys do not have same GenericGF field");if(n.isZero())throw new E("Divide by 0");const i=this.field;let a=i.getZero(),c=this;const d=n.getCoefficient(n.getDegree()),h=i.inverse(d);for(;c.getDegree()>=n.getDegree()&&!c.isZero();){const m=c.getDegree()-n.getDegree(),p=i.multiply(c.getCoefficient(c.getDegree()),h),y=n.multiplyByMonomial(m,p),b=i.buildMonomial(m,p);a=a.addOrSubtract(b),c=c.addOrSubtract(y)}return[a,c]}toString(){let n="";for(let i=this.getDegree();i>=0;i--){let a=this.getCoefficient(i);if(a!==0){if(a<0?(n+=" - ",a=-a):n.length>0&&(n+=" + "),i===0||a!==1){const c=this.field.log(a);c===0?n+="1":c===1?n+="a":(n+="a^",n+=c)}i!==0&&(i===1?n+="x":(n+="x^",n+=i))}}return n}}class wo extends x{}wo.kind="ArithmeticException";class Le extends Es{constructor(n,i,a){super(),this.primitive=n,this.size=i,this.generatorBase=a;const c=new Int32Array(i);let d=1;for(let m=0;m<i;m++)c[m]=d,d*=2,d>=i&&(d^=n,d&=i-1);this.expTable=c;const h=new Int32Array(i);for(let m=0;m<i-1;m++)h[c[m]]=m;this.logTable=h,this.zero=new or(this,Int32Array.from([0])),this.one=new or(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(n,i){if(n<0)throw new E;if(i===0)return this.zero;const a=new Int32Array(n+1);return a[0]=i,new or(this,a)}inverse(n){if(n===0)throw new wo;return this.expTable[this.size-this.logTable[n]-1]}multiply(n,i){return n===0||i===0?0:this.expTable[(this.logTable[n]+this.logTable[i])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+T.toHexString(this.primitive)+","+this.size+")"}equals(n){return n===this}}Le.AZTEC_DATA_12=new Le(4201,4096,1),Le.AZTEC_DATA_10=new Le(1033,1024,1),Le.AZTEC_DATA_6=new Le(67,64,1),Le.AZTEC_PARAM=new Le(19,16,1),Le.QR_CODE_FIELD_256=new Le(285,256,0),Le.DATA_MATRIX_FIELD_256=new Le(301,256,1),Le.AZTEC_DATA_8=Le.DATA_MATRIX_FIELD_256,Le.MAXICODE_FIELD_64=Le.AZTEC_DATA_6;class Js extends x{}Js.kind="ReedSolomonException";class dn extends x{}dn.kind="IllegalStateException";class ra{constructor(n){this.field=n}decode(n,i){const a=this.field,c=new or(a,n),d=new Int32Array(i);let h=!0;for(let L=0;L<i;L++){const B=c.evaluateAt(a.exp(L+a.getGeneratorBase()));d[d.length-1-L]=B,B!==0&&(h=!1)}if(h)return;const m=new or(a,d),p=this.runEuclideanAlgorithm(a.buildMonomial(i,1),m,i),y=p[0],b=p[1],_=this.findErrorLocations(y),R=this.findErrorMagnitudes(b,_);for(let L=0;L<_.length;L++){const B=n.length-1-a.log(_[L]);if(B<0)throw new Js("Bad error location");n[B]=Le.addOrSubtract(n[B],R[L])}}runEuclideanAlgorithm(n,i,a){if(n.getDegree()<i.getDegree()){const L=n;n=i,i=L}const c=this.field;let d=n,h=i,m=c.getZero(),p=c.getOne();for(;h.getDegree()>=(a/2|0);){let L=d,B=m;if(d=h,m=p,d.isZero())throw new Js("r_{i-1} was zero");h=L;let F=c.getZero();const H=d.getCoefficient(d.getDegree()),q=c.inverse(H);for(;h.getDegree()>=d.getDegree()&&!h.isZero();){const ee=h.getDegree()-d.getDegree(),re=c.multiply(h.getCoefficient(h.getDegree()),q);F=F.addOrSubtract(c.buildMonomial(ee,re)),h=h.addOrSubtract(d.multiplyByMonomial(ee,re))}if(p=F.multiply(m).addOrSubtract(B),h.getDegree()>=d.getDegree())throw new dn("Division algorithm failed to reduce polynomial?")}const y=p.getCoefficient(0);if(y===0)throw new Js("sigmaTilde(0) was zero");const b=c.inverse(y),_=p.multiplyScalar(b),R=h.multiplyScalar(b);return[_,R]}findErrorLocations(n){const i=n.getDegree();if(i===1)return Int32Array.from([n.getCoefficient(1)]);const a=new Int32Array(i);let c=0;const d=this.field;for(let h=1;h<d.getSize()&&c<i;h++)n.evaluateAt(h)===0&&(a[c]=d.inverse(h),c++);if(c!==i)throw new Js("Error locator degree does not match number of roots");return a}findErrorMagnitudes(n,i){const a=i.length,c=new Int32Array(a),d=this.field;for(let h=0;h<a;h++){const m=d.inverse(i[h]);let p=1;for(let y=0;y<a;y++)if(h!==y){const b=d.multiply(i[y],m),_=b&1?b&-2:b|1;p=d.multiply(p,_)}c[h]=d.multiply(n.evaluateAt(m),d.inverse(p)),d.getGeneratorBase()!==0&&(c[h]=d.multiply(c[h],m))}return c}}var Lt;(function(N){N[N.UPPER=0]="UPPER",N[N.LOWER=1]="LOWER",N[N.MIXED=2]="MIXED",N[N.DIGIT=3]="DIGIT",N[N.PUNCT=4]="PUNCT",N[N.BINARY=5]="BINARY"})(Lt||(Lt={}));class Ke{decode(n){this.ddata=n;let i=n.getBits(),a=this.extractBits(i),c=this.correctBits(a),d=Ke.convertBoolArrayToByteArray(c),h=Ke.getEncodedData(c),m=new Gr(d,h,null,null);return m.setNumBits(c.length),m}static highLevelDecode(n){return this.getEncodedData(n)}static getEncodedData(n){let i=n.length,a=Lt.UPPER,c=Lt.UPPER,d="",h=0;for(;h<i;)if(c===Lt.BINARY){if(i-h<5)break;let m=Ke.readCode(n,h,5);if(h+=5,m===0){if(i-h<11)break;m=Ke.readCode(n,h,11)+31,h+=11}for(let p=0;p<m;p++){if(i-h<8){h=i;break}const y=Ke.readCode(n,h,8);d+=ue.castAsNonUtf8Char(y),h+=8}c=a}else{let m=c===Lt.DIGIT?4:5;if(i-h<m)break;let p=Ke.readCode(n,h,m);h+=m;let y=Ke.getCharacter(c,p);y.startsWith("CTRL_")?(a=c,c=Ke.getTable(y.charAt(5)),y.charAt(6)==="L"&&(a=c)):(d+=y,c=a)}return d}static getTable(n){switch(n){case"L":return Lt.LOWER;case"P":return Lt.PUNCT;case"M":return Lt.MIXED;case"D":return Lt.DIGIT;case"B":return Lt.BINARY;case"U":default:return Lt.UPPER}}static getCharacter(n,i){switch(n){case Lt.UPPER:return Ke.UPPER_TABLE[i];case Lt.LOWER:return Ke.LOWER_TABLE[i];case Lt.MIXED:return Ke.MIXED_TABLE[i];case Lt.PUNCT:return Ke.PUNCT_TABLE[i];case Lt.DIGIT:return Ke.DIGIT_TABLE[i];default:throw new dn("Bad table")}}correctBits(n){let i,a;this.ddata.getNbLayers()<=2?(a=6,i=Le.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(a=8,i=Le.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(a=10,i=Le.AZTEC_DATA_10):(a=12,i=Le.AZTEC_DATA_12);let c=this.ddata.getNbDatablocks(),d=n.length/a;if(d<c)throw new U;let h=n.length%a,m=new Int32Array(d);for(let R=0;R<d;R++,h+=a)m[R]=Ke.readCode(n,h,a);try{new ra(i).decode(m,d-c)}catch(R){throw new U(R)}let p=(1<<a)-1,y=0;for(let R=0;R<c;R++){let L=m[R];if(L===0||L===p)throw new U;(L===1||L===p-1)&&y++}let b=new Array(c*a-y),_=0;for(let R=0;R<c;R++){let L=m[R];if(L===1||L===p-1)b.fill(L>1,_,_+a-1),_+=a-1;else for(let B=a-1;B>=0;--B)b[_++]=(L&1<<B)!==0}return b}extractBits(n){let i=this.ddata.isCompact(),a=this.ddata.getNbLayers(),c=(i?11:14)+a*4,d=new Int32Array(c),h=new Array(this.totalBitsInLayer(a,i));if(i)for(let m=0;m<d.length;m++)d[m]=m;else{let m=c+1+2*T.truncDivision(T.truncDivision(c,2)-1,15),p=c/2,y=T.truncDivision(m,2);for(let b=0;b<p;b++){let _=b+T.truncDivision(b,15);d[p-b-1]=y-_-1,d[p+b]=y+_+1}}for(let m=0,p=0;m<a;m++){let y=(a-m)*4+(i?9:12),b=m*2,_=c-1-b;for(let R=0;R<y;R++){let L=R*2;for(let B=0;B<2;B++)h[p+L+B]=n.get(d[b+B],d[b+R]),h[p+2*y+L+B]=n.get(d[b+R],d[_-B]),h[p+4*y+L+B]=n.get(d[_-B],d[_-R]),h[p+6*y+L+B]=n.get(d[_-R],d[b+B])}p+=y*8}return h}static readCode(n,i,a){let c=0;for(let d=i;d<i+a;d++)c<<=1,n[d]&&(c|=1);return c}static readByte(n,i){let a=n.length-i;return a>=8?Ke.readCode(n,i,8):Ke.readCode(n,i,a)<<8-a}static convertBoolArrayToByteArray(n){let i=new Uint8Array((n.length+7)/8);for(let a=0;a<i.length;a++)i[a]=Ke.readByte(n,8*a);return i}totalBitsInLayer(n,i){return((i?88:112)+16*n)*n}}Ke.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Ke.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Ke.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Ke.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Ke.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class ke{constructor(){}static round(n){return n===NaN?0:n<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:n>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:n+(n<0?-.5:.5)|0}static distance(n,i,a,c){const d=n-a,h=i-c;return Math.sqrt(d*d+h*h)}static sum(n){let i=0;for(let a=0,c=n.length;a!==c;a++){const d=n[a];i+=d}return i}}class yo{static floatToIntBits(n){return n}}yo.MAX_VALUE=Number.MAX_SAFE_INTEGER;class de{constructor(n,i){this.x=n,this.y=i}getX(){return this.x}getY(){return this.y}equals(n){if(n instanceof de){const i=n;return this.x===i.x&&this.y===i.y}return!1}hashCode(){return 31*yo.floatToIntBits(this.x)+yo.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(n){const i=this.distance(n[0],n[1]),a=this.distance(n[1],n[2]),c=this.distance(n[0],n[2]);let d,h,m;if(a>=i&&a>=c?(h=n[0],d=n[1],m=n[2]):c>=a&&c>=i?(h=n[1],d=n[0],m=n[2]):(h=n[2],d=n[0],m=n[1]),this.crossProductZ(d,h,m)<0){const p=d;d=m,m=p}n[0]=d,n[1]=h,n[2]=m}static distance(n,i){return ke.distance(n.x,n.y,i.x,i.y)}static crossProductZ(n,i,a){const c=i.x,d=i.y;return(a.x-c)*(n.y-d)-(a.y-d)*(n.x-c)}}class vo{constructor(n,i){this.bits=n,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class Zh extends vo{constructor(n,i,a,c,d){super(n,i),this.compact=a,this.nbDatablocks=c,this.nbLayers=d}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class _n{constructor(n,i,a,c){this.image=n,this.height=n.getHeight(),this.width=n.getWidth(),i==null&&(i=_n.INIT_SIZE),a==null&&(a=n.getWidth()/2|0),c==null&&(c=n.getHeight()/2|0);const d=i/2|0;if(this.leftInit=a-d,this.rightInit=a+d,this.upInit=c-d,this.downInit=c+d,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Y}detect(){let n=this.leftInit,i=this.rightInit,a=this.upInit,c=this.downInit,d=!1,h=!0,m=!1,p=!1,y=!1,b=!1,_=!1;const R=this.width,L=this.height;for(;h;){h=!1;let B=!0;for(;(B||!p)&&i<R;)B=this.containsBlackPoint(a,c,i,!1),B?(i++,h=!0,p=!0):p||i++;if(i>=R){d=!0;break}let F=!0;for(;(F||!y)&&c<L;)F=this.containsBlackPoint(n,i,c,!0),F?(c++,h=!0,y=!0):y||c++;if(c>=L){d=!0;break}let H=!0;for(;(H||!b)&&n>=0;)H=this.containsBlackPoint(a,c,n,!1),H?(n--,h=!0,b=!0):b||n--;if(n<0){d=!0;break}let q=!0;for(;(q||!_)&&a>=0;)q=this.containsBlackPoint(n,i,a,!0),q?(a--,h=!0,_=!0):_||a--;if(a<0){d=!0;break}h&&(m=!0)}if(!d&&m){const B=i-n;let F=null;for(let re=1;F===null&&re<B;re++)F=this.getBlackPointOnSegment(n,c-re,n+re,c);if(F==null)throw new Y;let H=null;for(let re=1;H===null&&re<B;re++)H=this.getBlackPointOnSegment(n,a+re,n+re,a);if(H==null)throw new Y;let q=null;for(let re=1;q===null&&re<B;re++)q=this.getBlackPointOnSegment(i,a+re,i-re,a);if(q==null)throw new Y;let ee=null;for(let re=1;ee===null&&re<B;re++)ee=this.getBlackPointOnSegment(i,c-re,i-re,c);if(ee==null)throw new Y;return this.centerEdges(ee,F,q,H)}else throw new Y}getBlackPointOnSegment(n,i,a,c){const d=ke.round(ke.distance(n,i,a,c)),h=(a-n)/d,m=(c-i)/d,p=this.image;for(let y=0;y<d;y++){const b=ke.round(n+y*h),_=ke.round(i+y*m);if(p.get(b,_))return new de(b,_)}return null}centerEdges(n,i,a,c){const d=n.getX(),h=n.getY(),m=i.getX(),p=i.getY(),y=a.getX(),b=a.getY(),_=c.getX(),R=c.getY(),L=_n.CORR;return d<this.width/2?[new de(_-L,R+L),new de(m+L,p+L),new de(y-L,b-L),new de(d+L,h-L)]:[new de(_+L,R+L),new de(m+L,p-L),new de(y-L,b+L),new de(d-L,h-L)]}containsBlackPoint(n,i,a,c){const d=this.image;if(c){for(let h=n;h<=i;h++)if(d.get(h,a))return!0}else for(let h=n;h<=i;h++)if(d.get(a,h))return!0;return!1}}_n.INIT_SIZE=10,_n.CORR=1;class vc{static checkAndNudgePoints(n,i){const a=n.getWidth(),c=n.getHeight();let d=!0;for(let h=0;h<i.length&&d;h+=2){const m=Math.floor(i[h]),p=Math.floor(i[h+1]);if(m<-1||m>a||p<-1||p>c)throw new Y;d=!1,m===-1?(i[h]=0,d=!0):m===a&&(i[h]=a-1,d=!0),p===-1?(i[h+1]=0,d=!0):p===c&&(i[h+1]=c-1,d=!0)}d=!0;for(let h=i.length-2;h>=0&&d;h-=2){const m=Math.floor(i[h]),p=Math.floor(i[h+1]);if(m<-1||m>a||p<-1||p>c)throw new Y;d=!1,m===-1?(i[h]=0,d=!0):m===a&&(i[h]=a-1,d=!0),p===-1?(i[h+1]=0,d=!0):p===c&&(i[h+1]=c-1,d=!0)}}}class $r{constructor(n,i,a,c,d,h,m,p,y){this.a11=n,this.a21=i,this.a31=a,this.a12=c,this.a22=d,this.a32=h,this.a13=m,this.a23=p,this.a33=y}static quadrilateralToQuadrilateral(n,i,a,c,d,h,m,p,y,b,_,R,L,B,F,H){const q=$r.quadrilateralToSquare(n,i,a,c,d,h,m,p);return $r.squareToQuadrilateral(y,b,_,R,L,B,F,H).times(q)}transformPoints(n){const i=n.length,a=this.a11,c=this.a12,d=this.a13,h=this.a21,m=this.a22,p=this.a23,y=this.a31,b=this.a32,_=this.a33;for(let R=0;R<i;R+=2){const L=n[R],B=n[R+1],F=d*L+p*B+_;n[R]=(a*L+h*B+y)/F,n[R+1]=(c*L+m*B+b)/F}}transformPointsWithValues(n,i){const a=this.a11,c=this.a12,d=this.a13,h=this.a21,m=this.a22,p=this.a23,y=this.a31,b=this.a32,_=this.a33,R=n.length;for(let L=0;L<R;L++){const B=n[L],F=i[L],H=d*B+p*F+_;n[L]=(a*B+h*F+y)/H,i[L]=(c*B+m*F+b)/H}}static squareToQuadrilateral(n,i,a,c,d,h,m,p){const y=n-a+d-m,b=i-c+h-p;if(y===0&&b===0)return new $r(a-n,d-a,n,c-i,h-c,i,0,0,1);{const _=a-d,R=m-d,L=c-h,B=p-h,F=_*B-R*L,H=(y*B-R*b)/F,q=(_*b-y*L)/F;return new $r(a-n+H*a,m-n+q*m,n,c-i+H*c,p-i+q*p,i,H,q,1)}}static quadrilateralToSquare(n,i,a,c,d,h,m,p){return $r.squareToQuadrilateral(n,i,a,c,d,h,m,p).buildAdjoint()}buildAdjoint(){return new $r(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(n){return new $r(this.a11*n.a11+this.a21*n.a12+this.a31*n.a13,this.a11*n.a21+this.a21*n.a22+this.a31*n.a23,this.a11*n.a31+this.a21*n.a32+this.a31*n.a33,this.a12*n.a11+this.a22*n.a12+this.a32*n.a13,this.a12*n.a21+this.a22*n.a22+this.a32*n.a23,this.a12*n.a31+this.a22*n.a32+this.a32*n.a33,this.a13*n.a11+this.a23*n.a12+this.a33*n.a13,this.a13*n.a21+this.a23*n.a22+this.a33*n.a23,this.a13*n.a31+this.a23*n.a32+this.a33*n.a33)}}class Jh extends vc{sampleGrid(n,i,a,c,d,h,m,p,y,b,_,R,L,B,F,H,q,ee,re){const Z=$r.quadrilateralToQuadrilateral(c,d,h,m,p,y,b,_,R,L,B,F,H,q,ee,re);return this.sampleGridWithTransform(n,i,a,Z)}sampleGridWithTransform(n,i,a,c){if(i<=0||a<=0)throw new Y;const d=new We(i,a),h=new Float32Array(2*i);for(let m=0;m<a;m++){const p=h.length,y=m+.5;for(let b=0;b<p;b+=2)h[b]=b/2+.5,h[b+1]=y;c.transformPoints(h),vc.checkAndNudgePoints(n,h);try{for(let b=0;b<p;b+=2)n.get(Math.floor(h[b]),Math.floor(h[b+1]))&&d.set(b/2,m)}catch{throw new Y}}return d}}class zn{static setGridSampler(n){zn.gridSampler=n}static getInstance(){return zn.gridSampler}}zn.gridSampler=new Jh;class Zt{constructor(n,i){this.x=n,this.y=i}toResultPoint(){return new de(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class e0{constructor(n){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=n}detect(){return this.detectMirror(!1)}detectMirror(n){let i=this.getMatrixCenter(),a=this.getBullsEyeCorners(i);if(n){let h=a[0];a[0]=a[2],a[2]=h}this.extractParameters(a);let c=this.sampleGrid(this.image,a[this.shift%4],a[(this.shift+1)%4],a[(this.shift+2)%4],a[(this.shift+3)%4]),d=this.getMatrixCornerPoints(a);return new Zh(c,d,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(n){if(!this.isValidPoint(n[0])||!this.isValidPoint(n[1])||!this.isValidPoint(n[2])||!this.isValidPoint(n[3]))throw new Y;let i=2*this.nbCenterLayers,a=new Int32Array([this.sampleLine(n[0],n[1],i),this.sampleLine(n[1],n[2],i),this.sampleLine(n[2],n[3],i),this.sampleLine(n[3],n[0],i)]);this.shift=this.getRotation(a,i);let c=0;for(let h=0;h<4;h++){let m=a[(this.shift+h)%4];this.compact?(c<<=7,c+=m>>1&127):(c<<=10,c+=(m>>2&992)+(m>>1&31))}let d=this.getCorrectedParameterData(c,this.compact);this.compact?(this.nbLayers=(d>>6)+1,this.nbDataBlocks=(d&63)+1):(this.nbLayers=(d>>11)+1,this.nbDataBlocks=(d&2047)+1)}getRotation(n,i){let a=0;n.forEach((c,d,h)=>{let m=(c>>i-2<<1)+(c&1);a=(a<<3)+m}),a=((a&1)<<11)+(a>>1);for(let c=0;c<4;c++)if(T.bitCount(a^this.EXPECTED_CORNER_BITS[c])<=2)return c;throw new Y}getCorrectedParameterData(n,i){let a,c;i?(a=7,c=2):(a=10,c=4);let d=a-c,h=new Int32Array(a);for(let p=a-1;p>=0;--p)h[p]=n&15,n>>=4;try{new ra(Le.AZTEC_PARAM).decode(h,d)}catch{throw new Y}let m=0;for(let p=0;p<c;p++)m=(m<<4)+h[p];return m}getBullsEyeCorners(n){let i=n,a=n,c=n,d=n,h=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let _=this.getFirstDifferent(i,h,1,-1),R=this.getFirstDifferent(a,h,1,1),L=this.getFirstDifferent(c,h,-1,1),B=this.getFirstDifferent(d,h,-1,-1);if(this.nbCenterLayers>2){let F=this.distancePoint(B,_)*this.nbCenterLayers/(this.distancePoint(d,i)*(this.nbCenterLayers+2));if(F<.75||F>1.25||!this.isWhiteOrBlackRectangle(_,R,L,B))break}i=_,a=R,c=L,d=B,h=!h}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new Y;this.compact=this.nbCenterLayers===5;let m=new de(i.getX()+.5,i.getY()-.5),p=new de(a.getX()+.5,a.getY()+.5),y=new de(c.getX()-.5,c.getY()+.5),b=new de(d.getX()-.5,d.getY()-.5);return this.expandSquare([m,p,y,b],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let n,i,a,c;try{let m=new _n(this.image).detect();n=m[0],i=m[1],a=m[2],c=m[3]}catch{let p=this.image.getWidth()/2,y=this.image.getHeight()/2;n=this.getFirstDifferent(new Zt(p+7,y-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Zt(p+7,y+7),!1,1,1).toResultPoint(),a=this.getFirstDifferent(new Zt(p-7,y+7),!1,-1,1).toResultPoint(),c=this.getFirstDifferent(new Zt(p-7,y-7),!1,-1,-1).toResultPoint()}let d=ke.round((n.getX()+c.getX()+i.getX()+a.getX())/4),h=ke.round((n.getY()+c.getY()+i.getY()+a.getY())/4);try{let m=new _n(this.image,15,d,h).detect();n=m[0],i=m[1],a=m[2],c=m[3]}catch{n=this.getFirstDifferent(new Zt(d+7,h-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Zt(d+7,h+7),!1,1,1).toResultPoint(),a=this.getFirstDifferent(new Zt(d-7,h+7),!1,-1,1).toResultPoint(),c=this.getFirstDifferent(new Zt(d-7,h-7),!1,-1,-1).toResultPoint()}return d=ke.round((n.getX()+c.getX()+i.getX()+a.getX())/4),h=ke.round((n.getY()+c.getY()+i.getY()+a.getY())/4),new Zt(d,h)}getMatrixCornerPoints(n){return this.expandSquare(n,2*this.nbCenterLayers,this.getDimension())}sampleGrid(n,i,a,c,d){let h=zn.getInstance(),m=this.getDimension(),p=m/2-this.nbCenterLayers,y=m/2+this.nbCenterLayers;return h.sampleGrid(n,m,m,p,p,y,p,y,y,p,y,i.getX(),i.getY(),a.getX(),a.getY(),c.getX(),c.getY(),d.getX(),d.getY())}sampleLine(n,i,a){let c=0,d=this.distanceResultPoint(n,i),h=d/a,m=n.getX(),p=n.getY(),y=h*(i.getX()-n.getX())/d,b=h*(i.getY()-n.getY())/d;for(let _=0;_<a;_++)this.image.get(ke.round(m+_*y),ke.round(p+_*b))&&(c|=1<<a-_-1);return c}isWhiteOrBlackRectangle(n,i,a,c){let d=3;n=new Zt(n.getX()-d,n.getY()+d),i=new Zt(i.getX()-d,i.getY()-d),a=new Zt(a.getX()+d,a.getY()-d),c=new Zt(c.getX()+d,c.getY()+d);let h=this.getColor(c,n);if(h===0)return!1;let m=this.getColor(n,i);return m!==h||(m=this.getColor(i,a),m!==h)?!1:(m=this.getColor(a,c),m===h)}getColor(n,i){let a=this.distancePoint(n,i),c=(i.getX()-n.getX())/a,d=(i.getY()-n.getY())/a,h=0,m=n.getX(),p=n.getY(),y=this.image.get(n.getX(),n.getY()),b=Math.ceil(a);for(let R=0;R<b;R++)m+=c,p+=d,this.image.get(ke.round(m),ke.round(p))!==y&&h++;let _=h/a;return _>.1&&_<.9?0:_<=.1===y?1:-1}getFirstDifferent(n,i,a,c){let d=n.getX()+a,h=n.getY()+c;for(;this.isValid(d,h)&&this.image.get(d,h)===i;)d+=a,h+=c;for(d-=a,h-=c;this.isValid(d,h)&&this.image.get(d,h)===i;)d+=a;for(d-=a;this.isValid(d,h)&&this.image.get(d,h)===i;)h+=c;return h-=c,new Zt(d,h)}expandSquare(n,i,a){let c=a/(2*i),d=n[0].getX()-n[2].getX(),h=n[0].getY()-n[2].getY(),m=(n[0].getX()+n[2].getX())/2,p=(n[0].getY()+n[2].getY())/2,y=new de(m+c*d,p+c*h),b=new de(m-c*d,p-c*h);d=n[1].getX()-n[3].getX(),h=n[1].getY()-n[3].getY(),m=(n[1].getX()+n[3].getX())/2,p=(n[1].getY()+n[3].getY())/2;let _=new de(m+c*d,p+c*h),R=new de(m-c*d,p-c*h);return[y,_,b,R]}isValid(n,i){return n>=0&&n<this.image.getWidth()&&i>0&&i<this.image.getHeight()}isValidPoint(n){let i=ke.round(n.getX()),a=ke.round(n.getY());return this.isValid(i,a)}distancePoint(n,i){return ke.distance(n.getX(),n.getY(),i.getX(),i.getY())}distanceResultPoint(n,i){return ke.distance(n.getX(),n.getY(),i.getX(),i.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(T.truncDivision(this.nbLayers-4,8)+1)+15}}class bo{decode(n,i=null){let a=null,c=new e0(n.getBlackMatrix()),d=null,h=null;try{let b=c.detectMirror(!1);d=b.getPoints(),this.reportFoundResultPoints(i,d),h=new Ke().decode(b)}catch(b){a=b}if(h==null)try{let b=c.detectMirror(!0);d=b.getPoints(),this.reportFoundResultPoints(i,d),h=new Ke().decode(b)}catch(b){throw a??b}let m=new Ie(h.getText(),h.getRawBytes(),h.getNumBits(),d,se.AZTEC,j.currentTimeMillis()),p=h.getByteSegments();p!=null&&m.putMetadata(Ue.BYTE_SEGMENTS,p);let y=h.getECLevel();return y!=null&&m.putMetadata(Ue.ERROR_CORRECTION_LEVEL,y),m}reportFoundResultPoints(n,i){if(n!=null){let a=n.get(z.NEED_RESULT_POINT_CALLBACK);a!=null&&i.forEach((c,d,h)=>{a.foundPossibleResultPoint(c)})}}reset(){}}class pp extends Dt{constructor(n=500){super(new bo,n)}}class Et{decode(n,i){try{return this.doDecode(n,i)}catch{if(i&&i.get(z.TRY_HARDER)===!0&&n.isRotateSupported()){const d=n.rotateCounterClockwise(),h=this.doDecode(d,i),m=h.getResultMetadata();let p=270;m!==null&&m.get(Ue.ORIENTATION)===!0&&(p=p+m.get(Ue.ORIENTATION)%360),h.putMetadata(Ue.ORIENTATION,p);const y=h.getResultPoints();if(y!==null){const b=d.getHeight();for(let _=0;_<y.length;_++)y[_]=new de(b-y[_].getY()-1,y[_].getX())}return h}else throw new Y}}reset(){}doDecode(n,i){const a=n.getWidth(),c=n.getHeight();let d=new O(a);const h=i&&i.get(z.TRY_HARDER)===!0,m=Math.max(1,c>>(h?8:5));let p;h?p=c:p=15;const y=Math.trunc(c/2);for(let b=0;b<p;b++){const _=Math.trunc((b+1)/2),R=(b&1)===0,L=y+m*(R?_:-_);if(L<0||L>=c)break;try{d=n.getBlackRow(L,d)}catch{continue}for(let B=0;B<2;B++){if(B===1&&(d.reverse(),i&&i.get(z.NEED_RESULT_POINT_CALLBACK)===!0)){const F=new Map;i.forEach((H,q)=>F.set(q,H)),F.delete(z.NEED_RESULT_POINT_CALLBACK),i=F}try{const F=this.decodeRow(L,d,i);if(B===1){F.putMetadata(Ue.ORIENTATION,180);const H=F.getResultPoints();H!==null&&(H[0]=new de(a-H[0].getX()-1,H[0].getY()),H[1]=new de(a-H[1].getX()-1,H[1].getY()))}return F}catch{}}}throw new Y}static recordPattern(n,i,a){const c=a.length;for(let y=0;y<c;y++)a[y]=0;const d=n.getSize();if(i>=d)throw new Y;let h=!n.get(i),m=0,p=i;for(;p<d;){if(n.get(p)!==h)a[m]++;else{if(++m===c)break;a[m]=1,h=!h}p++}if(!(m===c||m===c-1&&p===d))throw new Y}static recordPatternInReverse(n,i,a){let c=a.length,d=n.get(i);for(;i>0&&c>=0;)n.get(--i)!==d&&(c--,d=!d);if(c>=0)throw new Y;Et.recordPattern(n,i+1,a)}static patternMatchVariance(n,i,a){const c=n.length;let d=0,h=0;for(let y=0;y<c;y++)d+=n[y],h+=i[y];if(d<h)return Number.POSITIVE_INFINITY;const m=d/h;a*=m;let p=0;for(let y=0;y<c;y++){const b=n[y],_=i[y]*m,R=b>_?b-_:_-b;if(R>a)return Number.POSITIVE_INFINITY;p+=R}return p/d}}class ne extends Et{static findStartPattern(n){const i=n.getSize(),a=n.getNextSet(0);let c=0,d=Int32Array.from([0,0,0,0,0,0]),h=a,m=!1;const p=6;for(let y=a;y<i;y++)if(n.get(y)!==m)d[c]++;else{if(c===p-1){let b=ne.MAX_AVG_VARIANCE,_=-1;for(let R=ne.CODE_START_A;R<=ne.CODE_START_C;R++){const L=Et.patternMatchVariance(d,ne.CODE_PATTERNS[R],ne.MAX_INDIVIDUAL_VARIANCE);L<b&&(b=L,_=R)}if(_>=0&&n.isRange(Math.max(0,h-(y-h)/2),h,!1))return Int32Array.from([h,y,_]);h+=d[0]+d[1],d=d.slice(2,d.length-1),d[c-1]=0,d[c]=0,c--}else c++;d[c]=1,m=!m}throw new Y}static decodeCode(n,i,a){Et.recordPattern(n,a,i);let c=ne.MAX_AVG_VARIANCE,d=-1;for(let h=0;h<ne.CODE_PATTERNS.length;h++){const m=ne.CODE_PATTERNS[h],p=this.patternMatchVariance(i,m,ne.MAX_INDIVIDUAL_VARIANCE);p<c&&(c=p,d=h)}if(d>=0)return d;throw new Y}decodeRow(n,i,a){const c=a&&a.get(z.ASSUME_GS1)===!0,d=ne.findStartPattern(i),h=d[2];let m=0;const p=new Uint8Array(20);p[m++]=h;let y;switch(h){case ne.CODE_START_A:y=ne.CODE_CODE_A;break;case ne.CODE_START_B:y=ne.CODE_CODE_B;break;case ne.CODE_START_C:y=ne.CODE_CODE_C;break;default:throw new U}let b=!1,_=!1,R="",L=d[0],B=d[1];const F=Int32Array.from([0,0,0,0,0,0]);let H=0,q=0,ee=h,re=0,Z=!0,Re=!1,_e=!1;for(;!b;){const li=_;switch(_=!1,H=q,q=ne.decodeCode(i,F,B),p[m++]=q,q!==ne.CODE_STOP&&(Z=!0),q!==ne.CODE_STOP&&(re++,ee+=re*q),L=B,B+=F.reduce(($p,Xp)=>$p+Xp,0),q){case ne.CODE_START_A:case ne.CODE_START_B:case ne.CODE_START_C:throw new U}switch(y){case ne.CODE_CODE_A:if(q<64)_e===Re?R+=String.fromCharCode(32+q):R+=String.fromCharCode(32+q+128),_e=!1;else if(q<96)_e===Re?R+=String.fromCharCode(q-64):R+=String.fromCharCode(q+64),_e=!1;else switch(q!==ne.CODE_STOP&&(Z=!1),q){case ne.CODE_FNC_1:c&&(R.length===0?R+="]C1":R+="");break;case ne.CODE_FNC_2:case ne.CODE_FNC_3:break;case ne.CODE_FNC_4_A:!Re&&_e?(Re=!0,_e=!1):Re&&_e?(Re=!1,_e=!1):_e=!0;break;case ne.CODE_SHIFT:_=!0,y=ne.CODE_CODE_B;break;case ne.CODE_CODE_B:y=ne.CODE_CODE_B;break;case ne.CODE_CODE_C:y=ne.CODE_CODE_C;break;case ne.CODE_STOP:b=!0;break}break;case ne.CODE_CODE_B:if(q<96)_e===Re?R+=String.fromCharCode(32+q):R+=String.fromCharCode(32+q+128),_e=!1;else switch(q!==ne.CODE_STOP&&(Z=!1),q){case ne.CODE_FNC_1:c&&(R.length===0?R+="]C1":R+="");break;case ne.CODE_FNC_2:case ne.CODE_FNC_3:break;case ne.CODE_FNC_4_B:!Re&&_e?(Re=!0,_e=!1):Re&&_e?(Re=!1,_e=!1):_e=!0;break;case ne.CODE_SHIFT:_=!0,y=ne.CODE_CODE_A;break;case ne.CODE_CODE_A:y=ne.CODE_CODE_A;break;case ne.CODE_CODE_C:y=ne.CODE_CODE_C;break;case ne.CODE_STOP:b=!0;break}break;case ne.CODE_CODE_C:if(q<100)q<10&&(R+="0"),R+=q;else switch(q!==ne.CODE_STOP&&(Z=!1),q){case ne.CODE_FNC_1:c&&(R.length===0?R+="]C1":R+="");break;case ne.CODE_CODE_A:y=ne.CODE_CODE_A;break;case ne.CODE_CODE_B:y=ne.CODE_CODE_B;break;case ne.CODE_STOP:b=!0;break}break}li&&(y=y===ne.CODE_CODE_A?ne.CODE_CODE_B:ne.CODE_CODE_A)}const dr=B-L;if(B=i.getNextUnset(B),!i.isRange(B,Math.min(i.getSize(),B+(B-L)/2),!1))throw new Y;if(ee-=re*H,ee%103!==H)throw new I;const Yr=R.length;if(Yr===0)throw new Y;Yr>0&&Z&&(y===ne.CODE_CODE_C?R=R.substring(0,Yr-2):R=R.substring(0,Yr-1));const hr=(d[1]+d[0])/2,Xe=L+dr/2,Ft=p.length,vr=new Uint8Array(Ft);for(let li=0;li<Ft;li++)vr[li]=p[li];const oi=[new de(hr,n),new de(Xe,n)];return new Ie(R,vr,0,oi,se.CODE_128,new Date().getTime())}}ne.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],ne.MAX_AVG_VARIANCE=.25,ne.MAX_INDIVIDUAL_VARIANCE=.7,ne.CODE_SHIFT=98,ne.CODE_CODE_C=99,ne.CODE_CODE_B=100,ne.CODE_CODE_A=101,ne.CODE_FNC_1=102,ne.CODE_FNC_2=97,ne.CODE_FNC_3=96,ne.CODE_FNC_4_A=101,ne.CODE_FNC_4_B=100,ne.CODE_START_A=103,ne.CODE_START_B=104,ne.CODE_START_C=105,ne.CODE_STOP=106;class _t extends Et{constructor(n=!1,i=!1){super(),this.usingCheckDigit=n,this.extendedMode=i,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(n,i,a){let c=this.counters;c.fill(0),this.decodeRowResult="";let d=_t.findAsteriskPattern(i,c),h=i.getNextSet(d[1]),m=i.getSize(),p,y;do{_t.recordPattern(i,h,c);let F=_t.toNarrowWidePattern(c);if(F<0)throw new Y;p=_t.patternToChar(F),this.decodeRowResult+=p,y=h;for(let H of c)h+=H;h=i.getNextSet(h)}while(p!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let b=0;for(let F of c)b+=F;let _=h-y-b;if(h!==m&&_*2<b)throw new Y;if(this.usingCheckDigit){let F=this.decodeRowResult.length-1,H=0;for(let q=0;q<F;q++)H+=_t.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(q));if(this.decodeRowResult.charAt(F)!==_t.ALPHABET_STRING.charAt(H%43))throw new I;this.decodeRowResult=this.decodeRowResult.substring(0,F)}if(this.decodeRowResult.length===0)throw new Y;let R;this.extendedMode?R=_t.decodeExtended(this.decodeRowResult):R=this.decodeRowResult;let L=(d[1]+d[0])/2,B=y+b/2;return new Ie(R,null,0,[new de(L,n),new de(B,n)],se.CODE_39,new Date().getTime())}static findAsteriskPattern(n,i){let a=n.getSize(),c=n.getNextSet(0),d=0,h=c,m=!1,p=i.length;for(let y=c;y<a;y++)if(n.get(y)!==m)i[d]++;else{if(d===p-1){if(this.toNarrowWidePattern(i)===_t.ASTERISK_ENCODING&&n.isRange(Math.max(0,h-Math.floor((y-h)/2)),h,!1))return[h,y];h+=i[0]+i[1],i.copyWithin(0,2,2+d-1),i[d-1]=0,i[d]=0,d--}else d++;i[d]=1,m=!m}throw new Y}static toNarrowWidePattern(n){let i=n.length,a=0,c;do{let d=2147483647;for(let p of n)p<d&&p>a&&(d=p);a=d,c=0;let h=0,m=0;for(let p=0;p<i;p++){let y=n[p];y>a&&(m|=1<<i-1-p,c++,h+=y)}if(c===3){for(let p=0;p<i&&c>0;p++){let y=n[p];if(y>a&&(c--,y*2>=h))return-1}return m}}while(c>3);return-1}static patternToChar(n){for(let i=0;i<_t.CHARACTER_ENCODINGS.length;i++)if(_t.CHARACTER_ENCODINGS[i]===n)return _t.ALPHABET_STRING.charAt(i);if(n===_t.ASTERISK_ENCODING)return"*";throw new Y}static decodeExtended(n){let i=n.length,a="";for(let c=0;c<i;c++){let d=n.charAt(c);if(d==="+"||d==="$"||d==="%"||d==="/"){let h=n.charAt(c+1),m="\0";switch(d){case"+":if(h>="A"&&h<="Z")m=String.fromCharCode(h.charCodeAt(0)+32);else throw new U;break;case"$":if(h>="A"&&h<="Z")m=String.fromCharCode(h.charCodeAt(0)-64);else throw new U;break;case"%":if(h>="A"&&h<="E")m=String.fromCharCode(h.charCodeAt(0)-38);else if(h>="F"&&h<="J")m=String.fromCharCode(h.charCodeAt(0)-11);else if(h>="K"&&h<="O")m=String.fromCharCode(h.charCodeAt(0)+16);else if(h>="P"&&h<="T")m=String.fromCharCode(h.charCodeAt(0)+43);else if(h==="U")m="\0";else if(h==="V")m="@";else if(h==="W")m="`";else if(h==="X"||h==="Y"||h==="Z")m="";else throw new U;break;case"/":if(h>="A"&&h<="O")m=String.fromCharCode(h.charCodeAt(0)-32);else if(h==="Z")m=":";else throw new U;break}a+=m,c++}else a+=d}return a}}_t.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",_t.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],_t.ASTERISK_ENCODING=148;class Ge extends Et{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(n,i,a){let c=this.decodeStart(i),d=this.decodeEnd(i),h=new Ne;Ge.decodeMiddle(i,c[1],d[0],h);let m=h.toString(),p=null;a!=null&&(p=a.get(z.ALLOWED_LENGTHS)),p==null&&(p=Ge.DEFAULT_ALLOWED_LENGTHS);let y=m.length,b=!1,_=0;for(let B of p){if(y===B){b=!0;break}B>_&&(_=B)}if(!b&&y>_&&(b=!0),!b)throw new U;const R=[new de(c[1],n),new de(d[0],n)];return new Ie(m,null,0,R,se.ITF,new Date().getTime())}static decodeMiddle(n,i,a,c){let d=new Int32Array(10),h=new Int32Array(5),m=new Int32Array(5);for(d.fill(0),h.fill(0),m.fill(0);i<a;){Et.recordPattern(n,i,d);for(let y=0;y<5;y++){let b=2*y;h[y]=d[b],m[y]=d[b+1]}let p=Ge.decodeDigit(h);c.append(p.toString()),p=this.decodeDigit(m),c.append(p.toString()),d.forEach(function(y){i+=y})}}decodeStart(n){let i=Ge.skipWhiteSpace(n),a=Ge.findGuardPattern(n,i,Ge.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(n,a[0]),a}validateQuietZone(n,i){let a=this.narrowLineWidth*10;a=a<i?a:i;for(let c=i-1;a>0&&c>=0&&!n.get(c);c--)a--;if(a!==0)throw new Y}static skipWhiteSpace(n){const i=n.getSize(),a=n.getNextSet(0);if(a===i)throw new Y;return a}decodeEnd(n){n.reverse();try{let i=Ge.skipWhiteSpace(n),a;try{a=Ge.findGuardPattern(n,i,Ge.END_PATTERN_REVERSED[0])}catch(d){d instanceof Y&&(a=Ge.findGuardPattern(n,i,Ge.END_PATTERN_REVERSED[1]))}this.validateQuietZone(n,a[0]);let c=a[0];return a[0]=n.getSize()-a[1],a[1]=n.getSize()-c,a}finally{n.reverse()}}static findGuardPattern(n,i,a){let c=a.length,d=new Int32Array(c),h=n.getSize(),m=!1,p=0,y=i;d.fill(0);for(let b=i;b<h;b++)if(n.get(b)!==m)d[p]++;else{if(p===c-1){if(Et.patternMatchVariance(d,a,Ge.MAX_INDIVIDUAL_VARIANCE)<Ge.MAX_AVG_VARIANCE)return[y,b];y+=d[0]+d[1],j.arraycopy(d,2,d,0,p-1),d[p-1]=0,d[p]=0,p--}else p++;d[p]=1,m=!m}throw new Y}static decodeDigit(n){let i=Ge.MAX_AVG_VARIANCE,a=-1,c=Ge.PATTERNS.length;for(let d=0;d<c;d++){let h=Ge.PATTERNS[d],m=Et.patternMatchVariance(n,h,Ge.MAX_INDIVIDUAL_VARIANCE);m<i?(i=m,a=d):m===i&&(a=-1)}if(a>=0)return a%10;throw new Y}}Ge.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ge.MAX_AVG_VARIANCE=.38,Ge.MAX_INDIVIDUAL_VARIANCE=.5,Ge.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ge.START_PATTERN=Int32Array.from([1,1,1,1]),Ge.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class ft extends Et{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(n){let i=!1,a,c=0,d=Int32Array.from([0,0,0]);for(;!i;){d=Int32Array.from([0,0,0]),a=ft.findGuardPattern(n,c,!1,this.START_END_PATTERN,d);let h=a[0];c=a[1];let m=h-(c-h);m>=0&&(i=n.isRange(m,h,!1))}return a}static checkChecksum(n){return ft.checkStandardUPCEANChecksum(n)}static checkStandardUPCEANChecksum(n){let i=n.length;if(i===0)return!1;let a=parseInt(n.charAt(i-1),10);return ft.getStandardUPCEANChecksum(n.substring(0,i-1))===a}static getStandardUPCEANChecksum(n){let i=n.length,a=0;for(let c=i-1;c>=0;c-=2){let d=n.charAt(c).charCodeAt(0)-48;if(d<0||d>9)throw new U;a+=d}a*=3;for(let c=i-2;c>=0;c-=2){let d=n.charAt(c).charCodeAt(0)-48;if(d<0||d>9)throw new U;a+=d}return(1e3-a)%10}static decodeEnd(n,i){return ft.findGuardPattern(n,i,!1,ft.START_END_PATTERN,new Int32Array(ft.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(n,i,a,c){return this.findGuardPattern(n,i,a,c,new Int32Array(c.length))}static findGuardPattern(n,i,a,c,d){let h=n.getSize();i=a?n.getNextUnset(i):n.getNextSet(i);let m=0,p=i,y=c.length,b=a;for(let _=i;_<h;_++)if(n.get(_)!==b)d[m]++;else{if(m===y-1){if(Et.patternMatchVariance(d,c,ft.MAX_INDIVIDUAL_VARIANCE)<ft.MAX_AVG_VARIANCE)return Int32Array.from([p,_]);p+=d[0]+d[1];let R=d.slice(2,d.length-1);for(let L=0;L<m-1;L++)d[L]=R[L];d[m-1]=0,d[m]=0,m--}else m++;d[m]=1,b=!b}throw new Y}static decodeDigit(n,i,a,c){this.recordPattern(n,a,i);let d=this.MAX_AVG_VARIANCE,h=-1,m=c.length;for(let p=0;p<m;p++){let y=c[p],b=Et.patternMatchVariance(i,y,ft.MAX_INDIVIDUAL_VARIANCE);b<d&&(d=b,h=p)}if(h>=0)return h;throw new Y}}ft.MAX_AVG_VARIANCE=.48,ft.MAX_INDIVIDUAL_VARIANCE=.7,ft.START_END_PATTERN=Int32Array.from([1,1,1]),ft.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),ft.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ft.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class na{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(n,i,a){let c=this.decodeRowStringBuffer,d=this.decodeMiddle(i,a,c),h=c.toString(),m=na.parseExtensionString(h),p=[new de((a[0]+a[1])/2,n),new de(d,n)],y=new Ie(h,null,0,p,se.UPC_EAN_EXTENSION,new Date().getTime());return m!=null&&y.putAllMetadata(m),y}decodeMiddle(n,i,a){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let d=n.getSize(),h=i[1],m=0;for(let y=0;y<5&&h<d;y++){let b=ft.decodeDigit(n,c,h,ft.L_AND_G_PATTERNS);a+=String.fromCharCode(48+b%10);for(let _ of c)h+=_;b>=10&&(m|=1<<4-y),y!==4&&(h=n.getNextSet(h),h=n.getNextUnset(h))}if(a.length!==5)throw new Y;let p=this.determineCheckDigit(m);if(na.extensionChecksum(a.toString())!==p)throw new Y;return h}static extensionChecksum(n){let i=n.length,a=0;for(let c=i-2;c>=0;c-=2)a+=n.charAt(c).charCodeAt(0)-48;a*=3;for(let c=i-1;c>=0;c-=2)a+=n.charAt(c).charCodeAt(0)-48;return a*=3,a%10}determineCheckDigit(n){for(let i=0;i<10;i++)if(n===this.CHECK_DIGIT_ENCODINGS[i])return i;throw new Y}static parseExtensionString(n){if(n.length!==5)return null;let i=na.parseExtension5String(n);return i==null?null:new Map([[Ue.SUGGESTED_PRICE,i]])}static parseExtension5String(n){let i;switch(n.charAt(0)){case"0":i="";break;case"5":i="$";break;case"9":switch(n){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}i="";break;default:i="";break}let a=parseInt(n.substring(1)),c=(a/100).toString(),d=a%100,h=d<10?"0"+d:d.toString();return i+c+"."+h}}class bc{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(n,i,a){let c=this.decodeRowStringBuffer,d=this.decodeMiddle(i,a,c),h=c.toString(),m=bc.parseExtensionString(h),p=[new de((a[0]+a[1])/2,n),new de(d,n)],y=new Ie(h,null,0,p,se.UPC_EAN_EXTENSION,new Date().getTime());return m!=null&&y.putAllMetadata(m),y}decodeMiddle(n,i,a){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let d=n.getSize(),h=i[1],m=0;for(let p=0;p<2&&h<d;p++){let y=ft.decodeDigit(n,c,h,ft.L_AND_G_PATTERNS);a+=String.fromCharCode(48+y%10);for(let b of c)h+=b;y>=10&&(m|=1<<1-p),p!==1&&(h=n.getNextSet(h),h=n.getNextUnset(h))}if(a.length!==2)throw new Y;if(parseInt(a.toString())%4!==m)throw new Y;return h}static parseExtensionString(n){return n.length!==2?null:new Map([[Ue.ISSUE_NUMBER,parseInt(n)]])}}class t0{static decodeRow(n,i,a){let c=ft.findGuardPattern(i,a,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new na().decodeRow(n,i,c)}catch{return new bc().decodeRow(n,i,c)}}}t0.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Pe extends ft{constructor(){super(),this.decodeRowStringBuffer="",Pe.L_AND_G_PATTERNS=Pe.L_PATTERNS.map(n=>Int32Array.from(n));for(let n=10;n<20;n++){let i=Pe.L_PATTERNS[n-10],a=new Int32Array(i.length);for(let c=0;c<i.length;c++)a[c]=i[i.length-c-1];Pe.L_AND_G_PATTERNS[n]=a}}decodeRow(n,i,a){let c=Pe.findStartGuardPattern(i),d=a==null?null:a.get(z.NEED_RESULT_POINT_CALLBACK);if(d!=null){const Z=new de((c[0]+c[1])/2,n);d.foundPossibleResultPoint(Z)}let h=this.decodeMiddle(i,c,this.decodeRowStringBuffer),m=h.rowOffset,p=h.resultString;if(d!=null){const Z=new de(m,n);d.foundPossibleResultPoint(Z)}let y=this.decodeEnd(i,m);if(d!=null){const Z=new de((y[0]+y[1])/2,n);d.foundPossibleResultPoint(Z)}let b=y[1],_=b+(b-y[0]);if(_>=i.getSize()||!i.isRange(b,_,!1))throw new Y;let R=p.toString();if(R.length<8)throw new U;if(!Pe.checkChecksum(R))throw new I;let L=(c[1]+c[0])/2,B=(y[1]+y[0])/2,F=this.getBarcodeFormat(),H=[new de(L,n),new de(B,n)],q=new Ie(R,null,0,H,F,new Date().getTime()),ee=0;try{let Z=t0.decodeRow(n,i,y[1]);q.putMetadata(Ue.UPC_EAN_EXTENSION,Z.getText()),q.putAllMetadata(Z.getResultMetadata()),q.addResultPoints(Z.getResultPoints()),ee=Z.getText().length}catch{}let re=a==null?null:a.get(z.ALLOWED_EAN_EXTENSIONS);if(re!=null){let Z=!1;for(let Re in re)if(ee.toString()===Re){Z=!0;break}if(!Z)throw new Y}return q}decodeEnd(n,i){return Pe.findGuardPattern(n,i,!1,Pe.START_END_PATTERN,new Int32Array(Pe.START_END_PATTERN.length).fill(0))}static checkChecksum(n){return Pe.checkStandardUPCEANChecksum(n)}static checkStandardUPCEANChecksum(n){let i=n.length;if(i===0)return!1;let a=parseInt(n.charAt(i-1),10);return Pe.getStandardUPCEANChecksum(n.substring(0,i-1))===a}static getStandardUPCEANChecksum(n){let i=n.length,a=0;for(let c=i-1;c>=0;c-=2){let d=n.charAt(c).charCodeAt(0)-48;if(d<0||d>9)throw new U;a+=d}a*=3;for(let c=i-2;c>=0;c-=2){let d=n.charAt(c).charCodeAt(0)-48;if(d<0||d>9)throw new U;a+=d}return(1e3-a)%10}}class Cs extends Pe{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(n,i,a){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let d=n.getSize(),h=i[1],m=0;for(let y=0;y<6&&h<d;y++){let b=Pe.decodeDigit(n,c,h,Pe.L_AND_G_PATTERNS);a+=String.fromCharCode(48+b%10);for(let _ of c)h+=_;b>=10&&(m|=1<<5-y)}a=Cs.determineFirstDigit(a,m),h=Pe.findGuardPattern(n,h,!0,Pe.MIDDLE_PATTERN,new Int32Array(Pe.MIDDLE_PATTERN.length).fill(0))[1];for(let y=0;y<6&&h<d;y++){let b=Pe.decodeDigit(n,c,h,Pe.L_PATTERNS);a+=String.fromCharCode(48+b);for(let _ of c)h+=_}return{rowOffset:h,resultString:a}}getBarcodeFormat(){return se.EAN_13}static determineFirstDigit(n,i){for(let a=0;a<10;a++)if(i===this.FIRST_DIGIT_ENCODINGS[a])return n=String.fromCharCode(48+a)+n,n;throw new Y}}Cs.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class r0 extends Pe{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(n,i,a){const c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let d=n.getSize(),h=i[1];for(let p=0;p<4&&h<d;p++){let y=Pe.decodeDigit(n,c,h,Pe.L_PATTERNS);a+=String.fromCharCode(48+y);for(let b of c)h+=b}h=Pe.findGuardPattern(n,h,!0,Pe.MIDDLE_PATTERN,new Int32Array(Pe.MIDDLE_PATTERN.length).fill(0))[1];for(let p=0;p<4&&h<d;p++){let y=Pe.decodeDigit(n,c,h,Pe.L_PATTERNS);a+=String.fromCharCode(48+y);for(let b of c)h+=b}return{rowOffset:h,resultString:a}}getBarcodeFormat(){return se.EAN_8}}class n0 extends Pe{constructor(){super(...arguments),this.ean13Reader=new Cs}getBarcodeFormat(){return se.UPC_A}decode(n,i){return this.maybeReturnResult(this.ean13Reader.decode(n))}decodeRow(n,i,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(n,i,a))}decodeMiddle(n,i,a){return this.ean13Reader.decodeMiddle(n,i,a)}maybeReturnResult(n){let i=n.getText();if(i.charAt(0)==="0"){let a=new Ie(i.substring(1),null,null,n.getResultPoints(),se.UPC_A);return n.getResultMetadata()!=null&&a.putAllMetadata(n.getResultMetadata()),a}else throw new Y}reset(){this.ean13Reader.reset()}}class Xr extends Pe{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(n,i,a){const c=this.decodeMiddleCounters.map(y=>y);c[0]=0,c[1]=0,c[2]=0,c[3]=0;const d=n.getSize();let h=i[1],m=0;for(let y=0;y<6&&h<d;y++){const b=Xr.decodeDigit(n,c,h,Xr.L_AND_G_PATTERNS);a+=String.fromCharCode(48+b%10);for(let _ of c)h+=_;b>=10&&(m|=1<<5-y)}let p=Xr.determineNumSysAndCheckDigit(a,m);return{rowOffset:h,resultString:p}}decodeEnd(n,i){return Xr.findGuardPatternWithoutCounters(n,i,!0,Xr.MIDDLE_END_PATTERN)}checkChecksum(n){return Pe.checkChecksum(Xr.convertUPCEtoUPCA(n))}static determineNumSysAndCheckDigit(n,i){for(let a=0;a<=1;a++)for(let c=0;c<10;c++)if(i===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][c]){let d=String.fromCharCode(48+a),h=String.fromCharCode(48+c);return d+n+h}throw Y.getNotFoundInstance()}getBarcodeFormat(){return se.UPC_E}static convertUPCEtoUPCA(n){const i=n.slice(1,7).split("").map(d=>d.charCodeAt(0)),a=new Ne;a.append(n.charAt(0));let c=i[5];switch(c){case 0:case 1:case 2:a.appendChars(i,0,2),a.append(c),a.append("0000"),a.appendChars(i,2,3);break;case 3:a.appendChars(i,0,3),a.append("00000"),a.appendChars(i,3,2);break;case 4:a.appendChars(i,0,4),a.append("00000"),a.append(i[4]);break;default:a.appendChars(i,0,5),a.append("0000"),a.append(c);break}return n.length>=8&&a.append(n.charAt(7)),a.toString()}}Xr.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Xr.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Ec extends Et{constructor(n){super();let i=n==null?null:n.get(z.POSSIBLE_FORMATS),a=[];s(i)?(a.push(new Cs),a.push(new n0),a.push(new r0),a.push(new Xr)):(i.indexOf(se.EAN_13)>-1&&a.push(new Cs),i.indexOf(se.UPC_A)>-1&&a.push(new n0),i.indexOf(se.EAN_8)>-1&&a.push(new r0),i.indexOf(se.UPC_E)>-1&&a.push(new Xr)),this.readers=a}decodeRow(n,i,a){for(let c of this.readers)try{const d=c.decodeRow(n,i,a),h=d.getBarcodeFormat()===se.EAN_13&&d.getText().charAt(0)==="0",m=a==null?null:a.get(z.POSSIBLE_FORMATS),p=m==null||m.includes(se.UPC_A);if(h&&p){const y=d.getRawBytes(),b=new Ie(d.getText().substring(1),y,y?y.length:null,d.getResultPoints(),se.UPC_A);return b.putAllMetadata(d.getResultMetadata()),b}return d}catch{}throw new Y}reset(){for(let n of this.readers)n.reset()}}class Wt extends Et{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(n,i){for(let a=0;a<i.length;a++)if(Et.patternMatchVariance(n,i[a],Wt.MAX_INDIVIDUAL_VARIANCE)<Wt.MAX_AVG_VARIANCE)return a;throw new Y}static count(n){return ke.sum(new Int32Array(n))}static increment(n,i){let a=0,c=i[0];for(let d=1;d<n.length;d++)i[d]>c&&(c=i[d],a=d);n[a]++}static decrement(n,i){let a=0,c=i[0];for(let d=1;d<n.length;d++)i[d]<c&&(c=i[d],a=d);n[a]--}static isFinderPattern(n){let i=n[0]+n[1],a=i+n[2]+n[3],c=i/a;if(c>=Wt.MIN_FINDER_PATTERN_RATIO&&c<=Wt.MAX_FINDER_PATTERN_RATIO){let d=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER;for(let m of n)m>h&&(h=m),m<d&&(d=m);return h<10*d}return!1}}Wt.MAX_AVG_VARIANCE=.2,Wt.MAX_INDIVIDUAL_VARIANCE=.45,Wt.MIN_FINDER_PATTERN_RATIO=9.5/12,Wt.MAX_FINDER_PATTERN_RATIO=12.5/14;class ei{constructor(n,i){this.value=n,this.checksumPortion=i}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(n){if(!(n instanceof ei))return!1;const i=n;return this.value===i.value&&this.checksumPortion===i.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Eo{constructor(n,i,a,c,d){this.value=n,this.startEnd=i,this.value=n,this.startEnd=i,this.resultPoints=new Array,this.resultPoints.push(new de(a,d)),this.resultPoints.push(new de(c,d))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(n){if(!(n instanceof Eo))return!1;const i=n;return this.value===i.value}hashCode(){return this.value}}class hn{constructor(){}static getRSSvalue(n,i,a){let c=0;for(let p of n)c+=p;let d=0,h=0,m=n.length;for(let p=0;p<m-1;p++){let y;for(y=1,h|=1<<p;y<n[p];y++,h&=~(1<<p)){let b=hn.combins(c-y-1,m-p-2);if(a&&h===0&&c-y-(m-p-1)>=m-p-1&&(b-=hn.combins(c-y-(m-p),m-p-2)),m-p-1>1){let _=0;for(let R=c-y-(m-p-2);R>i;R--)_+=hn.combins(c-y-R-1,m-p-3);b-=_*(m-1-p)}else c-y>i&&b--;d+=b}c-=y}return d}static combins(n,i){let a,c;n-i>i?(c=i,a=n-i):(c=n-i,a=i);let d=1,h=1;for(let m=n;m>a;m--)d*=m,h<=c&&(d/=h,h++);for(;h<=c;)d/=h,h++;return d}}class wp{static buildBitArray(n){let i=n.length*2-1;n[n.length-1].getRightChar()==null&&(i-=1);let a=12*i,c=new O(a),d=0,m=n[0].getRightChar().getValue();for(let p=11;p>=0;--p)m&1<<p&&c.set(d),d++;for(let p=1;p<n.length;++p){let y=n[p],b=y.getLeftChar().getValue();for(let _=11;_>=0;--_)b&1<<_&&c.set(d),d++;if(y.getRightChar()!=null){let _=y.getRightChar().getValue();for(let R=11;R>=0;--R)_&1<<R&&c.set(d),d++}}return c}}class Ns{constructor(n,i){i?this.decodedInformation=null:(this.finished=n,this.decodedInformation=i)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Cc{constructor(n){this.newPosition=n}getNewPosition(){return this.newPosition}}class lr extends Cc{constructor(n,i){super(n),this.value=i}getValue(){return this.value}isFNC1(){return this.value===lr.FNC1}}lr.FNC1="$";class _s extends Cc{constructor(n,i,a){super(n),a?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=i}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Dr extends Cc{constructor(n,i,a){if(super(n),i<0||i>10||a<0||a>10)throw new U;this.firstDigit=i,this.secondDigit=a}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Dr.FNC1}isSecondDigitFNC1(){return this.secondDigit===Dr.FNC1}isAnyFNC1(){return this.firstDigit===Dr.FNC1||this.secondDigit===Dr.FNC1}}Dr.FNC1=10;class oe{constructor(){}static parseFieldsInGeneralPurpose(n){if(!n)return null;if(n.length<2)throw new Y;let i=n.substring(0,2);for(let d of oe.TWO_DIGIT_DATA_LENGTH)if(d[0]===i)return d[1]===oe.VARIABLE_LENGTH?oe.processVariableAI(2,d[2],n):oe.processFixedAI(2,d[1],n);if(n.length<3)throw new Y;let a=n.substring(0,3);for(let d of oe.THREE_DIGIT_DATA_LENGTH)if(d[0]===a)return d[1]===oe.VARIABLE_LENGTH?oe.processVariableAI(3,d[2],n):oe.processFixedAI(3,d[1],n);for(let d of oe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(d[0]===a)return d[1]===oe.VARIABLE_LENGTH?oe.processVariableAI(4,d[2],n):oe.processFixedAI(4,d[1],n);if(n.length<4)throw new Y;let c=n.substring(0,4);for(let d of oe.FOUR_DIGIT_DATA_LENGTH)if(d[0]===c)return d[1]===oe.VARIABLE_LENGTH?oe.processVariableAI(4,d[2],n):oe.processFixedAI(4,d[1],n);throw new Y}static processFixedAI(n,i,a){if(a.length<n)throw new Y;let c=a.substring(0,n);if(a.length<n+i)throw new Y;let d=a.substring(n,n+i),h=a.substring(n+i),m="("+c+")"+d,p=oe.parseFieldsInGeneralPurpose(h);return p==null?m:m+p}static processVariableAI(n,i,a){let c=a.substring(0,n),d;a.length<n+i?d=a.length:d=n+i;let h=a.substring(n,d),m=a.substring(d),p="("+c+")"+h,y=oe.parseFieldsInGeneralPurpose(m);return y==null?p:p+y}}oe.VARIABLE_LENGTH=[],oe.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",oe.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",oe.VARIABLE_LENGTH,20],["22",oe.VARIABLE_LENGTH,29],["30",oe.VARIABLE_LENGTH,8],["37",oe.VARIABLE_LENGTH,8],["90",oe.VARIABLE_LENGTH,30],["91",oe.VARIABLE_LENGTH,30],["92",oe.VARIABLE_LENGTH,30],["93",oe.VARIABLE_LENGTH,30],["94",oe.VARIABLE_LENGTH,30],["95",oe.VARIABLE_LENGTH,30],["96",oe.VARIABLE_LENGTH,30],["97",oe.VARIABLE_LENGTH,3],["98",oe.VARIABLE_LENGTH,30],["99",oe.VARIABLE_LENGTH,30]],oe.THREE_DIGIT_DATA_LENGTH=[["240",oe.VARIABLE_LENGTH,30],["241",oe.VARIABLE_LENGTH,30],["242",oe.VARIABLE_LENGTH,6],["250",oe.VARIABLE_LENGTH,30],["251",oe.VARIABLE_LENGTH,30],["253",oe.VARIABLE_LENGTH,17],["254",oe.VARIABLE_LENGTH,20],["400",oe.VARIABLE_LENGTH,30],["401",oe.VARIABLE_LENGTH,30],["402",17],["403",oe.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",oe.VARIABLE_LENGTH,20],["421",oe.VARIABLE_LENGTH,15],["422",3],["423",oe.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],oe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",oe.VARIABLE_LENGTH,15],["391",oe.VARIABLE_LENGTH,18],["392",oe.VARIABLE_LENGTH,15],["393",oe.VARIABLE_LENGTH,18],["703",oe.VARIABLE_LENGTH,30]],oe.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",oe.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",oe.VARIABLE_LENGTH,20],["8003",oe.VARIABLE_LENGTH,30],["8004",oe.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",oe.VARIABLE_LENGTH,30],["8008",oe.VARIABLE_LENGTH,12],["8018",18],["8020",oe.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",oe.VARIABLE_LENGTH,70],["8200",oe.VARIABLE_LENGTH,70]];class ti{constructor(n){this.buffer=new Ne,this.information=n}decodeAllCodes(n,i){let a=i,c=null;do{let d=this.decodeGeneralPurposeField(a,c),h=oe.parseFieldsInGeneralPurpose(d.getNewString());if(h!=null&&n.append(h),d.isRemaining()?c=""+d.getRemainingValue():c=null,a===d.getNewPosition())break;a=d.getNewPosition()}while(!0);return n.toString()}isStillNumeric(n){if(n+7>this.information.getSize())return n+4<=this.information.getSize();for(let i=n;i<n+3;++i)if(this.information.get(i))return!0;return this.information.get(n+3)}decodeNumeric(n){if(n+7>this.information.getSize()){let d=this.extractNumericValueFromBitArray(n,4);return d===0?new Dr(this.information.getSize(),Dr.FNC1,Dr.FNC1):new Dr(this.information.getSize(),d-1,Dr.FNC1)}let i=this.extractNumericValueFromBitArray(n,7),a=(i-8)/11,c=(i-8)%11;return new Dr(n+7,a,c)}extractNumericValueFromBitArray(n,i){return ti.extractNumericValueFromBitArray(this.information,n,i)}static extractNumericValueFromBitArray(n,i,a){let c=0;for(let d=0;d<a;++d)n.get(i+d)&&(c|=1<<a-d-1);return c}decodeGeneralPurposeField(n,i){this.buffer.setLengthToZero(),i!=null&&this.buffer.append(i),this.current.setPosition(n);let a=this.parseBlocks();return a!=null&&a.isRemaining()?new _s(this.current.getPosition(),this.buffer.toString(),a.getRemainingValue()):new _s(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let n,i;do{let a=this.current.getPosition();if(this.current.isAlpha()?(i=this.parseAlphaBlock(),n=i.isFinished()):this.current.isIsoIec646()?(i=this.parseIsoIec646Block(),n=i.isFinished()):(i=this.parseNumericBlock(),n=i.isFinished()),!(a!==this.current.getPosition())&&!n)break}while(!n);return i.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let n=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(n.getNewPosition()),n.isFirstDigitFNC1()){let i;return n.isSecondDigitFNC1()?i=new _s(this.current.getPosition(),this.buffer.toString()):i=new _s(this.current.getPosition(),this.buffer.toString(),n.getSecondDigit()),new Ns(!0,i)}if(this.buffer.append(n.getFirstDigit()),n.isSecondDigitFNC1()){let i=new _s(this.current.getPosition(),this.buffer.toString());return new Ns(!0,i)}this.buffer.append(n.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Ns(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let n=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(n.getNewPosition()),n.isFNC1()){let i=new _s(this.current.getPosition(),this.buffer.toString());return new Ns(!0,i)}this.buffer.append(n.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Ns(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let n=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(n.getNewPosition()),n.isFNC1()){let i=new _s(this.current.getPosition(),this.buffer.toString());return new Ns(!0,i)}this.buffer.append(n.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Ns(!1)}isStillIsoIec646(n){if(n+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(n,5);if(i>=5&&i<16)return!0;if(n+7>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(n,7);if(a>=64&&a<116)return!0;if(n+8>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(n,8);return c>=232&&c<253}decodeIsoIec646(n){let i=this.extractNumericValueFromBitArray(n,5);if(i===15)return new lr(n+5,lr.FNC1);if(i>=5&&i<15)return new lr(n+5,"0"+(i-5));let a=this.extractNumericValueFromBitArray(n,7);if(a>=64&&a<90)return new lr(n+7,""+(a+1));if(a>=90&&a<116)return new lr(n+7,""+(a+7));let c=this.extractNumericValueFromBitArray(n,8),d;switch(c){case 232:d="!";break;case 233:d='"';break;case 234:d="%";break;case 235:d="&";break;case 236:d="'";break;case 237:d="(";break;case 238:d=")";break;case 239:d="*";break;case 240:d="+";break;case 241:d=",";break;case 242:d="-";break;case 243:d=".";break;case 244:d="/";break;case 245:d=":";break;case 246:d=";";break;case 247:d="<";break;case 248:d="=";break;case 249:d=">";break;case 250:d="?";break;case 251:d="_";break;case 252:d=" ";break;default:throw new U}return new lr(n+8,d)}isStillAlpha(n){if(n+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(n,5);if(i>=5&&i<16)return!0;if(n+6>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(n,6);return a>=16&&a<63}decodeAlphanumeric(n){let i=this.extractNumericValueFromBitArray(n,5);if(i===15)return new lr(n+5,lr.FNC1);if(i>=5&&i<15)return new lr(n+5,"0"+(i-5));let a=this.extractNumericValueFromBitArray(n,6);if(a>=32&&a<58)return new lr(n+6,""+(a+33));let c;switch(a){case 58:c="*";break;case 59:c=",";break;case 60:c="-";break;case 61:c=".";break;case 62:c="/";break;default:throw new dn("Decoding invalid alphanumeric value: "+a)}return new lr(n+6,c)}isAlphaTo646ToAlphaLatch(n){if(n+1>this.information.getSize())return!1;for(let i=0;i<5&&i+n<this.information.getSize();++i)if(i===2){if(!this.information.get(n+2))return!1}else if(this.information.get(n+i))return!1;return!0}isAlphaOr646ToNumericLatch(n){if(n+3>this.information.getSize())return!1;for(let i=n;i<n+3;++i)if(this.information.get(i))return!1;return!0}isNumericToAlphaNumericLatch(n){if(n+1>this.information.getSize())return!1;for(let i=0;i<4&&i+n<this.information.getSize();++i)if(this.information.get(n+i))return!1;return!0}}class Nc{constructor(n){this.information=n,this.generalDecoder=new ti(n)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class cr extends Nc{constructor(n){super(n)}encodeCompressedGtin(n,i){n.append("(01)");let a=n.length();n.append("9"),this.encodeCompressedGtinWithoutAI(n,i,a)}encodeCompressedGtinWithoutAI(n,i,a){for(let c=0;c<4;++c){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(i+10*c,10);d/100===0&&n.append("0"),d/10===0&&n.append("0"),n.append(d)}cr.appendCheckDigit(n,a)}static appendCheckDigit(n,i){let a=0;for(let c=0;c<13;c++){let d=n.charAt(c+i).charCodeAt(0)-48;a+=c&1?d:3*d}a=10-a%10,a===10&&(a=0),n.append(a)}}cr.GTIN_SIZE=40;class ri extends cr{constructor(n){super(n)}parseInformation(){let n=new Ne;n.append("(01)");let i=n.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(ri.HEADER_SIZE,4);return n.append(a),this.encodeCompressedGtinWithoutAI(n,ri.HEADER_SIZE+4,i),this.getGeneralDecoder().decodeAllCodes(n,ri.HEADER_SIZE+44)}}ri.HEADER_SIZE=4;class Co extends Nc{constructor(n){super(n)}parseInformation(){let n=new Ne;return this.getGeneralDecoder().decodeAllCodes(n,Co.HEADER_SIZE)}}Co.HEADER_SIZE=5;class No extends cr{constructor(n){super(n)}encodeCompressedWeight(n,i,a){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(i,a);this.addWeightCode(n,c);let d=this.checkWeight(c),h=1e5;for(let m=0;m<5;++m)d/h===0&&n.append("0"),h/=10;n.append(d)}}class fn extends No{constructor(n){super(n)}parseInformation(){if(this.getInformation().getSize()!=fn.HEADER_SIZE+No.GTIN_SIZE+fn.WEIGHT_SIZE)throw new Y;let n=new Ne;return this.encodeCompressedGtin(n,fn.HEADER_SIZE),this.encodeCompressedWeight(n,fn.HEADER_SIZE+No.GTIN_SIZE,fn.WEIGHT_SIZE),n.toString()}}fn.HEADER_SIZE=5,fn.WEIGHT_SIZE=15;class yp extends fn{constructor(n){super(n)}addWeightCode(n,i){n.append("(3103)")}checkWeight(n){return n}}class vp extends fn{constructor(n){super(n)}addWeightCode(n,i){i<1e4?n.append("(3202)"):n.append("(3203)")}checkWeight(n){return n<1e4?n:n-1e4}}class mn extends cr{constructor(n){super(n)}parseInformation(){if(this.getInformation().getSize()<mn.HEADER_SIZE+cr.GTIN_SIZE)throw new Y;let n=new Ne;this.encodeCompressedGtin(n,mn.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(mn.HEADER_SIZE+cr.GTIN_SIZE,mn.LAST_DIGIT_SIZE);n.append("(392"),n.append(i),n.append(")");let a=this.getGeneralDecoder().decodeGeneralPurposeField(mn.HEADER_SIZE+cr.GTIN_SIZE+mn.LAST_DIGIT_SIZE,null);return n.append(a.getNewString()),n.toString()}}mn.HEADER_SIZE=8,mn.LAST_DIGIT_SIZE=2;class Jt extends cr{constructor(n){super(n)}parseInformation(){if(this.getInformation().getSize()<Jt.HEADER_SIZE+cr.GTIN_SIZE)throw new Y;let n=new Ne;this.encodeCompressedGtin(n,Jt.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(Jt.HEADER_SIZE+cr.GTIN_SIZE,Jt.LAST_DIGIT_SIZE);n.append("(393"),n.append(i),n.append(")");let a=this.getGeneralDecoder().extractNumericValueFromBitArray(Jt.HEADER_SIZE+cr.GTIN_SIZE+Jt.LAST_DIGIT_SIZE,Jt.FIRST_THREE_DIGITS_SIZE);a/100==0&&n.append("0"),a/10==0&&n.append("0"),n.append(a);let c=this.getGeneralDecoder().decodeGeneralPurposeField(Jt.HEADER_SIZE+cr.GTIN_SIZE+Jt.LAST_DIGIT_SIZE+Jt.FIRST_THREE_DIGITS_SIZE,null);return n.append(c.getNewString()),n.toString()}}Jt.HEADER_SIZE=8,Jt.LAST_DIGIT_SIZE=2,Jt.FIRST_THREE_DIGITS_SIZE=10;class st extends No{constructor(n,i,a){super(n),this.dateCode=a,this.firstAIdigits=i}parseInformation(){if(this.getInformation().getSize()!=st.HEADER_SIZE+st.GTIN_SIZE+st.WEIGHT_SIZE+st.DATE_SIZE)throw new Y;let n=new Ne;return this.encodeCompressedGtin(n,st.HEADER_SIZE),this.encodeCompressedWeight(n,st.HEADER_SIZE+st.GTIN_SIZE,st.WEIGHT_SIZE),this.encodeCompressedDate(n,st.HEADER_SIZE+st.GTIN_SIZE+st.WEIGHT_SIZE),n.toString()}encodeCompressedDate(n,i){let a=this.getGeneralDecoder().extractNumericValueFromBitArray(i,st.DATE_SIZE);if(a==38400)return;n.append("("),n.append(this.dateCode),n.append(")");let c=a%32;a/=32;let d=a%12+1;a/=12;let h=a;h/10==0&&n.append("0"),n.append(h),d/10==0&&n.append("0"),n.append(d),c/10==0&&n.append("0"),n.append(c)}addWeightCode(n,i){n.append("("),n.append(this.firstAIdigits),n.append(i/1e5),n.append(")")}checkWeight(n){return n%1e5}}st.HEADER_SIZE=8,st.WEIGHT_SIZE=20,st.DATE_SIZE=16;function s0(N){try{if(N.get(1))return new ri(N);if(!N.get(2))return new Co(N);switch(ti.extractNumericValueFromBitArray(N,1,4)){case 4:return new yp(N);case 5:return new vp(N)}switch(ti.extractNumericValueFromBitArray(N,1,5)){case 12:return new mn(N);case 13:return new Jt(N)}switch(ti.extractNumericValueFromBitArray(N,1,7)){case 56:return new st(N,"310","11");case 57:return new st(N,"320","11");case 58:return new st(N,"310","13");case 59:return new st(N,"320","13");case 60:return new st(N,"310","15");case 61:return new st(N,"320","15");case 62:return new st(N,"310","17");case 63:return new st(N,"320","17")}}catch(n){throw console.log(n),new dn("unknown decoder: "+N)}}class Vn{constructor(n,i,a,c){this.leftchar=n,this.rightchar=i,this.finderpattern=a,this.maybeLast=c}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(n,i){return n instanceof Vn?Vn.equalsOrNull(n.leftchar,i.leftchar)&&Vn.equalsOrNull(n.rightchar,i.rightchar)&&Vn.equalsOrNull(n.finderpattern,i.finderpattern):!1}static equalsOrNull(n,i){return n===null?i===null:Vn.equals(n,i)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class _c{constructor(n,i,a){this.pairs=n,this.rowNumber=i,this.wasReversed=a}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(n){return this.checkEqualitity(this,n)}toString(){return"{ "+this.pairs+" }"}equals(n,i){return n instanceof _c?this.checkEqualitity(n,i)&&n.wasReversed===i.wasReversed:!1}checkEqualitity(n,i){if(!n||!i)return;let a;return n.forEach((c,d)=>{i.forEach(h=>{c.getLeftChar().getValue()===h.getLeftChar().getValue()&&c.getRightChar().getValue()===h.getRightChar().getValue()&&c.getFinderPatter().getValue()===h.getFinderPatter().getValue()&&(a=!0)})}),a}}class K extends Wt{constructor(n){super(...arguments),this.pairs=new Array(K.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=n===!0}decodeRow(n,i,a){this.pairs.length=0,this.startFromEven=!1;try{return K.constructResult(this.decodeRow2pairs(n,i))}catch(c){this.verbose&&console.log(c)}return this.pairs.length=0,this.startFromEven=!0,K.constructResult(this.decodeRow2pairs(n,i))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(n,i){let a=!1;for(;!a;)try{this.pairs.push(this.retrieveNextPair(i,this.pairs,n))}catch(d){if(d instanceof Y){if(!this.pairs.length)throw new Y;a=!0}}if(this.checkChecksum())return this.pairs;let c;if(this.rows.length?c=!0:c=!1,this.storeRow(n,!1),c){let d=this.checkRowsBoolean(!1);if(d!=null||(d=this.checkRowsBoolean(!0),d!=null))return d}throw new Y}checkRowsBoolean(n){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,n&&(this.rows=this.rows.reverse());let i=null;try{i=this.checkRows(new Array,0)}catch(a){this.verbose&&console.log(a)}return n&&(this.rows=this.rows.reverse()),i}checkRows(n,i){for(let a=i;a<this.rows.length;a++){let c=this.rows[a];this.pairs.length=0;for(let h of n)this.pairs.push(h.getPairs());if(this.pairs.push(c.getPairs()),!K.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let d=new Array(n);d.push(c);try{return this.checkRows(d,a+1)}catch(h){this.verbose&&console.log(h)}}throw new Y}static isValidSequence(n){for(let i of K.FINDER_PATTERN_SEQUENCES){if(n.length>i.length)continue;let a=!0;for(let c=0;c<n.length;c++)if(n[c].getFinderPattern().getValue()!=i[c]){a=!1;break}if(a)return!0}return!1}storeRow(n,i){let a=0,c=!1,d=!1;for(;a<this.rows.length;){let h=this.rows[a];if(h.getRowNumber()>n){d=h.isEquivalent(this.pairs);break}c=h.isEquivalent(this.pairs),a++}d||c||K.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new _c(this.pairs,n,i)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(n,i){for(let a of i)if(a.getPairs().length!==n.length){for(let c of a.getPairs())for(let d of n)if(Vn.equals(c,d))break}}static isPartialRow(n,i){for(let a of i){let c=!0;for(let d of n){let h=!1;for(let m of a.getPairs())if(d.equals(m)){h=!0;break}if(!h){c=!1;break}}if(c)return!0}return!1}getRows(){return this.rows}static constructResult(n){let i=wp.buildBitArray(n),c=s0(i).parseInformation(),d=n[0].getFinderPattern().getResultPoints(),h=n[n.length-1].getFinderPattern().getResultPoints(),m=[d[0],d[1],h[0],h[1]];return new Ie(c,null,null,m,se.RSS_EXPANDED,null)}checkChecksum(){let n=this.pairs.get(0),i=n.getLeftChar(),a=n.getRightChar();if(a==null)return!1;let c=a.getChecksumPortion(),d=2;for(let m=1;m<this.pairs.size();++m){let p=this.pairs.get(m);c+=p.getLeftChar().getChecksumPortion(),d++;let y=p.getRightChar();y!=null&&(c+=y.getChecksumPortion(),d++)}return c%=211,211*(d-4)+c==i.getValue()}static getNextSecondBar(n,i){let a;return n.get(i)?(a=n.getNextUnset(i),a=n.getNextSet(a)):(a=n.getNextSet(i),a=n.getNextUnset(a)),a}retrieveNextPair(n,i,a){let c=i.length%2==0;this.startFromEven&&(c=!c);let d,h=!0,m=-1;do this.findNextPair(n,i,m),d=this.parseFoundFinderPattern(n,a,c),d==null?m=K.getNextSecondBar(n,this.startEnd[0]):h=!1;while(h);let p=this.decodeDataCharacter(n,d,c,!0);if(!this.isEmptyPair(i)&&i[i.length-1].mustBeLast())throw new Y;let y;try{y=this.decodeDataCharacter(n,d,c,!1)}catch(b){y=null,this.verbose&&console.log(b)}return new Vn(p,y,d,!0)}isEmptyPair(n){return n.length===0}findNextPair(n,i,a){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let d=n.getSize(),h;a>=0?h=a:this.isEmptyPair(i)?h=0:h=i[i.length-1].getFinderPattern().getStartEnd()[1];let m=i.length%2!=0;this.startFromEven&&(m=!m);let p=!1;for(;h<d&&(p=!n.get(h),!!p);)h++;let y=0,b=h;for(let _=h;_<d;_++)if(n.get(_)!=p)c[y]++;else{if(y==3){if(m&&K.reverseCounters(c),K.isFinderPattern(c)){this.startEnd[0]=b,this.startEnd[1]=_;return}m&&K.reverseCounters(c),b+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,y--}else y++;c[y]=1,p=!p}throw new Y}static reverseCounters(n){let i=n.length;for(let a=0;a<i/2;++a){let c=n[a];n[a]=n[i-a-1],n[i-a-1]=c}}parseFoundFinderPattern(n,i,a){let c,d,h;if(a){let y=this.startEnd[0]-1;for(;y>=0&&!n.get(y);)y--;y++,c=this.startEnd[0]-y,d=y,h=this.startEnd[1]}else d=this.startEnd[0],h=n.getNextUnset(this.startEnd[1]+1),c=h-this.startEnd[1];let m=this.getDecodeFinderCounters();j.arraycopy(m,0,m,1,m.length-1),m[0]=c;let p;try{p=this.parseFinderValue(m,K.FINDER_PATTERNS)}catch{return null}return new Eo(p,[d,h],d,h,i)}decodeDataCharacter(n,i,a,c){let d=this.getDataCharacterCounters();for(let Xe=0;Xe<d.length;Xe++)d[Xe]=0;if(c)K.recordPatternInReverse(n,i.getStartEnd()[0],d);else{K.recordPattern(n,i.getStartEnd()[1],d);for(let Xe=0,Ft=d.length-1;Xe<Ft;Xe++,Ft--){let vr=d[Xe];d[Xe]=d[Ft],d[Ft]=vr}}let h=17,m=ke.sum(new Int32Array(d))/h,p=(i.getStartEnd()[1]-i.getStartEnd()[0])/15;if(Math.abs(m-p)/p>.3)throw new Y;let y=this.getOddCounts(),b=this.getEvenCounts(),_=this.getOddRoundingErrors(),R=this.getEvenRoundingErrors();for(let Xe=0;Xe<d.length;Xe++){let Ft=1*d[Xe]/m,vr=Ft+.5;if(vr<1){if(Ft<.3)throw new Y;vr=1}else if(vr>8){if(Ft>8.7)throw new Y;vr=8}let oi=Xe/2;Xe&1?(b[oi]=vr,R[oi]=Ft-vr):(y[oi]=vr,_[oi]=Ft-vr)}this.adjustOddEvenCounts(h);let L=4*i.getValue()+(a?0:2)+(c?0:1)-1,B=0,F=0;for(let Xe=y.length-1;Xe>=0;Xe--){if(K.isNotA1left(i,a,c)){let Ft=K.WEIGHTS[L][2*Xe];F+=y[Xe]*Ft}B+=y[Xe]}let H=0;for(let Xe=b.length-1;Xe>=0;Xe--)if(K.isNotA1left(i,a,c)){let Ft=K.WEIGHTS[L][2*Xe+1];H+=b[Xe]*Ft}let q=F+H;if(B&1||B>13||B<4)throw new Y;let ee=(13-B)/2,re=K.SYMBOL_WIDEST[ee],Z=9-re,Re=hn.getRSSvalue(y,re,!0),_e=hn.getRSSvalue(b,Z,!1),dr=K.EVEN_TOTAL_SUBSET[ee],Yr=K.GSUM[ee],hr=Re*dr+_e+Yr;return new ei(hr,q)}static isNotA1left(n,i,a){return!(n.getValue()==0&&i&&a)}adjustOddEvenCounts(n){let i=ke.sum(new Int32Array(this.getOddCounts())),a=ke.sum(new Int32Array(this.getEvenCounts())),c=!1,d=!1;i>13?d=!0:i<4&&(c=!0);let h=!1,m=!1;a>13?m=!0:a<4&&(h=!0);let p=i+a-n,y=(i&1)==1,b=(a&1)==0;if(p==1)if(y){if(b)throw new Y;d=!0}else{if(!b)throw new Y;m=!0}else if(p==-1)if(y){if(b)throw new Y;c=!0}else{if(!b)throw new Y;h=!0}else if(p==0){if(y){if(!b)throw new Y;i<a?(c=!0,m=!0):(d=!0,h=!0)}else if(b)throw new Y}else throw new Y;if(c){if(d)throw new Y;K.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&K.decrement(this.getOddCounts(),this.getOddRoundingErrors()),h){if(m)throw new Y;K.increment(this.getEvenCounts(),this.getOddRoundingErrors())}m&&K.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}K.SYMBOL_WIDEST=[7,5,4,3,1],K.EVEN_TOTAL_SUBSET=[4,20,52,104,204],K.GSUM=[0,348,1388,2948,3988],K.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],K.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],K.FINDER_PAT_A=0,K.FINDER_PAT_B=1,K.FINDER_PAT_C=2,K.FINDER_PAT_D=3,K.FINDER_PAT_E=4,K.FINDER_PAT_F=5,K.FINDER_PATTERN_SEQUENCES=[[K.FINDER_PAT_A,K.FINDER_PAT_A],[K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B],[K.FINDER_PAT_A,K.FINDER_PAT_C,K.FINDER_PAT_B,K.FINDER_PAT_D],[K.FINDER_PAT_A,K.FINDER_PAT_E,K.FINDER_PAT_B,K.FINDER_PAT_D,K.FINDER_PAT_C],[K.FINDER_PAT_A,K.FINDER_PAT_E,K.FINDER_PAT_B,K.FINDER_PAT_D,K.FINDER_PAT_D,K.FINDER_PAT_F],[K.FINDER_PAT_A,K.FINDER_PAT_E,K.FINDER_PAT_B,K.FINDER_PAT_D,K.FINDER_PAT_E,K.FINDER_PAT_F,K.FINDER_PAT_F],[K.FINDER_PAT_A,K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B,K.FINDER_PAT_C,K.FINDER_PAT_C,K.FINDER_PAT_D,K.FINDER_PAT_D],[K.FINDER_PAT_A,K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B,K.FINDER_PAT_C,K.FINDER_PAT_C,K.FINDER_PAT_D,K.FINDER_PAT_E,K.FINDER_PAT_E],[K.FINDER_PAT_A,K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B,K.FINDER_PAT_C,K.FINDER_PAT_C,K.FINDER_PAT_D,K.FINDER_PAT_E,K.FINDER_PAT_F,K.FINDER_PAT_F],[K.FINDER_PAT_A,K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B,K.FINDER_PAT_C,K.FINDER_PAT_D,K.FINDER_PAT_D,K.FINDER_PAT_E,K.FINDER_PAT_E,K.FINDER_PAT_F,K.FINDER_PAT_F]],K.MAX_PAIRS=11;class bp extends ei{constructor(n,i,a){super(n,i),this.count=0,this.finderPattern=a}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class mt extends Wt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(n,i,a){const c=this.decodePair(i,!1,n,a);mt.addOrTally(this.possibleLeftPairs,c),i.reverse();let d=this.decodePair(i,!0,n,a);mt.addOrTally(this.possibleRightPairs,d),i.reverse();for(let h of this.possibleLeftPairs)if(h.getCount()>1){for(let m of this.possibleRightPairs)if(m.getCount()>1&&mt.checkChecksum(h,m))return mt.constructResult(h,m)}throw new Y}static addOrTally(n,i){if(i==null)return;let a=!1;for(let c of n)if(c.getValue()===i.getValue()){c.incrementCount(),a=!0;break}a||n.push(i)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(n,i){let a=4537077*n.getValue()+i.getValue(),c=new String(a).toString(),d=new Ne;for(let y=13-c.length;y>0;y--)d.append("0");d.append(c);let h=0;for(let y=0;y<13;y++){let b=d.charAt(y).charCodeAt(0)-48;h+=y&1?b:3*b}h=10-h%10,h===10&&(h=0),d.append(h.toString());let m=n.getFinderPattern().getResultPoints(),p=i.getFinderPattern().getResultPoints();return new Ie(d.toString(),null,0,[m[0],m[1],p[0],p[1]],se.RSS_14,new Date().getTime())}static checkChecksum(n,i){let a=(n.getChecksumPortion()+16*i.getChecksumPortion())%79,c=9*n.getFinderPattern().getValue()+i.getFinderPattern().getValue();return c>72&&c--,c>8&&c--,a===c}decodePair(n,i,a,c){try{let d=this.findFinderPattern(n,i),h=this.parseFoundFinderPattern(n,a,i,d),m=c==null?null:c.get(z.NEED_RESULT_POINT_CALLBACK);if(m!=null){let b=(d[0]+d[1])/2;i&&(b=n.getSize()-1-b),m.foundPossibleResultPoint(new de(b,a))}let p=this.decodeDataCharacter(n,h,!0),y=this.decodeDataCharacter(n,h,!1);return new bp(1597*p.getValue()+y.getValue(),p.getChecksumPortion()+4*y.getChecksumPortion(),h)}catch{return null}}decodeDataCharacter(n,i,a){let c=this.getDataCharacterCounters();for(let H=0;H<c.length;H++)c[H]=0;if(a)Et.recordPatternInReverse(n,i.getStartEnd()[0],c);else{Et.recordPattern(n,i.getStartEnd()[1]+1,c);for(let H=0,q=c.length-1;H<q;H++,q--){let ee=c[H];c[H]=c[q],c[q]=ee}}let d=a?16:15,h=ke.sum(new Int32Array(c))/d,m=this.getOddCounts(),p=this.getEvenCounts(),y=this.getOddRoundingErrors(),b=this.getEvenRoundingErrors();for(let H=0;H<c.length;H++){let q=c[H]/h,ee=Math.floor(q+.5);ee<1?ee=1:ee>8&&(ee=8);let re=Math.floor(H/2);H&1?(p[re]=ee,b[re]=q-ee):(m[re]=ee,y[re]=q-ee)}this.adjustOddEvenCounts(a,d);let _=0,R=0;for(let H=m.length-1;H>=0;H--)R*=9,R+=m[H],_+=m[H];let L=0,B=0;for(let H=p.length-1;H>=0;H--)L*=9,L+=p[H],B+=p[H];let F=R+3*L;if(a){if(_&1||_>12||_<4)throw new Y;let H=(12-_)/2,q=mt.OUTSIDE_ODD_WIDEST[H],ee=9-q,re=hn.getRSSvalue(m,q,!1),Z=hn.getRSSvalue(p,ee,!0),Re=mt.OUTSIDE_EVEN_TOTAL_SUBSET[H],_e=mt.OUTSIDE_GSUM[H];return new ei(re*Re+Z+_e,F)}else{if(B&1||B>10||B<4)throw new Y;let H=(10-B)/2,q=mt.INSIDE_ODD_WIDEST[H],ee=9-q,re=hn.getRSSvalue(m,q,!0),Z=hn.getRSSvalue(p,ee,!1),Re=mt.INSIDE_ODD_TOTAL_SUBSET[H],_e=mt.INSIDE_GSUM[H];return new ei(Z*Re+re+_e,F)}}findFinderPattern(n,i){let a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;let c=n.getSize(),d=!1,h=0;for(;h<c&&(d=!n.get(h),i!==d);)h++;let m=0,p=h;for(let y=h;y<c;y++)if(n.get(y)!==d)a[m]++;else{if(m===3){if(Wt.isFinderPattern(a))return[p,y];p+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,m--}else m++;a[m]=1,d=!d}throw new Y}parseFoundFinderPattern(n,i,a,c){let d=n.get(c[0]),h=c[0]-1;for(;h>=0&&d!==n.get(h);)h--;h++;const m=c[0]-h,p=this.getDecodeFinderCounters(),y=new Int32Array(p.length);j.arraycopy(p,0,y,1,p.length-1),y[0]=m;const b=this.parseFinderValue(y,mt.FINDER_PATTERNS);let _=h,R=c[1];return a&&(_=n.getSize()-1-_,R=n.getSize()-1-R),new Eo(b,[h,c[1]],_,R,i)}adjustOddEvenCounts(n,i){let a=ke.sum(new Int32Array(this.getOddCounts())),c=ke.sum(new Int32Array(this.getEvenCounts())),d=!1,h=!1,m=!1,p=!1;n?(a>12?h=!0:a<4&&(d=!0),c>12?p=!0:c<4&&(m=!0)):(a>11?h=!0:a<5&&(d=!0),c>10?p=!0:c<4&&(m=!0));let y=a+c-i,b=(a&1)===(n?1:0),_=(c&1)===1;if(y===1)if(b){if(_)throw new Y;h=!0}else{if(!_)throw new Y;p=!0}else if(y===-1)if(b){if(_)throw new Y;d=!0}else{if(!_)throw new Y;m=!0}else if(y===0){if(b){if(!_)throw new Y;a<c?(d=!0,p=!0):(h=!0,m=!0)}else if(_)throw new Y}else throw new Y;if(d){if(h)throw new Y;Wt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(h&&Wt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),m){if(p)throw new Y;Wt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}p&&Wt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}mt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],mt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],mt.OUTSIDE_GSUM=[0,161,961,2015,2715],mt.INSIDE_GSUM=[0,336,1036,1516],mt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],mt.INSIDE_ODD_WIDEST=[2,4,6,8],mt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class ni extends Et{constructor(n,i){super(),this.readers=[],this.verbose=i===!0;const a=n?n.get(z.POSSIBLE_FORMATS):null,c=n&&n.get(z.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;a?((a.includes(se.EAN_13)||a.includes(se.UPC_A)||a.includes(se.EAN_8)||a.includes(se.UPC_E))&&this.readers.push(new Ec(n)),a.includes(se.CODE_39)&&this.readers.push(new _t(c)),a.includes(se.CODE_128)&&this.readers.push(new ne),a.includes(se.ITF)&&this.readers.push(new Ge),a.includes(se.RSS_14)&&this.readers.push(new mt),a.includes(se.RSS_EXPANDED)&&this.readers.push(new K(this.verbose))):(this.readers.push(new Ec(n)),this.readers.push(new _t),this.readers.push(new Ec(n)),this.readers.push(new ne),this.readers.push(new Ge),this.readers.push(new mt),this.readers.push(new K(this.verbose)))}decodeRow(n,i,a){for(let c=0;c<this.readers.length;c++)try{return this.readers[c].decodeRow(n,i,a)}catch{}throw new Y}reset(){this.readers.forEach(n=>n.reset())}}class Ep extends Dt{constructor(n=500,i){super(new ni(i),n,i)}}class Fe{constructor(n,i,a){this.ecCodewords=n,this.ecBlocks=[i],a&&this.ecBlocks.push(a)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Be{constructor(n,i){this.count=n,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Oe{constructor(n,i,a,c,d,h){this.versionNumber=n,this.symbolSizeRows=i,this.symbolSizeColumns=a,this.dataRegionSizeRows=c,this.dataRegionSizeColumns=d,this.ecBlocks=h;let m=0;const p=h.getECCodewords(),y=h.getECBlocks();for(let b of y)m+=b.getCount()*(b.getDataCodewords()+p);this.totalCodewords=m}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(n,i){if(n&1||i&1)throw new U;for(let a of Oe.VERSIONS)if(a.symbolSizeRows===n&&a.symbolSizeColumns===i)return a;throw new U}toString(){return""+this.versionNumber}static buildVersions(){return[new Oe(1,10,10,8,8,new Fe(5,new Be(1,3))),new Oe(2,12,12,10,10,new Fe(7,new Be(1,5))),new Oe(3,14,14,12,12,new Fe(10,new Be(1,8))),new Oe(4,16,16,14,14,new Fe(12,new Be(1,12))),new Oe(5,18,18,16,16,new Fe(14,new Be(1,18))),new Oe(6,20,20,18,18,new Fe(18,new Be(1,22))),new Oe(7,22,22,20,20,new Fe(20,new Be(1,30))),new Oe(8,24,24,22,22,new Fe(24,new Be(1,36))),new Oe(9,26,26,24,24,new Fe(28,new Be(1,44))),new Oe(10,32,32,14,14,new Fe(36,new Be(1,62))),new Oe(11,36,36,16,16,new Fe(42,new Be(1,86))),new Oe(12,40,40,18,18,new Fe(48,new Be(1,114))),new Oe(13,44,44,20,20,new Fe(56,new Be(1,144))),new Oe(14,48,48,22,22,new Fe(68,new Be(1,174))),new Oe(15,52,52,24,24,new Fe(42,new Be(2,102))),new Oe(16,64,64,14,14,new Fe(56,new Be(2,140))),new Oe(17,72,72,16,16,new Fe(36,new Be(4,92))),new Oe(18,80,80,18,18,new Fe(48,new Be(4,114))),new Oe(19,88,88,20,20,new Fe(56,new Be(4,144))),new Oe(20,96,96,22,22,new Fe(68,new Be(4,174))),new Oe(21,104,104,24,24,new Fe(56,new Be(6,136))),new Oe(22,120,120,18,18,new Fe(68,new Be(6,175))),new Oe(23,132,132,20,20,new Fe(62,new Be(8,163))),new Oe(24,144,144,22,22,new Fe(62,new Be(8,156),new Be(2,155))),new Oe(25,8,18,6,16,new Fe(7,new Be(1,5))),new Oe(26,8,32,6,14,new Fe(11,new Be(1,10))),new Oe(27,12,26,10,24,new Fe(14,new Be(1,16))),new Oe(28,12,36,10,16,new Fe(18,new Be(1,22))),new Oe(29,16,36,14,16,new Fe(24,new Be(1,32))),new Oe(30,16,48,14,22,new Fe(28,new Be(1,49)))]}}Oe.VERSIONS=Oe.buildVersions();class Sc{constructor(n){const i=n.getHeight();if(i<8||i>144||i&1)throw new U;this.version=Sc.readVersion(n),this.mappingBitMatrix=this.extractDataRegion(n),this.readMappingMatrix=new We(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(n){const i=n.getHeight(),a=n.getWidth();return Oe.getVersionForDimensions(i,a)}readCodewords(){const n=new Int8Array(this.version.getTotalCodewords());let i=0,a=4,c=0;const d=this.mappingBitMatrix.getHeight(),h=this.mappingBitMatrix.getWidth();let m=!1,p=!1,y=!1,b=!1;do if(a===d&&c===0&&!m)n[i++]=this.readCorner1(d,h)&255,a-=2,c+=2,m=!0;else if(a===d-2&&c===0&&h&3&&!p)n[i++]=this.readCorner2(d,h)&255,a-=2,c+=2,p=!0;else if(a===d+4&&c===2&&!(h&7)&&!y)n[i++]=this.readCorner3(d,h)&255,a-=2,c+=2,y=!0;else if(a===d-2&&c===0&&(h&7)===4&&!b)n[i++]=this.readCorner4(d,h)&255,a-=2,c+=2,b=!0;else{do a<d&&c>=0&&!this.readMappingMatrix.get(c,a)&&(n[i++]=this.readUtah(a,c,d,h)&255),a-=2,c+=2;while(a>=0&&c<h);a+=1,c+=3;do a>=0&&c<h&&!this.readMappingMatrix.get(c,a)&&(n[i++]=this.readUtah(a,c,d,h)&255),a+=2,c-=2;while(a<d&&c>=0);a+=3,c+=1}while(a<d||c<h);if(i!==this.version.getTotalCodewords())throw new U;return n}readModule(n,i,a,c){return n<0&&(n+=a,i+=4-(a+4&7)),i<0&&(i+=c,n+=4-(c+4&7)),this.readMappingMatrix.set(i,n),this.mappingBitMatrix.get(i,n)}readUtah(n,i,a,c){let d=0;return this.readModule(n-2,i-2,a,c)&&(d|=1),d<<=1,this.readModule(n-2,i-1,a,c)&&(d|=1),d<<=1,this.readModule(n-1,i-2,a,c)&&(d|=1),d<<=1,this.readModule(n-1,i-1,a,c)&&(d|=1),d<<=1,this.readModule(n-1,i,a,c)&&(d|=1),d<<=1,this.readModule(n,i-2,a,c)&&(d|=1),d<<=1,this.readModule(n,i-1,a,c)&&(d|=1),d<<=1,this.readModule(n,i,a,c)&&(d|=1),d}readCorner1(n,i){let a=0;return this.readModule(n-1,0,n,i)&&(a|=1),a<<=1,this.readModule(n-1,1,n,i)&&(a|=1),a<<=1,this.readModule(n-1,2,n,i)&&(a|=1),a<<=1,this.readModule(0,i-2,n,i)&&(a|=1),a<<=1,this.readModule(0,i-1,n,i)&&(a|=1),a<<=1,this.readModule(1,i-1,n,i)&&(a|=1),a<<=1,this.readModule(2,i-1,n,i)&&(a|=1),a<<=1,this.readModule(3,i-1,n,i)&&(a|=1),a}readCorner2(n,i){let a=0;return this.readModule(n-3,0,n,i)&&(a|=1),a<<=1,this.readModule(n-2,0,n,i)&&(a|=1),a<<=1,this.readModule(n-1,0,n,i)&&(a|=1),a<<=1,this.readModule(0,i-4,n,i)&&(a|=1),a<<=1,this.readModule(0,i-3,n,i)&&(a|=1),a<<=1,this.readModule(0,i-2,n,i)&&(a|=1),a<<=1,this.readModule(0,i-1,n,i)&&(a|=1),a<<=1,this.readModule(1,i-1,n,i)&&(a|=1),a}readCorner3(n,i){let a=0;return this.readModule(n-1,0,n,i)&&(a|=1),a<<=1,this.readModule(n-1,i-1,n,i)&&(a|=1),a<<=1,this.readModule(0,i-3,n,i)&&(a|=1),a<<=1,this.readModule(0,i-2,n,i)&&(a|=1),a<<=1,this.readModule(0,i-1,n,i)&&(a|=1),a<<=1,this.readModule(1,i-3,n,i)&&(a|=1),a<<=1,this.readModule(1,i-2,n,i)&&(a|=1),a<<=1,this.readModule(1,i-1,n,i)&&(a|=1),a}readCorner4(n,i){let a=0;return this.readModule(n-3,0,n,i)&&(a|=1),a<<=1,this.readModule(n-2,0,n,i)&&(a|=1),a<<=1,this.readModule(n-1,0,n,i)&&(a|=1),a<<=1,this.readModule(0,i-2,n,i)&&(a|=1),a<<=1,this.readModule(0,i-1,n,i)&&(a|=1),a<<=1,this.readModule(1,i-1,n,i)&&(a|=1),a<<=1,this.readModule(2,i-1,n,i)&&(a|=1),a<<=1,this.readModule(3,i-1,n,i)&&(a|=1),a}extractDataRegion(n){const i=this.version.getSymbolSizeRows(),a=this.version.getSymbolSizeColumns();if(n.getHeight()!==i)throw new E("Dimension of bitMatrix must match the version size");const c=this.version.getDataRegionSizeRows(),d=this.version.getDataRegionSizeColumns(),h=i/c|0,m=a/d|0,p=h*c,y=m*d,b=new We(y,p);for(let _=0;_<h;++_){const R=_*c;for(let L=0;L<m;++L){const B=L*d;for(let F=0;F<c;++F){const H=_*(c+2)+1+F,q=R+F;for(let ee=0;ee<d;++ee){const re=L*(d+2)+1+ee;if(n.get(re,H)){const Z=B+ee;b.set(Z,q)}}}}}return b}}class Ac{constructor(n,i){this.numDataCodewords=n,this.codewords=i}static getDataBlocks(n,i){const a=i.getECBlocks();let c=0;const d=a.getECBlocks();for(let F of d)c+=F.getCount();const h=new Array(c);let m=0;for(let F of d)for(let H=0;H<F.getCount();H++){const q=F.getDataCodewords(),ee=a.getECCodewords()+q;h[m++]=new Ac(q,new Uint8Array(ee))}const y=h[0].codewords.length-a.getECCodewords(),b=y-1;let _=0;for(let F=0;F<b;F++)for(let H=0;H<m;H++)h[H].codewords[F]=n[_++];const R=i.getVersionNumber()===24,L=R?8:m;for(let F=0;F<L;F++)h[F].codewords[y-1]=n[_++];const B=h[0].codewords.length;for(let F=y;F<B;F++)for(let H=0;H<m;H++){const q=R?(H+8)%m:H,ee=R&&q>7?F-1:F;h[q].codewords[ee]=n[_++]}if(_!==n.length)throw new E;return h}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Ic{constructor(n){this.bytes=n,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(n){if(n<1||n>32||n>this.available())throw new E(""+n);let i=0,a=this.bitOffset,c=this.byteOffset;const d=this.bytes;if(a>0){const h=8-a,m=n<h?n:h,p=h-m,y=255>>8-m<<p;i=(d[c]&y)>>p,n-=m,a+=m,a===8&&(a=0,c++)}if(n>0){for(;n>=8;)i=i<<8|d[c]&255,c++,n-=8;if(n>0){const h=8-n,m=255>>h<<h;i=i<<n|(d[c]&m)>>h,a+=n}}return this.bitOffset=a,this.byteOffset=c,i}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var St;(function(N){N[N.PAD_ENCODE=0]="PAD_ENCODE",N[N.ASCII_ENCODE=1]="ASCII_ENCODE",N[N.C40_ENCODE=2]="C40_ENCODE",N[N.TEXT_ENCODE=3]="TEXT_ENCODE",N[N.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",N[N.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",N[N.BASE256_ENCODE=6]="BASE256_ENCODE"})(St||(St={}));class Hn{static decode(n){const i=new Ic(n),a=new Ne,c=new Ne,d=new Array;let h=St.ASCII_ENCODE;do if(h===St.ASCII_ENCODE)h=this.decodeAsciiSegment(i,a,c);else{switch(h){case St.C40_ENCODE:this.decodeC40Segment(i,a);break;case St.TEXT_ENCODE:this.decodeTextSegment(i,a);break;case St.ANSIX12_ENCODE:this.decodeAnsiX12Segment(i,a);break;case St.EDIFACT_ENCODE:this.decodeEdifactSegment(i,a);break;case St.BASE256_ENCODE:this.decodeBase256Segment(i,a,d);break;default:throw new U}h=St.ASCII_ENCODE}while(h!==St.PAD_ENCODE&&i.available()>0);return c.length()>0&&a.append(c.toString()),new Gr(n,a.toString(),d.length===0?null:d,null)}static decodeAsciiSegment(n,i,a){let c=!1;do{let d=n.readBits(8);if(d===0)throw new U;if(d<=128)return c&&(d+=128),i.append(String.fromCharCode(d-1)),St.ASCII_ENCODE;if(d===129)return St.PAD_ENCODE;if(d<=229){const h=d-130;h<10&&i.append("0"),i.append(""+h)}else switch(d){case 230:return St.C40_ENCODE;case 231:return St.BASE256_ENCODE;case 232:i.append("");break;case 233:case 234:break;case 235:c=!0;break;case 236:i.append("[)>05"),a.insert(0,"");break;case 237:i.append("[)>06"),a.insert(0,"");break;case 238:return St.ANSIX12_ENCODE;case 239:return St.TEXT_ENCODE;case 240:return St.EDIFACT_ENCODE;case 241:break;default:if(d!==254||n.available()!==0)throw new U;break}}while(n.available()>0);return St.ASCII_ENCODE}static decodeC40Segment(n,i){let a=!1;const c=[];let d=0;do{if(n.available()===8)return;const h=n.readBits(8);if(h===254)return;this.parseTwoBytes(h,n.readBits(8),c);for(let m=0;m<3;m++){const p=c[m];switch(d){case 0:if(p<3)d=p+1;else if(p<this.C40_BASIC_SET_CHARS.length){const y=this.C40_BASIC_SET_CHARS[p];a?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):i.append(y)}else throw new U;break;case 1:a?(i.append(String.fromCharCode(p+128)),a=!1):i.append(String.fromCharCode(p)),d=0;break;case 2:if(p<this.C40_SHIFT2_SET_CHARS.length){const y=this.C40_SHIFT2_SET_CHARS[p];a?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):i.append(y)}else switch(p){case 27:i.append("");break;case 30:a=!0;break;default:throw new U}d=0;break;case 3:a?(i.append(String.fromCharCode(p+224)),a=!1):i.append(String.fromCharCode(p+96)),d=0;break;default:throw new U}}}while(n.available()>0)}static decodeTextSegment(n,i){let a=!1,c=[],d=0;do{if(n.available()===8)return;const h=n.readBits(8);if(h===254)return;this.parseTwoBytes(h,n.readBits(8),c);for(let m=0;m<3;m++){const p=c[m];switch(d){case 0:if(p<3)d=p+1;else if(p<this.TEXT_BASIC_SET_CHARS.length){const y=this.TEXT_BASIC_SET_CHARS[p];a?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):i.append(y)}else throw new U;break;case 1:a?(i.append(String.fromCharCode(p+128)),a=!1):i.append(String.fromCharCode(p)),d=0;break;case 2:if(p<this.TEXT_SHIFT2_SET_CHARS.length){const y=this.TEXT_SHIFT2_SET_CHARS[p];a?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):i.append(y)}else switch(p){case 27:i.append("");break;case 30:a=!0;break;default:throw new U}d=0;break;case 3:if(p<this.TEXT_SHIFT3_SET_CHARS.length){const y=this.TEXT_SHIFT3_SET_CHARS[p];a?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):i.append(y),d=0}else throw new U;break;default:throw new U}}}while(n.available()>0)}static decodeAnsiX12Segment(n,i){const a=[];do{if(n.available()===8)return;const c=n.readBits(8);if(c===254)return;this.parseTwoBytes(c,n.readBits(8),a);for(let d=0;d<3;d++){const h=a[d];switch(h){case 0:i.append("\r");break;case 1:i.append("*");break;case 2:i.append(">");break;case 3:i.append(" ");break;default:if(h<14)i.append(String.fromCharCode(h+44));else if(h<40)i.append(String.fromCharCode(h+51));else throw new U;break}}}while(n.available()>0)}static parseTwoBytes(n,i,a){let c=(n<<8)+i-1,d=Math.floor(c/1600);a[0]=d,c-=d*1600,d=Math.floor(c/40),a[1]=d,a[2]=c-d*40}static decodeEdifactSegment(n,i){do{if(n.available()<=16)return;for(let a=0;a<4;a++){let c=n.readBits(6);if(c===31){const d=8-n.getBitOffset();d!==8&&n.readBits(d);return}c&32||(c|=64),i.append(String.fromCharCode(c))}}while(n.available()>0)}static decodeBase256Segment(n,i,a){let c=1+n.getByteOffset();const d=this.unrandomize255State(n.readBits(8),c++);let h;if(d===0?h=n.available()/8|0:d<250?h=d:h=250*(d-249)+this.unrandomize255State(n.readBits(8),c++),h<0)throw new U;const m=new Uint8Array(h);for(let p=0;p<h;p++){if(n.available()<8)throw new U;m[p]=this.unrandomize255State(n.readBits(8),c++)}a.push(m);try{i.append(be.decode(m,ue.ISO88591))}catch(p){throw new dn("Platform does not support required encoding: "+p.message)}}static unrandomize255State(n,i){const a=149*i%255+1,c=n-a;return c>=0?c:c+256}}Hn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Hn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Hn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Hn.TEXT_SHIFT2_SET_CHARS=Hn.C40_SHIFT2_SET_CHARS,Hn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Cp{constructor(){this.rsDecoder=new ra(Le.DATA_MATRIX_FIELD_256)}decode(n){const i=new Sc(n),a=i.getVersion(),c=i.readCodewords(),d=Ac.getDataBlocks(c,a);let h=0;for(let y of d)h+=y.getNumDataCodewords();const m=new Uint8Array(h),p=d.length;for(let y=0;y<p;y++){const b=d[y],_=b.getCodewords(),R=b.getNumDataCodewords();this.correctErrors(_,R);for(let L=0;L<R;L++)m[L*p+y]=_[L]}return Hn.decode(m)}correctErrors(n,i){const a=new Int32Array(n);try{this.rsDecoder.decode(a,n.length-i)}catch{throw new I}for(let c=0;c<i;c++)n[c]=a[c]}}class yt{constructor(n){this.image=n,this.rectangleDetector=new _n(this.image)}detect(){const n=this.rectangleDetector.detect();let i=this.detectSolid1(n);if(i=this.detectSolid2(i),i[3]=this.correctTopRight(i),!i[3])throw new Y;i=this.shiftToModuleCenter(i);const a=i[0],c=i[1],d=i[2],h=i[3];let m=this.transitionsBetween(a,h)+1,p=this.transitionsBetween(d,h)+1;(m&1)===1&&(m+=1),(p&1)===1&&(p+=1),4*m<7*p&&4*p<7*m&&(m=p=Math.max(m,p));let y=yt.sampleGrid(this.image,a,c,d,h,m,p);return new vo(y,[a,c,d,h])}static shiftPoint(n,i,a){let c=(i.getX()-n.getX())/(a+1),d=(i.getY()-n.getY())/(a+1);return new de(n.getX()+c,n.getY()+d)}static moveAway(n,i,a){let c=n.getX(),d=n.getY();return c<i?c-=1:c+=1,d<a?d-=1:d+=1,new de(c,d)}detectSolid1(n){let i=n[0],a=n[1],c=n[3],d=n[2],h=this.transitionsBetween(i,a),m=this.transitionsBetween(a,c),p=this.transitionsBetween(c,d),y=this.transitionsBetween(d,i),b=h,_=[d,i,a,c];return b>m&&(b=m,_[0]=i,_[1]=a,_[2]=c,_[3]=d),b>p&&(b=p,_[0]=a,_[1]=c,_[2]=d,_[3]=i),b>y&&(_[0]=c,_[1]=d,_[2]=i,_[3]=a),_}detectSolid2(n){let i=n[0],a=n[1],c=n[2],d=n[3],h=this.transitionsBetween(i,d),m=yt.shiftPoint(a,c,(h+1)*4),p=yt.shiftPoint(c,a,(h+1)*4),y=this.transitionsBetween(m,i),b=this.transitionsBetween(p,d);return y<b?(n[0]=i,n[1]=a,n[2]=c,n[3]=d):(n[0]=a,n[1]=c,n[2]=d,n[3]=i),n}correctTopRight(n){let i=n[0],a=n[1],c=n[2],d=n[3],h=this.transitionsBetween(i,d),m=this.transitionsBetween(a,d),p=yt.shiftPoint(i,a,(m+1)*4),y=yt.shiftPoint(c,a,(h+1)*4);h=this.transitionsBetween(p,d),m=this.transitionsBetween(y,d);let b=new de(d.getX()+(c.getX()-a.getX())/(h+1),d.getY()+(c.getY()-a.getY())/(h+1)),_=new de(d.getX()+(i.getX()-a.getX())/(m+1),d.getY()+(i.getY()-a.getY())/(m+1));if(!this.isValid(b))return this.isValid(_)?_:null;if(!this.isValid(_))return b;let R=this.transitionsBetween(p,b)+this.transitionsBetween(y,b),L=this.transitionsBetween(p,_)+this.transitionsBetween(y,_);return R>L?b:_}shiftToModuleCenter(n){let i=n[0],a=n[1],c=n[2],d=n[3],h=this.transitionsBetween(i,d)+1,m=this.transitionsBetween(c,d)+1,p=yt.shiftPoint(i,a,m*4),y=yt.shiftPoint(c,a,h*4);h=this.transitionsBetween(p,d)+1,m=this.transitionsBetween(y,d)+1,(h&1)===1&&(h+=1),(m&1)===1&&(m+=1);let b=(i.getX()+a.getX()+c.getX()+d.getX())/4,_=(i.getY()+a.getY()+c.getY()+d.getY())/4;i=yt.moveAway(i,b,_),a=yt.moveAway(a,b,_),c=yt.moveAway(c,b,_),d=yt.moveAway(d,b,_);let R,L;return p=yt.shiftPoint(i,a,m*4),p=yt.shiftPoint(p,d,h*4),R=yt.shiftPoint(a,i,m*4),R=yt.shiftPoint(R,c,h*4),y=yt.shiftPoint(c,d,m*4),y=yt.shiftPoint(y,a,h*4),L=yt.shiftPoint(d,c,m*4),L=yt.shiftPoint(L,i,h*4),[p,R,y,L]}isValid(n){return n.getX()>=0&&n.getX()<this.image.getWidth()&&n.getY()>0&&n.getY()<this.image.getHeight()}static sampleGrid(n,i,a,c,d,h,m){return zn.getInstance().sampleGrid(n,h,m,.5,.5,h-.5,.5,h-.5,m-.5,.5,m-.5,i.getX(),i.getY(),d.getX(),d.getY(),c.getX(),c.getY(),a.getX(),a.getY())}transitionsBetween(n,i){let a=Math.trunc(n.getX()),c=Math.trunc(n.getY()),d=Math.trunc(i.getX()),h=Math.trunc(i.getY()),m=Math.abs(h-c)>Math.abs(d-a);if(m){let F=a;a=c,c=F,F=d,d=h,h=F}let p=Math.abs(d-a),y=Math.abs(h-c),b=-p/2,_=c<h?1:-1,R=a<d?1:-1,L=0,B=this.image.get(m?c:a,m?a:c);for(let F=a,H=c;F!==d;F+=R){let q=this.image.get(m?H:F,m?F:H);if(q!==B&&(L++,B=q),b+=y,b>0){if(H===h)break;H+=_,b-=p}}return L}}class Wn{constructor(){this.decoder=new Cp}decode(n,i=null){let a,c;if(i!=null&&i.has(z.PURE_BARCODE)){const y=Wn.extractPureBits(n.getBlackMatrix());a=this.decoder.decode(y),c=Wn.NO_POINTS}else{const y=new yt(n.getBlackMatrix()).detect();a=this.decoder.decode(y.getBits()),c=y.getPoints()}const d=a.getRawBytes(),h=new Ie(a.getText(),d,8*d.length,c,se.DATA_MATRIX,j.currentTimeMillis()),m=a.getByteSegments();m!=null&&h.putMetadata(Ue.BYTE_SEGMENTS,m);const p=a.getECLevel();return p!=null&&h.putMetadata(Ue.ERROR_CORRECTION_LEVEL,p),h}reset(){}static extractPureBits(n){const i=n.getTopLeftOnBit(),a=n.getBottomRightOnBit();if(i==null||a==null)throw new Y;const c=this.moduleSize(i,n);let d=i[1];const h=a[1];let m=i[0];const y=(a[0]-m+1)/c,b=(h-d+1)/c;if(y<=0||b<=0)throw new Y;const _=c/2;d+=_,m+=_;const R=new We(y,b);for(let L=0;L<b;L++){const B=d+L*c;for(let F=0;F<y;F++)n.get(m+F*c,B)&&R.set(F,L)}return R}static moduleSize(n,i){const a=i.getWidth();let c=n[0];const d=n[1];for(;c<a&&i.get(c,d);)c++;if(c===a)throw new Y;const h=c-n[0];if(h===0)throw new Y;return h}}Wn.NO_POINTS=[];class Np extends Dt{constructor(n=500){super(new Wn,n)}}var si;(function(N){N[N.L=0]="L",N[N.M=1]="M",N[N.Q=2]="Q",N[N.H=3]="H"})(si||(si={}));class Qe{constructor(n,i,a){this.value=n,this.stringValue=i,this.bits=a,Qe.FOR_BITS.set(a,this),Qe.FOR_VALUE.set(n,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(n){switch(n){case"L":return Qe.L;case"M":return Qe.M;case"Q":return Qe.Q;case"H":return Qe.H;default:throw new v(n+"not available")}}toString(){return this.stringValue}equals(n){if(!(n instanceof Qe))return!1;const i=n;return this.value===i.value}static forBits(n){if(n<0||n>=Qe.FOR_BITS.size)throw new E;return Qe.FOR_BITS.get(n)}}Qe.FOR_BITS=new Map,Qe.FOR_VALUE=new Map,Qe.L=new Qe(si.L,"L",1),Qe.M=new Qe(si.M,"M",0),Qe.Q=new Qe(si.Q,"Q",3),Qe.H=new Qe(si.H,"H",2);class Gt{constructor(n){this.errorCorrectionLevel=Qe.forBits(n>>3&3),this.dataMask=n&7}static numBitsDiffering(n,i){return T.bitCount(n^i)}static decodeFormatInformation(n,i){const a=Gt.doDecodeFormatInformation(n,i);return a!==null?a:Gt.doDecodeFormatInformation(n^Gt.FORMAT_INFO_MASK_QR,i^Gt.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(n,i){let a=Number.MAX_SAFE_INTEGER,c=0;for(const d of Gt.FORMAT_INFO_DECODE_LOOKUP){const h=d[0];if(h===n||h===i)return new Gt(d[1]);let m=Gt.numBitsDiffering(n,h);m<a&&(c=d[1],a=m),n!==i&&(m=Gt.numBitsDiffering(i,h),m<a&&(c=d[1],a=m))}return a<=3?new Gt(c):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(n){if(!(n instanceof Gt))return!1;const i=n;return this.errorCorrectionLevel===i.errorCorrectionLevel&&this.dataMask===i.dataMask}}Gt.FORMAT_INFO_MASK_QR=21522,Gt.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class W{constructor(n,...i){this.ecCodewordsPerBlock=n,this.ecBlocks=i}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let n=0;const i=this.ecBlocks;for(const a of i)n+=a.getCount();return n}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class D{constructor(n,i){this.count=n,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class me{constructor(n,i,...a){this.versionNumber=n,this.alignmentPatternCenters=i,this.ecBlocks=a;let c=0;const d=a[0].getECCodewordsPerBlock(),h=a[0].getECBlocks();for(const m of h)c+=m.getCount()*(m.getDataCodewords()+d);this.totalCodewords=c}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(n){return this.ecBlocks[n.getValue()]}static getProvisionalVersionForDimension(n){if(n%4!==1)throw new U;try{return this.getVersionForNumber((n-17)/4)}catch{throw new U}}static getVersionForNumber(n){if(n<1||n>40)throw new E;return me.VERSIONS[n-1]}static decodeVersionInformation(n){let i=Number.MAX_SAFE_INTEGER,a=0;for(let c=0;c<me.VERSION_DECODE_INFO.length;c++){const d=me.VERSION_DECODE_INFO[c];if(d===n)return me.getVersionForNumber(c+7);const h=Gt.numBitsDiffering(n,d);h<i&&(a=c+7,i=h)}return i<=3?me.getVersionForNumber(a):null}buildFunctionPattern(){const n=this.getDimensionForVersion(),i=new We(n);i.setRegion(0,0,9,9),i.setRegion(n-8,0,8,9),i.setRegion(0,n-8,9,8);const a=this.alignmentPatternCenters.length;for(let c=0;c<a;c++){const d=this.alignmentPatternCenters[c]-2;for(let h=0;h<a;h++)c===0&&(h===0||h===a-1)||c===a-1&&h===0||i.setRegion(this.alignmentPatternCenters[h]-2,d,5,5)}return i.setRegion(6,9,1,n-17),i.setRegion(9,6,n-17,1),this.versionNumber>6&&(i.setRegion(n-11,0,3,6),i.setRegion(0,n-11,6,3)),i}toString(){return""+this.versionNumber}}me.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),me.VERSIONS=[new me(1,new Int32Array(0),new W(7,new D(1,19)),new W(10,new D(1,16)),new W(13,new D(1,13)),new W(17,new D(1,9))),new me(2,Int32Array.from([6,18]),new W(10,new D(1,34)),new W(16,new D(1,28)),new W(22,new D(1,22)),new W(28,new D(1,16))),new me(3,Int32Array.from([6,22]),new W(15,new D(1,55)),new W(26,new D(1,44)),new W(18,new D(2,17)),new W(22,new D(2,13))),new me(4,Int32Array.from([6,26]),new W(20,new D(1,80)),new W(18,new D(2,32)),new W(26,new D(2,24)),new W(16,new D(4,9))),new me(5,Int32Array.from([6,30]),new W(26,new D(1,108)),new W(24,new D(2,43)),new W(18,new D(2,15),new D(2,16)),new W(22,new D(2,11),new D(2,12))),new me(6,Int32Array.from([6,34]),new W(18,new D(2,68)),new W(16,new D(4,27)),new W(24,new D(4,19)),new W(28,new D(4,15))),new me(7,Int32Array.from([6,22,38]),new W(20,new D(2,78)),new W(18,new D(4,31)),new W(18,new D(2,14),new D(4,15)),new W(26,new D(4,13),new D(1,14))),new me(8,Int32Array.from([6,24,42]),new W(24,new D(2,97)),new W(22,new D(2,38),new D(2,39)),new W(22,new D(4,18),new D(2,19)),new W(26,new D(4,14),new D(2,15))),new me(9,Int32Array.from([6,26,46]),new W(30,new D(2,116)),new W(22,new D(3,36),new D(2,37)),new W(20,new D(4,16),new D(4,17)),new W(24,new D(4,12),new D(4,13))),new me(10,Int32Array.from([6,28,50]),new W(18,new D(2,68),new D(2,69)),new W(26,new D(4,43),new D(1,44)),new W(24,new D(6,19),new D(2,20)),new W(28,new D(6,15),new D(2,16))),new me(11,Int32Array.from([6,30,54]),new W(20,new D(4,81)),new W(30,new D(1,50),new D(4,51)),new W(28,new D(4,22),new D(4,23)),new W(24,new D(3,12),new D(8,13))),new me(12,Int32Array.from([6,32,58]),new W(24,new D(2,92),new D(2,93)),new W(22,new D(6,36),new D(2,37)),new W(26,new D(4,20),new D(6,21)),new W(28,new D(7,14),new D(4,15))),new me(13,Int32Array.from([6,34,62]),new W(26,new D(4,107)),new W(22,new D(8,37),new D(1,38)),new W(24,new D(8,20),new D(4,21)),new W(22,new D(12,11),new D(4,12))),new me(14,Int32Array.from([6,26,46,66]),new W(30,new D(3,115),new D(1,116)),new W(24,new D(4,40),new D(5,41)),new W(20,new D(11,16),new D(5,17)),new W(24,new D(11,12),new D(5,13))),new me(15,Int32Array.from([6,26,48,70]),new W(22,new D(5,87),new D(1,88)),new W(24,new D(5,41),new D(5,42)),new W(30,new D(5,24),new D(7,25)),new W(24,new D(11,12),new D(7,13))),new me(16,Int32Array.from([6,26,50,74]),new W(24,new D(5,98),new D(1,99)),new W(28,new D(7,45),new D(3,46)),new W(24,new D(15,19),new D(2,20)),new W(30,new D(3,15),new D(13,16))),new me(17,Int32Array.from([6,30,54,78]),new W(28,new D(1,107),new D(5,108)),new W(28,new D(10,46),new D(1,47)),new W(28,new D(1,22),new D(15,23)),new W(28,new D(2,14),new D(17,15))),new me(18,Int32Array.from([6,30,56,82]),new W(30,new D(5,120),new D(1,121)),new W(26,new D(9,43),new D(4,44)),new W(28,new D(17,22),new D(1,23)),new W(28,new D(2,14),new D(19,15))),new me(19,Int32Array.from([6,30,58,86]),new W(28,new D(3,113),new D(4,114)),new W(26,new D(3,44),new D(11,45)),new W(26,new D(17,21),new D(4,22)),new W(26,new D(9,13),new D(16,14))),new me(20,Int32Array.from([6,34,62,90]),new W(28,new D(3,107),new D(5,108)),new W(26,new D(3,41),new D(13,42)),new W(30,new D(15,24),new D(5,25)),new W(28,new D(15,15),new D(10,16))),new me(21,Int32Array.from([6,28,50,72,94]),new W(28,new D(4,116),new D(4,117)),new W(26,new D(17,42)),new W(28,new D(17,22),new D(6,23)),new W(30,new D(19,16),new D(6,17))),new me(22,Int32Array.from([6,26,50,74,98]),new W(28,new D(2,111),new D(7,112)),new W(28,new D(17,46)),new W(30,new D(7,24),new D(16,25)),new W(24,new D(34,13))),new me(23,Int32Array.from([6,30,54,78,102]),new W(30,new D(4,121),new D(5,122)),new W(28,new D(4,47),new D(14,48)),new W(30,new D(11,24),new D(14,25)),new W(30,new D(16,15),new D(14,16))),new me(24,Int32Array.from([6,28,54,80,106]),new W(30,new D(6,117),new D(4,118)),new W(28,new D(6,45),new D(14,46)),new W(30,new D(11,24),new D(16,25)),new W(30,new D(30,16),new D(2,17))),new me(25,Int32Array.from([6,32,58,84,110]),new W(26,new D(8,106),new D(4,107)),new W(28,new D(8,47),new D(13,48)),new W(30,new D(7,24),new D(22,25)),new W(30,new D(22,15),new D(13,16))),new me(26,Int32Array.from([6,30,58,86,114]),new W(28,new D(10,114),new D(2,115)),new W(28,new D(19,46),new D(4,47)),new W(28,new D(28,22),new D(6,23)),new W(30,new D(33,16),new D(4,17))),new me(27,Int32Array.from([6,34,62,90,118]),new W(30,new D(8,122),new D(4,123)),new W(28,new D(22,45),new D(3,46)),new W(30,new D(8,23),new D(26,24)),new W(30,new D(12,15),new D(28,16))),new me(28,Int32Array.from([6,26,50,74,98,122]),new W(30,new D(3,117),new D(10,118)),new W(28,new D(3,45),new D(23,46)),new W(30,new D(4,24),new D(31,25)),new W(30,new D(11,15),new D(31,16))),new me(29,Int32Array.from([6,30,54,78,102,126]),new W(30,new D(7,116),new D(7,117)),new W(28,new D(21,45),new D(7,46)),new W(30,new D(1,23),new D(37,24)),new W(30,new D(19,15),new D(26,16))),new me(30,Int32Array.from([6,26,52,78,104,130]),new W(30,new D(5,115),new D(10,116)),new W(28,new D(19,47),new D(10,48)),new W(30,new D(15,24),new D(25,25)),new W(30,new D(23,15),new D(25,16))),new me(31,Int32Array.from([6,30,56,82,108,134]),new W(30,new D(13,115),new D(3,116)),new W(28,new D(2,46),new D(29,47)),new W(30,new D(42,24),new D(1,25)),new W(30,new D(23,15),new D(28,16))),new me(32,Int32Array.from([6,34,60,86,112,138]),new W(30,new D(17,115)),new W(28,new D(10,46),new D(23,47)),new W(30,new D(10,24),new D(35,25)),new W(30,new D(19,15),new D(35,16))),new me(33,Int32Array.from([6,30,58,86,114,142]),new W(30,new D(17,115),new D(1,116)),new W(28,new D(14,46),new D(21,47)),new W(30,new D(29,24),new D(19,25)),new W(30,new D(11,15),new D(46,16))),new me(34,Int32Array.from([6,34,62,90,118,146]),new W(30,new D(13,115),new D(6,116)),new W(28,new D(14,46),new D(23,47)),new W(30,new D(44,24),new D(7,25)),new W(30,new D(59,16),new D(1,17))),new me(35,Int32Array.from([6,30,54,78,102,126,150]),new W(30,new D(12,121),new D(7,122)),new W(28,new D(12,47),new D(26,48)),new W(30,new D(39,24),new D(14,25)),new W(30,new D(22,15),new D(41,16))),new me(36,Int32Array.from([6,24,50,76,102,128,154]),new W(30,new D(6,121),new D(14,122)),new W(28,new D(6,47),new D(34,48)),new W(30,new D(46,24),new D(10,25)),new W(30,new D(2,15),new D(64,16))),new me(37,Int32Array.from([6,28,54,80,106,132,158]),new W(30,new D(17,122),new D(4,123)),new W(28,new D(29,46),new D(14,47)),new W(30,new D(49,24),new D(10,25)),new W(30,new D(24,15),new D(46,16))),new me(38,Int32Array.from([6,32,58,84,110,136,162]),new W(30,new D(4,122),new D(18,123)),new W(28,new D(13,46),new D(32,47)),new W(30,new D(48,24),new D(14,25)),new W(30,new D(42,15),new D(32,16))),new me(39,Int32Array.from([6,26,54,82,110,138,166]),new W(30,new D(20,117),new D(4,118)),new W(28,new D(40,47),new D(7,48)),new W(30,new D(43,24),new D(22,25)),new W(30,new D(10,15),new D(67,16))),new me(40,Int32Array.from([6,30,58,86,114,142,170]),new W(30,new D(19,118),new D(6,119)),new W(28,new D(18,47),new D(31,48)),new W(30,new D(34,24),new D(34,25)),new W(30,new D(20,15),new D(61,16)))];var Rt;(function(N){N[N.DATA_MASK_000=0]="DATA_MASK_000",N[N.DATA_MASK_001=1]="DATA_MASK_001",N[N.DATA_MASK_010=2]="DATA_MASK_010",N[N.DATA_MASK_011=3]="DATA_MASK_011",N[N.DATA_MASK_100=4]="DATA_MASK_100",N[N.DATA_MASK_101=5]="DATA_MASK_101",N[N.DATA_MASK_110=6]="DATA_MASK_110",N[N.DATA_MASK_111=7]="DATA_MASK_111"})(Rt||(Rt={}));class Lr{constructor(n,i){this.value=n,this.isMasked=i}unmaskBitMatrix(n,i){for(let a=0;a<i;a++)for(let c=0;c<i;c++)this.isMasked(a,c)&&n.flip(c,a)}}Lr.values=new Map([[Rt.DATA_MASK_000,new Lr(Rt.DATA_MASK_000,(N,n)=>(N+n&1)===0)],[Rt.DATA_MASK_001,new Lr(Rt.DATA_MASK_001,(N,n)=>(N&1)===0)],[Rt.DATA_MASK_010,new Lr(Rt.DATA_MASK_010,(N,n)=>n%3===0)],[Rt.DATA_MASK_011,new Lr(Rt.DATA_MASK_011,(N,n)=>(N+n)%3===0)],[Rt.DATA_MASK_100,new Lr(Rt.DATA_MASK_100,(N,n)=>(Math.floor(N/2)+Math.floor(n/3)&1)===0)],[Rt.DATA_MASK_101,new Lr(Rt.DATA_MASK_101,(N,n)=>N*n%6===0)],[Rt.DATA_MASK_110,new Lr(Rt.DATA_MASK_110,(N,n)=>N*n%6<3)],[Rt.DATA_MASK_111,new Lr(Rt.DATA_MASK_111,(N,n)=>(N+n+N*n%3&1)===0)]]);class _p{constructor(n){const i=n.getHeight();if(i<21||(i&3)!==1)throw new U;this.bitMatrix=n}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let n=0;for(let d=0;d<6;d++)n=this.copyBit(d,8,n);n=this.copyBit(7,8,n),n=this.copyBit(8,8,n),n=this.copyBit(8,7,n);for(let d=5;d>=0;d--)n=this.copyBit(8,d,n);const i=this.bitMatrix.getHeight();let a=0;const c=i-7;for(let d=i-1;d>=c;d--)a=this.copyBit(8,d,a);for(let d=i-8;d<i;d++)a=this.copyBit(d,8,a);if(this.parsedFormatInfo=Gt.decodeFormatInformation(n,a),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new U}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const n=this.bitMatrix.getHeight(),i=Math.floor((n-17)/4);if(i<=6)return me.getVersionForNumber(i);let a=0;const c=n-11;for(let h=5;h>=0;h--)for(let m=n-9;m>=c;m--)a=this.copyBit(m,h,a);let d=me.decodeVersionInformation(a);if(d!==null&&d.getDimensionForVersion()===n)return this.parsedVersion=d,d;a=0;for(let h=5;h>=0;h--)for(let m=n-9;m>=c;m--)a=this.copyBit(h,m,a);if(d=me.decodeVersionInformation(a),d!==null&&d.getDimensionForVersion()===n)return this.parsedVersion=d,d;throw new U}copyBit(n,i,a){return(this.isMirror?this.bitMatrix.get(i,n):this.bitMatrix.get(n,i))?a<<1|1:a<<1}readCodewords(){const n=this.readFormatInformation(),i=this.readVersion(),a=Lr.values.get(n.getDataMask()),c=this.bitMatrix.getHeight();a.unmaskBitMatrix(this.bitMatrix,c);const d=i.buildFunctionPattern();let h=!0;const m=new Uint8Array(i.getTotalCodewords());let p=0,y=0,b=0;for(let _=c-1;_>0;_-=2){_===6&&_--;for(let R=0;R<c;R++){const L=h?c-1-R:R;for(let B=0;B<2;B++)d.get(_-B,L)||(b++,y<<=1,this.bitMatrix.get(_-B,L)&&(y|=1),b===8&&(m[p++]=y,b=0,y=0))}h=!h}if(p!==i.getTotalCodewords())throw new U;return m}remask(){if(this.parsedFormatInfo===null)return;const n=Lr.values[this.parsedFormatInfo.getDataMask()],i=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,i)}setMirror(n){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=n}mirror(){const n=this.bitMatrix;for(let i=0,a=n.getWidth();i<a;i++)for(let c=i+1,d=n.getHeight();c<d;c++)n.get(i,c)!==n.get(c,i)&&(n.flip(c,i),n.flip(i,c))}}class Tc{constructor(n,i){this.numDataCodewords=n,this.codewords=i}static getDataBlocks(n,i,a){if(n.length!==i.getTotalCodewords())throw new E;const c=i.getECBlocksForLevel(a);let d=0;const h=c.getECBlocks();for(const B of h)d+=B.getCount();const m=new Array(d);let p=0;for(const B of h)for(let F=0;F<B.getCount();F++){const H=B.getDataCodewords(),q=c.getECCodewordsPerBlock()+H;m[p++]=new Tc(H,new Uint8Array(q))}const y=m[0].codewords.length;let b=m.length-1;for(;b>=0&&m[b].codewords.length!==y;)b--;b++;const _=y-c.getECCodewordsPerBlock();let R=0;for(let B=0;B<_;B++)for(let F=0;F<p;F++)m[F].codewords[B]=n[R++];for(let B=b;B<p;B++)m[B].codewords[_]=n[R++];const L=m[0].codewords.length;for(let B=_;B<L;B++)for(let F=0;F<p;F++){const H=F<b?B:B+1;m[F].codewords[H]=n[R++]}return m}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Pr;(function(N){N[N.TERMINATOR=0]="TERMINATOR",N[N.NUMERIC=1]="NUMERIC",N[N.ALPHANUMERIC=2]="ALPHANUMERIC",N[N.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",N[N.BYTE=4]="BYTE",N[N.ECI=5]="ECI",N[N.KANJI=6]="KANJI",N[N.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",N[N.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",N[N.HANZI=9]="HANZI"})(Pr||(Pr={}));class ge{constructor(n,i,a,c){this.value=n,this.stringValue=i,this.characterCountBitsForVersions=a,this.bits=c,ge.FOR_BITS.set(c,this),ge.FOR_VALUE.set(n,this)}static forBits(n){const i=ge.FOR_BITS.get(n);if(i===void 0)throw new E;return i}getCharacterCountBits(n){const i=n.getVersionNumber();let a;return i<=9?a=0:i<=26?a=1:a=2,this.characterCountBitsForVersions[a]}getValue(){return this.value}getBits(){return this.bits}equals(n){if(!(n instanceof ge))return!1;const i=n;return this.value===i.value}toString(){return this.stringValue}}ge.FOR_BITS=new Map,ge.FOR_VALUE=new Map,ge.TERMINATOR=new ge(Pr.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),ge.NUMERIC=new ge(Pr.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),ge.ALPHANUMERIC=new ge(Pr.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),ge.STRUCTURED_APPEND=new ge(Pr.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),ge.BYTE=new ge(Pr.BYTE,"BYTE",Int32Array.from([8,16,16]),4),ge.ECI=new ge(Pr.ECI,"ECI",Int32Array.from([0,0,0]),7),ge.KANJI=new ge(Pr.KANJI,"KANJI",Int32Array.from([8,10,12]),8),ge.FNC1_FIRST_POSITION=new ge(Pr.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),ge.FNC1_SECOND_POSITION=new ge(Pr.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),ge.HANZI=new ge(Pr.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class lt{static decode(n,i,a,c){const d=new Ic(n);let h=new Ne;const m=new Array;let p=-1,y=-1;try{let b=null,_=!1,R;do{if(d.available()<4)R=ge.TERMINATOR;else{const L=d.readBits(4);R=ge.forBits(L)}switch(R){case ge.TERMINATOR:break;case ge.FNC1_FIRST_POSITION:case ge.FNC1_SECOND_POSITION:_=!0;break;case ge.STRUCTURED_APPEND:if(d.available()<16)throw new U;p=d.readBits(8),y=d.readBits(8);break;case ge.ECI:const L=lt.parseECIValue(d);if(b=G.getCharacterSetECIByValue(L),b===null)throw new U;break;case ge.HANZI:const B=d.readBits(4),F=d.readBits(R.getCharacterCountBits(i));B===lt.GB2312_SUBSET&&lt.decodeHanziSegment(d,h,F);break;default:const H=d.readBits(R.getCharacterCountBits(i));switch(R){case ge.NUMERIC:lt.decodeNumericSegment(d,h,H);break;case ge.ALPHANUMERIC:lt.decodeAlphanumericSegment(d,h,H,_);break;case ge.BYTE:lt.decodeByteSegment(d,h,H,b,m,c);break;case ge.KANJI:lt.decodeKanjiSegment(d,h,H);break;default:throw new U}break}}while(R!==ge.TERMINATOR)}catch{throw new U}return new Gr(n,h.toString(),m.length===0?null:m,a===null?null:a.toString(),p,y)}static decodeHanziSegment(n,i,a){if(a*13>n.available())throw new U;const c=new Uint8Array(2*a);let d=0;for(;a>0;){const h=n.readBits(13);let m=h/96<<8&4294967295|h%96;m<959?m+=41377:m+=42657,c[d]=m>>8&255,c[d+1]=m&255,d+=2,a--}try{i.append(be.decode(c,ue.GB2312))}catch(h){throw new U(h)}}static decodeKanjiSegment(n,i,a){if(a*13>n.available())throw new U;const c=new Uint8Array(2*a);let d=0;for(;a>0;){const h=n.readBits(13);let m=h/192<<8&4294967295|h%192;m<7936?m+=33088:m+=49472,c[d]=m>>8,c[d+1]=m,d+=2,a--}try{i.append(be.decode(c,ue.SHIFT_JIS))}catch(h){throw new U(h)}}static decodeByteSegment(n,i,a,c,d,h){if(8*a>n.available())throw new U;const m=new Uint8Array(a);for(let y=0;y<a;y++)m[y]=n.readBits(8);let p;c===null?p=ue.guessEncoding(m,h):p=c.getName();try{i.append(be.decode(m,p))}catch(y){throw new U(y)}d.push(m)}static toAlphaNumericChar(n){if(n>=lt.ALPHANUMERIC_CHARS.length)throw new U;return lt.ALPHANUMERIC_CHARS[n]}static decodeAlphanumericSegment(n,i,a,c){const d=i.length();for(;a>1;){if(n.available()<11)throw new U;const h=n.readBits(11);i.append(lt.toAlphaNumericChar(Math.floor(h/45))),i.append(lt.toAlphaNumericChar(h%45)),a-=2}if(a===1){if(n.available()<6)throw new U;i.append(lt.toAlphaNumericChar(n.readBits(6)))}if(c)for(let h=d;h<i.length();h++)i.charAt(h)==="%"&&(h<i.length()-1&&i.charAt(h+1)==="%"?i.deleteCharAt(h+1):i.setCharAt(h,""))}static decodeNumericSegment(n,i,a){for(;a>=3;){if(n.available()<10)throw new U;const c=n.readBits(10);if(c>=1e3)throw new U;i.append(lt.toAlphaNumericChar(Math.floor(c/100))),i.append(lt.toAlphaNumericChar(Math.floor(c/10)%10)),i.append(lt.toAlphaNumericChar(c%10)),a-=3}if(a===2){if(n.available()<7)throw new U;const c=n.readBits(7);if(c>=100)throw new U;i.append(lt.toAlphaNumericChar(Math.floor(c/10))),i.append(lt.toAlphaNumericChar(c%10))}else if(a===1){if(n.available()<4)throw new U;const c=n.readBits(4);if(c>=10)throw new U;i.append(lt.toAlphaNumericChar(c))}}static parseECIValue(n){const i=n.readBits(8);if(!(i&128))return i&127;if((i&192)===128){const a=n.readBits(8);return(i&63)<<8&4294967295|a}if((i&224)===192){const a=n.readBits(16);return(i&31)<<16&4294967295|a}throw new U}}lt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",lt.GB2312_SUBSET=1;class i0{constructor(n){this.mirrored=n}isMirrored(){return this.mirrored}applyMirroredCorrection(n){if(!this.mirrored||n===null||n.length<3)return;const i=n[0];n[0]=n[2],n[2]=i}}class Sp{constructor(){this.rsDecoder=new ra(Le.QR_CODE_FIELD_256)}decodeBooleanArray(n,i){return this.decodeBitMatrix(We.parseFromBooleanArray(n),i)}decodeBitMatrix(n,i){const a=new _p(n);let c=null;try{return this.decodeBitMatrixParser(a,i)}catch(d){c=d}try{a.remask(),a.setMirror(!0),a.readVersion(),a.readFormatInformation(),a.mirror();const d=this.decodeBitMatrixParser(a,i);return d.setOther(new i0(!0)),d}catch(d){throw c!==null?c:d}}decodeBitMatrixParser(n,i){const a=n.readVersion(),c=n.readFormatInformation().getErrorCorrectionLevel(),d=n.readCodewords(),h=Tc.getDataBlocks(d,a,c);let m=0;for(const b of h)m+=b.getNumDataCodewords();const p=new Uint8Array(m);let y=0;for(const b of h){const _=b.getCodewords(),R=b.getNumDataCodewords();this.correctErrors(_,R);for(let L=0;L<R;L++)p[y++]=_[L]}return lt.decode(p,a,c,i)}correctErrors(n,i){const a=new Int32Array(n);try{this.rsDecoder.decode(a,n.length-i)}catch{throw new I}for(let c=0;c<i;c++)n[c]=a[c]}}class jc extends de{constructor(n,i,a){super(n,i),this.estimatedModuleSize=a}aboutEquals(n,i,a){if(Math.abs(i-this.getY())<=n&&Math.abs(a-this.getX())<=n){const c=Math.abs(n-this.estimatedModuleSize);return c<=1||c<=this.estimatedModuleSize}return!1}combineEstimate(n,i,a){const c=(this.getX()+i)/2,d=(this.getY()+n)/2,h=(this.estimatedModuleSize+a)/2;return new jc(c,d,h)}}class _o{constructor(n,i,a,c,d,h,m){this.image=n,this.startX=i,this.startY=a,this.width=c,this.height=d,this.moduleSize=h,this.resultPointCallback=m,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const n=this.startX,i=this.height,a=this.width,c=n+a,d=this.startY+i/2,h=new Int32Array(3),m=this.image;for(let p=0;p<i;p++){const y=d+(p&1?-Math.floor((p+1)/2):Math.floor((p+1)/2));h[0]=0,h[1]=0,h[2]=0;let b=n;for(;b<c&&!m.get(b,y);)b++;let _=0;for(;b<c;){if(m.get(b,y))if(_===1)h[1]++;else if(_===2){if(this.foundPatternCross(h)){const R=this.handlePossibleCenter(h,y,b);if(R!==null)return R}h[0]=h[2],h[1]=1,h[2]=0,_=1}else h[++_]++;else _===1&&_++,h[_]++;b++}if(this.foundPatternCross(h)){const R=this.handlePossibleCenter(h,y,c);if(R!==null)return R}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new Y}static centerFromEnd(n,i){return i-n[2]-n[1]/2}foundPatternCross(n){const i=this.moduleSize,a=i/2;for(let c=0;c<3;c++)if(Math.abs(i-n[c])>=a)return!1;return!0}crossCheckVertical(n,i,a,c){const d=this.image,h=d.getHeight(),m=this.crossCheckStateCount;m[0]=0,m[1]=0,m[2]=0;let p=n;for(;p>=0&&d.get(i,p)&&m[1]<=a;)m[1]++,p--;if(p<0||m[1]>a)return NaN;for(;p>=0&&!d.get(i,p)&&m[0]<=a;)m[0]++,p--;if(m[0]>a)return NaN;for(p=n+1;p<h&&d.get(i,p)&&m[1]<=a;)m[1]++,p++;if(p===h||m[1]>a)return NaN;for(;p<h&&!d.get(i,p)&&m[2]<=a;)m[2]++,p++;if(m[2]>a)return NaN;const y=m[0]+m[1]+m[2];return 5*Math.abs(y-c)>=2*c?NaN:this.foundPatternCross(m)?_o.centerFromEnd(m,p):NaN}handlePossibleCenter(n,i,a){const c=n[0]+n[1]+n[2],d=_o.centerFromEnd(n,a),h=this.crossCheckVertical(i,d,2*n[1],c);if(!isNaN(h)){const m=(n[0]+n[1]+n[2])/3;for(const y of this.possibleCenters)if(y.aboutEquals(m,h,d))return y.combineEstimate(h,d,m);const p=new jc(d,h,m);this.possibleCenters.push(p),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(p)}return null}}class Rc extends de{constructor(n,i,a,c){super(n,i),this.estimatedModuleSize=a,this.count=c,c===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(n,i,a){if(Math.abs(i-this.getY())<=n&&Math.abs(a-this.getX())<=n){const c=Math.abs(n-this.estimatedModuleSize);return c<=1||c<=this.estimatedModuleSize}return!1}combineEstimate(n,i,a){const c=this.count+1,d=(this.count*this.getX()+i)/c,h=(this.count*this.getY()+n)/c,m=(this.count*this.estimatedModuleSize+a)/c;return new Rc(d,h,m,c)}}class Ap{constructor(n){this.bottomLeft=n[0],this.topLeft=n[1],this.topRight=n[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Ot{constructor(n,i){this.image=n,this.resultPointCallback=i,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=i}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(n){const i=n!=null&&n.get(z.TRY_HARDER)!==void 0,a=n!=null&&n.get(z.PURE_BARCODE)!==void 0,c=this.image,d=c.getHeight(),h=c.getWidth();let m=Math.floor(3*d/(4*Ot.MAX_MODULES));(m<Ot.MIN_SKIP||i)&&(m=Ot.MIN_SKIP);let p=!1;const y=new Int32Array(5);for(let _=m-1;_<d&&!p;_+=m){y[0]=0,y[1]=0,y[2]=0,y[3]=0,y[4]=0;let R=0;for(let L=0;L<h;L++)if(c.get(L,_))(R&1)===1&&R++,y[R]++;else if(R&1)y[R]++;else if(R===4)if(Ot.foundPatternCross(y)){if(this.handlePossibleCenter(y,_,L,a)===!0)if(m=2,this.hasSkipped===!0)p=this.haveMultiplyConfirmedCenters();else{const F=this.findRowSkip();F>y[2]&&(_+=F-y[2]-m,L=h-1)}else{y[0]=y[2],y[1]=y[3],y[2]=y[4],y[3]=1,y[4]=0,R=3;continue}R=0,y[0]=0,y[1]=0,y[2]=0,y[3]=0,y[4]=0}else y[0]=y[2],y[1]=y[3],y[2]=y[4],y[3]=1,y[4]=0,R=3;else y[++R]++;Ot.foundPatternCross(y)&&this.handlePossibleCenter(y,_,h,a)===!0&&(m=y[0],this.hasSkipped&&(p=this.haveMultiplyConfirmedCenters()))}const b=this.selectBestPatterns();return de.orderBestPatterns(b),new Ap(b)}static centerFromEnd(n,i){return i-n[4]-n[3]-n[2]/2}static foundPatternCross(n){let i=0;for(let d=0;d<5;d++){const h=n[d];if(h===0)return!1;i+=h}if(i<7)return!1;const a=i/7,c=a/2;return Math.abs(a-n[0])<c&&Math.abs(a-n[1])<c&&Math.abs(3*a-n[2])<3*c&&Math.abs(a-n[3])<c&&Math.abs(a-n[4])<c}getCrossCheckStateCount(){const n=this.crossCheckStateCount;return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n}crossCheckDiagonal(n,i,a,c){const d=this.getCrossCheckStateCount();let h=0;const m=this.image;for(;n>=h&&i>=h&&m.get(i-h,n-h);)d[2]++,h++;if(n<h||i<h)return!1;for(;n>=h&&i>=h&&!m.get(i-h,n-h)&&d[1]<=a;)d[1]++,h++;if(n<h||i<h||d[1]>a)return!1;for(;n>=h&&i>=h&&m.get(i-h,n-h)&&d[0]<=a;)d[0]++,h++;if(d[0]>a)return!1;const p=m.getHeight(),y=m.getWidth();for(h=1;n+h<p&&i+h<y&&m.get(i+h,n+h);)d[2]++,h++;if(n+h>=p||i+h>=y)return!1;for(;n+h<p&&i+h<y&&!m.get(i+h,n+h)&&d[3]<a;)d[3]++,h++;if(n+h>=p||i+h>=y||d[3]>=a)return!1;for(;n+h<p&&i+h<y&&m.get(i+h,n+h)&&d[4]<a;)d[4]++,h++;if(d[4]>=a)return!1;const b=d[0]+d[1]+d[2]+d[3]+d[4];return Math.abs(b-c)<2*c&&Ot.foundPatternCross(d)}crossCheckVertical(n,i,a,c){const d=this.image,h=d.getHeight(),m=this.getCrossCheckStateCount();let p=n;for(;p>=0&&d.get(i,p);)m[2]++,p--;if(p<0)return NaN;for(;p>=0&&!d.get(i,p)&&m[1]<=a;)m[1]++,p--;if(p<0||m[1]>a)return NaN;for(;p>=0&&d.get(i,p)&&m[0]<=a;)m[0]++,p--;if(m[0]>a)return NaN;for(p=n+1;p<h&&d.get(i,p);)m[2]++,p++;if(p===h)return NaN;for(;p<h&&!d.get(i,p)&&m[3]<a;)m[3]++,p++;if(p===h||m[3]>=a)return NaN;for(;p<h&&d.get(i,p)&&m[4]<a;)m[4]++,p++;if(m[4]>=a)return NaN;const y=m[0]+m[1]+m[2]+m[3]+m[4];return 5*Math.abs(y-c)>=2*c?NaN:Ot.foundPatternCross(m)?Ot.centerFromEnd(m,p):NaN}crossCheckHorizontal(n,i,a,c){const d=this.image,h=d.getWidth(),m=this.getCrossCheckStateCount();let p=n;for(;p>=0&&d.get(p,i);)m[2]++,p--;if(p<0)return NaN;for(;p>=0&&!d.get(p,i)&&m[1]<=a;)m[1]++,p--;if(p<0||m[1]>a)return NaN;for(;p>=0&&d.get(p,i)&&m[0]<=a;)m[0]++,p--;if(m[0]>a)return NaN;for(p=n+1;p<h&&d.get(p,i);)m[2]++,p++;if(p===h)return NaN;for(;p<h&&!d.get(p,i)&&m[3]<a;)m[3]++,p++;if(p===h||m[3]>=a)return NaN;for(;p<h&&d.get(p,i)&&m[4]<a;)m[4]++,p++;if(m[4]>=a)return NaN;const y=m[0]+m[1]+m[2]+m[3]+m[4];return 5*Math.abs(y-c)>=c?NaN:Ot.foundPatternCross(m)?Ot.centerFromEnd(m,p):NaN}handlePossibleCenter(n,i,a,c){const d=n[0]+n[1]+n[2]+n[3]+n[4];let h=Ot.centerFromEnd(n,a),m=this.crossCheckVertical(i,Math.floor(h),n[2],d);if(!isNaN(m)&&(h=this.crossCheckHorizontal(Math.floor(h),Math.floor(m),n[2],d),!isNaN(h)&&(!c||this.crossCheckDiagonal(Math.floor(m),Math.floor(h),n[2],d)))){const p=d/7;let y=!1;const b=this.possibleCenters;for(let _=0,R=b.length;_<R;_++){const L=b[_];if(L.aboutEquals(p,m,h)){b[_]=L.combineEstimate(m,h,p),y=!0;break}}if(!y){const _=new Rc(h,m,p);b.push(_),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(_)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let i=null;for(const a of this.possibleCenters)if(a.getCount()>=Ot.CENTER_QUORUM)if(i==null)i=a;else return this.hasSkipped=!0,Math.floor((Math.abs(i.getX()-a.getX())-Math.abs(i.getY()-a.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let n=0,i=0;const a=this.possibleCenters.length;for(const h of this.possibleCenters)h.getCount()>=Ot.CENTER_QUORUM&&(n++,i+=h.getEstimatedModuleSize());if(n<3)return!1;const c=i/a;let d=0;for(const h of this.possibleCenters)d+=Math.abs(h.getEstimatedModuleSize()-c);return d<=.05*i}selectBestPatterns(){const n=this.possibleCenters.length;if(n<3)throw new Y;const i=this.possibleCenters;let a;if(n>3){let c=0,d=0;for(const p of this.possibleCenters){const y=p.getEstimatedModuleSize();c+=y,d+=y*y}a=c/n;let h=Math.sqrt(d/n-a*a);i.sort((p,y)=>{const b=Math.abs(y.getEstimatedModuleSize()-a),_=Math.abs(p.getEstimatedModuleSize()-a);return b<_?-1:b>_?1:0});const m=Math.max(.2*a,h);for(let p=0;p<i.length&&i.length>3;p++){const y=i[p];Math.abs(y.getEstimatedModuleSize()-a)>m&&(i.splice(p,1),p--)}}if(i.length>3){let c=0;for(const d of i)c+=d.getEstimatedModuleSize();a=c/i.length,i.sort((d,h)=>{if(h.getCount()===d.getCount()){const m=Math.abs(h.getEstimatedModuleSize()-a),p=Math.abs(d.getEstimatedModuleSize()-a);return m<p?1:m>p?-1:0}else return h.getCount()-d.getCount()}),i.splice(3)}return[i[0],i[1],i[2]]}}Ot.CENTER_QUORUM=2,Ot.MIN_SKIP=3,Ot.MAX_MODULES=57;class sa{constructor(n){this.image=n}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(n){this.resultPointCallback=n==null?null:n.get(z.NEED_RESULT_POINT_CALLBACK);const a=new Ot(this.image,this.resultPointCallback).find(n);return this.processFinderPatternInfo(a)}processFinderPatternInfo(n){const i=n.getTopLeft(),a=n.getTopRight(),c=n.getBottomLeft(),d=this.calculateModuleSize(i,a,c);if(d<1)throw new Y("No pattern found in proccess finder.");const h=sa.computeDimension(i,a,c,d),m=me.getProvisionalVersionForDimension(h),p=m.getDimensionForVersion()-7;let y=null;if(m.getAlignmentPatternCenters().length>0){const L=a.getX()-i.getX()+c.getX(),B=a.getY()-i.getY()+c.getY(),F=1-3/p,H=Math.floor(i.getX()+F*(L-i.getX())),q=Math.floor(i.getY()+F*(B-i.getY()));for(let ee=4;ee<=16;ee<<=1)try{y=this.findAlignmentInRegion(d,H,q,ee);break}catch(re){if(!(re instanceof Y))throw re}}const b=sa.createTransform(i,a,c,y,h),_=sa.sampleGrid(this.image,b,h);let R;return y===null?R=[c,i,a]:R=[c,i,a,y],new vo(_,R)}static createTransform(n,i,a,c,d){const h=d-3.5;let m,p,y,b;return c!==null?(m=c.getX(),p=c.getY(),y=h-3,b=y):(m=i.getX()-n.getX()+a.getX(),p=i.getY()-n.getY()+a.getY(),y=h,b=h),$r.quadrilateralToQuadrilateral(3.5,3.5,h,3.5,y,b,3.5,h,n.getX(),n.getY(),i.getX(),i.getY(),m,p,a.getX(),a.getY())}static sampleGrid(n,i,a){return zn.getInstance().sampleGridWithTransform(n,a,a,i)}static computeDimension(n,i,a,c){const d=ke.round(de.distance(n,i)/c),h=ke.round(de.distance(n,a)/c);let m=Math.floor((d+h)/2)+7;switch(m&3){case 0:m++;break;case 2:m--;break;case 3:throw new Y("Dimensions could be not found.")}return m}calculateModuleSize(n,i,a){return(this.calculateModuleSizeOneWay(n,i)+this.calculateModuleSizeOneWay(n,a))/2}calculateModuleSizeOneWay(n,i){const a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(n.getX()),Math.floor(n.getY()),Math.floor(i.getX()),Math.floor(i.getY())),c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(i.getX()),Math.floor(i.getY()),Math.floor(n.getX()),Math.floor(n.getY()));return isNaN(a)?c/7:isNaN(c)?a/7:(a+c)/14}sizeOfBlackWhiteBlackRunBothWays(n,i,a,c){let d=this.sizeOfBlackWhiteBlackRun(n,i,a,c),h=1,m=n-(a-n);m<0?(h=n/(n-m),m=0):m>=this.image.getWidth()&&(h=(this.image.getWidth()-1-n)/(m-n),m=this.image.getWidth()-1);let p=Math.floor(i-(c-i)*h);return h=1,p<0?(h=i/(i-p),p=0):p>=this.image.getHeight()&&(h=(this.image.getHeight()-1-i)/(p-i),p=this.image.getHeight()-1),m=Math.floor(n+(m-n)*h),d+=this.sizeOfBlackWhiteBlackRun(n,i,m,p),d-1}sizeOfBlackWhiteBlackRun(n,i,a,c){const d=Math.abs(c-i)>Math.abs(a-n);if(d){let L=n;n=i,i=L,L=a,a=c,c=L}const h=Math.abs(a-n),m=Math.abs(c-i);let p=-h/2;const y=n<a?1:-1,b=i<c?1:-1;let _=0;const R=a+y;for(let L=n,B=i;L!==R;L+=y){const F=d?B:L,H=d?L:B;if(_===1===this.image.get(F,H)){if(_===2)return ke.distance(L,B,n,i);_++}if(p+=m,p>0){if(B===c)break;B+=b,p-=h}}return _===2?ke.distance(a+y,c,n,i):NaN}findAlignmentInRegion(n,i,a,c){const d=Math.floor(c*n),h=Math.max(0,i-d),m=Math.min(this.image.getWidth()-1,i+d);if(m-h<n*3)throw new Y("Alignment top exceeds estimated module size.");const p=Math.max(0,a-d),y=Math.min(this.image.getHeight()-1,a+d);if(y-p<n*3)throw new Y("Alignment bottom exceeds estimated module size.");return new _o(this.image,h,p,m-h,y-p,n,this.resultPointCallback).find()}}class Gn{constructor(){this.decoder=new Sp}getDecoder(){return this.decoder}decode(n,i){let a,c;if(i!=null&&i.get(z.PURE_BARCODE)!==void 0){const p=Gn.extractPureBits(n.getBlackMatrix());a=this.decoder.decodeBitMatrix(p,i),c=Gn.NO_POINTS}else{const p=new sa(n.getBlackMatrix()).detect(i);a=this.decoder.decodeBitMatrix(p.getBits(),i),c=p.getPoints()}a.getOther()instanceof i0&&a.getOther().applyMirroredCorrection(c);const d=new Ie(a.getText(),a.getRawBytes(),void 0,c,se.QR_CODE,void 0),h=a.getByteSegments();h!==null&&d.putMetadata(Ue.BYTE_SEGMENTS,h);const m=a.getECLevel();return m!==null&&d.putMetadata(Ue.ERROR_CORRECTION_LEVEL,m),a.hasStructuredAppend()&&(d.putMetadata(Ue.STRUCTURED_APPEND_SEQUENCE,a.getStructuredAppendSequenceNumber()),d.putMetadata(Ue.STRUCTURED_APPEND_PARITY,a.getStructuredAppendParity())),d}reset(){}static extractPureBits(n){const i=n.getTopLeftOnBit(),a=n.getBottomRightOnBit();if(i===null||a===null)throw new Y;const c=this.moduleSize(i,n);let d=i[1],h=a[1],m=i[0],p=a[0];if(m>=p||d>=h)throw new Y;if(h-d!==p-m&&(p=m+(h-d),p>=n.getWidth()))throw new Y;const y=Math.round((p-m+1)/c),b=Math.round((h-d+1)/c);if(y<=0||b<=0)throw new Y;if(b!==y)throw new Y;const _=Math.floor(c/2);d+=_,m+=_;const R=m+Math.floor((y-1)*c)-p;if(R>0){if(R>_)throw new Y;m-=R}const L=d+Math.floor((b-1)*c)-h;if(L>0){if(L>_)throw new Y;d-=L}const B=new We(y,b);for(let F=0;F<b;F++){const H=d+Math.floor(F*c);for(let q=0;q<y;q++)n.get(m+Math.floor(q*c),H)&&B.set(q,F)}return B}static moduleSize(n,i){const a=i.getHeight(),c=i.getWidth();let d=n[0],h=n[1],m=!0,p=0;for(;d<c&&h<a;){if(m!==i.get(d,h)){if(++p===5)break;m=!m}d++,h++}if(d===c||h===a)throw new Y;return(d-n[0])/7}}Gn.NO_POINTS=new Array;class ve{PDF417Common(){}static getBitCountSum(n){return ke.sum(n)}static toIntArray(n){if(n==null||!n.length)return ve.EMPTY_INT_ARRAY;const i=new Int32Array(n.length);let a=0;for(const c of n)i[a++]=c;return i}static getCodeword(n){const i=C.binarySearch(ve.SYMBOL_TABLE,n&262143);return i<0?-1:(ve.CODEWORD_TABLE[i]-1)%ve.NUMBER_OF_CODEWORDS}}ve.NUMBER_OF_CODEWORDS=929,ve.MAX_CODEWORDS_IN_BARCODE=ve.NUMBER_OF_CODEWORDS-1,ve.MIN_ROWS_IN_BARCODE=3,ve.MAX_ROWS_IN_BARCODE=90,ve.MODULES_IN_CODEWORD=17,ve.MODULES_IN_STOP_PATTERN=18,ve.BARS_IN_MODULE=8,ve.EMPTY_INT_ARRAY=new Int32Array([]),ve.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),ve.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Ip{constructor(n,i){this.bits=n,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class Se{static detectMultiple(n,i,a){let c=n.getBlackMatrix(),d=Se.detect(a,c);return d.length||(c=c.clone(),c.rotate180(),d=Se.detect(a,c)),new Ip(c,d)}static detect(n,i){const a=new Array;let c=0,d=0,h=!1;for(;c<i.getHeight();){const m=Se.findVertices(i,c,d);if(m[0]==null&&m[3]==null){if(!h)break;h=!1,d=0;for(const p of a)p[1]!=null&&(c=Math.trunc(Math.max(c,p[1].getY()))),p[3]!=null&&(c=Math.max(c,Math.trunc(p[3].getY())));c+=Se.ROW_STEP;continue}if(h=!0,a.push(m),!n)break;m[2]!=null?(d=Math.trunc(m[2].getX()),c=Math.trunc(m[2].getY())):(d=Math.trunc(m[4].getX()),c=Math.trunc(m[4].getY()))}return a}static findVertices(n,i,a){const c=n.getHeight(),d=n.getWidth(),h=new Array(8);return Se.copyToResult(h,Se.findRowsWithPattern(n,c,d,i,a,Se.START_PATTERN),Se.INDEXES_START_PATTERN),h[4]!=null&&(a=Math.trunc(h[4].getX()),i=Math.trunc(h[4].getY())),Se.copyToResult(h,Se.findRowsWithPattern(n,c,d,i,a,Se.STOP_PATTERN),Se.INDEXES_STOP_PATTERN),h}static copyToResult(n,i,a){for(let c=0;c<a.length;c++)n[a[c]]=i[c]}static findRowsWithPattern(n,i,a,c,d,h){const m=new Array(4);let p=!1;const y=new Int32Array(h.length);for(;c<i;c+=Se.ROW_STEP){let _=Se.findGuardPattern(n,d,c,a,!1,h,y);if(_!=null){for(;c>0;){const R=Se.findGuardPattern(n,d,--c,a,!1,h,y);if(R!=null)_=R;else{c++;break}}m[0]=new de(_[0],c),m[1]=new de(_[1],c),p=!0;break}}let b=c+1;if(p){let _=0,R=Int32Array.from([Math.trunc(m[0].getX()),Math.trunc(m[1].getX())]);for(;b<i;b++){const L=Se.findGuardPattern(n,R[0],b,a,!1,h,y);if(L!=null&&Math.abs(R[0]-L[0])<Se.MAX_PATTERN_DRIFT&&Math.abs(R[1]-L[1])<Se.MAX_PATTERN_DRIFT)R=L,_=0;else{if(_>Se.SKIPPED_ROW_COUNT_MAX)break;_++}}b-=_+1,m[2]=new de(R[0],b),m[3]=new de(R[1],b)}return b-c<Se.BARCODE_MIN_HEIGHT&&C.fill(m,null),m}static findGuardPattern(n,i,a,c,d,h,m){C.fillWithin(m,0,m.length,0);let p=i,y=0;for(;n.get(p,a)&&p>0&&y++<Se.MAX_PIXEL_DRIFT;)p--;let b=p,_=0,R=h.length;for(let L=d;b<c;b++)if(n.get(b,a)!==L)m[_]++;else{if(_===R-1){if(Se.patternMatchVariance(m,h,Se.MAX_INDIVIDUAL_VARIANCE)<Se.MAX_AVG_VARIANCE)return new Int32Array([p,b]);p+=m[0]+m[1],j.arraycopy(m,2,m,0,_-1),m[_-1]=0,m[_]=0,_--}else _++;m[_]=1,L=!L}return _===R-1&&Se.patternMatchVariance(m,h,Se.MAX_INDIVIDUAL_VARIANCE)<Se.MAX_AVG_VARIANCE?new Int32Array([p,b-1]):null}static patternMatchVariance(n,i,a){let c=n.length,d=0,h=0;for(let y=0;y<c;y++)d+=n[y],h+=i[y];if(d<h)return 1/0;let m=d/h;a*=m;let p=0;for(let y=0;y<c;y++){let b=n[y],_=i[y]*m,R=b>_?b-_:_-b;if(R>a)return 1/0;p+=R}return p/d}}Se.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Se.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Se.MAX_AVG_VARIANCE=.42,Se.MAX_INDIVIDUAL_VARIANCE=.8,Se.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Se.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Se.MAX_PIXEL_DRIFT=3,Se.MAX_PATTERN_DRIFT=5,Se.SKIPPED_ROW_COUNT_MAX=25,Se.ROW_STEP=5,Se.BARCODE_MIN_HEIGHT=10;class Pt{constructor(n,i){if(i.length===0)throw new E;this.field=n;let a=i.length;if(a>1&&i[0]===0){let c=1;for(;c<a&&i[c]===0;)c++;c===a?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(a-c),j.arraycopy(i,c,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(n){return this.coefficients[this.coefficients.length-1-n]}evaluateAt(n){if(n===0)return this.getCoefficient(0);if(n===1){let c=0;for(let d of this.coefficients)c=this.field.add(c,d);return c}let i=this.coefficients[0],a=this.coefficients.length;for(let c=1;c<a;c++)i=this.field.add(this.field.multiply(n,i),this.coefficients[c]);return i}add(n){if(!this.field.equals(n.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero())return n;if(n.isZero())return this;let i=this.coefficients,a=n.coefficients;if(i.length>a.length){let h=i;i=a,a=h}let c=new Int32Array(a.length),d=a.length-i.length;j.arraycopy(a,0,c,0,d);for(let h=d;h<a.length;h++)c[h]=this.field.add(i[h-d],a[h]);return new Pt(this.field,c)}subtract(n){if(!this.field.equals(n.field))throw new E("ModulusPolys do not have same ModulusGF field");return n.isZero()?this:this.add(n.negative())}multiply(n){return n instanceof Pt?this.multiplyOther(n):this.multiplyScalar(n)}multiplyOther(n){if(!this.field.equals(n.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero()||n.isZero())return new Pt(this.field,new Int32Array([0]));let i=this.coefficients,a=i.length,c=n.coefficients,d=c.length,h=new Int32Array(a+d-1);for(let m=0;m<a;m++){let p=i[m];for(let y=0;y<d;y++)h[m+y]=this.field.add(h[m+y],this.field.multiply(p,c[y]))}return new Pt(this.field,h)}negative(){let n=this.coefficients.length,i=new Int32Array(n);for(let a=0;a<n;a++)i[a]=this.field.subtract(0,this.coefficients[a]);return new Pt(this.field,i)}multiplyScalar(n){if(n===0)return new Pt(this.field,new Int32Array([0]));if(n===1)return this;let i=this.coefficients.length,a=new Int32Array(i);for(let c=0;c<i;c++)a[c]=this.field.multiply(this.coefficients[c],n);return new Pt(this.field,a)}multiplyByMonomial(n,i){if(n<0)throw new E;if(i===0)return new Pt(this.field,new Int32Array([0]));let a=this.coefficients.length,c=new Int32Array(a+n);for(let d=0;d<a;d++)c[d]=this.field.multiply(this.coefficients[d],i);return new Pt(this.field,c)}toString(){let n=new Ne;for(let i=this.getDegree();i>=0;i--){let a=this.getCoefficient(i);a!==0&&(a<0?(n.append(" - "),a=-a):n.length()>0&&n.append(" + "),(i===0||a!==1)&&n.append(a),i!==0&&(i===1?n.append("x"):(n.append("x^"),n.append(i))))}return n.toString()}}class Tp{add(n,i){return(n+i)%this.modulus}subtract(n,i){return(this.modulus+n-i)%this.modulus}exp(n){return this.expTable[n]}log(n){if(n===0)throw new E;return this.logTable[n]}inverse(n){if(n===0)throw new wo;return this.expTable[this.modulus-this.logTable[n]-1]}multiply(n,i){return n===0||i===0?0:this.expTable[(this.logTable[n]+this.logTable[i])%(this.modulus-1)]}getSize(){return this.modulus}equals(n){return n===this}}class Oc extends Tp{constructor(n,i){super(),this.modulus=n,this.expTable=new Int32Array(n),this.logTable=new Int32Array(n);let a=1;for(let c=0;c<n;c++)this.expTable[c]=a,a=a*i%n;for(let c=0;c<n-1;c++)this.logTable[this.expTable[c]]=c;this.zero=new Pt(this,new Int32Array([0])),this.one=new Pt(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(n,i){if(n<0)throw new E;if(i===0)return this.zero;let a=new Int32Array(n+1);return a[0]=i,new Pt(this,a)}}Oc.PDF417_GF=new Oc(ve.NUMBER_OF_CODEWORDS,3);class a0{constructor(){this.field=Oc.PDF417_GF}decode(n,i,a){let c=new Pt(this.field,n),d=new Int32Array(i),h=!1;for(let B=i;B>0;B--){let F=c.evaluateAt(this.field.exp(B));d[i-B]=F,F!==0&&(h=!0)}if(!h)return 0;let m=this.field.getOne();if(a!=null)for(const B of a){let F=this.field.exp(n.length-1-B),H=new Pt(this.field,new Int32Array([this.field.subtract(0,F),1]));m=m.multiply(H)}let p=new Pt(this.field,d),y=this.runEuclideanAlgorithm(this.field.buildMonomial(i,1),p,i),b=y[0],_=y[1],R=this.findErrorLocations(b),L=this.findErrorMagnitudes(_,b,R);for(let B=0;B<R.length;B++){let F=n.length-1-this.field.log(R[B]);if(F<0)throw I.getChecksumInstance();n[F]=this.field.subtract(n[F],L[B])}return R.length}runEuclideanAlgorithm(n,i,a){if(n.getDegree()<i.getDegree()){let R=n;n=i,i=R}let c=n,d=i,h=this.field.getZero(),m=this.field.getOne();for(;d.getDegree()>=Math.round(a/2);){let R=c,L=h;if(c=d,h=m,c.isZero())throw I.getChecksumInstance();d=R;let B=this.field.getZero(),F=c.getCoefficient(c.getDegree()),H=this.field.inverse(F);for(;d.getDegree()>=c.getDegree()&&!d.isZero();){let q=d.getDegree()-c.getDegree(),ee=this.field.multiply(d.getCoefficient(d.getDegree()),H);B=B.add(this.field.buildMonomial(q,ee)),d=d.subtract(c.multiplyByMonomial(q,ee))}m=B.multiply(h).subtract(L).negative()}let p=m.getCoefficient(0);if(p===0)throw I.getChecksumInstance();let y=this.field.inverse(p),b=m.multiply(y),_=d.multiply(y);return[b,_]}findErrorLocations(n){let i=n.getDegree(),a=new Int32Array(i),c=0;for(let d=1;d<this.field.getSize()&&c<i;d++)n.evaluateAt(d)===0&&(a[c]=this.field.inverse(d),c++);if(c!==i)throw I.getChecksumInstance();return a}findErrorMagnitudes(n,i,a){let c=i.getDegree(),d=new Int32Array(c);for(let y=1;y<=c;y++)d[c-y]=this.field.multiply(y,i.getCoefficient(y));let h=new Pt(this.field,d),m=a.length,p=new Int32Array(m);for(let y=0;y<m;y++){let b=this.field.inverse(a[y]),_=this.field.subtract(0,n.evaluateAt(b)),R=this.field.inverse(h.evaluateAt(b));p[y]=this.field.multiply(_,R)}return p}}class Ss{constructor(n,i,a,c,d){n instanceof Ss?this.constructor_2(n):this.constructor_1(n,i,a,c,d)}constructor_1(n,i,a,c,d){const h=i==null||a==null,m=c==null||d==null;if(h&&m)throw new Y;h?(i=new de(0,c.getY()),a=new de(0,d.getY())):m&&(c=new de(n.getWidth()-1,i.getY()),d=new de(n.getWidth()-1,a.getY())),this.image=n,this.topLeft=i,this.bottomLeft=a,this.topRight=c,this.bottomRight=d,this.minX=Math.trunc(Math.min(i.getX(),a.getX())),this.maxX=Math.trunc(Math.max(c.getX(),d.getX())),this.minY=Math.trunc(Math.min(i.getY(),c.getY())),this.maxY=Math.trunc(Math.max(a.getY(),d.getY()))}constructor_2(n){this.image=n.image,this.topLeft=n.getTopLeft(),this.bottomLeft=n.getBottomLeft(),this.topRight=n.getTopRight(),this.bottomRight=n.getBottomRight(),this.minX=n.getMinX(),this.maxX=n.getMaxX(),this.minY=n.getMinY(),this.maxY=n.getMaxY()}static merge(n,i){return n==null?i:i==null?n:new Ss(n.image,n.topLeft,n.bottomLeft,i.topRight,i.bottomRight)}addMissingRows(n,i,a){let c=this.topLeft,d=this.bottomLeft,h=this.topRight,m=this.bottomRight;if(n>0){let p=a?this.topLeft:this.topRight,y=Math.trunc(p.getY()-n);y<0&&(y=0);let b=new de(p.getX(),y);a?c=b:h=b}if(i>0){let p=a?this.bottomLeft:this.bottomRight,y=Math.trunc(p.getY()+i);y>=this.image.getHeight()&&(y=this.image.getHeight()-1);let b=new de(p.getX(),y);a?d=b:m=b}return new Ss(this.image,c,d,h,m)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class jp{constructor(n,i,a,c){this.columnCount=n,this.errorCorrectionLevel=c,this.rowCountUpperPart=i,this.rowCountLowerPart=a,this.rowCount=i+a}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class ia{constructor(){this.buffer=""}static form(n,i){let a=-1;function c(h,m,p,y,b,_){if(h==="%%")return"%";if(i[++a]===void 0)return;h=y?parseInt(y.substr(1)):void 0;let R=b?parseInt(b.substr(1)):void 0,L;switch(_){case"s":L=i[a];break;case"c":L=i[a][0];break;case"f":L=parseFloat(i[a]).toFixed(h);break;case"p":L=parseFloat(i[a]).toPrecision(h);break;case"e":L=parseFloat(i[a]).toExponential(h);break;case"x":L=parseInt(i[a]).toString(R||16);break;case"d":L=parseFloat(parseInt(i[a],R||10).toPrecision(h)).toFixed(0);break}L=typeof L=="object"?JSON.stringify(L):(+L).toString(R);let B=parseInt(p),F=p&&p[0]+""=="0"?"0":" ";for(;L.length<B;)L=m!==void 0?L+F:F+L;return L}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return n.replace(d,c)}format(n,...i){this.buffer+=ia.form(n,i)}toString(){return this.buffer}}class aa{constructor(n){this.boundingBox=new Ss(n),this.codewords=new Array(n.getMaxY()-n.getMinY()+1)}getCodewordNearby(n){let i=this.getCodeword(n);if(i!=null)return i;for(let a=1;a<aa.MAX_NEARBY_DISTANCE;a++){let c=this.imageRowToCodewordIndex(n)-a;if(c>=0&&(i=this.codewords[c],i!=null)||(c=this.imageRowToCodewordIndex(n)+a,c<this.codewords.length&&(i=this.codewords[c],i!=null)))return i}return null}imageRowToCodewordIndex(n){return n-this.boundingBox.getMinY()}setCodeword(n,i){this.codewords[this.imageRowToCodewordIndex(n)]=i}getCodeword(n){return this.codewords[this.imageRowToCodewordIndex(n)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const n=new ia;let i=0;for(const a of this.codewords){if(a==null){n.format("%3d:    |   %n",i++);continue}n.format("%3d: %3d|%3d%n",i++,a.getRowNumber(),a.getValue())}return n.toString()}}aa.MAX_NEARBY_DISTANCE=5;class oa{constructor(){this.values=new Map}setValue(n){n=Math.trunc(n);let i=this.values.get(n);i==null&&(i=0),i++,this.values.set(n,i)}getValue(){let n=-1,i=new Array;for(const[a,c]of this.values.entries()){const d={getKey:()=>a,getValue:()=>c};d.getValue()>n?(n=d.getValue(),i=[],i.push(d.getKey())):d.getValue()===n&&i.push(d.getKey())}return ve.toIntArray(i)}getConfidence(n){return this.values.get(n)}}class o0 extends aa{constructor(n,i){super(n),this._isLeft=i}setRowNumbers(){for(let n of this.getCodewords())n!=null&&n.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(n){let i=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(i,n);let a=this.getBoundingBox(),c=this._isLeft?a.getTopLeft():a.getTopRight(),d=this._isLeft?a.getBottomLeft():a.getBottomRight(),h=this.imageRowToCodewordIndex(Math.trunc(c.getY())),m=this.imageRowToCodewordIndex(Math.trunc(d.getY())),p=-1,y=1,b=0;for(let _=h;_<m;_++){if(i[_]==null)continue;let R=i[_],L=R.getRowNumber()-p;if(L===0)b++;else if(L===1)y=Math.max(y,b),b=1,p=R.getRowNumber();else if(L<0||R.getRowNumber()>=n.getRowCount()||L>_)i[_]=null;else{let B;y>2?B=(y-2)*L:B=L;let F=B>=_;for(let H=1;H<=B&&!F;H++)F=i[_-H]!=null;F?i[_]=null:(p=R.getRowNumber(),b=1)}}}getRowHeights(){let n=this.getBarcodeMetadata();if(n==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(n);let i=new Int32Array(n.getRowCount());for(let a of this.getCodewords())if(a!=null){let c=a.getRowNumber();if(c>=i.length)continue;i[c]++}return i}adjustIncompleteIndicatorColumnRowNumbers(n){let i=this.getBoundingBox(),a=this._isLeft?i.getTopLeft():i.getTopRight(),c=this._isLeft?i.getBottomLeft():i.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(a.getY())),h=this.imageRowToCodewordIndex(Math.trunc(c.getY())),m=this.getCodewords(),p=-1;for(let y=d;y<h;y++){if(m[y]==null)continue;let b=m[y];b.setRowNumberAsRowIndicatorColumn();let _=b.getRowNumber()-p;_===0||(_===1?p=b.getRowNumber():b.getRowNumber()>=n.getRowCount()?m[y]=null:p=b.getRowNumber())}}getBarcodeMetadata(){let n=this.getCodewords(),i=new oa,a=new oa,c=new oa,d=new oa;for(let m of n){if(m==null)continue;m.setRowNumberAsRowIndicatorColumn();let p=m.getValue()%30,y=m.getRowNumber();switch(this._isLeft||(y+=2),y%3){case 0:a.setValue(p*3+1);break;case 1:d.setValue(p/3),c.setValue(p%3);break;case 2:i.setValue(p+1);break}}if(i.getValue().length===0||a.getValue().length===0||c.getValue().length===0||d.getValue().length===0||i.getValue()[0]<1||a.getValue()[0]+c.getValue()[0]<ve.MIN_ROWS_IN_BARCODE||a.getValue()[0]+c.getValue()[0]>ve.MAX_ROWS_IN_BARCODE)return null;let h=new jp(i.getValue()[0],a.getValue()[0],c.getValue()[0],d.getValue()[0]);return this.removeIncorrectCodewords(n,h),h}removeIncorrectCodewords(n,i){for(let a=0;a<n.length;a++){let c=n[a];if(n[a]==null)continue;let d=c.getValue()%30,h=c.getRowNumber();if(h>i.getRowCount()){n[a]=null;continue}switch(this._isLeft||(h+=2),h%3){case 0:d*3+1!==i.getRowCountUpperPart()&&(n[a]=null);break;case 1:(Math.trunc(d/3)!==i.getErrorCorrectionLevel()||d%3!==i.getRowCountLowerPart())&&(n[a]=null);break;case 2:d+1!==i.getColumnCount()&&(n[a]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class la{constructor(n,i){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=n,this.barcodeColumnCount=n.getColumnCount(),this.boundingBox=i,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let n=ve.MAX_CODEWORDS_IN_BARCODE,i;do i=n,n=this.adjustRowNumbersAndGetCount();while(n>0&&n<i);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(n){n!=null&&n.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let n=this.adjustRowNumbersByRow();if(n===0)return 0;for(let i=1;i<this.barcodeColumnCount+1;i++){let a=this.detectionResultColumns[i].getCodewords();for(let c=0;c<a.length;c++)a[c]!=null&&(a[c].hasValidRowNumber()||this.adjustRowNumbers(i,c,a))}return n}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let n=this.detectionResultColumns[0].getCodewords(),i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let a=0;a<n.length;a++)if(n[a]!=null&&i[a]!=null&&n[a].getRowNumber()===i[a].getRowNumber())for(let c=1;c<=this.barcodeColumnCount;c++){let d=this.detectionResultColumns[c].getCodewords()[a];d!=null&&(d.setRowNumber(n[a].getRowNumber()),d.hasValidRowNumber()||(this.detectionResultColumns[c].getCodewords()[a]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let n=0,i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let a=0;a<i.length;a++){if(i[a]==null)continue;let c=i[a].getRowNumber(),d=0;for(let h=this.barcodeColumnCount+1;h>0&&d<this.ADJUST_ROW_NUMBER_SKIP;h--){let m=this.detectionResultColumns[h].getCodewords()[a];m!=null&&(d=la.adjustRowNumberIfValid(c,d,m),m.hasValidRowNumber()||n++)}}return n}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let n=0,i=this.detectionResultColumns[0].getCodewords();for(let a=0;a<i.length;a++){if(i[a]==null)continue;let c=i[a].getRowNumber(),d=0;for(let h=1;h<this.barcodeColumnCount+1&&d<this.ADJUST_ROW_NUMBER_SKIP;h++){let m=this.detectionResultColumns[h].getCodewords()[a];m!=null&&(d=la.adjustRowNumberIfValid(c,d,m),m.hasValidRowNumber()||n++)}}return n}static adjustRowNumberIfValid(n,i,a){return a==null||a.hasValidRowNumber()||(a.isValidRowNumber(n)?(a.setRowNumber(n),i=0):++i),i}adjustRowNumbers(n,i,a){if(!this.detectionResultColumns[n-1])return;let c=a[i],d=this.detectionResultColumns[n-1].getCodewords(),h=d;this.detectionResultColumns[n+1]!=null&&(h=this.detectionResultColumns[n+1].getCodewords());let m=new Array(14);m[2]=d[i],m[3]=h[i],i>0&&(m[0]=a[i-1],m[4]=d[i-1],m[5]=h[i-1]),i>1&&(m[8]=a[i-2],m[10]=d[i-2],m[11]=h[i-2]),i<a.length-1&&(m[1]=a[i+1],m[6]=d[i+1],m[7]=h[i+1]),i<a.length-2&&(m[9]=a[i+2],m[12]=d[i+2],m[13]=h[i+2]);for(let p of m)if(la.adjustRowNumber(c,p))return}static adjustRowNumber(n,i){return i==null?!1:i.hasValidRowNumber()&&i.getBucket()===n.getBucket()?(n.setRowNumber(i.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(n){this.boundingBox=n}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(n,i){this.detectionResultColumns[n]=i}getDetectionResultColumn(n){return this.detectionResultColumns[n]}toString(){let n=this.detectionResultColumns[0];n==null&&(n=this.detectionResultColumns[this.barcodeColumnCount+1]);let i=new ia;for(let a=0;a<n.getCodewords().length;a++){i.format("CW %3d:",a);for(let c=0;c<this.barcodeColumnCount+2;c++){if(this.detectionResultColumns[c]==null){i.format("    |   ");continue}let d=this.detectionResultColumns[c].getCodewords()[a];if(d==null){i.format("    |   ");continue}i.format(" %3d|%3d",d.getRowNumber(),d.getValue())}i.format("%n")}return i.toString()}}class ca{constructor(n,i,a,c){this.rowNumber=ca.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(n),this.endX=Math.trunc(i),this.bucket=Math.trunc(a),this.value=Math.trunc(c)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(n){return n!==ca.BARCODE_ROW_UNKNOWN&&this.bucket===n%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(n){this.rowNumber=n}toString(){return this.rowNumber+"|"+this.value}}ca.BARCODE_ROW_UNKNOWN=-1;class ur{static initialize(){for(let n=0;n<ve.SYMBOL_TABLE.length;n++){let i=ve.SYMBOL_TABLE[n],a=i&1;for(let c=0;c<ve.BARS_IN_MODULE;c++){let d=0;for(;(i&1)===a;)d+=1,i>>=1;a=i&1,ur.RATIOS_TABLE[n]||(ur.RATIOS_TABLE[n]=new Array(ve.BARS_IN_MODULE)),ur.RATIOS_TABLE[n][ve.BARS_IN_MODULE-c-1]=Math.fround(d/ve.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(n){let i=ur.getDecodedCodewordValue(ur.sampleBitCounts(n));return i!==-1?i:ur.getClosestDecodedValue(n)}static sampleBitCounts(n){let i=ke.sum(n),a=new Int32Array(ve.BARS_IN_MODULE),c=0,d=0;for(let h=0;h<ve.MODULES_IN_CODEWORD;h++){let m=i/(2*ve.MODULES_IN_CODEWORD)+h*i/ve.MODULES_IN_CODEWORD;d+n[c]<=m&&(d+=n[c],c++),a[c]++}return a}static getDecodedCodewordValue(n){let i=ur.getBitValue(n);return ve.getCodeword(i)===-1?-1:i}static getBitValue(n){let i=0;for(let a=0;a<n.length;a++)for(let c=0;c<n[a];c++)i=i<<1|(a%2===0?1:0);return Math.trunc(i)}static getClosestDecodedValue(n){let i=ke.sum(n),a=new Array(ve.BARS_IN_MODULE);if(i>1)for(let h=0;h<a.length;h++)a[h]=Math.fround(n[h]/i);let c=yo.MAX_VALUE,d=-1;this.bSymbolTableReady||ur.initialize();for(let h=0;h<ur.RATIOS_TABLE.length;h++){let m=0,p=ur.RATIOS_TABLE[h];for(let y=0;y<ve.BARS_IN_MODULE;y++){let b=Math.fround(p[y]-a[y]);if(m+=Math.fround(b*b),m>=c)break}m<c&&(c=m,d=ve.SYMBOL_TABLE[h])}return d}}ur.bSymbolTableReady=!1,ur.RATIOS_TABLE=new Array(ve.SYMBOL_TABLE.length).map(N=>new Array(ve.BARS_IN_MODULE));class l0{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(n){this.segmentIndex=n}getFileId(){return this.fileId}setFileId(n){this.fileId=n}getOptionalData(){return this.optionalData}setOptionalData(n){this.optionalData=n}isLastSegment(){return this.lastSegment}setLastSegment(n){this.lastSegment=n}getSegmentCount(){return this.segmentCount}setSegmentCount(n){this.segmentCount=n}getSender(){return this.sender||null}setSender(n){this.sender=n}getAddressee(){return this.addressee||null}setAddressee(n){this.addressee=n}getFileName(){return this.fileName}setFileName(n){this.fileName=n}getFileSize(){return this.fileSize}setFileSize(n){this.fileSize=n}getChecksum(){return this.checksum}setChecksum(n){this.checksum=n}getTimestamp(){return this.timestamp}setTimestamp(n){this.timestamp=n}}class c0{static parseLong(n,i=void 0){return parseInt(n,i)}}class u0 extends x{}u0.kind="NullPointerException";class Rp{writeBytes(n){this.writeBytesOffset(n,0,n.length)}writeBytesOffset(n,i,a){if(n==null)throw new u0;if(i<0||i>n.length||a<0||i+a>n.length||i+a<0)throw new M;if(a===0)return;for(let c=0;c<a;c++)this.write(n[i+c])}flush(){}close(){}}class Op extends x{}class kp extends Rp{constructor(n=32){if(super(),this.count=0,n<0)throw new E("Negative initial size: "+n);this.buf=new Uint8Array(n)}ensureCapacity(n){n-this.buf.length>0&&this.grow(n)}grow(n){let a=this.buf.length<<1;if(a-n<0&&(a=n),a<0){if(n<0)throw new Op;a=T.MAX_VALUE}this.buf=C.copyOfUint8Array(this.buf,a)}write(n){this.ensureCapacity(this.count+1),this.buf[this.count]=n,this.count+=1}writeBytesOffset(n,i,a){if(i<0||i>n.length||a<0||i+a-n.length>0)throw new M;this.ensureCapacity(this.count+a),j.arraycopy(n,i,this.buf,this.count,a),this.count+=a}writeTo(n){n.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return C.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(n){return n?typeof n=="string"?this.toString_string(n):this.toString_number(n):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(n){return new String(this.buf).toString()}toString_number(n){return new String(this.buf).toString()}close(){}}var He;(function(N){N[N.ALPHA=0]="ALPHA",N[N.LOWER=1]="LOWER",N[N.MIXED=2]="MIXED",N[N.PUNCT=3]="PUNCT",N[N.ALPHA_SHIFT=4]="ALPHA_SHIFT",N[N.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(He||(He={}));function d0(){if(typeof window<"u")return window.BigInt||null;if(typeof ha<"u")return ha.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let So;function $n(N){if(typeof So>"u"&&(So=d0()),So===null)throw new Error("BigInt is not supported!");return So(N)}function Mp(){let N=[];N[0]=$n(1);let n=$n(900);N[1]=n;for(let i=2;i<16;i++)N[i]=N[i-1]*n;return N}class X{static decode(n,i){let a=new Ne(""),c=G.ISO8859_1;a.enableDecoding(c);let d=1,h=n[d++],m=new l0;for(;d<n[0];){switch(h){case X.TEXT_COMPACTION_MODE_LATCH:d=X.textCompaction(n,d,a);break;case X.BYTE_COMPACTION_MODE_LATCH:case X.BYTE_COMPACTION_MODE_LATCH_6:d=X.byteCompaction(h,n,c,d,a);break;case X.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(n[d++]);break;case X.NUMERIC_COMPACTION_MODE_LATCH:d=X.numericCompaction(n,d,a);break;case X.ECI_CHARSET:G.getCharacterSetECIByValue(n[d++]);break;case X.ECI_GENERAL_PURPOSE:d+=2;break;case X.ECI_USER_DEFINED:d++;break;case X.BEGIN_MACRO_PDF417_CONTROL_BLOCK:d=X.decodeMacroBlock(n,d,m);break;case X.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case X.MACRO_PDF417_TERMINATOR:throw new U;default:d--,d=X.textCompaction(n,d,a);break}if(d<n.length)h=n[d++];else throw U.getFormatInstance()}if(a.length()===0)throw U.getFormatInstance();let p=new Gr(null,a.toString(),null,i);return p.setOther(m),p}static decodeMacroBlock(n,i,a){if(i+X.NUMBER_OF_SEQUENCE_CODEWORDS>n[0])throw U.getFormatInstance();let c=new Int32Array(X.NUMBER_OF_SEQUENCE_CODEWORDS);for(let m=0;m<X.NUMBER_OF_SEQUENCE_CODEWORDS;m++,i++)c[m]=n[i];a.setSegmentIndex(T.parseInt(X.decodeBase900toBase10(c,X.NUMBER_OF_SEQUENCE_CODEWORDS)));let d=new Ne;i=X.textCompaction(n,i,d),a.setFileId(d.toString());let h=-1;for(n[i]===X.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(h=i+1);i<n[0];)switch(n[i]){case X.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(i++,n[i]){case X.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let m=new Ne;i=X.textCompaction(n,i+1,m),a.setFileName(m.toString());break;case X.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let p=new Ne;i=X.textCompaction(n,i+1,p),a.setSender(p.toString());break;case X.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let y=new Ne;i=X.textCompaction(n,i+1,y),a.setAddressee(y.toString());break;case X.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let b=new Ne;i=X.numericCompaction(n,i+1,b),a.setSegmentCount(T.parseInt(b.toString()));break;case X.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let _=new Ne;i=X.numericCompaction(n,i+1,_),a.setTimestamp(c0.parseLong(_.toString()));break;case X.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let R=new Ne;i=X.numericCompaction(n,i+1,R),a.setChecksum(T.parseInt(R.toString()));break;case X.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let L=new Ne;i=X.numericCompaction(n,i+1,L),a.setFileSize(c0.parseLong(L.toString()));break;default:throw U.getFormatInstance()}break;case X.MACRO_PDF417_TERMINATOR:i++,a.setLastSegment(!0);break;default:throw U.getFormatInstance()}if(h!==-1){let m=i-h;a.isLastSegment()&&m--,a.setOptionalData(C.copyOfRange(n,h,h+m))}return i}static textCompaction(n,i,a){let c=new Int32Array((n[0]-i)*2),d=new Int32Array((n[0]-i)*2),h=0,m=!1;for(;i<n[0]&&!m;){let p=n[i++];if(p<X.TEXT_COMPACTION_MODE_LATCH)c[h]=p/30,c[h+1]=p%30,h+=2;else switch(p){case X.TEXT_COMPACTION_MODE_LATCH:c[h++]=X.TEXT_COMPACTION_MODE_LATCH;break;case X.BYTE_COMPACTION_MODE_LATCH:case X.BYTE_COMPACTION_MODE_LATCH_6:case X.NUMERIC_COMPACTION_MODE_LATCH:case X.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case X.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case X.MACRO_PDF417_TERMINATOR:i--,m=!0;break;case X.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c[h]=X.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,p=n[i++],d[h]=p,h++;break}}return X.decodeTextCompaction(c,d,h,a),i}static decodeTextCompaction(n,i,a,c){let d=He.ALPHA,h=He.ALPHA,m=0;for(;m<a;){let p=n[m],y="";switch(d){case He.ALPHA:if(p<26)y=String.fromCharCode(65+p);else switch(p){case 26:y=" ";break;case X.LL:d=He.LOWER;break;case X.ML:d=He.MIXED;break;case X.PS:h=d,d=He.PUNCT_SHIFT;break;case X.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[m]);break;case X.TEXT_COMPACTION_MODE_LATCH:d=He.ALPHA;break}break;case He.LOWER:if(p<26)y=String.fromCharCode(97+p);else switch(p){case 26:y=" ";break;case X.AS:h=d,d=He.ALPHA_SHIFT;break;case X.ML:d=He.MIXED;break;case X.PS:h=d,d=He.PUNCT_SHIFT;break;case X.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[m]);break;case X.TEXT_COMPACTION_MODE_LATCH:d=He.ALPHA;break}break;case He.MIXED:if(p<X.PL)y=X.MIXED_CHARS[p];else switch(p){case X.PL:d=He.PUNCT;break;case 26:y=" ";break;case X.LL:d=He.LOWER;break;case X.AL:d=He.ALPHA;break;case X.PS:h=d,d=He.PUNCT_SHIFT;break;case X.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[m]);break;case X.TEXT_COMPACTION_MODE_LATCH:d=He.ALPHA;break}break;case He.PUNCT:if(p<X.PAL)y=X.PUNCT_CHARS[p];else switch(p){case X.PAL:d=He.ALPHA;break;case X.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[m]);break;case X.TEXT_COMPACTION_MODE_LATCH:d=He.ALPHA;break}break;case He.ALPHA_SHIFT:if(d=h,p<26)y=String.fromCharCode(65+p);else switch(p){case 26:y=" ";break;case X.TEXT_COMPACTION_MODE_LATCH:d=He.ALPHA;break}break;case He.PUNCT_SHIFT:if(d=h,p<X.PAL)y=X.PUNCT_CHARS[p];else switch(p){case X.PAL:d=He.ALPHA;break;case X.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[m]);break;case X.TEXT_COMPACTION_MODE_LATCH:d=He.ALPHA;break}break}y!==""&&c.append(y),m++}}static byteCompaction(n,i,a,c,d){let h=new kp,m=0,p=0,y=!1;switch(n){case X.BYTE_COMPACTION_MODE_LATCH:let b=new Int32Array(6),_=i[c++];for(;c<i[0]&&!y;)switch(b[m++]=_,p=900*p+_,_=i[c++],_){case X.TEXT_COMPACTION_MODE_LATCH:case X.BYTE_COMPACTION_MODE_LATCH:case X.NUMERIC_COMPACTION_MODE_LATCH:case X.BYTE_COMPACTION_MODE_LATCH_6:case X.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case X.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case X.MACRO_PDF417_TERMINATOR:c--,y=!0;break;default:if(m%5===0&&m>0){for(let R=0;R<6;++R)h.write(Number($n(p)>>$n(8*(5-R))));p=0,m=0}break}c===i[0]&&_<X.TEXT_COMPACTION_MODE_LATCH&&(b[m++]=_);for(let R=0;R<m;R++)h.write(b[R]);break;case X.BYTE_COMPACTION_MODE_LATCH_6:for(;c<i[0]&&!y;){let R=i[c++];if(R<X.TEXT_COMPACTION_MODE_LATCH)m++,p=900*p+R;else switch(R){case X.TEXT_COMPACTION_MODE_LATCH:case X.BYTE_COMPACTION_MODE_LATCH:case X.NUMERIC_COMPACTION_MODE_LATCH:case X.BYTE_COMPACTION_MODE_LATCH_6:case X.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case X.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case X.MACRO_PDF417_TERMINATOR:c--,y=!0;break}if(m%5===0&&m>0){for(let L=0;L<6;++L)h.write(Number($n(p)>>$n(8*(5-L))));p=0,m=0}}break}return d.append(be.decode(h.toByteArray(),a)),c}static numericCompaction(n,i,a){let c=0,d=!1,h=new Int32Array(X.MAX_NUMERIC_CODEWORDS);for(;i<n[0]&&!d;){let m=n[i++];if(i===n[0]&&(d=!0),m<X.TEXT_COMPACTION_MODE_LATCH)h[c]=m,c++;else switch(m){case X.TEXT_COMPACTION_MODE_LATCH:case X.BYTE_COMPACTION_MODE_LATCH:case X.BYTE_COMPACTION_MODE_LATCH_6:case X.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case X.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case X.MACRO_PDF417_TERMINATOR:i--,d=!0;break}(c%X.MAX_NUMERIC_CODEWORDS===0||m===X.NUMERIC_COMPACTION_MODE_LATCH||d)&&c>0&&(a.append(X.decodeBase900toBase10(h,c)),c=0)}return i}static decodeBase900toBase10(n,i){let a=$n(0);for(let d=0;d<i;d++)a+=X.EXP900[i-d-1]*$n(n[d]);let c=a.toString();if(c.charAt(0)!=="1")throw new U;return c.substring(1)}}X.TEXT_COMPACTION_MODE_LATCH=900,X.BYTE_COMPACTION_MODE_LATCH=901,X.NUMERIC_COMPACTION_MODE_LATCH=902,X.BYTE_COMPACTION_MODE_LATCH_6=924,X.ECI_USER_DEFINED=925,X.ECI_GENERAL_PURPOSE=926,X.ECI_CHARSET=927,X.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,X.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,X.MACRO_PDF417_TERMINATOR=922,X.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,X.MAX_NUMERIC_CODEWORDS=15,X.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,X.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,X.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,X.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,X.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,X.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,X.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,X.PL=25,X.LL=27,X.AS=27,X.ML=28,X.AL=28,X.PS=29,X.PAL=29,X.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,X.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",X.EXP900=d0()?Mp():[],X.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Ae{constructor(){}static decode(n,i,a,c,d,h,m){let p=new Ss(n,i,a,c,d),y=null,b=null,_;for(let B=!0;;B=!1){if(i!=null&&(y=Ae.getRowIndicatorColumn(n,p,i,!0,h,m)),c!=null&&(b=Ae.getRowIndicatorColumn(n,p,c,!1,h,m)),_=Ae.merge(y,b),_==null)throw Y.getNotFoundInstance();let F=_.getBoundingBox();if(B&&F!=null&&(F.getMinY()<p.getMinY()||F.getMaxY()>p.getMaxY()))p=F;else break}_.setBoundingBox(p);let R=_.getBarcodeColumnCount()+1;_.setDetectionResultColumn(0,y),_.setDetectionResultColumn(R,b);let L=y!=null;for(let B=1;B<=R;B++){let F=L?B:R-B;if(_.getDetectionResultColumn(F)!==void 0)continue;let H;F===0||F===R?H=new o0(p,F===0):H=new aa(p),_.setDetectionResultColumn(F,H);let q=-1,ee=q;for(let re=p.getMinY();re<=p.getMaxY();re++){if(q=Ae.getStartColumn(_,F,re,L),q<0||q>p.getMaxX()){if(ee===-1)continue;q=ee}let Z=Ae.detectCodeword(n,p.getMinX(),p.getMaxX(),L,q,re,h,m);Z!=null&&(H.setCodeword(re,Z),ee=q,h=Math.min(h,Z.getWidth()),m=Math.max(m,Z.getWidth()))}}return Ae.createDecoderResult(_)}static merge(n,i){if(n==null&&i==null)return null;let a=Ae.getBarcodeMetadata(n,i);if(a==null)return null;let c=Ss.merge(Ae.adjustBoundingBox(n),Ae.adjustBoundingBox(i));return new la(a,c)}static adjustBoundingBox(n){if(n==null)return null;let i=n.getRowHeights();if(i==null)return null;let a=Ae.getMax(i),c=0;for(let m of i)if(c+=a-m,m>0)break;let d=n.getCodewords();for(let m=0;c>0&&d[m]==null;m++)c--;let h=0;for(let m=i.length-1;m>=0&&(h+=a-i[m],!(i[m]>0));m--);for(let m=d.length-1;h>0&&d[m]==null;m--)h--;return n.getBoundingBox().addMissingRows(c,h,n.isLeft())}static getMax(n){let i=-1;for(let a of n)i=Math.max(i,a);return i}static getBarcodeMetadata(n,i){let a;if(n==null||(a=n.getBarcodeMetadata())==null)return i==null?null:i.getBarcodeMetadata();let c;return i==null||(c=i.getBarcodeMetadata())==null?a:a.getColumnCount()!==c.getColumnCount()&&a.getErrorCorrectionLevel()!==c.getErrorCorrectionLevel()&&a.getRowCount()!==c.getRowCount()?null:a}static getRowIndicatorColumn(n,i,a,c,d,h){let m=new o0(i,c);for(let p=0;p<2;p++){let y=p===0?1:-1,b=Math.trunc(Math.trunc(a.getX()));for(let _=Math.trunc(Math.trunc(a.getY()));_<=i.getMaxY()&&_>=i.getMinY();_+=y){let R=Ae.detectCodeword(n,0,n.getWidth(),c,b,_,d,h);R!=null&&(m.setCodeword(_,R),c?b=R.getStartX():b=R.getEndX())}}return m}static adjustCodewordCount(n,i){let a=i[0][1],c=a.getValue(),d=n.getBarcodeColumnCount()*n.getBarcodeRowCount()-Ae.getNumberOfECCodeWords(n.getBarcodeECLevel());if(c.length===0){if(d<1||d>ve.MAX_CODEWORDS_IN_BARCODE)throw Y.getNotFoundInstance();a.setValue(d)}else c[0]!==d&&a.setValue(d)}static createDecoderResult(n){let i=Ae.createBarcodeMatrix(n);Ae.adjustCodewordCount(n,i);let a=new Array,c=new Int32Array(n.getBarcodeRowCount()*n.getBarcodeColumnCount()),d=[],h=new Array;for(let p=0;p<n.getBarcodeRowCount();p++)for(let y=0;y<n.getBarcodeColumnCount();y++){let b=i[p][y+1].getValue(),_=p*n.getBarcodeColumnCount()+y;b.length===0?a.push(_):b.length===1?c[_]=b[0]:(h.push(_),d.push(b))}let m=new Array(d.length);for(let p=0;p<m.length;p++)m[p]=d[p];return Ae.createDecoderResultFromAmbiguousValues(n.getBarcodeECLevel(),c,ve.toIntArray(a),ve.toIntArray(h),m)}static createDecoderResultFromAmbiguousValues(n,i,a,c,d){let h=new Int32Array(c.length),m=100;for(;m-- >0;){for(let p=0;p<h.length;p++)i[c[p]]=d[p][h[p]];try{return Ae.decodeCodewords(i,n,a)}catch(p){if(!(p instanceof I))throw p}if(h.length===0)throw I.getChecksumInstance();for(let p=0;p<h.length;p++)if(h[p]<d[p].length-1){h[p]++;break}else if(h[p]=0,p===h.length-1)throw I.getChecksumInstance()}throw I.getChecksumInstance()}static createBarcodeMatrix(n){let i=Array.from({length:n.getBarcodeRowCount()},()=>new Array(n.getBarcodeColumnCount()+2));for(let c=0;c<i.length;c++)for(let d=0;d<i[c].length;d++)i[c][d]=new oa;let a=0;for(let c of n.getDetectionResultColumns()){if(c!=null){for(let d of c.getCodewords())if(d!=null){let h=d.getRowNumber();if(h>=0){if(h>=i.length)continue;i[h][a].setValue(d.getValue())}}}a++}return i}static isValidBarcodeColumn(n,i){return i>=0&&i<=n.getBarcodeColumnCount()+1}static getStartColumn(n,i,a,c){let d=c?1:-1,h=null;if(Ae.isValidBarcodeColumn(n,i-d)&&(h=n.getDetectionResultColumn(i-d).getCodeword(a)),h!=null)return c?h.getEndX():h.getStartX();if(h=n.getDetectionResultColumn(i).getCodewordNearby(a),h!=null)return c?h.getStartX():h.getEndX();if(Ae.isValidBarcodeColumn(n,i-d)&&(h=n.getDetectionResultColumn(i-d).getCodewordNearby(a)),h!=null)return c?h.getEndX():h.getStartX();let m=0;for(;Ae.isValidBarcodeColumn(n,i-d);){i-=d;for(let p of n.getDetectionResultColumn(i).getCodewords())if(p!=null)return(c?p.getEndX():p.getStartX())+d*m*(p.getEndX()-p.getStartX());m++}return c?n.getBoundingBox().getMinX():n.getBoundingBox().getMaxX()}static detectCodeword(n,i,a,c,d,h,m,p){d=Ae.adjustCodewordStartColumn(n,i,a,c,d,h);let y=Ae.getModuleBitCount(n,i,a,c,d,h);if(y==null)return null;let b,_=ke.sum(y);if(c)b=d+_;else{for(let B=0;B<y.length/2;B++){let F=y[B];y[B]=y[y.length-1-B],y[y.length-1-B]=F}b=d,d=b-_}if(!Ae.checkCodewordSkew(_,m,p))return null;let R=ur.getDecodedValue(y),L=ve.getCodeword(R);return L===-1?null:new ca(d,b,Ae.getCodewordBucketNumber(R),L)}static getModuleBitCount(n,i,a,c,d,h){let m=d,p=new Int32Array(8),y=0,b=c?1:-1,_=c;for(;(c?m<a:m>=i)&&y<p.length;)n.get(m,h)===_?(p[y]++,m+=b):(y++,_=!_);return y===p.length||m===(c?a:i)&&y===p.length-1?p:null}static getNumberOfECCodeWords(n){return 2<<n}static adjustCodewordStartColumn(n,i,a,c,d,h){let m=d,p=c?-1:1;for(let y=0;y<2;y++){for(;(c?m>=i:m<a)&&c===n.get(m,h);){if(Math.abs(d-m)>Ae.CODEWORD_SKEW_SIZE)return d;m+=p}p=-p,c=!c}return m}static checkCodewordSkew(n,i,a){return i-Ae.CODEWORD_SKEW_SIZE<=n&&n<=a+Ae.CODEWORD_SKEW_SIZE}static decodeCodewords(n,i,a){if(n.length===0)throw U.getFormatInstance();let c=1<<i+1,d=Ae.correctErrors(n,a,c);Ae.verifyCodewordCount(n,c);let h=X.decode(n,""+i);return h.setErrorsCorrected(d),h.setErasures(a.length),h}static correctErrors(n,i,a){if(i!=null&&i.length>a/2+Ae.MAX_ERRORS||a<0||a>Ae.MAX_EC_CODEWORDS)throw I.getChecksumInstance();return Ae.errorCorrection.decode(n,a,i)}static verifyCodewordCount(n,i){if(n.length<4)throw U.getFormatInstance();let a=n[0];if(a>n.length)throw U.getFormatInstance();if(a===0)if(i<n.length)n[0]=n.length-i;else throw U.getFormatInstance()}static getBitCountForCodeword(n){let i=new Int32Array(8),a=0,c=i.length-1;for(;!((n&1)!==a&&(a=n&1,c--,c<0));)i[c]++,n>>=1;return i}static getCodewordBucketNumber(n){return n instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(n):this.getCodewordBucketNumber_number(n)}static getCodewordBucketNumber_number(n){return Ae.getCodewordBucketNumber(Ae.getBitCountForCodeword(n))}static getCodewordBucketNumber_Int32Array(n){return(n[0]-n[2]+n[4]-n[6]+9)%9}static toString(n){let i=new ia;for(let a=0;a<n.length;a++){i.format("Row %2d: ",a);for(let c=0;c<n[a].length;c++){let d=n[a][c];d.getValue().length===0?i.format("        ",null):i.format("%4d(%2d)",d.getValue()[0],d.getConfidence(d.getValue()[0]))}i.format("%n")}return i.toString()}}Ae.CODEWORD_SKEW_SIZE=2,Ae.MAX_ERRORS=3,Ae.MAX_EC_CODEWORDS=512,Ae.errorCorrection=new a0;class Bt{decode(n,i=null){let a=Bt.decode(n,i,!1);if(a==null||a.length===0||a[0]==null)throw Y.getNotFoundInstance();return a[0]}decodeMultiple(n,i=null){try{return Bt.decode(n,i,!0)}catch(a){throw a instanceof U||a instanceof I?Y.getNotFoundInstance():a}}static decode(n,i,a){const c=new Array,d=Se.detectMultiple(n,i,a);for(const h of d.getPoints()){const m=Ae.decode(d.getBits(),h[4],h[5],h[6],h[7],Bt.getMinCodewordWidth(h),Bt.getMaxCodewordWidth(h)),p=new Ie(m.getText(),m.getRawBytes(),void 0,h,se.PDF_417);p.putMetadata(Ue.ERROR_CORRECTION_LEVEL,m.getECLevel());const y=m.getOther();y!=null&&p.putMetadata(Ue.PDF417_EXTRA_METADATA,y),c.push(p)}return c.map(h=>h)}static getMaxWidth(n,i){return n==null||i==null?0:Math.trunc(Math.abs(n.getX()-i.getX()))}static getMinWidth(n,i){return n==null||i==null?T.MAX_VALUE:Math.trunc(Math.abs(n.getX()-i.getX()))}static getMaxCodewordWidth(n){return Math.floor(Math.max(Math.max(Bt.getMaxWidth(n[0],n[4]),Bt.getMaxWidth(n[6],n[2])*ve.MODULES_IN_CODEWORD/ve.MODULES_IN_STOP_PATTERN),Math.max(Bt.getMaxWidth(n[1],n[5]),Bt.getMaxWidth(n[7],n[3])*ve.MODULES_IN_CODEWORD/ve.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(n){return Math.floor(Math.min(Math.min(Bt.getMinWidth(n[0],n[4]),Bt.getMinWidth(n[6],n[2])*ve.MODULES_IN_CODEWORD/ve.MODULES_IN_STOP_PATTERN),Math.min(Bt.getMinWidth(n[1],n[5]),Bt.getMinWidth(n[7],n[3])*ve.MODULES_IN_CODEWORD/ve.MODULES_IN_STOP_PATTERN)))}reset(){}}class Ao extends x{}Ao.kind="ReaderException";class h0{constructor(n,i){this.verbose=n===!0,i&&this.setHints(i)}decode(n,i){return i&&this.setHints(i),this.decodeInternal(n)}decodeWithState(n){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(n)}setHints(n){this.hints=n;const i=!s(n)&&n.get(z.TRY_HARDER)===!0,a=s(n)?null:n.get(z.POSSIBLE_FORMATS),c=new Array;if(!s(a)){const d=a.some(h=>h===se.UPC_A||h===se.UPC_E||h===se.EAN_13||h===se.EAN_8||h===se.CODABAR||h===se.CODE_39||h===se.CODE_93||h===se.CODE_128||h===se.ITF||h===se.RSS_14||h===se.RSS_EXPANDED);d&&!i&&c.push(new ni(n,this.verbose)),a.includes(se.QR_CODE)&&c.push(new Gn),a.includes(se.DATA_MATRIX)&&c.push(new Wn),a.includes(se.AZTEC)&&c.push(new bo),a.includes(se.PDF_417)&&c.push(new Bt),d&&i&&c.push(new ni(n,this.verbose))}c.length===0&&(i||c.push(new ni(n,this.verbose)),c.push(new Gn),c.push(new Wn),c.push(new bo),c.push(new Bt),i&&c.push(new ni(n,this.verbose))),this.readers=c}reset(){if(this.readers!==null)for(const n of this.readers)n.reset()}decodeInternal(n){if(this.readers===null)throw new Ao("No readers where selected, nothing can be read.");for(const i of this.readers)try{return i.decode(n,this.hints)}catch(a){if(a instanceof Ao)continue}throw new Y("No MultiFormat Readers were able to detect the code.")}}class Dp extends Dt{constructor(n=null,i=500){const a=new h0;a.setHints(n),super(a,i)}decodeBitmap(n){return this.reader.decodeWithState(n)}}class Lp extends Dt{constructor(n=500){super(new Bt,n)}}class Pp extends Dt{constructor(n=500){super(new Gn,n)}}var kc;(function(N){N[N.ERROR_CORRECTION=0]="ERROR_CORRECTION",N[N.CHARACTER_SET=1]="CHARACTER_SET",N[N.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",N[N.MIN_SIZE=3]="MIN_SIZE",N[N.MAX_SIZE=4]="MAX_SIZE",N[N.MARGIN=5]="MARGIN",N[N.PDF417_COMPACT=6]="PDF417_COMPACT",N[N.PDF417_COMPACTION=7]="PDF417_COMPACTION",N[N.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",N[N.AZTEC_LAYERS=9]="AZTEC_LAYERS",N[N.QR_VERSION=10]="QR_VERSION"})(kc||(kc={}));var At=kc;class Mc{constructor(n){this.field=n,this.cachedGenerators=[],this.cachedGenerators.push(new or(n,Int32Array.from([1])))}buildGenerator(n){const i=this.cachedGenerators;if(n>=i.length){let a=i[i.length-1];const c=this.field;for(let d=i.length;d<=n;d++){const h=a.multiply(new or(c,Int32Array.from([1,c.exp(d-1+c.getGeneratorBase())])));i.push(h),a=h}}return i[n]}encode(n,i){if(i===0)throw new E("No error correction bytes");const a=n.length-i;if(a<=0)throw new E("No data bytes provided");const c=this.buildGenerator(i),d=new Int32Array(a);j.arraycopy(n,0,d,0,a);let h=new or(this.field,d);h=h.multiplyByMonomial(i,1);const p=h.divide(c)[1].getCoefficients(),y=i-p.length;for(let b=0;b<y;b++)n[a+b]=0;j.arraycopy(p,0,n,a+y,p.length)}}class gt{constructor(){}static applyMaskPenaltyRule1(n){return gt.applyMaskPenaltyRule1Internal(n,!0)+gt.applyMaskPenaltyRule1Internal(n,!1)}static applyMaskPenaltyRule2(n){let i=0;const a=n.getArray(),c=n.getWidth(),d=n.getHeight();for(let h=0;h<d-1;h++){const m=a[h];for(let p=0;p<c-1;p++){const y=m[p];y===m[p+1]&&y===a[h+1][p]&&y===a[h+1][p+1]&&i++}}return gt.N2*i}static applyMaskPenaltyRule3(n){let i=0;const a=n.getArray(),c=n.getWidth(),d=n.getHeight();for(let h=0;h<d;h++)for(let m=0;m<c;m++){const p=a[h];m+6<c&&p[m]===1&&p[m+1]===0&&p[m+2]===1&&p[m+3]===1&&p[m+4]===1&&p[m+5]===0&&p[m+6]===1&&(gt.isWhiteHorizontal(p,m-4,m)||gt.isWhiteHorizontal(p,m+7,m+11))&&i++,h+6<d&&a[h][m]===1&&a[h+1][m]===0&&a[h+2][m]===1&&a[h+3][m]===1&&a[h+4][m]===1&&a[h+5][m]===0&&a[h+6][m]===1&&(gt.isWhiteVertical(a,m,h-4,h)||gt.isWhiteVertical(a,m,h+7,h+11))&&i++}return i*gt.N3}static isWhiteHorizontal(n,i,a){i=Math.max(i,0),a=Math.min(a,n.length);for(let c=i;c<a;c++)if(n[c]===1)return!1;return!0}static isWhiteVertical(n,i,a,c){a=Math.max(a,0),c=Math.min(c,n.length);for(let d=a;d<c;d++)if(n[d][i]===1)return!1;return!0}static applyMaskPenaltyRule4(n){let i=0;const a=n.getArray(),c=n.getWidth(),d=n.getHeight();for(let p=0;p<d;p++){const y=a[p];for(let b=0;b<c;b++)y[b]===1&&i++}const h=n.getHeight()*n.getWidth();return Math.floor(Math.abs(i*2-h)*10/h)*gt.N4}static getDataMaskBit(n,i,a){let c,d;switch(n){case 0:c=a+i&1;break;case 1:c=a&1;break;case 2:c=i%3;break;case 3:c=(a+i)%3;break;case 4:c=Math.floor(a/2)+Math.floor(i/3)&1;break;case 5:d=a*i,c=(d&1)+d%3;break;case 6:d=a*i,c=(d&1)+d%3&1;break;case 7:d=a*i,c=d%3+(a+i&1)&1;break;default:throw new E("Invalid mask pattern: "+n)}return c===0}static applyMaskPenaltyRule1Internal(n,i){let a=0;const c=i?n.getHeight():n.getWidth(),d=i?n.getWidth():n.getHeight(),h=n.getArray();for(let m=0;m<c;m++){let p=0,y=-1;for(let b=0;b<d;b++){const _=i?h[m][b]:h[b][m];_===y?p++:(p>=5&&(a+=gt.N1+(p-5)),p=1,y=_)}p>=5&&(a+=gt.N1+(p-5))}return a}}gt.N1=3,gt.N2=3,gt.N3=40,gt.N4=10;class Io{constructor(n,i){this.width=n,this.height=i;const a=new Array(i);for(let c=0;c!==i;c++)a[c]=new Uint8Array(n);this.bytes=a}getHeight(){return this.height}getWidth(){return this.width}get(n,i){return this.bytes[i][n]}getArray(){return this.bytes}setNumber(n,i,a){this.bytes[i][n]=a}setBoolean(n,i,a){this.bytes[i][n]=a?1:0}clear(n){for(const i of this.bytes)C.fill(i,n)}equals(n){if(!(n instanceof Io))return!1;const i=n;if(this.width!==i.width||this.height!==i.height)return!1;for(let a=0,c=this.height;a<c;++a){const d=this.bytes[a],h=i.bytes[a];for(let m=0,p=this.width;m<p;++m)if(d[m]!==h[m])return!1}return!0}toString(){const n=new Ne;for(let i=0,a=this.height;i<a;++i){const c=this.bytes[i];for(let d=0,h=this.width;d<h;++d)switch(c[d]){case 0:n.append(" 0");break;case 1:n.append(" 1");break;default:n.append("  ");break}n.append(`
`)}return n.toString()}}class As{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const n=new Ne;return n.append(`<<
`),n.append(" mode: "),n.append(this.mode?this.mode.toString():"null"),n.append(`
 ecLevel: `),n.append(this.ecLevel?this.ecLevel.toString():"null"),n.append(`
 version: `),n.append(this.version?this.version.toString():"null"),n.append(`
 maskPattern: `),n.append(this.maskPattern.toString()),this.matrix?(n.append(`
 matrix:
`),n.append(this.matrix.toString())):n.append(`
 matrix: null
`),n.append(`>>
`),n.toString()}setMode(n){this.mode=n}setECLevel(n){this.ecLevel=n}setVersion(n){this.version=n}setMaskPattern(n){this.maskPattern=n}setMatrix(n){this.matrix=n}static isValidMaskPattern(n){return n>=0&&n<As.NUM_MASK_PATTERNS}}As.NUM_MASK_PATTERNS=8;class $e extends x{}$e.kind="WriterException";class pe{constructor(){}static clearMatrix(n){n.clear(255)}static buildMatrix(n,i,a,c,d){pe.clearMatrix(d),pe.embedBasicPatterns(a,d),pe.embedTypeInfo(i,c,d),pe.maybeEmbedVersionInfo(a,d),pe.embedDataBits(n,c,d)}static embedBasicPatterns(n,i){pe.embedPositionDetectionPatternsAndSeparators(i),pe.embedDarkDotAtLeftBottomCorner(i),pe.maybeEmbedPositionAdjustmentPatterns(n,i),pe.embedTimingPatterns(i)}static embedTypeInfo(n,i,a){const c=new O;pe.makeTypeInfoBits(n,i,c);for(let d=0,h=c.getSize();d<h;++d){const m=c.get(c.getSize()-1-d),p=pe.TYPE_INFO_COORDINATES[d],y=p[0],b=p[1];if(a.setBoolean(y,b,m),d<8){const _=a.getWidth()-d-1;a.setBoolean(_,8,m)}else{const R=a.getHeight()-7+(d-8);a.setBoolean(8,R,m)}}}static maybeEmbedVersionInfo(n,i){if(n.getVersionNumber()<7)return;const a=new O;pe.makeVersionInfoBits(n,a);let c=6*3-1;for(let d=0;d<6;++d)for(let h=0;h<3;++h){const m=a.get(c);c--,i.setBoolean(d,i.getHeight()-11+h,m),i.setBoolean(i.getHeight()-11+h,d,m)}}static embedDataBits(n,i,a){let c=0,d=-1,h=a.getWidth()-1,m=a.getHeight()-1;for(;h>0;){for(h===6&&(h-=1);m>=0&&m<a.getHeight();){for(let p=0;p<2;++p){const y=h-p;if(!pe.isEmpty(a.get(y,m)))continue;let b;c<n.getSize()?(b=n.get(c),++c):b=!1,i!==255&&gt.getDataMaskBit(i,y,m)&&(b=!b),a.setBoolean(y,m,b)}m+=d}d=-d,m+=d,h-=2}if(c!==n.getSize())throw new $e("Not all bits consumed: "+c+"/"+n.getSize())}static findMSBSet(n){return 32-T.numberOfLeadingZeros(n)}static calculateBCHCode(n,i){if(i===0)throw new E("0 polynomial");const a=pe.findMSBSet(i);for(n<<=a-1;pe.findMSBSet(n)>=a;)n^=i<<pe.findMSBSet(n)-a;return n}static makeTypeInfoBits(n,i,a){if(!As.isValidMaskPattern(i))throw new $e("Invalid mask pattern");const c=n.getBits()<<3|i;a.appendBits(c,5);const d=pe.calculateBCHCode(c,pe.TYPE_INFO_POLY);a.appendBits(d,10);const h=new O;if(h.appendBits(pe.TYPE_INFO_MASK_PATTERN,15),a.xor(h),a.getSize()!==15)throw new $e("should not happen but we got: "+a.getSize())}static makeVersionInfoBits(n,i){i.appendBits(n.getVersionNumber(),6);const a=pe.calculateBCHCode(n.getVersionNumber(),pe.VERSION_INFO_POLY);if(i.appendBits(a,12),i.getSize()!==18)throw new $e("should not happen but we got: "+i.getSize())}static isEmpty(n){return n===255}static embedTimingPatterns(n){for(let i=8;i<n.getWidth()-8;++i){const a=(i+1)%2;pe.isEmpty(n.get(i,6))&&n.setNumber(i,6,a),pe.isEmpty(n.get(6,i))&&n.setNumber(6,i,a)}}static embedDarkDotAtLeftBottomCorner(n){if(n.get(8,n.getHeight()-8)===0)throw new $e;n.setNumber(8,n.getHeight()-8,1)}static embedHorizontalSeparationPattern(n,i,a){for(let c=0;c<8;++c){if(!pe.isEmpty(a.get(n+c,i)))throw new $e;a.setNumber(n+c,i,0)}}static embedVerticalSeparationPattern(n,i,a){for(let c=0;c<7;++c){if(!pe.isEmpty(a.get(n,i+c)))throw new $e;a.setNumber(n,i+c,0)}}static embedPositionAdjustmentPattern(n,i,a){for(let c=0;c<5;++c){const d=pe.POSITION_ADJUSTMENT_PATTERN[c];for(let h=0;h<5;++h)a.setNumber(n+h,i+c,d[h])}}static embedPositionDetectionPattern(n,i,a){for(let c=0;c<7;++c){const d=pe.POSITION_DETECTION_PATTERN[c];for(let h=0;h<7;++h)a.setNumber(n+h,i+c,d[h])}}static embedPositionDetectionPatternsAndSeparators(n){const i=pe.POSITION_DETECTION_PATTERN[0].length;pe.embedPositionDetectionPattern(0,0,n),pe.embedPositionDetectionPattern(n.getWidth()-i,0,n),pe.embedPositionDetectionPattern(0,n.getWidth()-i,n);const a=8;pe.embedHorizontalSeparationPattern(0,a-1,n),pe.embedHorizontalSeparationPattern(n.getWidth()-a,a-1,n),pe.embedHorizontalSeparationPattern(0,n.getWidth()-a,n);const c=7;pe.embedVerticalSeparationPattern(c,0,n),pe.embedVerticalSeparationPattern(n.getHeight()-c-1,0,n),pe.embedVerticalSeparationPattern(c,n.getHeight()-c,n)}static maybeEmbedPositionAdjustmentPatterns(n,i){if(n.getVersionNumber()<2)return;const a=n.getVersionNumber()-1,c=pe.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[a];for(let d=0,h=c.length;d!==h;d++){const m=c[d];if(m>=0)for(let p=0;p!==h;p++){const y=c[p];y>=0&&pe.isEmpty(i.get(y,m))&&pe.embedPositionAdjustmentPattern(y-2,m-2,i)}}}}pe.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),pe.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),pe.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),pe.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),pe.VERSION_INFO_POLY=7973,pe.TYPE_INFO_POLY=1335,pe.TYPE_INFO_MASK_PATTERN=21522;class Bp{constructor(n,i){this.dataBytes=n,this.errorCorrectionBytes=i}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class et{constructor(){}static calculateMaskPenalty(n){return gt.applyMaskPenaltyRule1(n)+gt.applyMaskPenaltyRule2(n)+gt.applyMaskPenaltyRule3(n)+gt.applyMaskPenaltyRule4(n)}static encode(n,i,a=null){let c=et.DEFAULT_BYTE_MODE_ENCODING;const d=a!==null&&a.get(At.CHARACTER_SET)!==void 0;d&&(c=a.get(At.CHARACTER_SET).toString());const h=this.chooseMode(n,c),m=new O;if(h===ge.BYTE&&(d||et.DEFAULT_BYTE_MODE_ENCODING!==c)){const re=G.getCharacterSetECIByName(c);re!==void 0&&this.appendECI(re,m)}this.appendModeInfo(h,m);const p=new O;this.appendBytes(n,h,p,c);let y;if(a!==null&&a.get(At.QR_VERSION)!==void 0){const re=Number.parseInt(a.get(At.QR_VERSION).toString(),10);y=me.getVersionForNumber(re);const Z=this.calculateBitsNeeded(h,m,p,y);if(!this.willFit(Z,y,i))throw new $e("Data too big for requested version")}else y=this.recommendVersion(i,h,m,p);const b=new O;b.appendBitArray(m);const _=h===ge.BYTE?p.getSizeInBytes():n.length;this.appendLengthInfo(_,y,h,b),b.appendBitArray(p);const R=y.getECBlocksForLevel(i),L=y.getTotalCodewords()-R.getTotalECCodewords();this.terminateBits(L,b);const B=this.interleaveWithECBytes(b,y.getTotalCodewords(),L,R.getNumBlocks()),F=new As;F.setECLevel(i),F.setMode(h),F.setVersion(y);const H=y.getDimensionForVersion(),q=new Io(H,H),ee=this.chooseMaskPattern(B,i,y,q);return F.setMaskPattern(ee),pe.buildMatrix(B,i,y,ee,q),F.setMatrix(q),F}static recommendVersion(n,i,a,c){const d=this.calculateBitsNeeded(i,a,c,me.getVersionForNumber(1)),h=this.chooseVersion(d,n),m=this.calculateBitsNeeded(i,a,c,h);return this.chooseVersion(m,n)}static calculateBitsNeeded(n,i,a,c){return i.getSize()+n.getCharacterCountBits(c)+a.getSize()}static getAlphanumericCode(n){return n<et.ALPHANUMERIC_TABLE.length?et.ALPHANUMERIC_TABLE[n]:-1}static chooseMode(n,i=null){if(G.SJIS.getName()===i&&this.isOnlyDoubleByteKanji(n))return ge.KANJI;let a=!1,c=!1;for(let d=0,h=n.length;d<h;++d){const m=n.charAt(d);if(et.isDigit(m))a=!0;else if(this.getAlphanumericCode(m.charCodeAt(0))!==-1)c=!0;else return ge.BYTE}return c?ge.ALPHANUMERIC:a?ge.NUMERIC:ge.BYTE}static isOnlyDoubleByteKanji(n){let i;try{i=be.encode(n,G.SJIS)}catch{return!1}const a=i.length;if(a%2!==0)return!1;for(let c=0;c<a;c+=2){const d=i[c]&255;if((d<129||d>159)&&(d<224||d>235))return!1}return!0}static chooseMaskPattern(n,i,a,c){let d=Number.MAX_SAFE_INTEGER,h=-1;for(let m=0;m<As.NUM_MASK_PATTERNS;m++){pe.buildMatrix(n,i,a,m,c);let p=this.calculateMaskPenalty(c);p<d&&(d=p,h=m)}return h}static chooseVersion(n,i){for(let a=1;a<=40;a++){const c=me.getVersionForNumber(a);if(et.willFit(n,c,i))return c}throw new $e("Data too big")}static willFit(n,i,a){const c=i.getTotalCodewords(),h=i.getECBlocksForLevel(a).getTotalECCodewords(),m=c-h,p=(n+7)/8;return m>=p}static terminateBits(n,i){const a=n*8;if(i.getSize()>a)throw new $e("data bits cannot fit in the QR Code"+i.getSize()+" > "+a);for(let h=0;h<4&&i.getSize()<a;++h)i.appendBit(!1);const c=i.getSize()&7;if(c>0)for(let h=c;h<8;h++)i.appendBit(!1);const d=n-i.getSizeInBytes();for(let h=0;h<d;++h)i.appendBits(h&1?17:236,8);if(i.getSize()!==a)throw new $e("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(n,i,a,c,d,h){if(c>=a)throw new $e("Block ID too large");const m=n%a,p=a-m,y=Math.floor(n/a),b=y+1,_=Math.floor(i/a),R=_+1,L=y-_,B=b-R;if(L!==B)throw new $e("EC bytes mismatch");if(a!==p+m)throw new $e("RS blocks mismatch");if(n!==(_+L)*p+(R+B)*m)throw new $e("Total bytes mismatch");c<p?(d[0]=_,h[0]=L):(d[0]=R,h[0]=B)}static interleaveWithECBytes(n,i,a,c){if(n.getSizeInBytes()!==a)throw new $e("Number of bits and data bytes does not match");let d=0,h=0,m=0;const p=new Array;for(let b=0;b<c;++b){const _=new Int32Array(1),R=new Int32Array(1);et.getNumDataBytesAndNumECBytesForBlockID(i,a,c,b,_,R);const L=_[0],B=new Uint8Array(L);n.toBytes(8*d,B,0,L);const F=et.generateECBytes(B,R[0]);p.push(new Bp(B,F)),h=Math.max(h,L),m=Math.max(m,F.length),d+=_[0]}if(a!==d)throw new $e("Data bytes does not match offset");const y=new O;for(let b=0;b<h;++b)for(const _ of p){const R=_.getDataBytes();b<R.length&&y.appendBits(R[b],8)}for(let b=0;b<m;++b)for(const _ of p){const R=_.getErrorCorrectionBytes();b<R.length&&y.appendBits(R[b],8)}if(i!==y.getSizeInBytes())throw new $e("Interleaving error: "+i+" and "+y.getSizeInBytes()+" differ.");return y}static generateECBytes(n,i){const a=n.length,c=new Int32Array(a+i);for(let h=0;h<a;h++)c[h]=n[h]&255;new Mc(Le.QR_CODE_FIELD_256).encode(c,i);const d=new Uint8Array(i);for(let h=0;h<i;h++)d[h]=c[a+h];return d}static appendModeInfo(n,i){i.appendBits(n.getBits(),4)}static appendLengthInfo(n,i,a,c){const d=a.getCharacterCountBits(i);if(n>=1<<d)throw new $e(n+" is bigger than "+((1<<d)-1));c.appendBits(n,d)}static appendBytes(n,i,a,c){switch(i){case ge.NUMERIC:et.appendNumericBytes(n,a);break;case ge.ALPHANUMERIC:et.appendAlphanumericBytes(n,a);break;case ge.BYTE:et.append8BitBytes(n,a,c);break;case ge.KANJI:et.appendKanjiBytes(n,a);break;default:throw new $e("Invalid mode: "+i)}}static getDigit(n){return n.charCodeAt(0)-48}static isDigit(n){const i=et.getDigit(n);return i>=0&&i<=9}static appendNumericBytes(n,i){const a=n.length;let c=0;for(;c<a;){const d=et.getDigit(n.charAt(c));if(c+2<a){const h=et.getDigit(n.charAt(c+1)),m=et.getDigit(n.charAt(c+2));i.appendBits(d*100+h*10+m,10),c+=3}else if(c+1<a){const h=et.getDigit(n.charAt(c+1));i.appendBits(d*10+h,7),c+=2}else i.appendBits(d,4),c++}}static appendAlphanumericBytes(n,i){const a=n.length;let c=0;for(;c<a;){const d=et.getAlphanumericCode(n.charCodeAt(c));if(d===-1)throw new $e;if(c+1<a){const h=et.getAlphanumericCode(n.charCodeAt(c+1));if(h===-1)throw new $e;i.appendBits(d*45+h,11),c+=2}else i.appendBits(d,6),c++}}static append8BitBytes(n,i,a){let c;try{c=be.encode(n,a)}catch(d){throw new $e(d)}for(let d=0,h=c.length;d!==h;d++){const m=c[d];i.appendBits(m,8)}}static appendKanjiBytes(n,i){let a;try{a=be.encode(n,G.SJIS)}catch(d){throw new $e(d)}const c=a.length;for(let d=0;d<c;d+=2){const h=a[d]&255,m=a[d+1]&255,p=h<<8&4294967295|m;let y=-1;if(p>=33088&&p<=40956?y=p-33088:p>=57408&&p<=60351&&(y=p-49472),y===-1)throw new $e("Invalid byte sequence");const b=(y>>8)*192+(y&255);i.appendBits(b,13)}}static appendECI(n,i){i.appendBits(ge.ECI.getBits(),4),i.appendBits(n.getValue(),8)}}et.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),et.DEFAULT_BYTE_MODE_ENCODING=G.UTF8.getName();class Is{write(n,i,a,c=null){if(n.length===0)throw new E("Found empty contents");if(i<0||a<0)throw new E("Requested dimensions are too small: "+i+"x"+a);let d=Qe.L,h=Is.QUIET_ZONE_SIZE;c!==null&&(c.get(At.ERROR_CORRECTION)!==void 0&&(d=Qe.fromString(c.get(At.ERROR_CORRECTION).toString())),c.get(At.MARGIN)!==void 0&&(h=Number.parseInt(c.get(At.MARGIN).toString(),10)));const m=et.encode(n,d,c);return this.renderResult(m,i,a,h)}writeToDom(n,i,a,c,d=null){typeof n=="string"&&(n=document.querySelector(n));const h=this.write(i,a,c,d);n&&n.appendChild(h)}renderResult(n,i,a,c){const d=n.getMatrix();if(d===null)throw new dn;const h=d.getWidth(),m=d.getHeight(),p=h+c*2,y=m+c*2,b=Math.max(i,p),_=Math.max(a,y),R=Math.min(Math.floor(b/p),Math.floor(_/y)),L=Math.floor((b-h*R)/2),B=Math.floor((_-m*R)/2),F=this.createSVGElement(b,_);for(let H=0,q=B;H<m;H++,q+=R)for(let ee=0,re=L;ee<h;ee++,re+=R)if(d.get(ee,H)===1){const Z=this.createSvgRectElement(re,q,R,R);F.appendChild(Z)}return F}createSVGElement(n,i){const a=document.createElementNS(Is.SVG_NS,"svg");return a.setAttributeNS(null,"height",n.toString()),a.setAttributeNS(null,"width",i.toString()),a}createSvgRectElement(n,i,a,c){const d=document.createElementNS(Is.SVG_NS,"rect");return d.setAttributeNS(null,"x",n.toString()),d.setAttributeNS(null,"y",i.toString()),d.setAttributeNS(null,"height",a.toString()),d.setAttributeNS(null,"width",c.toString()),d.setAttributeNS(null,"fill","#000000"),d}}Is.QUIET_ZONE_SIZE=4,Is.SVG_NS="http://www.w3.org/2000/svg";class ii{encode(n,i,a,c,d){if(n.length===0)throw new E("Found empty contents");if(i!==se.QR_CODE)throw new E("Can only encode QR_CODE, but got "+i);if(a<0||c<0)throw new E(`Requested dimensions are too small: ${a}x${c}`);let h=Qe.L,m=ii.QUIET_ZONE_SIZE;d!==null&&(d.get(At.ERROR_CORRECTION)!==void 0&&(h=Qe.fromString(d.get(At.ERROR_CORRECTION).toString())),d.get(At.MARGIN)!==void 0&&(m=Number.parseInt(d.get(At.MARGIN).toString(),10)));const p=et.encode(n,h,d);return ii.renderResult(p,a,c,m)}static renderResult(n,i,a,c){const d=n.getMatrix();if(d===null)throw new dn;const h=d.getWidth(),m=d.getHeight(),p=h+c*2,y=m+c*2,b=Math.max(i,p),_=Math.max(a,y),R=Math.min(Math.floor(b/p),Math.floor(_/y)),L=Math.floor((b-h*R)/2),B=Math.floor((_-m*R)/2),F=new We(b,_);for(let H=0,q=B;H<m;H++,q+=R)for(let ee=0,re=L;ee<h;ee++,re+=R)d.get(ee,H)===1&&F.setRegion(re,q,R,R);return F}}ii.QUIET_ZONE_SIZE=4;class Fp{encode(n,i,a,c,d){let h;switch(i){case se.QR_CODE:h=new ii;break;default:throw new E("No encoder available for format "+i)}return h.encode(n,i,a,c,d)}}class gn extends ie{constructor(n,i,a,c,d,h,m,p){if(super(h,m),this.yuvData=n,this.dataWidth=i,this.dataHeight=a,this.left=c,this.top=d,c+h>i||d+m>a)throw new E("Crop rectangle does not fit within image data.");p&&this.reverseHorizontal(h,m)}getRow(n,i){if(n<0||n>=this.getHeight())throw new E("Requested row is outside the image: "+n);const a=this.getWidth();(i==null||i.length<a)&&(i=new Uint8ClampedArray(a));const c=(n+this.top)*this.dataWidth+this.left;return j.arraycopy(this.yuvData,c,i,0,a),i}getMatrix(){const n=this.getWidth(),i=this.getHeight();if(n===this.dataWidth&&i===this.dataHeight)return this.yuvData;const a=n*i,c=new Uint8ClampedArray(a);let d=this.top*this.dataWidth+this.left;if(n===this.dataWidth)return j.arraycopy(this.yuvData,d,c,0,a),c;for(let h=0;h<i;h++){const m=h*n;j.arraycopy(this.yuvData,d,c,m,n),d+=this.dataWidth}return c}isCropSupported(){return!0}crop(n,i,a,c){return new gn(this.yuvData,this.dataWidth,this.dataHeight,this.left+n,this.top+i,a,c,!1)}renderThumbnail(){const n=this.getWidth()/gn.THUMBNAIL_SCALE_FACTOR,i=this.getHeight()/gn.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(n*i),c=this.yuvData;let d=this.top*this.dataWidth+this.left;for(let h=0;h<i;h++){const m=h*n;for(let p=0;p<n;p++){const y=c[d+p*gn.THUMBNAIL_SCALE_FACTOR]&255;a[m+p]=4278190080|y*65793}d+=this.dataWidth*gn.THUMBNAIL_SCALE_FACTOR}return a}getThumbnailWidth(){return this.getWidth()/gn.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/gn.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(n,i){const a=this.yuvData;for(let c=0,d=this.top*this.dataWidth+this.left;c<i;c++,d+=this.dataWidth){const h=d+n/2;for(let m=d,p=d+n-1;m<h;m++,p--){const y=a[m];a[m]=a[p],a[p]=y}}}invert(){return new xe(this)}}gn.THUMBNAIL_SCALE_FACTOR=2;class Dc extends ie{constructor(n,i,a,c,d,h,m){if(super(i,a),this.dataWidth=c,this.dataHeight=d,this.left=h,this.top=m,n.BYTES_PER_ELEMENT===4){const p=i*a,y=new Uint8ClampedArray(p);for(let b=0;b<p;b++){const _=n[b],R=_>>16&255,L=_>>7&510,B=_&255;y[b]=(R+L+B)/4&255}this.luminances=y}else this.luminances=n;if(c===void 0&&(this.dataWidth=i),d===void 0&&(this.dataHeight=a),h===void 0&&(this.left=0),m===void 0&&(this.top=0),this.left+i>this.dataWidth||this.top+a>this.dataHeight)throw new E("Crop rectangle does not fit within image data.")}getRow(n,i){if(n<0||n>=this.getHeight())throw new E("Requested row is outside the image: "+n);const a=this.getWidth();(i==null||i.length<a)&&(i=new Uint8ClampedArray(a));const c=(n+this.top)*this.dataWidth+this.left;return j.arraycopy(this.luminances,c,i,0,a),i}getMatrix(){const n=this.getWidth(),i=this.getHeight();if(n===this.dataWidth&&i===this.dataHeight)return this.luminances;const a=n*i,c=new Uint8ClampedArray(a);let d=this.top*this.dataWidth+this.left;if(n===this.dataWidth)return j.arraycopy(this.luminances,d,c,0,a),c;for(let h=0;h<i;h++){const m=h*n;j.arraycopy(this.luminances,d,c,m,n),d+=this.dataWidth}return c}isCropSupported(){return!0}crop(n,i,a,c){return new Dc(this.luminances,a,c,this.dataWidth,this.dataHeight,this.left+n,this.top+i)}invert(){return new xe(this)}}class f0 extends G{static forName(n){return this.getCharacterSetECIByName(n)}}class Lc{}Lc.ISO_8859_1=G.ISO8859_1;class m0{isCompact(){return this.compact}setCompact(n){this.compact=n}getSize(){return this.size}setSize(n){this.size=n}getLayers(){return this.layers}setLayers(n){this.layers=n}getCodeWords(){return this.codeWords}setCodeWords(n){this.codeWords=n}getMatrix(){return this.matrix}setMatrix(n){this.matrix=n}}class g0{static singletonList(n){return[n]}static min(n,i){return n.sort(i)[0]}}class Up{constructor(n){this.previous=n}getPrevious(){return this.previous}}class ai extends Up{constructor(n,i,a){super(n),this.value=i,this.bitCount=a}appendTo(n,i){n.appendBits(this.value,this.bitCount)}add(n,i){return new ai(this,n,i)}addBinaryShift(n,i){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new ai(this,n,i)}toString(){let n=this.value&(1<<this.bitCount)-1;return n|=1<<this.bitCount,"<"+T.toBinaryString(n|1<<this.bitCount).substring(1)+">"}}class Pc extends ai{constructor(n,i,a){super(n,0,0),this.binaryShiftStart=i,this.binaryShiftByteCount=a}appendTo(n,i){for(let a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(n.appendBits(31,5),this.binaryShiftByteCount>62?n.appendBits(this.binaryShiftByteCount-31,16):a===0?n.appendBits(Math.min(this.binaryShiftByteCount,31),5):n.appendBits(this.binaryShiftByteCount-31,5)),n.appendBits(i[this.binaryShiftStart+a],8)}addBinaryShift(n,i){return new Pc(this,n,i)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function zp(N,n,i){return new Pc(N,n,i)}function ua(N,n,i){return new ai(N,n,i)}const Vp=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Xn=0,To=1,Br=2,x0=3,xn=4,Hp=new ai(null,0,0),Bc=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Wp(N){for(let n of N)C.fill(n,-1);return N[Xn][xn]=0,N[To][xn]=0,N[To][Xn]=28,N[x0][xn]=0,N[Br][xn]=0,N[Br][Xn]=15,N}const p0=Wp(C.createInt32Array(6,6));class pn{constructor(n,i,a,c){this.token=n,this.mode=i,this.binaryShiftByteCount=a,this.bitCount=c}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(n,i){let a=this.bitCount,c=this.token;if(n!==this.mode){let h=Bc[this.mode][n];c=ua(c,h&65535,h>>16),a+=h>>16}let d=n===Br?4:5;return c=ua(c,i,d),new pn(c,n,0,a+d)}shiftAndAppend(n,i){let a=this.token,c=this.mode===Br?4:5;return a=ua(a,p0[this.mode][n],c),a=ua(a,i,5),new pn(a,this.mode,0,this.bitCount+c+5)}addBinaryShiftChar(n){let i=this.token,a=this.mode,c=this.bitCount;if(this.mode===xn||this.mode===Br){let m=Bc[a][Xn];i=ua(i,m&65535,m>>16),c+=m>>16,a=Xn}let d=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,h=new pn(i,a,this.binaryShiftByteCount+1,c+d);return h.binaryShiftByteCount===2078&&(h=h.endBinaryShift(n+1)),h}endBinaryShift(n){if(this.binaryShiftByteCount===0)return this;let i=this.token;return i=zp(i,n-this.binaryShiftByteCount,this.binaryShiftByteCount),new pn(i,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(n){let i=this.bitCount+(Bc[this.mode][n.mode]>>16);return this.binaryShiftByteCount<n.binaryShiftByteCount?i+=pn.calculateBinaryShiftCost(n)-pn.calculateBinaryShiftCost(this):this.binaryShiftByteCount>n.binaryShiftByteCount&&n.binaryShiftByteCount>0&&(i+=10),i<=n.bitCount}toBitArray(n){let i=[];for(let c=this.endBinaryShift(n.length).token;c!==null;c=c.getPrevious())i.unshift(c);let a=new O;for(const c of i)c.appendTo(a,n);return a}toString(){return ue.format("%s bits=%d bytes=%d",Vp[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(n){return n.binaryShiftByteCount>62?21:n.binaryShiftByteCount>31?20:n.binaryShiftByteCount>0?10:0}}pn.INITIAL_STATE=new pn(Hp,Xn,0,0);function Gp(N){const n=ue.getCharCode(" "),i=ue.getCharCode("."),a=ue.getCharCode(",");N[Xn][n]=1;const c=ue.getCharCode("Z"),d=ue.getCharCode("A");for(let R=d;R<=c;R++)N[Xn][R]=R-d+2;N[To][n]=1;const h=ue.getCharCode("z"),m=ue.getCharCode("a");for(let R=m;R<=h;R++)N[To][R]=R-m+2;N[Br][n]=1;const p=ue.getCharCode("9"),y=ue.getCharCode("0");for(let R=y;R<=p;R++)N[Br][R]=R-y+2;N[Br][a]=12,N[Br][i]=13;const b=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let R=0;R<b.length;R++)N[x0][ue.getCharCode(b[R])]=R;const _=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let R=0;R<_.length;R++)ue.getCharCode(_[R])>0&&(N[xn][ue.getCharCode(_[R])]=R);return N}const Fc=Gp(C.createInt32Array(5,256));class da{constructor(n){this.text=n}encode(){const n=ue.getCharCode(" "),i=ue.getCharCode(`
`);let a=g0.singletonList(pn.INITIAL_STATE);for(let d=0;d<this.text.length;d++){let h,m=d+1<this.text.length?this.text[d+1]:0;switch(this.text[d]){case ue.getCharCode("\r"):h=m===i?2:0;break;case ue.getCharCode("."):h=m===n?3:0;break;case ue.getCharCode(","):h=m===n?4:0;break;case ue.getCharCode(":"):h=m===n?5:0;break;default:h=0}h>0?(a=da.updateStateListForPair(a,d,h),d++):a=this.updateStateListForChar(a,d)}return g0.min(a,(d,h)=>d.getBitCount()-h.getBitCount()).toBitArray(this.text)}updateStateListForChar(n,i){const a=[];for(let c of n)this.updateStateForChar(c,i,a);return da.simplifyStates(a)}updateStateForChar(n,i,a){let c=this.text[i]&255,d=Fc[n.getMode()][c]>0,h=null;for(let m=0;m<=xn;m++){let p=Fc[m][c];if(p>0){if(h==null&&(h=n.endBinaryShift(i)),!d||m===n.getMode()||m===Br){const y=h.latchAndAppend(m,p);a.push(y)}if(!d&&p0[n.getMode()][m]>=0){const y=h.shiftAndAppend(m,p);a.push(y)}}}if(n.getBinaryShiftByteCount()>0||Fc[n.getMode()][c]===0){let m=n.addBinaryShiftChar(i);a.push(m)}}static updateStateListForPair(n,i,a){const c=[];for(let d of n)this.updateStateForPair(d,i,a,c);return this.simplifyStates(c)}static updateStateForPair(n,i,a,c){let d=n.endBinaryShift(i);if(c.push(d.latchAndAppend(xn,a)),n.getMode()!==xn&&c.push(d.shiftAndAppend(xn,a)),a===3||a===4){let h=d.latchAndAppend(Br,16-a).latchAndAppend(Br,1);c.push(h)}if(n.getBinaryShiftByteCount()>0){let h=n.addBinaryShiftChar(i).addBinaryShiftChar(i+1);c.push(h)}}static simplifyStates(n){let i=[];for(const a of n){let c=!0;for(const d of i){if(d.isBetterThanOrEqualTo(a)){c=!1;break}a.isBetterThanOrEqualTo(d)&&(i=i.filter(h=>h!==d))}c&&i.push(a)}return i}}class Me{constructor(){}static encodeBytes(n){return Me.encode(n,Me.DEFAULT_EC_PERCENT,Me.DEFAULT_AZTEC_LAYERS)}static encode(n,i,a){let c=new da(n).encode(),d=T.truncDivision(c.getSize()*i,100)+11,h=c.getSize()+d,m,p,y,b,_;if(a!==Me.DEFAULT_AZTEC_LAYERS){if(m=a<0,p=Math.abs(a),p>(m?Me.MAX_NB_BITS_COMPACT:Me.MAX_NB_BITS))throw new E(ue.format("Illegal value %s for layers",a));y=Me.totalBitsInLayer(p,m),b=Me.WORD_SIZE[p];let Z=y-y%b;if(_=Me.stuffBits(c,b),_.getSize()+d>Z)throw new E("Data to large for user specified layer");if(m&&_.getSize()>b*64)throw new E("Data to large for user specified layer")}else{b=0,_=null;for(let Z=0;;Z++){if(Z>Me.MAX_NB_BITS)throw new E("Data too large for an Aztec code");if(m=Z<=3,p=m?Z+1:Z,y=Me.totalBitsInLayer(p,m),h>y)continue;(_==null||b!==Me.WORD_SIZE[p])&&(b=Me.WORD_SIZE[p],_=Me.stuffBits(c,b));let Re=y-y%b;if(!(m&&_.getSize()>b*64)&&_.getSize()+d<=Re)break}}let R=Me.generateCheckWords(_,y,b),L=_.getSize()/b,B=Me.generateModeMessage(m,p,L),F=(m?11:14)+p*4,H=new Int32Array(F),q;if(m){q=F;for(let Z=0;Z<H.length;Z++)H[Z]=Z}else{q=F+1+2*T.truncDivision(T.truncDivision(F,2)-1,15);let Z=T.truncDivision(F,2),Re=T.truncDivision(q,2);for(let _e=0;_e<Z;_e++){let dr=_e+T.truncDivision(_e,15);H[Z-_e-1]=Re-dr-1,H[Z+_e]=Re+dr+1}}let ee=new We(q);for(let Z=0,Re=0;Z<p;Z++){let _e=(p-Z)*4+(m?9:12);for(let dr=0;dr<_e;dr++){let Yr=dr*2;for(let hr=0;hr<2;hr++)R.get(Re+Yr+hr)&&ee.set(H[Z*2+hr],H[Z*2+dr]),R.get(Re+_e*2+Yr+hr)&&ee.set(H[Z*2+dr],H[F-1-Z*2-hr]),R.get(Re+_e*4+Yr+hr)&&ee.set(H[F-1-Z*2-hr],H[F-1-Z*2-dr]),R.get(Re+_e*6+Yr+hr)&&ee.set(H[F-1-Z*2-dr],H[Z*2+hr])}Re+=_e*8}if(Me.drawModeMessage(ee,m,q,B),m)Me.drawBullsEye(ee,T.truncDivision(q,2),5);else{Me.drawBullsEye(ee,T.truncDivision(q,2),7);for(let Z=0,Re=0;Z<T.truncDivision(F,2)-1;Z+=15,Re+=16)for(let _e=T.truncDivision(q,2)&1;_e<q;_e+=2)ee.set(T.truncDivision(q,2)-Re,_e),ee.set(T.truncDivision(q,2)+Re,_e),ee.set(_e,T.truncDivision(q,2)-Re),ee.set(_e,T.truncDivision(q,2)+Re)}let re=new m0;return re.setCompact(m),re.setSize(q),re.setLayers(p),re.setCodeWords(L),re.setMatrix(ee),re}static drawBullsEye(n,i,a){for(let c=0;c<a;c+=2)for(let d=i-c;d<=i+c;d++)n.set(d,i-c),n.set(d,i+c),n.set(i-c,d),n.set(i+c,d);n.set(i-a,i-a),n.set(i-a+1,i-a),n.set(i-a,i-a+1),n.set(i+a,i-a),n.set(i+a,i-a+1),n.set(i+a,i+a-1)}static generateModeMessage(n,i,a){let c=new O;return n?(c.appendBits(i-1,2),c.appendBits(a-1,6),c=Me.generateCheckWords(c,28,4)):(c.appendBits(i-1,5),c.appendBits(a-1,11),c=Me.generateCheckWords(c,40,4)),c}static drawModeMessage(n,i,a,c){let d=T.truncDivision(a,2);if(i)for(let h=0;h<7;h++){let m=d-3+h;c.get(h)&&n.set(m,d-5),c.get(h+7)&&n.set(d+5,m),c.get(20-h)&&n.set(m,d+5),c.get(27-h)&&n.set(d-5,m)}else for(let h=0;h<10;h++){let m=d-5+h+T.truncDivision(h,5);c.get(h)&&n.set(m,d-7),c.get(h+10)&&n.set(d+7,m),c.get(29-h)&&n.set(m,d+7),c.get(39-h)&&n.set(d-7,m)}}static generateCheckWords(n,i,a){let c=n.getSize()/a,d=new Mc(Me.getGF(a)),h=T.truncDivision(i,a),m=Me.bitsToWords(n,a,h);d.encode(m,h-c);let p=i%a,y=new O;y.appendBits(0,p);for(const b of Array.from(m))y.appendBits(b,a);return y}static bitsToWords(n,i,a){let c=new Int32Array(a),d,h;for(d=0,h=n.getSize()/i;d<h;d++){let m=0;for(let p=0;p<i;p++)m|=n.get(d*i+p)?1<<i-p-1:0;c[d]=m}return c}static getGF(n){switch(n){case 4:return Le.AZTEC_PARAM;case 6:return Le.AZTEC_DATA_6;case 8:return Le.AZTEC_DATA_8;case 10:return Le.AZTEC_DATA_10;case 12:return Le.AZTEC_DATA_12;default:throw new E("Unsupported word size "+n)}}static stuffBits(n,i){let a=new O,c=n.getSize(),d=(1<<i)-2;for(let h=0;h<c;h+=i){let m=0;for(let p=0;p<i;p++)(h+p>=c||n.get(h+p))&&(m|=1<<i-1-p);(m&d)===d?(a.appendBits(m&d,i),h--):m&d?a.appendBits(m,i):(a.appendBits(m|1,i),h--)}return a}static totalBitsInLayer(n,i){return((i?88:112)+16*n)*n}}Me.DEFAULT_EC_PERCENT=33,Me.DEFAULT_AZTEC_LAYERS=0,Me.MAX_NB_BITS=32,Me.MAX_NB_BITS_COMPACT=4,Me.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class jo{encode(n,i,a,c){return this.encodeWithHints(n,i,a,c,null)}encodeWithHints(n,i,a,c,d){let h=Lc.ISO_8859_1,m=Me.DEFAULT_EC_PERCENT,p=Me.DEFAULT_AZTEC_LAYERS;return d!=null&&(d.has(At.CHARACTER_SET)&&(h=f0.forName(d.get(At.CHARACTER_SET).toString())),d.has(At.ERROR_CORRECTION)&&(m=T.parseInt(d.get(At.ERROR_CORRECTION).toString())),d.has(At.AZTEC_LAYERS)&&(p=T.parseInt(d.get(At.AZTEC_LAYERS).toString()))),jo.encodeLayers(n,i,a,c,h,m,p)}static encodeLayers(n,i,a,c,d,h,m){if(i!==se.AZTEC)throw new E("Can only encode AZTEC, but got "+i);let p=Me.encode(ue.getBytes(n,d),h,m);return jo.renderResult(p,a,c)}static renderResult(n,i,a){let c=n.getMatrix();if(c==null)throw new dn;let d=c.getWidth(),h=c.getHeight(),m=Math.max(i,d),p=Math.max(a,h),y=Math.min(m/d,p/h),b=(m-d*y)/2,_=(p-h*y)/2,R=new We(m,p);for(let L=0,B=_;L<h;L++,B+=y)for(let F=0,H=b;F<d;F++,H+=y)c.get(F,L)&&R.setRegion(H,B,y,y);return R}}r.AbstractExpandedDecoder=Nc,r.ArgumentException=v,r.ArithmeticException=wo,r.AztecCode=m0,r.AztecCodeReader=bo,r.AztecCodeWriter=jo,r.AztecDecoder=Ke,r.AztecDetector=e0,r.AztecDetectorResult=Zh,r.AztecEncoder=Me,r.AztecHighLevelEncoder=da,r.AztecPoint=Zt,r.BarcodeFormat=se,r.Binarizer=k,r.BinaryBitmap=S,r.BitArray=O,r.BitMatrix=We,r.BitSource=Ic,r.BrowserAztecCodeReader=pp,r.BrowserBarcodeReader=Ep,r.BrowserCodeReader=Dt,r.BrowserDatamatrixCodeReader=Np,r.BrowserMultiFormatReader=Dp,r.BrowserPDF417Reader=Lp,r.BrowserQRCodeReader=Pp,r.BrowserQRCodeSvgWriter=Is,r.CharacterSetECI=G,r.ChecksumException=I,r.Code128Reader=ne,r.Code39Reader=_t,r.DataMatrixDecodedBitStreamParser=Hn,r.DataMatrixReader=Wn,r.DecodeHintType=z,r.DecoderResult=Gr,r.DefaultGridSampler=Jh,r.DetectorResult=vo,r.EAN13Reader=Cs,r.EncodeHintType=At,r.Exception=x,r.FormatException=U,r.GenericGF=Le,r.GenericGFPoly=or,r.GlobalHistogramBinarizer=Ye,r.GridSampler=vc,r.GridSamplerInstance=zn,r.HTMLCanvasElementLuminanceSource=ye,r.HybridBinarizer=Ee,r.ITFReader=Ge,r.IllegalArgumentException=E,r.IllegalStateException=dn,r.InvertedLuminanceSource=xe,r.LuminanceSource=ie,r.MathUtils=ke,r.MultiFormatOneDReader=ni,r.MultiFormatReader=h0,r.MultiFormatWriter=Fp,r.NotFoundException=Y,r.OneDReader=Et,r.PDF417DecodedBitStreamParser=X,r.PDF417DecoderErrorCorrection=a0,r.PDF417Reader=Bt,r.PDF417ResultMetadata=l0,r.PerspectiveTransform=$r,r.PlanarYUVLuminanceSource=gn,r.QRCodeByteMatrix=Io,r.QRCodeDataMask=Lr,r.QRCodeDecodedBitStreamParser=lt,r.QRCodeDecoderErrorCorrectionLevel=Qe,r.QRCodeDecoderFormatInformation=Gt,r.QRCodeEncoder=et,r.QRCodeEncoderQRCode=As,r.QRCodeMaskUtil=gt,r.QRCodeMatrixUtil=pe,r.QRCodeMode=ge,r.QRCodeReader=Gn,r.QRCodeVersion=me,r.QRCodeWriter=ii,r.RGBLuminanceSource=Dc,r.RSS14Reader=mt,r.RSSExpandedReader=K,r.ReaderException=Ao,r.ReedSolomonDecoder=ra,r.ReedSolomonEncoder=Mc,r.ReedSolomonException=Js,r.Result=Ie,r.ResultMetadataType=Ue,r.ResultPoint=de,r.StringUtils=ue,r.UnsupportedOperationException=te,r.VideoInputDevice=qe,r.WhiteRectangleDetector=_n,r.WriterException=$e,r.ZXingArrays=C,r.ZXingCharset=f0,r.ZXingInteger=T,r.ZXingStandardCharsets=Lc,r.ZXingStringBuilder=Ne,r.ZXingStringEncoding=be,r.ZXingSystem=j,r.createAbstractExpandedDecoder=s0,Object.defineProperty(r,"__esModule",{value:!0})})})(kd,kd.exports);var rt=kd.exports;const x3=Yp(rt),p3=N1({__proto__:null,default:x3},[rt]);var d1=function(){function t(e,r,s){if(this.formatMap=new Map([[le.QR_CODE,rt.BarcodeFormat.QR_CODE],[le.AZTEC,rt.BarcodeFormat.AZTEC],[le.CODABAR,rt.BarcodeFormat.CODABAR],[le.CODE_39,rt.BarcodeFormat.CODE_39],[le.CODE_93,rt.BarcodeFormat.CODE_93],[le.CODE_128,rt.BarcodeFormat.CODE_128],[le.DATA_MATRIX,rt.BarcodeFormat.DATA_MATRIX],[le.MAXICODE,rt.BarcodeFormat.MAXICODE],[le.ITF,rt.BarcodeFormat.ITF],[le.EAN_13,rt.BarcodeFormat.EAN_13],[le.EAN_8,rt.BarcodeFormat.EAN_8],[le.PDF_417,rt.BarcodeFormat.PDF_417],[le.RSS_14,rt.BarcodeFormat.RSS_14],[le.RSS_EXPANDED,rt.BarcodeFormat.RSS_EXPANDED],[le.UPC_A,rt.BarcodeFormat.UPC_A],[le.UPC_E,rt.BarcodeFormat.UPC_E],[le.UPC_EAN_EXTENSION,rt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!p3)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=r,this.logger=s;var o=this.createZXingFormats(e),l=new Map;l.set(rt.DecodeHintType.POSSIBLE_FORMATS,o),l.set(rt.DecodeHintType.TRY_HARDER,!1),this.hints=l}return t.prototype.decodeAsync=function(e){var r=this;return new Promise(function(s,o){try{s(r.decode(e))}catch(l){o(l)}})},t.prototype.decode=function(e){var r=new rt.MultiFormatReader(this.verbose,this.hints),s=new rt.HTMLCanvasElementLuminanceSource(e),o=new rt.BinaryBitmap(new rt.HybridBinarizer(s)),l=r.decode(o);return{text:l.text,format:np.create(this.toHtml5QrcodeSupportedFormats(l.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(r,s,o){e.set(r,s)}),e},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createZXingFormats=function(e){for(var r=[],s=0,o=e;s<o.length;s++){var l=o[s];this.formatMap.has(l)?r.push(this.formatMap.get(l)):this.logger.logError("".concat(l," is not supported by")+"ZXingHtml5QrcodeShim")}return r},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),w3=function(t,e,r,s){function o(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function g(v){try{x(s.next(v))}catch(E){f(E)}}function w(v){try{x(s.throw(v))}catch(E){f(E)}}function x(v){v.done?l(v.value):o(v.value).then(g,w)}x((s=s.apply(t,e||[])).next())})},y3=function(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,o,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(x){return function(v){return w([x,v])}}function w(x){if(s)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(r=0)),r;)try{if(s=1,o&&(l=x[0]&2?o.return:x[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,x[1])).done)return l;switch(o=0,l&&(x=[x[0]&2,l.value]),x[0]){case 0:case 1:l=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,o=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!l||x[1]>l[0]&&x[1]<l[3])){r.label=x[1];break}if(x[0]===6&&r.label<l[1]){r.label=l[1],l=x;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(x);break}l[2]&&r.ops.pop(),r.trys.pop();continue}x=e.call(t,r)}catch(v){x=[6,v],o=0}finally{s=l=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},h1=function(){function t(e,r,s){if(this.formatMap=new Map([[le.QR_CODE,"qr_code"],[le.AZTEC,"aztec"],[le.CODABAR,"codabar"],[le.CODE_39,"code_39"],[le.CODE_93,"code_93"],[le.CODE_128,"code_128"],[le.DATA_MATRIX,"data_matrix"],[le.ITF,"itf"],[le.EAN_13,"ean_13"],[le.EAN_8,"ean_8"],[le.PDF_417,"pdf417"],[le.UPC_A,"upc_a"],[le.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=r,this.logger=s;var o=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(o),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},t.prototype.decodeAsync=function(e){return w3(this,void 0,void 0,function(){var r,s;return y3(this,function(o){switch(o.label){case 0:return[4,this.detector.detect(e)];case 1:if(r=o.sent(),!r||r.length===0)throw"No barcode or QR code detected.";return s=this.selectLargestBarcode(r),[2,{text:s.rawValue,format:np.create(this.toHtml5QrcodeSupportedFormats(s.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(e){for(var r=null,s=0,o=0,l=e;o<l.length;o++){var f=l[o],g=f.boundingBox.width*f.boundingBox.height;g>s&&(s=g,r=f)}if(!r)throw"No largest barcode found";return r},t.prototype.createBarcodeDetectorFormats=function(e){for(var r=[],s=0,o=e;s<o.length;s++){var l=o[s];this.formatMap.has(l)?r.push(this.formatMap.get(l)):this.logger.warn("".concat(l," is not supported by")+"BarcodeDetectorDelegate")}return{formats:r}},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(r,s,o){e.set(r,s)}),e},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),f1=function(t,e,r,s){function o(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function g(v){try{x(s.next(v))}catch(E){f(E)}}function w(v){try{x(s.throw(v))}catch(E){f(E)}}function x(v){v.done?l(v.value):o(v.value).then(g,w)}x((s=s.apply(t,e||[])).next())})},m1=function(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,o,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(x){return function(v){return w([x,v])}}function w(x){if(s)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(r=0)),r;)try{if(s=1,o&&(l=x[0]&2?o.return:x[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,x[1])).done)return l;switch(o=0,l&&(x=[x[0]&2,l.value]),x[0]){case 0:case 1:l=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,o=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!l||x[1]>l[0]&&x[1]<l[3])){r.label=x[1];break}if(x[0]===6&&r.label<l[1]){r.label=l[1],l=x;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(x);break}l[2]&&r.ops.pop(),r.trys.pop();continue}x=e.call(t,r)}catch(v){x=[6,v],o=0}finally{s=l=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},v3=function(){function t(e,r,s,o){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=s,r&&h1.isSupported()?(this.primaryDecoder=new h1(e,s,o),this.secondaryDecoder=new d1(e,s,o)):this.primaryDecoder=new d1(e,s,o)}return t.prototype.decodeAsync=function(e){return f1(this,void 0,void 0,function(){var r;return m1(this,function(s){switch(s.label){case 0:r=performance.now(),s.label=1;case 1:return s.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,s.sent()];case 3:return this.possiblyLogPerformance(r),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(e){return f1(this,void 0,void 0,function(){var r,s;return m1(this,function(o){switch(o.label){case 0:r=performance.now(),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,o.sent()];case 3:if(s=o.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw s;case 4:return this.possiblyLogPerformance(r),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(e){if(this.verbose){var r=performance.now()-e;this.executionResults.push(r),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,r=0,s=this.executionResults;r<s.length;r++){var o=s[r];e+=o}var l=e/this.executionResults.length;console.log("".concat(l," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),Gh=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,o){s.__proto__=o}||function(s,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(s[l]=o[l])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function s(){this.constructor=e}e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}(),Yl=function(t,e,r,s){function o(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function g(v){try{x(s.next(v))}catch(E){f(E)}}function w(v){try{x(s.throw(v))}catch(E){f(E)}}function x(v){v.done?l(v.value):o(v.value).then(g,w)}x((s=s.apply(t,e||[])).next())})},ql=function(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,o,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(x){return function(v){return w([x,v])}}function w(x){if(s)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(r=0)),r;)try{if(s=1,o&&(l=x[0]&2?o.return:x[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,x[1])).done)return l;switch(o=0,l&&(x=[x[0]&2,l.value]),x[0]){case 0:case 1:l=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,o=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!l||x[1]>l[0]&&x[1]<l[3])){r.label=x[1];break}if(x[0]===6&&r.label<l[1]){r.label=l[1],l=x;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(x);break}l[2]&&r.ops.pop(),r.trys.pop();continue}x=e.call(t,r)}catch(v){x=[6,v],o=0}finally{s=l=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},op=function(){function t(e,r){this.name=e,this.track=r}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(e){var r={};r[this.name]=e;var s={advanced:[r]};return this.track.applyConstraints(s)},t.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var r=e[this.name];return r}return null},t}(),b3=function(t){Gh(e,t);function e(r,s){return t.call(this,r,s)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(r){var s={};s[this.name]=r;var o={advanced:[s]};return this.track.applyConstraints(o)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var r=this.track.getCapabilities(),s=r[this.name];return{min:s.min,max:s.max,step:s.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e}(op),E3=function(t){Gh(e,t);function e(r){return t.call(this,"zoom",r)||this}return e}(b3),C3=function(t){Gh(e,t);function e(r){return t.call(this,"torch",r)||this}return e}(op),N3=function(){function t(e){this.track=e}return t.prototype.zoomFeature=function(){return new E3(this.track)},t.prototype.torchFeature=function(){return new C3(this.track)},t}(),_3=function(){function t(e,r,s){this.isClosed=!1,this.parentElement=e,this.mediaStream=r,this.callbacks=s,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return t.prototype.createVideoElement=function(e){var r=document.createElement("video");return r.style.width="".concat(e,"px"),r.style.display="block",r.muted=!0,r.setAttribute("muted","true"),r.playsInline=!0,r},t.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var r=function(){var s=e.surface.clientWidth,o=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(s,o),e.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(e,r,s,o){return Yl(this,void 0,void 0,function(){var l,f;return ql(this,function(g){switch(g.label){case 0:return l=new t(e,r,o),s.aspectRatio?(f={aspectRatio:s.aspectRatio},[4,l.getFirstTrackOrFail().applyConstraints(f)]):[3,2];case 1:g.sent(),g.label=2;case 2:return l.setupSurface(),[2,l]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(e){this.failIfClosed();var r=this,s=function(){setTimeout(e,200),r.surface.removeEventListener("playing",s)};this.surface.addEventListener("playing",s),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(e){return Yl(this,void 0,void 0,function(){return ql(this,function(r){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(r,s){var o=e.mediaStream.getVideoTracks(),l=o.length,f=0;e.mediaStream.getVideoTracks().forEach(function(g){e.mediaStream.removeTrack(g),g.stop(),++f,f>=l&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),r())})})},t.prototype.getCapabilities=function(){return new N3(this.getFirstTrackOrFail())},t}(),S3=function(){function t(e){this.mediaStream=e}return t.prototype.render=function(e,r,s){return Yl(this,void 0,void 0,function(){return ql(this,function(o){return[2,_3.create(e,this.mediaStream,r,s)]})})},t.create=function(e){return Yl(this,void 0,void 0,function(){var r,s;return ql(this,function(o){switch(o.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return s=o.sent(),[2,new t(s)]}})})},t}(),g1=function(t,e,r,s){function o(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function g(v){try{x(s.next(v))}catch(E){f(E)}}function w(v){try{x(s.throw(v))}catch(E){f(E)}}function x(v){v.done?l(v.value):o(v.value).then(g,w)}x((s=s.apply(t,e||[])).next())})},x1=function(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,o,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(x){return function(v){return w([x,v])}}function w(x){if(s)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(r=0)),r;)try{if(s=1,o&&(l=x[0]&2?o.return:x[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,x[1])).done)return l;switch(o=0,l&&(x=[x[0]&2,l.value]),x[0]){case 0:case 1:l=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,o=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!l||x[1]>l[0]&&x[1]<l[3])){r.label=x[1];break}if(x[0]===6&&r.label<l[1]){r.label=l[1],l=x;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(x);break}l[2]&&r.ops.pop(),r.trys.pop();continue}x=e.call(t,r)}catch(v){x=[6,v],o=0}finally{s=l=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},A3=function(){function t(){}return t.failIfNotSupported=function(){return g1(this,void 0,void 0,function(){return x1(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(e){return g1(this,void 0,void 0,function(){return x1(this,function(r){return[2,S3.create(e)]})})},t}(),I3=function(t,e,r,s){function o(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function g(v){try{x(s.next(v))}catch(E){f(E)}}function w(v){try{x(s.throw(v))}catch(E){f(E)}}function x(v){v.done?l(v.value):o(v.value).then(g,w)}x((s=s.apply(t,e||[])).next())})},T3=function(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,o,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(x){return function(v){return w([x,v])}}function w(x){if(s)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(r=0)),r;)try{if(s=1,o&&(l=x[0]&2?o.return:x[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,x[1])).done)return l;switch(o=0,l&&(x=[x[0]&2,l.value]),x[0]){case 0:case 1:l=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,o=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!l||x[1]>l[0]&&x[1]<l[3])){r.label=x[1];break}if(x[0]===6&&r.label<l[1]){r.label=l[1],l=x;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(x);break}l[2]&&r.ops.pop(),r.trys.pop();continue}x=e.call(t,r)}catch(v){x=[6,v],o=0}finally{s=l=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},j3=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var e=Ti.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(e=Ti.insecureContextCameraQueryError()),Promise.reject(e)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},t.getCamerasFromMediaDevices=function(){return I3(this,void 0,void 0,function(){var e,r,s,o,l,f,g;return T3(this,function(w){switch(w.label){case 0:return e=function(x){for(var v=x.getVideoTracks(),E=0,S=v;E<S.length;E++){var I=S[E];I.enabled=!1,I.stop(),x.removeTrack(I)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return r=w.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(s=w.sent(),o=[],l=0,f=s;l<f.length;l++)g=f[l],g.kind==="videoinput"&&o.push({id:g.deviceId,label:g.label});return e(r),[2,o]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,r){var s=function(l){for(var f=[],g=0,w=l;g<w.length;g++){var x=w[g];x.kind==="video"&&f.push({id:x.id,label:x.label})}e(f)},o=MediaStreamTrack;o.getSources(s)})},t}(),xt;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(xt||(xt={}));var R3=function(){function t(){this.state=xt.NOT_STARTED,this.onGoingTransactionNewState=xt.UNKNOWN}return t.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},t.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===xt.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=xt.UNKNOWN,this.directTransition(e)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===xt.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=xt.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==xt.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(e){switch(this.state){case xt.UNKNOWN:throw"Transition from unknown is not allowed";case xt.NOT_STARTED:this.failIfNewStateIs(e,[xt.PAUSED]);break;case xt.SCANNING:break;case xt.PAUSED:break}},t.prototype.failIfNewStateIs=function(e,r){for(var s=0,o=r;s<o.length;s++){var l=o[s];if(e===l)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},t}(),O3=function(){function t(e){this.stateManager=e}return t.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},t.prototype.directTransition=function(e){this.stateManager.directTransition(e)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===xt.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==xt.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===xt.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===xt.PAUSED},t}(),k3=function(){function t(){}return t.create=function(){return new O3(new R3)},t}(),M3=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,o){s.__proto__=o}||function(s,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(s[l]=o[l])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function s(){this.constructor=e}e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}(),Er=function(t){M3(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e}(rn),D3=function(){function t(e,r){this.logger=r,this.fps=Er.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=Er.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?ap.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!vn(this.qrbox)},t.create=function(e,r){return new t(e,r)},t}(),p1=function(){function t(e,r){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var s;typeof r=="boolean"?this.verbose=r===!0:r&&(s=r,this.verbose=s.verbose===!0,s.experimentalFeatures),this.logger=new ip(this.verbose),this.qrcode=new v3(this.getSupportedFormats(r),this.getUseBarCodeDetectorIfSupported(s),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=k3.create()}return t.prototype.start=function(e,r,s,o){var l=this;if(!e)throw"cameraIdOrConfig is required";if(!s||typeof s!="function")throw"qrCodeSuccessCallback is required and should be a function.";var f;o?f=o:f=this.verbose?this.logger.log:function(){};var g=D3.create(r,this.logger);this.clearElement();var w=!1;g.videoConstraints&&(g.isMediaStreamConstraintsValid()?w=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var x=w,v=document.getElementById(this.elementId);v.clientWidth?v.clientWidth:Er.DEFAULT_WIDTH,v.style.position="relative",this.shouldScan=!0,this.element=v;var E=this,S=this.stateManagerProxy.startTransition(xt.SCANNING);return new Promise(function(I,k){var j=x?g.videoConstraints:E.createVideoConstraints(e);if(!j){S.cancel(),k("videoConstraints should be defined");return}var M={};(!x||g.aspectRatio)&&(M.aspectRatio=g.aspectRatio);var A={onRenderSurfaceReady:function(C,T){E.setupUi(C,T,g),E.isScanning=!0,E.foreverScan(g,s,f)}};A3.failIfNotSupported().then(function(C){C.create(j).then(function(T){return T.render(l.element,M,A).then(function(O){E.renderedCamera=O,S.execute(),I(null)}).catch(function(O){S.cancel(),k(O)})}).catch(function(T){S.cancel(),k(Ti.errorGettingUserMedia(T))})}).catch(function(C){S.cancel(),k(Ti.cameraStreamingNotSupported())})})},t.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(xt.PAUSED),this.showPausedState(),(vn(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,r=function(){e.stateManagerProxy.directTransition(xt.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){r();return}this.renderedCamera.resume(function(){r()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var r=this.stateManagerProxy.startTransition(xt.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var s=function(){if(e.element){var l=document.getElementById(Er.SHADED_REGION_ELEMENT_ID);l&&e.element.removeChild(l)}},o=this;return this.renderedCamera.close().then(function(){return o.renderedCamera=null,o.element&&(o.element.removeChild(o.canvasElement),o.canvasElement=null),s(),o.qrRegion&&(o.qrRegion=null),o.context&&(o.context=null),r.execute(),o.hidePausedState(),o.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(e,r){return this.scanFileV2(e,r).then(function(s){return s.decodedText})},t.prototype.scanFileV2=function(e,r){var s=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(vn(r)&&(r=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(o,l){s.possiblyCloseLastScanImageFile(),s.clearElement(),s.lastScanImageFile=URL.createObjectURL(e);var f=new Image;f.onload=function(){var g=f.width,w=f.height,x=document.getElementById(s.elementId),v=x.clientWidth?x.clientWidth:Er.DEFAULT_WIDTH,E=Math.max(x.clientHeight?x.clientHeight:w,Er.FILE_SCAN_MIN_HEIGHT),S=s.computeCanvasDrawConfig(g,w,v,E);if(r){var I=s.createCanvasElement(v,E,"qr-canvas-visible");I.style.display="inline-block",x.appendChild(I);var k=I.getContext("2d");if(!k)throw"Unable to get 2d context from canvas";k.canvas.width=v,k.canvas.height=E,k.drawImage(f,0,0,g,w,S.x,S.y,S.width,S.height)}var j=Er.FILE_SCAN_HIDDEN_CANVAS_PADDING,M=Math.max(f.width,S.width),A=Math.max(f.height,S.height),C=M+2*j,T=A+2*j,O=s.createCanvasElement(C,T);x.appendChild(O);var V=O.getContext("2d");if(!V)throw"Unable to get 2d context from canvas";V.canvas.width=C,V.canvas.height=T,V.drawImage(f,0,0,g,w,j,j,M,A);try{s.qrcode.decodeRobustlyAsync(O).then(function(z){o(c1.createFromQrcodeResult(z))}).catch(l)}catch(z){l("QR code parse error, error = ".concat(z))}},f.onerror=l,f.onabort=l,f.onstalled=l,f.onsuspend=l,f.src=URL.createObjectURL(e)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return j3.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(e){if(e){if(!ap.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(e){var r=[le.QR_CODE,le.AZTEC,le.CODABAR,le.CODE_39,le.CODE_93,le.CODE_128,le.DATA_MATRIX,le.MAXICODE,le.ITF,le.EAN_13,le.EAN_8,le.PDF_417,le.RSS_14,le.RSS_EXPANDED,le.UPC_A,le.UPC_E,le.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return r;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var s=[],o=0,l=e.formatsToSupport;o<l.length;o++){var f=l[o];m3(f)?s.push(f):this.logger.warn("Invalid format: ".concat(f," passed in config, ignoring."))}if(s.length===0)throw"None of formatsToSupport match supported values.";return s},t.prototype.getUseBarCodeDetectorIfSupported=function(e){if(vn(e))return!0;if(!vn(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(vn(e.experimentalFeatures))return!0;var r=e.experimentalFeatures;return vn(r.useBarCodeDetectorIfSupported)?!0:r.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(e,r,s){var o=this,l=s.qrbox;this.validateQrboxConfig(l);var f=this.toQrdimensions(e,r,l),g=function(x){if(x<Er.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Er.MIN_QR_BOX_SIZE,"px.")},w=function(x){return x>e&&(o.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),x=e),x};g(f.width),g(f.height),f.width=w(f.width)},t.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(e,r,s){if(typeof s=="number")return{width:s,height:s};if(typeof s=="function")try{return s(e,r)}catch(o){throw new Error("qrbox config was passed as a function but it failed with unknown error"+o)}return s},t.prototype.setupUi=function(e,r,s){s.isShadedBoxEnabled()&&this.validateQrboxSize(e,r,s);var o=vn(s.qrbox)?{width:e,height:r}:s.qrbox;this.validateQrboxConfig(o);var l=this.toQrdimensions(e,r,o);l.height>r&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var f=s.isShadedBoxEnabled()&&l.height<=r,g={x:0,y:0,width:e,height:r},w=f?this.getShadedRegionBounds(e,r,l):g,x=this.createCanvasElement(w.width,w.height),v={willReadFrequently:!0},E=x.getContext("2d",v);E.canvas.width=w.width,E.canvas.height=w.height,this.element.append(x),f&&this.possiblyInsertShadingElement(this.element,e,r,l),this.createScannerPausedUiElement(this.element),this.qrRegion=w,this.context=E,this.canvasElement=x},t.prototype.createScannerPausedUiElement=function(e){var r=document.createElement("div");r.innerText=Ti.scannerPaused(),r.style.display="none",r.style.position="absolute",r.style.top="0px",r.style.zIndex="1",r.style.background="rgba(9, 9, 9, 0.46)",r.style.color="#FFECEC",r.style.textAlign="center",r.style.width="100%",e.appendChild(r),this.scannerPausedUiElement=r},t.prototype.scanContext=function(e,r){var s=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(o){return e(o.text,c1.createFromQrcodeResult(o)),s.possiblyUpdateShaders(!0),!0}).catch(function(o){s.possiblyUpdateShaders(!1);var l=Ti.codeParseError(o);return r(l,sp.createFrom(l)),!1})},t.prototype.foreverScan=function(e,r,s){var o=this;if(this.shouldScan&&this.renderedCamera){var l=this.renderedCamera.getSurface(),f=l.videoWidth/l.clientWidth,g=l.videoHeight/l.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var w=this.qrRegion.width*f,x=this.qrRegion.height*g,v=this.qrRegion.x*f,E=this.qrRegion.y*g;this.context.drawImage(l,v,E,w,x,0,0,this.qrRegion.width,this.qrRegion.height);var S=function(){o.foreverScanTimeout=setTimeout(function(){o.foreverScan(e,r,s)},o.getTimeoutFps(e.fps))};this.scanContext(r,s).then(function(I){!I&&e.disableFlip!==!0?(o.context.translate(o.context.canvas.width,0),o.context.scale(-1,1),o.scanContext(r,s).finally(function(){S()})):S()}).catch(function(I){o.logger.logError("Error happend while scanning context",I),S()})}},t.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var r="facingMode",s="deviceId",o={user:!0,environment:!0},l="exact",f=function(k){if(k in o)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(k,"'")},g=Object.keys(e);if(g.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(g.length," keys");var w=Object.keys(e)[0];if(w!==r&&w!==s)throw"Only '".concat(r,"' and '").concat(s,"' ")+" are supported for 'cameraIdOrConfig'";if(w===r){var x=e.facingMode;if(typeof x=="string"){if(f(x))return{facingMode:x}}else if(typeof x=="object")if(l in x){if(f(x["".concat(l)]))return{facingMode:{exact:x["".concat(l)]}}}else throw"'facingMode' should be string or object with"+" ".concat(l," as key.");else{var v=typeof x;throw"Invalid type of 'facingMode' = ".concat(v)}}else{var E=e.deviceId;if(typeof E=="string")return{deviceId:E};if(typeof E=="object"){if(l in E)return{deviceId:{exact:E["".concat(l)]}};throw"'deviceId' should be string or object with"+" ".concat(l," as key.")}else{var S=typeof E;throw"Invalid type of 'deviceId' = ".concat(S)}}}var I=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(I)},t.prototype.computeCanvasDrawConfig=function(e,r,s,o){if(e<=s&&r<=o){var l=(s-e)/2,f=(o-r)/2;return{x:l,y:f,width:e,height:r}}else{var g=e,w=r;return e>s&&(r=s/e*r,e=s),r>o&&(e=o/r*e,r=o),this.logger.log("Image downsampled from "+"".concat(g,"X").concat(w)+" to ".concat(e,"X").concat(r,".")),this.computeCanvasDrawConfig(e,r,s,o)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},t.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(r){r.style.backgroundColor=e?Er.BORDER_SHADER_MATCH_COLOR:Er.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(e,r,s){var o=e,l=r,f=document.createElement("canvas");return f.style.width="".concat(o,"px"),f.style.height="".concat(l,"px"),f.style.display="none",f.id=vn(s)?"qr-canvas":s,f},t.prototype.getShadedRegionBounds=function(e,r,s){if(s.width>e||s.height>r)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-s.width)/2,y:(r-s.height)/2,width:s.width,height:s.height}},t.prototype.possiblyInsertShadingElement=function(e,r,s,o){if(!(r-o.width<1||s-o.height<1)){var l=document.createElement("div");l.style.position="absolute";var f=(r-o.width)/2,g=(s-o.height)/2;if(l.style.borderLeft="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderRight="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderTop="".concat(g,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderBottom="".concat(g,"px solid rgba(0, 0, 0, 0.48)"),l.style.boxSizing="border-box",l.style.top="0px",l.style.bottom="0px",l.style.left="0px",l.style.right="0px",l.id="".concat(Er.SHADED_REGION_ELEMENT_ID),r-o.width<11||s-o.height<11)this.hasBorderShaders=!1;else{var w=5,x=40;this.insertShaderBorders(l,x,w,-w,null,0,!0),this.insertShaderBorders(l,x,w,-w,null,0,!1),this.insertShaderBorders(l,x,w,null,-w,0,!0),this.insertShaderBorders(l,x,w,null,-w,0,!1),this.insertShaderBorders(l,w,x+w,-w,null,-w,!0),this.insertShaderBorders(l,w,x+w,null,-w,-w,!0),this.insertShaderBorders(l,w,x+w,-w,null,-w,!1),this.insertShaderBorders(l,w,x+w,null,-w,-w,!1),this.hasBorderShaders=!0}e.append(l)}},t.prototype.insertShaderBorders=function(e,r,s,o,l,f,g){var w=document.createElement("div");w.style.position="absolute",w.style.backgroundColor=Er.BORDER_SHADER_DEFAULT_COLOR,w.style.width="".concat(r,"px"),w.style.height="".concat(s,"px"),o!==null&&(w.style.top="".concat(o,"px")),l!==null&&(w.style.bottom="".concat(l,"px")),g?w.style.left="".concat(f,"px"):w.style.right="".concat(f,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(w),e.appendChild(w)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(e){return 1e3/e},t}(),$h="data:image/svg+xml;base64,",L3=$h+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",P3=$h+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",w1=$h+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",B3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",y1=function(){function t(){}return t.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},t}(),F3=function(){function t(){this.data=y1.createDefault();var e=localStorage.getItem(t.LOCAL_STORAGE_KEY);e?this.data=JSON.parse(e):this.reset()}return t.prototype.hasCameraPermissions=function(){return this.data.hasPermission},t.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},t.prototype.setHasPermission=function(e){this.data.hasPermission=e,this.flush()},t.prototype.setLastUsedCameraId=function(e){this.data.lastUsedCameraId=e,this.flush()},t.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},t.prototype.reset=function(){this.data=y1.createDefault(),this.flush()},t.prototype.flush=function(){localStorage.setItem(t.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},t.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",t}(),U3=function(){function t(){this.infoDiv=document.createElement("div")}return t.prototype.renderInto=function(e){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=u1.poweredBy();var r=document.createElement("a");r.innerText="ScanApp",r.href="https://scanapp.org",r.target="new",r.style.color="white",this.infoDiv.appendChild(r);var s=document.createElement("br"),o=document.createElement("br");this.infoDiv.appendChild(s),this.infoDiv.appendChild(o);var l=document.createElement("a");l.innerText=u1.reportIssues(),l.href="https://github.com/mebjas/html5-qrcode/issues",l.target="new",l.style.color="white",this.infoDiv.appendChild(l),e.appendChild(this.infoDiv)},t.prototype.show=function(){this.infoDiv.style.display="block"},t.prototype.hide=function(){this.infoDiv.style.display="none"},t}(),z3=function(){function t(e,r){this.isShowingInfoIcon=!0,this.onTapIn=e,this.onTapOut=r,this.infoIcon=document.createElement("img")}return t.prototype.renderInto=function(e){var r=this;this.infoIcon.alt="Info icon",this.infoIcon.src=w1,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(s){return r.onHoverIn()},this.infoIcon.onmouseout=function(s){return r.onHoverOut()},this.infoIcon.onclick=function(s){return r.onClick()},e.appendChild(this.infoIcon)},t.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},t.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},t.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=B3,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=w1,this.infoIcon.style.opacity="0.6")},t}(),V3=function(){function t(){var e=this;this.infoDiv=new U3,this.infoIcon=new z3(function(){e.infoDiv.show()},function(){e.infoDiv.hide()})}return t.prototype.renderInto=function(e){this.infoDiv.renderInto(e),this.infoIcon.renderInto(e)},t}(),H3=function(t,e,r,s){function o(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function g(v){try{x(s.next(v))}catch(E){f(E)}}function w(v){try{x(s.throw(v))}catch(E){f(E)}}function x(v){v.done?l(v.value):o(v.value).then(g,w)}x((s=s.apply(t,e||[])).next())})},W3=function(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,o,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(x){return function(v){return w([x,v])}}function w(x){if(s)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(r=0)),r;)try{if(s=1,o&&(l=x[0]&2?o.return:x[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,x[1])).done)return l;switch(o=0,l&&(x=[x[0]&2,l.value]),x[0]){case 0:case 1:l=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,o=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!l||x[1]>l[0]&&x[1]<l[3])){r.label=x[1];break}if(x[0]===6&&r.label<l[1]){r.label=l[1],l=x;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(x);break}l[2]&&r.ops.pop(),r.trys.pop();continue}x=e.call(t,r)}catch(v){x=[6,v],o=0}finally{s=l=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},v1=function(){function t(){}return t.hasPermissions=function(){return H3(this,void 0,void 0,function(){var e,r,s,o;return W3(this,function(l){switch(l.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(e=l.sent(),r=0,s=e;r<s.length;r++)if(o=s[r],o.kind==="videoinput"&&o.label)return[2,!0];return[2,!1]}})})},t}(),Kn=function(){function t(e){this.supportedScanTypes=this.validateAndReturnScanTypes(e)}return t.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},t.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},t.prototype.isCameraScanRequired=function(){for(var e=0,r=this.supportedScanTypes;e<r.length;e++){var s=r[e];if(t.isCameraScanType(s))return!0}return!1},t.isCameraScanType=function(e){return e===xs.SCAN_TYPE_CAMERA},t.isFileScanType=function(e){return e===xs.SCAN_TYPE_FILE},t.prototype.validateAndReturnScanTypes=function(e){if(!e||e.length===0)return rn.DEFAULT_SUPPORTED_SCAN_TYPE;var r=rn.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(e.length>r)throw"Max ".concat(r," values expected for ")+"supportedScanTypes";for(var s=0,o=e;s<o.length;s++){var l=o[s];if(!rn.DEFAULT_SUPPORTED_SCAN_TYPE.includes(l))throw"Unsupported scan type ".concat(l)}return e},t}(),Ar=function(){function t(){}return t.ALL_ELEMENT_CLASS="html5-qrcode-element",t.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",t.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",t.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",t.TORCH_BUTTON_ID="html5-qrcode-button-torch",t.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",t.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",t.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",t.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",t.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",t.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",t}(),Rn=function(){function t(){}return t.createElement=function(e,r){var s=document.createElement(e);return s.id=r,s.classList.add(Ar.ALL_ELEMENT_CLASS),e==="button"&&s.setAttribute("type","button"),s},t}(),lp=function(t,e,r,s){function o(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function g(v){try{x(s.next(v))}catch(E){f(E)}}function w(v){try{x(s.throw(v))}catch(E){f(E)}}function x(v){v.done?l(v.value):o(v.value).then(g,w)}x((s=s.apply(t,e||[])).next())})},cp=function(t,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,o,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(x){return function(v){return w([x,v])}}function w(x){if(s)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(r=0)),r;)try{if(s=1,o&&(l=x[0]&2?o.return:x[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,x[1])).done)return l;switch(o=0,l&&(x=[x[0]&2,l.value]),x[0]){case 0:case 1:l=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,o=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!l||x[1]>l[0]&&x[1]<l[3])){r.label=x[1];break}if(x[0]===6&&r.label<l[1]){r.label=l[1],l=x;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(x);break}l[2]&&r.ops.pop(),r.trys.pop();continue}x=e.call(t,r)}catch(v){x=[6,v],o=0}finally{s=l=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},b1=function(){function t(e,r,s){this.isTorchOn=!1,this.torchCapability=e,this.buttonController=r,this.onTorchActionFailureCallback=s}return t.prototype.isTorchEnabled=function(){return this.isTorchOn},t.prototype.flipState=function(){return lp(this,void 0,void 0,function(){var e,r;return cp(this,function(s){switch(s.label){case 0:this.buttonController.disable(),e=!this.isTorchOn,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.torchCapability.apply(e)];case 2:return s.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),e),[3,4];case 3:return r=s.sent(),this.propagateFailure(e,r),this.buttonController.enable(),[3,4];case 4:return[2]}})})},t.prototype.updateUiBasedOnLatestSettings=function(e,r){e===r?(this.buttonController.setText(r?ze.torchOffButton():ze.torchOnButton()),this.isTorchOn=r):this.propagateFailure(r),this.buttonController.enable()},t.prototype.propagateFailure=function(e,r){var s=e?ze.torchOnFailedMessage():ze.torchOffFailedMessage();r&&(s+="; Error = "+r),this.onTorchActionFailureCallback(s)},t.prototype.reset=function(){this.isTorchOn=!1},t}(),G3=function(){function t(e,r){this.onTorchActionFailureCallback=r,this.torchButton=Rn.createElement("button",Ar.TORCH_BUTTON_ID),this.torchController=new b1(e,this,r)}return t.prototype.render=function(e,r){var s=this;this.torchButton.innerText=ze.torchOnButton(),this.torchButton.style.display=r.display,this.torchButton.style.marginLeft=r.marginLeft;var o=this;this.torchButton.addEventListener("click",function(l){return lp(s,void 0,void 0,function(){return cp(this,function(f){switch(f.label){case 0:return[4,o.torchController.flipState()];case 1:return f.sent(),o.torchController.isTorchEnabled()?(o.torchButton.classList.remove(Ar.TORCH_BUTTON_CLASS_TORCH_OFF),o.torchButton.classList.add(Ar.TORCH_BUTTON_CLASS_TORCH_ON)):(o.torchButton.classList.remove(Ar.TORCH_BUTTON_CLASS_TORCH_ON),o.torchButton.classList.add(Ar.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),e.appendChild(this.torchButton)},t.prototype.updateTorchCapability=function(e){this.torchController=new b1(e,this,this.onTorchActionFailureCallback)},t.prototype.getTorchButton=function(){return this.torchButton},t.prototype.hide=function(){this.torchButton.style.display="none"},t.prototype.show=function(){this.torchButton.style.display="inline-block"},t.prototype.disable=function(){this.torchButton.disabled=!0},t.prototype.enable=function(){this.torchButton.disabled=!1},t.prototype.setText=function(e){this.torchButton.innerText=e},t.prototype.reset=function(){this.torchButton.innerText=ze.torchOnButton(),this.torchController.reset()},t.create=function(e,r,s,o){var l=new t(r,o);return l.render(e,s),l},t}(),$3=function(){function t(e,r,s){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=r?"block":"none",e.appendChild(this.fileBasedScanRegion);var o=document.createElement("label");o.setAttribute("for",this.getFileScanInputId()),o.style.display="inline-block",this.fileBasedScanRegion.appendChild(o),this.fileSelectionButton=Rn.createElement("button",Ar.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(g){o.click()}),o.append(this.fileSelectionButton),this.fileScanInput=Rn.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",o.appendChild(this.fileScanInput);var l=this;this.fileScanInput.addEventListener("change",function(g){if(!(g==null||g.target==null)){var w=g.target;if(!(w.files&&w.files.length===0)){var x=w.files,v=x[0],E=v.name;l.setImageNameToButton(E),s(v)}}});var f=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(f),this.fileBasedScanRegion.addEventListener("dragenter",function(g){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),g.stopPropagation(),g.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(g){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder(),g.stopPropagation(),g.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(g){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),g.stopPropagation(),g.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(g){g.stopPropagation(),g.preventDefault(),l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder();var w=g.dataTransfer;if(w){var x=w.files;if(!x||x.length===0)return;for(var v=!1,E=0;E<x.length;++E){var S=x.item(E);if(S){var I=/image.*/;if(S.type.match(I)){v=!0;var k=S.name;l.setImageNameToButton(k),s(S),f.innerText=ze.dragAndDropMessage();break}}}v||(f.innerText=ze.dragAndDropMessageOnlyImages())}})}return t.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},t.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},t.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},t.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},t.prototype.createFileBasedScanRegion=function(){var e=document.createElement("div");return e.style.textAlign="center",e.style.margin="auto",e.style.width="80%",e.style.maxWidth="600px",e.style.border=this.fileBasedScanRegionDefaultBorder(),e.style.padding="10px",e.style.marginBottom="10px",e},t.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},t.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},t.prototype.createDragAndDropMessage=function(){var e=document.createElement("div");return e.innerText=ze.dragAndDropMessage(),e.style.fontWeight="400",e},t.prototype.setImageNameToButton=function(e){var r=20;if(e.length>r){var s=e.substring(0,8),o=e.length,l=e.substring(o-8,o);e="".concat(s,"....").concat(l)}var f=ze.fileSelectionChooseAnother()+" - "+e;this.fileSelectionButton.innerText=f},t.prototype.setInitialValueToButton=function(){var e=ze.fileSelectionChooseImage()+" - "+ze.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=e},t.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},t.create=function(e,r,s){var o=new t(e,r,s);return o},t}(),X3=function(){function t(e){this.selectElement=Rn.createElement("select",Ar.CAMERA_SELECTION_SELECT_ID),this.cameras=e,this.options=[]}return t.prototype.render=function(e){var r=document.createElement("span");r.style.marginRight="10px";var s=this.cameras.length;if(s===0)throw new Error("No cameras found");if(s===1)r.style.display="none";else{var o=ze.selectCamera();r.innerText="".concat(o," (").concat(this.cameras.length,")  ")}for(var l=1,f=0,g=this.cameras;f<g.length;f++){var w=g[f],x=w.id,v=w.label==null?x:w.label;(!v||v==="")&&(v=[ze.anonymousCameraPrefix(),l++].join(" "));var E=document.createElement("option");E.value=x,E.innerText=v,this.options.push(E),this.selectElement.appendChild(E)}r.appendChild(this.selectElement),e.appendChild(r)},t.prototype.disable=function(){this.selectElement.disabled=!0},t.prototype.isDisabled=function(){return this.selectElement.disabled===!0},t.prototype.enable=function(){this.selectElement.disabled=!1},t.prototype.getValue=function(){return this.selectElement.value},t.prototype.hasValue=function(e){for(var r=0,s=this.options;r<s.length;r++){var o=s[r];if(o.value===e)return!0}return!1},t.prototype.setValue=function(e){if(!this.hasValue(e))throw new Error("".concat(e," is not present in the camera list."));this.selectElement.value=e},t.prototype.hasSingleItem=function(){return this.cameras.length===1},t.prototype.numCameras=function(){return this.cameras.length},t.create=function(e,r){var s=new t(r);return s.render(e),s},t}(),Y3=function(){function t(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=Rn.createElement("input",Ar.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return t.prototype.render=function(e,r){this.zoomElementContainer.style.display=r?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",e.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var s=ze.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(s),this.rangeText.style.marginRight="10px";var o=this;this.rangeInput.addEventListener("input",function(){return o.onValueChange()}),this.rangeInput.addEventListener("change",function(){return o.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},t.prototype.onValueChange=function(){var e=ze.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(e),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},t.prototype.setValues=function(e,r,s,o){this.rangeInput.min=e.toString(),this.rangeInput.max=r.toString(),this.rangeInput.step=o.toString(),this.rangeInput.value=s.toString(),this.onValueChange()},t.prototype.show=function(){this.zoomElementContainer.style.display="block"},t.prototype.hide=function(){this.zoomElementContainer.style.display="none"},t.prototype.setOnCameraZoomValueChangeCallback=function(e){this.onChangeCallback=e},t.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},t.create=function(e,r){var s=new t;return s.render(e,r),s},t}(),Cr;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Cr||(Cr={}));function q3(t){return{fps:t.fps,qrbox:t.qrbox,aspectRatio:t.aspectRatio,disableFlip:t.disableFlip,videoConstraints:t.videoConstraints}}function K3(t,e){return{formatsToSupport:t.formatsToSupport,useBarCodeDetectorIfSupported:t.useBarCodeDetectorIfSupported,experimentalFeatures:t.experimentalFeatures,verbose:e}}var Q3=function(){function t(e,r,s){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=e,this.config=this.createConfig(r),this.verbose=s===!0,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.scanTypeSelector=new Kn(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new ip(this.verbose),this.persistedDataManager=new F3,r.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return t.prototype.render=function(e,r){var s=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(l,f){if(e)e(l,f);else{if(s.lastMatchFound===l)return;s.lastMatchFound=l,s.setHeaderMessage(ze.lastMatch(l),Cr.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(l,f){r&&r(l,f)};var o=document.getElementById(this.elementId);if(!o)throw"HTML Element with id=".concat(this.elementId," not found");o.innerHTML="",this.createBasicLayout(o),this.html5Qrcode=new p1(this.getScanRegionId(),K3(this.config,this.verbose))},t.prototype.pause=function(e){(vn(e)||e!==!0)&&(e=!1),this.getHtml5QrcodeOrFail().pause(e)},t.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},t.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},t.prototype.clear=function(){var e=this,r=function(){var s=document.getElementById(e.elementId);s&&(s.innerHTML="",e.resetBasicLayout(s))};return this.html5Qrcode?new Promise(function(s,o){if(!e.html5Qrcode){s();return}e.html5Qrcode.isScanning?e.html5Qrcode.stop().then(function(l){if(!e.html5Qrcode){s();return}e.html5Qrcode.clear(),r(),s()}).catch(function(l){e.verbose&&e.logger.logError("Unable to stop qrcode scanner",l),o(l)}):(e.html5Qrcode.clear(),r(),s())}):Promise.resolve()},t.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},t.prototype.applyVideoConstraints=function(e){return this.getHtml5QrcodeOrFail().applyVideoConstraints(e)},t.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},t.prototype.createConfig=function(e){return e?(e.fps||(e.fps=rn.SCAN_DEFAULT_FPS),e.rememberLastUsedCamera!==!rn.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(e.rememberLastUsedCamera=rn.DEFAULT_REMEMBER_LAST_CAMERA_USED),e.supportedScanTypes||(e.supportedScanTypes=rn.DEFAULT_SUPPORTED_SCAN_TYPE),e):{fps:rn.SCAN_DEFAULT_FPS,rememberLastUsedCamera:rn.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:rn.DEFAULT_SUPPORTED_SCAN_TYPE}},t.prototype.createBasicLayout=function(e){e.style.position="relative",e.style.padding="0px",e.style.border="1px solid silver",this.createHeader(e);var r=document.createElement("div"),s=this.getScanRegionId();r.id=s,r.style.width="100%",r.style.minHeight="100px",r.style.textAlign="center",e.appendChild(r),Kn.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var o=document.createElement("div"),l=this.getDashboardId();o.id=l,o.style.width="100%",e.appendChild(o),this.setupInitialDashboard(o)},t.prototype.resetBasicLayout=function(e){e.style.border="none"},t.prototype.setupInitialDashboard=function(e){this.createSection(e),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},t.prototype.createHeader=function(e){var r=document.createElement("div");r.style.textAlign="left",r.style.margin="0px",e.appendChild(r);var s=new V3;s.renderInto(r);var o=document.createElement("div");o.id=this.getHeaderMessageContainerId(),o.style.display="none",o.style.textAlign="center",o.style.fontSize="14px",o.style.padding="2px 10px",o.style.margin="4px",o.style.borderTop="1px solid #f6f6f6",r.appendChild(o)},t.prototype.createSection=function(e){var r=document.createElement("div");r.id=this.getDashboardSectionId(),r.style.width="100%",r.style.padding="10px 0px 10px 0px",r.style.textAlign="left",e.appendChild(r)},t.prototype.createCameraListUi=function(e,r,s){var o=this;o.showHideScanTypeSwapLink(!1),o.setHeaderMessage(ze.cameraPermissionRequesting());var l=function(){s||o.createPermissionButton(e,r)};p1.getCameras().then(function(f){o.persistedDataManager.setHasPermission(!0),o.showHideScanTypeSwapLink(!0),o.resetHeaderMessage(),f&&f.length>0?(e.removeChild(r),o.renderCameraSelection(f)):(o.setHeaderMessage(ze.noCameraFound(),Cr.STATUS_WARNING),l())}).catch(function(f){o.persistedDataManager.setHasPermission(!1),s?s.disabled=!1:l(),o.setHeaderMessage(f,Cr.STATUS_WARNING),o.showHideScanTypeSwapLink(!0)})},t.prototype.createPermissionButton=function(e,r){var s=this,o=Rn.createElement("button",this.getCameraPermissionButtonId());o.innerText=ze.cameraPermissionTitle(),o.addEventListener("click",function(){o.disabled=!0,s.createCameraListUi(e,r,o)}),r.appendChild(o)},t.prototype.createPermissionsUi=function(e,r){var s=this;if(Kn.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){v1.hasPermissions().then(function(o){o?s.createCameraListUi(e,r):(s.persistedDataManager.setHasPermission(!1),s.createPermissionButton(e,r))}).catch(function(o){s.persistedDataManager.setHasPermission(!1),s.createPermissionButton(e,r)});return}this.createPermissionButton(e,r)},t.prototype.createSectionControlPanel=function(){var e=document.getElementById(this.getDashboardSectionId()),r=document.createElement("div");e.appendChild(r);var s=document.createElement("div");s.id=this.getDashboardSectionCameraScanRegionId(),s.style.display=Kn.isCameraScanType(this.currentScanType)?"block":"none",r.appendChild(s);var o=document.createElement("div");o.style.textAlign="center",s.appendChild(o),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(s,o),this.renderFileScanUi(r)},t.prototype.renderFileScanUi=function(e){var r=Kn.isFileScanType(this.currentScanType),s=this,o=function(l){if(!s.html5Qrcode)throw"html5Qrcode not defined";Kn.isFileScanType(s.currentScanType)&&(s.setHeaderMessage(ze.loadingImage()),s.html5Qrcode.scanFileV2(l,!0).then(function(f){s.resetHeaderMessage(),s.qrCodeSuccessCallback(f.decodedText,f)}).catch(function(f){s.setHeaderMessage(f,Cr.STATUS_WARNING),s.qrCodeErrorCallback(f,sp.createFrom(f))}))};this.fileSelectionUi=$3.create(e,r,o)},t.prototype.renderCameraSelection=function(e){var r=this,s=this,o=document.getElementById(this.getDashboardSectionCameraScanRegionId());o.style.textAlign="center";var l=Y3.create(o,!1),f=function(j){var M=j.zoomFeature();if(M.isSupported()){l.setOnCameraZoomValueChangeCallback(function(C){M.apply(C)});var A=1;r.config.defaultZoomValueIfSupported&&(A=r.config.defaultZoomValueIfSupported),A=g3(A,M.min(),M.max()),l.setValues(M.min(),M.max(),A,M.step()),l.show()}},g=X3.create(o,e),w=document.createElement("span"),x=Rn.createElement("button",Ar.CAMERA_START_BUTTON_ID);x.innerText=ze.scanButtonStartScanningText(),w.appendChild(x);var v=Rn.createElement("button",Ar.CAMERA_STOP_BUTTON_ID);v.innerText=ze.scanButtonStopScanningText(),v.style.display="none",v.disabled=!0,w.appendChild(v);var E,S=function(j){if(!j.torchFeature().isSupported()){E&&E.hide();return}E?E.updateTorchCapability(j.torchFeature()):E=G3.create(w,j.torchFeature(),{display:"none",marginLeft:"5px"},function(M){s.setHeaderMessage(M,Cr.STATUS_WARNING)}),E.show()};o.appendChild(w);var I=function(j){j||(x.style.display="none"),x.innerText=ze.scanButtonStartScanningText(),x.style.opacity="1",x.disabled=!1,j&&(x.style.display="inline-block")};if(x.addEventListener("click",function(j){x.innerText=ze.scanButtonScanningStarting(),g.disable(),x.disabled=!0,x.style.opacity="0.5",r.scanTypeSelector.hasMoreThanOneScanType()&&s.showHideScanTypeSwapLink(!1),s.resetHeaderMessage();var M=g.getValue();s.persistedDataManager.setLastUsedCameraId(M),s.html5Qrcode.start(M,q3(s.config),s.qrCodeSuccessCallback,s.qrCodeErrorCallback).then(function(A){v.disabled=!1,v.style.display="inline-block",I(!1);var C=s.html5Qrcode.getRunningTrackCameraCapabilities();r.config.showTorchButtonIfSupported===!0&&S(C),r.config.showZoomSliderIfSupported===!0&&f(C)}).catch(function(A){s.showHideScanTypeSwapLink(!0),g.enable(),I(!0),s.setHeaderMessage(A,Cr.STATUS_WARNING)})}),g.hasSingleItem()&&x.click(),v.addEventListener("click",function(j){if(!s.html5Qrcode)throw"html5Qrcode not defined";v.disabled=!0,s.html5Qrcode.stop().then(function(M){r.scanTypeSelector.hasMoreThanOneScanType()&&s.showHideScanTypeSwapLink(!0),g.enable(),x.disabled=!1,v.style.display="none",x.style.display="inline-block",E&&(E.reset(),E.hide()),l.removeOnCameraZoomValueChangeCallback(),l.hide(),s.insertCameraScanImageToScanRegion()}).catch(function(M){v.disabled=!1,s.setHeaderMessage(M,Cr.STATUS_WARNING)})}),s.persistedDataManager.getLastUsedCameraId()){var k=s.persistedDataManager.getLastUsedCameraId();g.hasValue(k)?(g.setValue(k),x.click()):s.persistedDataManager.resetLastUsedCameraId()}},t.prototype.createSectionSwap=function(){var e=this,r=ze.textIfCameraScanSelected(),s=ze.textIfFileScanSelected(),o=document.getElementById(this.getDashboardSectionId()),l=document.createElement("div");l.style.textAlign="center";var f=Rn.createElement("span",this.getDashboardSectionSwapLinkId());f.style.textDecoration="underline",f.style.cursor="pointer",f.innerText=Kn.isCameraScanType(this.currentScanType)?r:s,f.addEventListener("click",function(){if(!e.sectionSwapAllowed){e.verbose&&e.logger.logError("Section swap called when not allowed");return}e.resetHeaderMessage(),e.fileSelectionUi.resetValue(),e.sectionSwapAllowed=!1,Kn.isCameraScanType(e.currentScanType)?(e.clearScanRegion(),e.getCameraScanRegion().style.display="none",e.fileSelectionUi.show(),f.innerText=s,e.currentScanType=xs.SCAN_TYPE_FILE,e.insertFileScanImageToScanRegion()):(e.clearScanRegion(),e.getCameraScanRegion().style.display="block",e.fileSelectionUi.hide(),f.innerText=r,e.currentScanType=xs.SCAN_TYPE_CAMERA,e.insertCameraScanImageToScanRegion(),e.startCameraScanIfPermissionExistsOnSwap()),e.sectionSwapAllowed=!0}),l.appendChild(f),o.appendChild(l)},t.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var e=this,r=this;if(this.persistedDataManager.hasCameraPermissions()){v1.hasPermissions().then(function(s){if(s){var o=document.getElementById(r.getCameraPermissionButtonId());if(!o)throw e.logger.logError("Permission button not found, fail;"),"Permission button not found";o.click()}else r.persistedDataManager.setHasPermission(!1)}).catch(function(s){r.persistedDataManager.setHasPermission(!1)});return}},t.prototype.resetHeaderMessage=function(){var e=document.getElementById(this.getHeaderMessageContainerId());e.style.display="none"},t.prototype.setHeaderMessage=function(e,r){r||(r=Cr.STATUS_DEFAULT);var s=this.getHeaderMessageDiv();switch(s.innerText=e,s.style.display="block",r){case Cr.STATUS_SUCCESS:s.style.background="rgba(106, 175, 80, 0.26)",s.style.color="#477735";break;case Cr.STATUS_WARNING:s.style.background="rgba(203, 36, 49, 0.14)",s.style.color="#cb2431";break;case Cr.STATUS_DEFAULT:default:s.style.background="rgba(0, 0, 0, 0)",s.style.color="rgb(17, 17, 17)";break}},t.prototype.showHideScanTypeSwapLink=function(e){this.scanTypeSelector.hasMoreThanOneScanType()&&(e!==!0&&(e=!1),this.sectionSwapAllowed=e,this.getDashboardSectionSwapLink().style.display=e?"inline-block":"none")},t.prototype.insertCameraScanImageToScanRegion=function(){var e=this,r=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){r.innerHTML="<br>",r.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(s){r.innerHTML="<br>",r.appendChild(e.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=L3,this.cameraScanImage.alt=ze.cameraScanAltText()},t.prototype.insertFileScanImageToScanRegion=function(){var e=this,r=document.getElementById(this.getScanRegionId());if(this.fileScanImage){r.innerHTML="<br>",r.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(s){r.innerHTML="<br>",r.appendChild(e.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=P3,this.fileScanImage.alt=ze.fileScanAltText()},t.prototype.clearScanRegion=function(){var e=document.getElementById(this.getScanRegionId());e.innerHTML=""},t.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},t.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},t.prototype.getDashboardSectionSwapLinkId=function(){return Ar.SCAN_TYPE_CHANGE_ANCHOR_ID},t.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},t.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},t.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},t.prototype.getCameraPermissionButtonId=function(){return Ar.CAMERA_PERMISSION_BUTTON_ID},t.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},t.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},t.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},t}();/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Z3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ce=(t,e)=>{const r=P.forwardRef(({color:s="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:f,className:g="",children:w,...x},v)=>P.createElement("svg",{ref:v,...Z3,width:o,height:o,stroke:s,strokeWidth:f?Number(l)*24/Number(o):l,className:["lucide",`lucide-${J3(t)}`,g].join(" "),...x},[...e.map(([E,S])=>P.createElement(E,S)),...Array.isArray(w)?w:[w]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=Ce("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eC=Ce("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=Ce("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=Ce("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=Ce("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=Ce("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=Ce("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=Ce("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=Ce("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cu=Ce("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=Ce("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tC=Ce("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rC=Ce("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nC=Ce("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=Ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dp=Ce("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E1=Ce("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sC=Ce("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iC=Ce("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=Ce("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oC=Ce("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=Ce("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=Ce("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fp=Ce("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=Ce("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mp=Ce("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gp=Ce("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=Ce("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=Ce("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=Ce("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=Ce("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uC=Ce("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kh=Ce("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=Ce("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=Ce("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=Ce("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=Ce("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dC=Ce("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=Ce("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=Ce("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hC=Ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=Ce("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=Ce("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xp=Ce("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.34l1 1L22 8v8",key:"ubwiq0"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2l10 10Z",key:"1l10zd"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=Ce("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=Ce("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),fC=[{path:"/",icon:dp,label:"Accueil"},{path:"/client/scan",icon:Kh,label:"Scanner QR Code"},{path:"/client/exchanges",icon:aC,label:"Mes changes"},{path:"/client/chat",icon:jr,label:"Messagerie"}];function mC(){const t=un(),[e,r]=P.useState(!1);return u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>r(!e),className:"lg:hidden fixed top-4 left-4 z-50 p-2 bg-white rounded-lg shadow-lg",children:e?u.jsx(ta,{className:"w-6 h-6"}):u.jsx(fp,{className:"w-6 h-6"})}),u.jsx("aside",{className:`fixed left-0 top-0 h-full bg-white border-r border-slate-200 z-40 transition-transform duration-300 ${e?"translate-x-0":"-translate-x-full"} lg:translate-x-0 w-64`,children:u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx("div",{className:"p-6 border-b border-slate-200",children:u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:u.jsx(Kh,{className:"w-6 h-6 text-emerald-600"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"font-semibold text-slate-900",children:"Client"}),u.jsx("p",{className:"text-xs text-slate-500",children:"Espace change"})]})]})}),u.jsx("nav",{className:"flex-1 p-4",children:u.jsx("ul",{className:"space-y-2",children:fC.map(s=>{const o=s.icon,l=t.pathname===s.path;return u.jsx("li",{children:u.jsxs(qt,{to:s.path,onClick:()=>r(!1),className:`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${l?"bg-emerald-50 text-emerald-600":"text-slate-600 hover:bg-slate-50"}`,children:[u.jsx(o,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:s.label})]})},s.path)})})}),u.jsx("div",{className:"p-4 border-t border-slate-200",children:u.jsx("div",{className:"px-4 py-3 bg-emerald-50 rounded-lg",children:u.jsx("p",{className:"text-xs text-emerald-700",children:"Besoin d'aide? Contactez votre commerant via la messagerie dans le suivi de votre change."})})})]})}),e&&u.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30",onClick:()=>r(!1)})]})}function Ys({children:t}){return u.jsxs("div",{className:"flex min-h-screen bg-slate-50",children:[u.jsx(mC,{}),u.jsx("main",{className:"flex-1 lg:ml-64",children:u.jsx("div",{className:"p-6 lg:p-8",children:t})})]})}const C1=["EXC-2025-001","EXC-2025-002","EXC-2025-003","EXC-2025-004","EXC-2025-005"];function gC(){const[t,e]=P.useState(""),[r,s]=P.useState(""),[o,l]=P.useState(!1),[f,g]=P.useState(!1),[w,x]=P.useState(""),v=wt();P.useEffect(()=>{if(!o){const A=new Q3("qr-reader",{fps:10,qrbox:{width:250,height:250}},!1);return A.render(E,S),()=>{A.clear()}}},[o]);const E=A=>{I(A)},S=()=>{},I=A=>{C1.includes(A)?(x(A),g(!0),e("")):e("Code d'change invalide. Veuillez ressayer.")},k=()=>{g(!1),v(`/client/exchange/new?code=${w}`)},j=()=>{g(!1),v(`/client/review/new?code=${w}`)},M=A=>{A.preventDefault(),r.trim()&&I(r.trim())};return u.jsxs(Ys,{children:[u.jsxs("div",{className:"max-w-2xl mx-auto",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-emerald-100 rounded-full mb-4",children:u.jsx(Kh,{className:"w-8 h-8 text-emerald-600"})}),u.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Scanner le QR Code"}),u.jsx("p",{className:"text-slate-600",children:"Scannez le code sur votre colis pour dmarrer l'change"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t&&u.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:t}),o?u.jsxs("form",{onSubmit:M,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Code d'change"}),u.jsx("input",{type:"text",value:r,onChange:A=>s(A.target.value),placeholder:"EXC-2025-XXX",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("button",{type:"submit",className:"w-full py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:"Valider le code"}),u.jsx("button",{type:"button",onClick:()=>l(!1),className:"w-full py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-colors",children:"Retour au scanner"})]})]}):u.jsxs("div",{children:[u.jsx("div",{id:"qr-reader",className:"mb-4"}),u.jsxs("button",{onClick:()=>l(!0),className:"w-full flex items-center justify-center gap-2 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-colors",children:[u.jsx(sC,{className:"w-5 h-5"}),"Entrer le code manuellement"]})]}),u.jsxs("div",{className:"mt-6 p-4 bg-sky-50 rounded-lg",children:[u.jsx("p",{className:"text-sm text-sky-800 font-medium mb-2",children:"Codes de test disponibles:"}),u.jsx("ul",{className:"text-sm text-sky-700 space-y-1",children:C1.map(A=>u.jsxs("li",{className:"font-mono",children:[" ",A]},A))})]})]})]}),f&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Que souhaitez-vous faire ?"}),u.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:u.jsx(ta,{className:"w-5 h-5 text-slate-500"})})]}),u.jsxs("p",{className:"text-slate-600 mb-6",children:["Code scann :"," ",u.jsx("span",{className:"font-mono font-medium text-emerald-600",children:w})]}),u.jsxs("div",{className:"grid gap-4",children:[u.jsxs("button",{onClick:k,className:"flex items-center gap-4 p-4 bg-emerald-50 border-2 border-emerald-200 rounded-xl hover:border-emerald-500 hover:bg-emerald-100 transition-all text-left",children:[u.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center",children:u.jsx(Kt,{className:"w-6 h-6 text-emerald-600"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-slate-900",children:"Demander un change"}),u.jsx("p",{className:"text-sm text-slate-600",children:"changer votre produit contre un autre"})]})]}),u.jsxs("button",{onClick:j,className:"flex items-center gap-4 p-4 bg-amber-50 border-2 border-amber-200 rounded-xl hover:border-amber-500 hover:bg-amber-100 transition-all text-left",children:[u.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center",children:u.jsx(fs,{className:"w-6 h-6 text-amber-600"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-slate-900",children:"Laisser un avis"}),u.jsx("p",{className:"text-sm text-slate-600",children:"Partagez votre exprience avec le marchand"})]})]})]})]})})})]})}const xC=["Taille incorrecte","Couleur non conforme","Produit dfectueux","Produit endommag","Ne correspond pas  la description","Changement d'avis","Autre"];function pC(){const[t]=Zg(),e=wt(),r=t.get("code")||"",[s,o]=P.useState({clientName:"",clientPhone:"",clientAddress:"",clientCity:"",clientPostalCode:"",clientCountry:"Tunisia",productName:"",reason:""}),[l,f]=P.useState([]),[g,w]=P.useState(!1),[x,v]=P.useState(!1),[E,S]=P.useState(""),[I,k]=P.useState(!1);P.useEffect(()=>{const O=localStorage.getItem("lastClientPhone");O&&j(O)},[]);const j=async O=>{v(!0);try{const{data:V}=await ae.from("exchanges").select("*").eq("client_phone",O).order("created_at",{ascending:!1}).limit(1);if(V&&V.length>0){const z=V[0];o({clientName:z.client_name||"",clientPhone:O,clientAddress:z.client_address||"",clientCity:z.client_city||"",clientPostalCode:z.client_postal_code||"",clientCountry:z.client_country||"Tunisia",productName:"",reason:""}),k(!0)}}catch(V){console.error("Error loading previous data:",V)}finally{v(!1)}},M=async O=>{o({...s,clientPhone:O}),O.length>=8&&j(O)},A=O=>{const V=O.target.files;if(V){const z=[];Array.from(V).slice(0,3-l.length).forEach(U=>{const $=new FileReader;$.onloadend=()=>{z.push($.result),z.length===Math.min(V.length,3-l.length)&&f([...l,...z])},$.readAsDataURL(U)})}},C=O=>{f(l.filter((V,z)=>z!==O))},T=async O=>{O.preventDefault(),w(!0),S("");try{const V="11111111-1111-1111-1111-111111111111",{data:z}=await ae.from("exchanges").select("*").eq("exchange_code",r).maybeSingle();if(z){e(`/client/tracking/${r}`);return}const{data:U,error:$}=await ae.from("exchanges").insert({exchange_code:r,merchant_id:V,client_name:s.clientName,client_phone:s.clientPhone,client_address:s.clientAddress,client_city:s.clientCity,client_postal_code:s.clientPostalCode,client_country:s.clientCountry,product_name:s.productName,reason:s.reason,photos:l,status:"pending",payment_status:"pending",payment_amount:0}).select().single();if($)throw $;await ae.from("status_history").insert({exchange_id:U.id,status:"pending"}),localStorage.setItem("lastClientPhone",s.clientPhone),e(`/client/tracking/${r}`)}catch(V){console.error("Error submitting exchange:",V),S("Erreur lors de la soumission. Veuillez ressayer.")}finally{w(!1)}};return u.jsx("div",{className:"min-h-screen bg-slate-50",children:u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("button",{onClick:()=>e("/client/scan"),className:"flex items-center text-slate-600 hover:text-slate-900 mb-6 transition-colors",children:[u.jsx(Zs,{className:"w-5 h-5 mr-2"}),u.jsx("span",{className:"font-medium",children:"Retour"})]}),u.jsxs("div",{className:"max-w-2xl mx-auto",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Demande d'change"}),u.jsx("p",{className:"text-slate-600",children:"Remplissez le formulaire pour soumettre votre demande"})]}),I&&u.jsxs("div",{className:"mb-6 bg-emerald-50 border border-emerald-200 rounded-xl p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 text-emerald-700",children:[u.jsx(ao,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:"Informations retrouves"})]}),u.jsx("p",{className:"text-sm text-emerald-600 mt-1",children:"Vos informations ont t automatiquement remplies depuis votre dernier change"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[E&&u.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:E}),u.jsxs("form",{onSubmit:T,className:"space-y-6",children:[u.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Code d'change"}),u.jsx("input",{type:"text",value:r,disabled:!0,className:"w-full px-4 py-2 bg-white border border-slate-300 rounded-lg text-slate-900 font-mono font-semibold"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Vos informations"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nom complet *"}),u.jsx("input",{type:"text",required:!0,value:s.clientName,onChange:O=>o({...s,clientName:O.target.value}),placeholder:"Votre nom",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Tlphone *"}),u.jsx("input",{type:"tel",required:!0,value:s.clientPhone,onChange:O=>M(O.target.value),placeholder:"+216 XX XXX XXX",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),x&&u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Recherche de vos informations..."})]})]})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(qh,{className:"w-5 h-5 text-emerald-600"}),u.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Adresse de livraison"})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Adresse *"}),u.jsx("input",{type:"text",required:!0,value:s.clientAddress,onChange:O=>o({...s,clientAddress:O.target.value}),placeholder:"Rue, numro, btiment",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Ville *"}),u.jsx("input",{type:"text",required:!0,value:s.clientCity,onChange:O=>o({...s,clientCity:O.target.value}),placeholder:"Ville",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Code postal *"}),u.jsx("input",{type:"text",required:!0,value:s.clientPostalCode,onChange:O=>o({...s,clientPostalCode:O.target.value}),placeholder:"1000",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Pays *"}),u.jsx("input",{type:"text",required:!0,value:s.clientCountry,onChange:O=>o({...s,clientCountry:O.target.value}),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Dtails du produit"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nom du produit *"}),u.jsx("input",{type:"text",required:!0,value:s.productName,onChange:O=>o({...s,productName:O.target.value}),placeholder:"Ex: T-shirt Nike Bleu - Taille M",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Raison de l'change *"}),u.jsxs("select",{required:!0,value:s.reason,onChange:O=>o({...s,reason:O.target.value}),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",children:[u.jsx("option",{value:"",children:"Slectionnez une raison"}),xC.map(O=>u.jsx("option",{value:O,children:O},O))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Photos du produit (1-3) *"}),u.jsx("p",{className:"text-xs text-slate-600 mb-3",children:"Prenez des photos claires du produit et du problme rencontr"}),u.jsxs("div",{className:"space-y-4",children:[l.length<3&&u.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-slate-300 rounded-lg cursor-pointer hover:border-emerald-500 transition-colors",children:[u.jsx(hC,{className:"w-8 h-8 text-slate-400 mb-2"}),u.jsx("span",{className:"text-sm text-slate-500",children:"Cliquez pour ajouter des photos"}),u.jsxs("span",{className:"text-xs text-slate-400",children:[l.length,"/3 photos ajoutes"]}),u.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:A,className:"hidden"})]}),l.length>0&&u.jsx("div",{className:"grid grid-cols-3 gap-4",children:l.map((O,V)=>u.jsxs("div",{className:"relative group",children:[u.jsx("img",{src:O,alt:`Photo ${V+1}`,className:"w-full h-32 object-cover rounded-lg border border-slate-200"}),u.jsx("button",{type:"button",onClick:()=>C(V),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-lg",children:u.jsx(ta,{className:"w-4 h-4"})})]},V))})]})]})]})]}),u.jsx("button",{type:"submit",disabled:g||l.length===0,className:"w-full py-4 bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white rounded-lg font-semibold transition-colors shadow-sm",children:g?"Envoi en cours...":"Soumettre la demande"})]})]})]})]})})}function wC(){const{code:t}=Qi(),e=wt(),[r,s]=P.useState(null),[o,l]=P.useState([]),[f,g]=P.useState(null),[w,x]=P.useState(null),[v,E]=P.useState(!0);P.useEffect(()=>{S()},[t]);const S=async()=>{try{const{data:C}=await ae.from("exchanges").select("*").eq("exchange_code",t).maybeSingle();if(C){s(C);const{data:T}=await ae.from("status_history").select("*").eq("exchange_id",C.id).order("created_at",{ascending:!1});if(l(T||[]),C.mini_depot_id){const{data:O}=await ae.from("mini_depots").select("*").eq("id",C.mini_depot_id).maybeSingle();g(O)}if(C.transporter_id){const{data:O}=await ae.from("transporters").select("*").eq("id",C.transporter_id).maybeSingle();x(O)}}}catch(C){console.error("Error fetching exchange:",C)}finally{E(!1)}},I=()=>{const C=[{key:"pending",label:"Demande soumise",icon:sr},{key:"validated",label:"Valide",icon:wr},{key:"preparing",label:"En prparation",icon:Kt},{key:"in_transit",label:"En transit",icon:Ba},{key:"completed",label:"Livre",icon:ao}],O=["pending","validated","preparing","in_transit","completed"].indexOf(r==null?void 0:r.status);return C.map((V,z)=>({...V,isCompleted:z<=O&&(r==null?void 0:r.status)!=="rejected",isCurrent:z===O&&(r==null?void 0:r.status)!=="rejected",isRejected:(r==null?void 0:r.status)==="rejected"&&z>0}))},k=C=>{switch(C){case"pending":return{color:"bg-amber-50 border-amber-200",textColor:"text-amber-700",icon:sr,message:"Votre demande est en cours d'examen par le marchand",action:"En attente de validation"};case"validated":return{color:"bg-blue-50 border-blue-200",textColor:"text-blue-700",icon:wr,message:"Votre change a t approuv",action:"Prparation en cours"};case"preparing":return{color:"bg-purple-50 border-purple-200",textColor:"text-purple-700",icon:Kt,message:"Votre nouveau produit est en cours de prparation",action:"Sera bientt expdi"};case"in_transit":return{color:"bg-indigo-50 border-indigo-200",textColor:"text-indigo-700",icon:Ba,message:"Votre colis est en route",action:"Livraison en cours"};case"completed":return{color:"bg-emerald-50 border-emerald-200",textColor:"text-emerald-700",icon:wr,message:"Votre change est termin",action:"change complt"};case"rejected":return{color:"bg-red-50 border-red-200",textColor:"text-red-700",icon:ta,message:"Votre demande a t refuse",action:"change refus"};default:return{color:"bg-slate-50 border-slate-200",textColor:"text-slate-700",icon:Nn,message:"",action:""}}};if(v)return u.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})});if(!r)return u.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx(Nn,{className:"w-8 h-8 text-red-600"})}),u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"change non trouv"}),u.jsx("p",{className:"text-slate-600 mb-6",children:"Le code d'change est invalide ou n'existe pas"}),u.jsx("button",{onClick:()=>e("/client/exchanges"),className:"px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors font-medium",children:"Voir mes changes"})]})});const j=k(r.status),M=j.icon,A=I();return u.jsx("div",{className:"min-h-screen bg-slate-50",children:u.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-5xl",children:[u.jsxs("button",{onClick:()=>e("/client/exchanges"),className:"flex items-center text-slate-600 hover:text-slate-900 mb-6 transition-colors",children:[u.jsx(Zs,{className:"w-5 h-5 mr-2"}),u.jsx("span",{className:"font-medium",children:"Retour  mes changes"})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:`rounded-2xl border-2 p-6 ${j.color}`,children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"p-3 rounded-xl bg-white shadow-sm",children:u.jsx(M,{className:`w-8 h-8 ${j.textColor}`})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:j.action}),u.jsx("p",{className:"text-slate-700 text-lg mb-4",children:j.message}),u.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[u.jsx(Xh,{className:"w-4 h-4"}),u.jsxs("span",{children:["Demande cre le ",new Date(r.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})]})]})]})]})}),r.status!=="rejected"&&u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-6",children:"Progression de votre change"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute top-5 left-0 right-0 h-1 bg-slate-200",children:u.jsx("div",{className:"h-full bg-emerald-500 transition-all duration-500",style:{width:`${A.filter(C=>C.isCompleted).length/A.length*100}%`}})}),u.jsx("div",{className:"relative flex justify-between",children:A.map((C,T)=>{const O=C.icon;return u.jsxs("div",{className:"flex flex-col items-center flex-1",children:[u.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all ${C.isCompleted?"bg-emerald-500 border-emerald-500":C.isCurrent?"bg-white border-emerald-500":"bg-white border-slate-300"}`,children:u.jsx(O,{className:`w-5 h-5 ${C.isCompleted?"text-white":C.isCurrent?"text-emerald-500":"text-slate-400"}`})}),u.jsx("div",{className:"mt-3 text-center",children:u.jsx("div",{className:`text-sm font-medium ${C.isCompleted||C.isCurrent?"text-slate-900":"text-slate-500"}`,children:C.label})})]},C.key)})})]})]}),r.status==="rejected"&&r.rejection_reason&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-2xl p-6",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(Nn,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Motif du refus"}),u.jsx("p",{className:"text-red-700",children:r.rejection_reason})]})]})}),u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Dtails de la demande"}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"Code de suivi"}),u.jsx("div",{className:"font-mono font-semibold text-slate-900 text-lg",children:r.exchange_code})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"Nom du client"}),u.jsx("div",{className:"font-medium text-slate-900",children:r.client_name})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"Tlphone"}),u.jsx("div",{className:"font-medium text-slate-900",children:r.client_phone})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"Motif de l'change"}),u.jsx("div",{className:"font-medium text-slate-900",children:r.reason})]})]})]}),(f||w)&&u.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[f&&u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(qh,{className:"w-5 h-5 text-emerald-600"}),u.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Point de retrait"})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500",children:"Nom"}),u.jsx("div",{className:"font-medium text-slate-900",children:f.name})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500",children:"Adresse"}),u.jsx("div",{className:"font-medium text-slate-900",children:f.address}),u.jsx("div",{className:"text-slate-700",children:f.city})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500",children:"Tlphone"}),u.jsxs("a",{href:`tel:${f.phone}`,className:"font-medium text-emerald-600 hover:text-emerald-700 flex items-center gap-1",children:[u.jsx(Fn,{className:"w-4 h-4"}),f.phone]})]})]})]}),w&&u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(Ba,{className:"w-5 h-5 text-emerald-600"}),u.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Transporteur"})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500",children:"Socit"}),u.jsx("div",{className:"font-medium text-slate-900",children:w.name})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500",children:"Contact"}),u.jsxs("a",{href:`tel:${w.phone}`,className:"font-medium text-emerald-600 hover:text-emerald-700 flex items-center gap-1",children:[u.jsx(Fn,{className:"w-4 h-4"}),w.phone]})]})]})]})]}),o.length>0&&u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Historique"}),u.jsx("div",{className:"space-y-4",children:o.map((C,T)=>{const O=k(C.status).icon;return u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("div",{className:`p-2 rounded-lg ${k(C.status).color}`,children:u.jsx(O,{className:"w-4 h-4"})}),T<o.length-1&&u.jsx("div",{className:"w-0.5 flex-1 bg-slate-200 min-h-[24px] my-1"})]}),u.jsxs("div",{className:"flex-1 pb-2",children:[u.jsx("p",{className:"font-medium text-slate-900",children:hs[C.status]}),u.jsx("p",{className:"text-sm text-slate-600",children:new Date(C.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]},C.id)})})]}),u.jsx("div",{className:"bg-gradient-to-br from-emerald-50 to-blue-50 rounded-2xl border border-emerald-200 p-6",children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx(jr,{className:"w-6 h-6 text-emerald-600 flex-shrink-0 mt-1"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"font-semibold text-slate-900 mb-2",children:"Besoin d'aide ?"}),u.jsx("p",{className:"text-slate-700 mb-4",children:"Contactez le marchand via la messagerie pour toute question sur votre change."}),u.jsxs(qt,{to:"/client/chat",className:"inline-flex items-center px-5 py-2.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors font-medium",children:[u.jsx(jr,{className:"w-4 h-4 mr-2"}),"Ouvrir la messagerie"]})]})]})}),r.photos&&r.photos.length>0&&u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Photos du produit"}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:r.photos.map((C,T)=>u.jsx("img",{src:C,alt:`Photo ${T+1}`,className:"w-full h-48 object-cover rounded-xl border border-slate-200"},T))})]})]})]})})}function yC(){wt();const[t,e]=P.useState([]),[r,s]=P.useState(!0),[o,l]=P.useState("all");P.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:v}=await ae.from("exchanges").select("*").order("created_at",{ascending:!1});e(v||[])}catch(v){console.error("Error fetching exchanges:",v)}finally{s(!1)}},g=v=>{switch(v){case"pending":return{color:"bg-amber-50 text-amber-700 border-amber-200",icon:sr,label:"En attente de validation",description:"Le marchand examine votre demande"};case"validated":return{color:"bg-blue-50 text-blue-700 border-blue-200",icon:wr,label:"Valid",description:"Votre change est approuv"};case"preparing":return{color:"bg-purple-50 text-purple-700 border-purple-200",icon:Kt,label:"En prparation",description:"Le nouveau produit est en cours de prparation"};case"in_transit":return{color:"bg-indigo-50 text-indigo-700 border-indigo-200",icon:Ba,label:"En transit",description:"Le colis est en route"};case"completed":return{color:"bg-emerald-50 text-emerald-700 border-emerald-200",icon:wr,label:"Termin",description:"change complt avec succs"};case"rejected":return{color:"bg-red-50 text-red-700 border-red-200",icon:oo,label:"Refus",description:"Le marchand a refus la demande"};default:return{color:"bg-slate-50 text-slate-700 border-slate-200",icon:Nn,label:v,description:""}}},w=t.filter(v=>o==="all"?!0:o==="active"?!["completed","rejected"].includes(v.status):o==="completed"?v.status==="completed":!0),x={total:t.length,active:t.filter(v=>!["completed","rejected"].includes(v.status)).length,completed:t.filter(v=>v.status==="completed").length};return r?u.jsx(Ys,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})})}):u.jsx(Ys,{children:u.jsxs("div",{className:"max-w-5xl mx-auto",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Mes changes"}),u.jsx("p",{className:"text-slate-600",children:"Suivez vos demandes d'change en temps rel"})]}),u.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Total"}),u.jsx("div",{className:"text-2xl font-bold text-slate-900",children:x.total})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"En cours"}),u.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.active})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Termins"}),u.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:x.completed})]})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 mb-6",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Yh,{className:"w-4 h-4 text-slate-500"}),u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Filtrer:"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:()=>l("all"),className:`px-3 py-1 text-sm rounded-lg transition-colors ${o==="all"?"bg-emerald-100 text-emerald-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:["Tous (",x.total,")"]}),u.jsxs("button",{onClick:()=>l("active"),className:`px-3 py-1 text-sm rounded-lg transition-colors ${o==="active"?"bg-emerald-100 text-emerald-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:["En cours (",x.active,")"]}),u.jsxs("button",{onClick:()=>l("completed"),className:`px-3 py-1 text-sm rounded-lg transition-colors ${o==="completed"?"bg-emerald-100 text-emerald-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:["Termins (",x.completed,")"]})]})]})}),t.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12 text-center",children:[u.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx(Kt,{className:"w-8 h-8 text-slate-400"})}),u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Aucun change"}),u.jsx("p",{className:"text-slate-600 mb-6",children:"Vous n'avez pas encore cr de demande d'change"}),u.jsxs(qt,{to:"/client/scan",className:"inline-flex items-center px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors font-medium",children:[u.jsx(Kt,{className:"w-5 h-5 mr-2"}),"Crer un change"]})]}):u.jsx("div",{className:"space-y-3",children:w.map(v=>{const E=g(v.status),S=E.icon,I=Math.floor((Date.now()-new Date(v.created_at).getTime())/(1e3*60*60*24));return u.jsx(qt,{to:`/client/tracking/${v.exchange_code}`,className:"block bg-white rounded-xl shadow-sm border border-slate-200 hover:shadow-md hover:border-emerald-200 transition-all p-5 group",children:u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.jsx("div",{className:`p-2 rounded-lg border ${E.color}`,children:u.jsx(S,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("h3",{className:"font-semibold text-slate-900 text-lg",children:v.exchange_code}),u.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium border ${E.color}`,children:E.label})]}),u.jsx("p",{className:"text-sm text-slate-600",children:E.description})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 pl-14",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Motif"}),u.jsx("div",{className:"text-sm font-medium text-slate-900 truncate",children:v.reason})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Date"}),u.jsx("div",{className:"text-sm font-medium text-slate-900",children:I===0?"Aujourd'hui":I===1?"Hier":`Il y a ${I} jours`})]})]})]}),u.jsx(up,{className:"w-5 h-5 text-slate-400 group-hover:text-emerald-600 transition-colors flex-shrink-0 mt-2"})]})},v.id)})})]})})}function vC(){const{id:t}=Qi(),e=wt(),[r,s]=P.useState(null),[o,l]=P.useState([]),[f,g]=P.useState(""),[w,x]=P.useState(!0);P.useEffect(()=>{v()},[t]);const v=async()=>{try{const{data:S}=await ae.from("exchanges").select("*").eq("id",t).maybeSingle();if(S){s(S);const{data:I}=await ae.from("messages").select("*").eq("exchange_id",t).order("created_at",{ascending:!0});l(I||[])}}catch(S){console.error("Error fetching details:",S)}finally{x(!1)}},E=async S=>{if(S.preventDefault(),!!f.trim())try{await ae.from("messages").insert({exchange_id:t,sender_type:"client",message:f}),g(""),v()}catch(I){console.error("Error sending message:",I)}};return w?u.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):r?u.jsx("div",{className:"min-h-screen bg-slate-50",children:u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("button",{onClick:()=>e("/client/exchanges"),className:"flex items-center text-slate-600 hover:text-slate-900 mb-6",children:[u.jsx(Zs,{className:"w-5 h-5 mr-2"}),"Retour aux changes"]}),u.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Dtails de l'change"}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-slate-600",children:"Code:"}),u.jsx("p",{className:"font-medium text-slate-900",children:r.exchange_code})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-slate-600",children:"Statut:"}),u.jsx("p",{className:"font-medium text-slate-900",children:hs[r.status]})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-slate-600",children:"Client:"}),u.jsx("p",{className:"font-medium text-slate-900",children:r.client_name})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-slate-600",children:"Raison:"}),u.jsx("p",{className:"font-medium text-slate-900",children:r.reason})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:"Messages"}),u.jsx("div",{className:"space-y-4 mb-4 max-h-96 overflow-y-auto",children:o.length===0?u.jsx("p",{className:"text-slate-600 text-center py-8",children:"Aucun message"}):o.map(S=>u.jsxs("div",{className:`p-4 rounded-lg ${S.sender_type==="client"?"bg-emerald-50 ml-auto max-w-md":"bg-slate-100 mr-auto max-w-md"}`,children:[u.jsx("p",{className:"text-sm font-medium text-slate-900 mb-1",children:S.sender_type==="client"?"Vous":"Commerant"}),u.jsx("p",{className:"text-slate-700",children:S.message}),u.jsx("p",{className:"text-xs text-slate-500 mt-2",children:new Date(S.created_at).toLocaleString("fr-FR")})]},S.id))}),u.jsxs("form",{onSubmit:E,className:"flex gap-2",children:[u.jsx("input",{type:"text",value:f,onChange:S=>g(S.target.value),placeholder:"Votre message...",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:u.jsx(ps,{className:"w-5 h-5"})})]})]})]})]})}):u.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"change non trouv"}),u.jsx("button",{onClick:()=>e("/client/exchanges"),className:"px-6 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700",children:"Retour aux changes"})]})})}function bC(){const[t,e]=P.useState([]),[r,s]=P.useState(null),[o,l]=P.useState([]),[f,g]=P.useState(""),[w,x]=P.useState(!0);P.useEffect(()=>{v()},[]),P.useEffect(()=>{r&&E(r.id)},[r]);const v=async()=>{try{const{data:A}=await ae.from("exchanges").select("*, messages(count)").order("created_at",{ascending:!1});A&&(e(A),A.length>0&&!r&&s(A[0]))}catch(A){console.error("Error:",A)}finally{x(!1)}},E=async A=>{try{const{data:C}=await ae.from("messages").select("*").eq("exchange_id",A).order("created_at",{ascending:!0});l(C||[])}catch(C){console.error("Error:",C)}},S=async A=>{if(A.preventDefault(),!(!f.trim()||!r))try{const{error:C}=await ae.from("messages").insert({exchange_id:r.id,sender_type:"client",message:f});C||(g(""),E(r.id))}catch(C){console.error("Error:",C)}},I=A=>new Date(A).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),k=A=>{const C=new Date(A),T=new Date,O=new Date(T);return O.setDate(O.getDate()-1),C.toDateString()===T.toDateString()?"Aujourd'hui":C.toDateString()===O.toDateString()?"Hier":C.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})},j=A=>{switch(A){case"pending":return"bg-yellow-100 text-yellow-800";case"validated":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"completed":return"bg-blue-100 text-blue-800";case"in_transit":return"bg-purple-100 text-purple-800";case"at_depot":return"bg-orange-100 text-orange-800";default:return"bg-slate-100 text-slate-800"}},M=A=>{switch(A){case"pending":return"En attente";case"validated":return"Valid";case"rejected":return"Rejet";case"completed":return"Complt";case"in_transit":return"En transit";case"at_depot":return"Au dpt";default:return A}};return w?u.jsx(Ys,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"text-slate-600",children:"Chargement..."})})}):u.jsxs(Ys,{children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Messagerie"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Communiquez avec le marchand"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-[calc(100vh-200px)] flex overflow-hidden",children:[u.jsxs("div",{className:"w-1/3 border-r border-slate-200 flex flex-col",children:[u.jsx("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:u.jsx("h3",{className:"font-semibold text-slate-900",children:"Mes changes"})}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:t.length===0?u.jsxs("div",{className:"p-8 text-center text-slate-500",children:[u.jsx(Kt,{className:"w-12 h-12 mx-auto mb-3 text-slate-300"}),u.jsx("p",{children:"Aucun change"})]}):t.map(A=>{var C,T;return u.jsxs("div",{onClick:()=>s(A),className:`p-4 border-b border-slate-100 cursor-pointer transition-colors ${(r==null?void 0:r.id)===A.id?"bg-blue-50 border-l-4 border-l-blue-500":"hover:bg-slate-50"}`,children:[u.jsxs("div",{className:"flex items-start justify-between mb-1",children:[u.jsx("h3",{className:"font-semibold text-slate-900",children:A.exchange_code}),u.jsx("span",{className:"text-xs text-slate-500",children:k(A.created_at)})]}),u.jsx("p",{className:"text-sm text-slate-600 mb-2 truncate",children:A.reason}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${j(A.status)}`,children:M(A.status)}),((T=(C=A.messages)==null?void 0:C[0])==null?void 0:T.count)>0&&u.jsxs("span",{className:"text-xs text-slate-500",children:[A.messages[0].count," msg"]})]})]},A.id)})})]}),u.jsx("div",{className:"flex-1 flex flex-col",children:r?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"font-bold text-slate-900",children:r.exchange_code}),u.jsx("p",{className:"text-sm text-slate-600",children:r.reason})]}),u.jsx("span",{className:`text-sm px-3 py-1 rounded-full ${j(r.status)}`,children:M(r.status)})]})}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:o.length===0?u.jsxs("div",{className:"text-center text-slate-500 py-12",children:[u.jsx(jr,{className:"w-16 h-16 mx-auto mb-4 text-slate-300"}),u.jsx("p",{className:"text-lg font-medium",children:"Aucun message"}),u.jsx("p",{className:"text-sm",children:"Dmarrez la conversation avec le marchand"})]}):o.map(A=>u.jsx("div",{className:`flex ${A.sender_type==="client"?"justify-end":"justify-start"}`,children:u.jsxs("div",{className:`max-w-[70%] ${A.sender_type==="client"?"bg-blue-500 text-white":"bg-slate-100 text-slate-900"} rounded-2xl px-4 py-2`,children:[A.sender_type==="merchant"&&u.jsx("p",{className:"text-xs font-semibold mb-1 opacity-75",children:"Marchand"}),u.jsx("p",{className:"text-sm",children:A.message}),u.jsxs("div",{className:`flex items-center gap-1 mt-1 ${A.sender_type==="client"?"text-blue-100":"text-slate-500"}`,children:[u.jsx(sr,{className:"w-3 h-3"}),u.jsx("span",{className:"text-xs",children:I(A.created_at)})]})]})},A.id))}),u.jsx("form",{onSubmit:S,className:"p-4 border-t border-slate-200 bg-slate-50",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",placeholder:"Tapez votre message...",value:f,onChange:A=>g(A.target.value),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),u.jsxs("button",{type:"submit",disabled:!f.trim(),className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[u.jsx(ps,{className:"w-4 h-4"}),"Envoyer"]})]})})]}):u.jsx("div",{className:"flex-1 flex items-center justify-center text-slate-500",children:u.jsxs("div",{className:"text-center",children:[u.jsx(jr,{className:"w-16 h-16 mx-auto mb-4 text-slate-300"}),u.jsx("p",{className:"text-lg",children:"Slectionnez un change"})]})})})]})]})}const EC={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};function Zl({rating:t,onRatingChange:e,readonly:r=!1,size:s="md"}){const[o,l]=P.useState(0),f=v=>{!r&&e&&e(v)},g=v=>{r||l(v)},w=()=>{r||l(0)},x=o||t;return u.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(v=>u.jsx("button",{type:"button",onClick:()=>f(v),onMouseEnter:()=>g(v),onMouseLeave:w,disabled:r,className:`${r?"cursor-default":"cursor-pointer hover:scale-110"} transition-transform`,children:u.jsx(fs,{className:`${EC[s]} ${v<=x?"fill-amber-400 text-amber-400":"fill-none text-slate-300"} transition-colors`})},v))})}function CC(){const[t]=Zg(),e=wt(),r=t.get("code")||"",[s,o]=P.useState({clientName:"",clientPhone:"",rating:0,comment:""}),[l,f]=P.useState(!1),[g,w]=P.useState(!1),[x,v]=P.useState(""),[E,S]=P.useState(!1),[I,k]=P.useState(!1);P.useEffect(()=>{const C=localStorage.getItem("lastClientPhone");C&&j(C)},[]);const j=async C=>{w(!0);try{const{data:T}=await ae.from("exchanges").select("*").eq("client_phone",C).order("created_at",{ascending:!1}).limit(1);if(T&&T.length>0){const O=T[0];o(V=>({...V,clientName:O.client_name||"",clientPhone:C})),k(!0)}}catch(T){console.error("Error loading previous data:",T)}finally{w(!1)}},M=async C=>{o({...s,clientPhone:C}),C.length>=8&&j(C)},A=async C=>{if(C.preventDefault(),s.rating===0){v("Veuillez slectionner une note");return}f(!0),v("");try{const T="11111111-1111-1111-1111-111111111111",{error:O}=await ae.from("reviews").insert({exchange_code:r||null,merchant_id:T,client_name:s.clientName,client_phone:s.clientPhone,rating:s.rating,comment:s.comment||null,is_published:!0});if(O)throw O;localStorage.setItem("lastClientPhone",s.clientPhone),S(!0)}catch(T){console.error("Error submitting review:",T),v("Erreur lors de la soumission. Veuillez ressayer.")}finally{f(!1)}};return E?u.jsx(Ys,{children:u.jsx("div",{className:"max-w-2xl mx-auto",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-emerald-100 rounded-full mb-4",children:u.jsx(ao,{className:"w-8 h-8 text-emerald-600"})}),u.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Merci pour votre avis !"}),u.jsx("p",{className:"text-slate-600 mb-6",children:"Votre retour nous aide a ameliorer nos services."}),u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx(Zl,{rating:s.rating,readonly:!0,size:"lg"})}),u.jsx("button",{onClick:()=>e("/"),className:"px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:"Retour a l'accueil"})]})})}):u.jsx(Ys,{children:u.jsxs("div",{className:"max-w-2xl mx-auto",children:[u.jsxs("button",{onClick:()=>e("/client/scan"),className:"flex items-center text-slate-600 hover:text-slate-900 mb-6 transition-colors",children:[u.jsx(Zs,{className:"w-5 h-5 mr-2"}),u.jsx("span",{className:"font-medium",children:"Retour"})]}),u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-amber-100 rounded-full mb-4",children:u.jsx(fs,{className:"w-8 h-8 text-amber-600"})}),u.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Laisser un avis"}),u.jsx("p",{className:"text-slate-600",children:"Partagez votre experience avec le marchand"})]}),I&&u.jsxs("div",{className:"mb-6 bg-emerald-50 border border-emerald-200 rounded-xl p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 text-emerald-700",children:[u.jsx(ao,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:"Informations retrouvees"})]}),u.jsx("p",{className:"text-sm text-emerald-600 mt-1",children:"Vos informations ont ete automatiquement remplies"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[x&&u.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:x}),u.jsxs("form",{onSubmit:A,className:"space-y-6",children:[r&&u.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Code d'echange"}),u.jsx("input",{type:"text",value:r,disabled:!0,className:"w-full px-4 py-2 bg-white border border-slate-300 rounded-lg text-slate-900 font-mono font-semibold"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Vos informations"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nom complet *"}),u.jsx("input",{type:"text",required:!0,value:s.clientName,onChange:C=>o({...s,clientName:C.target.value}),placeholder:"Votre nom",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Telephone *"}),u.jsx("input",{type:"tel",required:!0,value:s.clientPhone,onChange:C=>M(C.target.value),placeholder:"+216 XX XXX XXX",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"}),g&&u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Recherche de vos informations..."})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Votre avis"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"Note *"}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Zl,{rating:s.rating,onRatingChange:C=>o({...s,rating:C}),size:"lg"}),s.rating>0&&u.jsxs("span",{className:"text-lg font-semibold text-amber-600",children:[s.rating,"/5"]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Commentaire (optionnel)"}),u.jsx("textarea",{value:s.comment,onChange:C=>o({...s,comment:C.target.value}),placeholder:"Decrivez votre experience...",rows:4,maxLength:500,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 resize-none"}),u.jsxs("p",{className:"text-xs text-slate-500 mt-1 text-right",children:[s.comment.length,"/500 caracteres"]})]})]})]}),u.jsxs("button",{type:"submit",disabled:l||s.rating===0,className:"w-full flex items-center justify-center gap-2 py-4 bg-amber-500 hover:bg-amber-600 disabled:bg-slate-300 disabled:cursor-not-allowed text-white rounded-lg font-semibold transition-colors shadow-sm",children:[u.jsx(ps,{className:"w-5 h-5"}),l?"Envoi en cours...":"Envoyer mon avis"]})]})]})]})})}function NC(){const{roomId:t}=Qi(),e=wt(),[r,s]=P.useState(null),[o,l]=P.useState(!0),[f,g]=P.useState(""),[w,x]=P.useState(!1),[v,E]=P.useState(!1),[S,I]=P.useState(300),[k,j]=P.useState(!0),[M,A]=P.useState(!0),[C,T]=P.useState(!1);P.useEffect(()=>{O()},[t]),P.useEffect(()=>{let $;return v&&S>0&&($=setInterval(()=>{I(G=>G<=1?(z(),0):G-1)},1e3)),()=>clearInterval($)},[v,S]);const O=async()=>{try{const{data:$,error:G}=await ae.from("video_calls").select("*").eq("room_id",t).single();if(G)throw G;if(!$){g("Appel video non trouve");return}if($.status==="completed"||$.status==="expired"||$.status==="cancelled"){g("Cet appel video n'est plus disponible");return}s($)}catch($){console.error("Error fetching video call:",$),g("Erreur lors du chargement de l'appel")}finally{l(!1)}},V=async()=>{if(r)try{await ae.from("video_calls").update({status:"active",started_at:new Date().toISOString(),recording_consent:w}).eq("id",r.id),E(!0)}catch($){console.error("Error joining call:",$)}},z=async()=>{if(!r)return;const $=300-S;try{await ae.from("video_calls").update({status:"completed",ended_at:new Date().toISOString(),duration_seconds:$}).eq("id",r.id),T(!0),E(!1)}catch(G){console.error("Error ending call:",G)}},U=$=>{const G=Math.floor($/60),te=$%60;return`${G}:${te.toString().padStart(2,"0")}`};return o?u.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}):f?u.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-8 text-center",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4",children:u.jsx(Nn,{className:"w-8 h-8 text-red-600"})}),u.jsx("h1",{className:"text-xl font-bold text-slate-900 mb-2",children:"Appel non disponible"}),u.jsx("p",{className:"text-slate-600 mb-6",children:f}),u.jsx("button",{onClick:()=>e("/"),className:"px-6 py-3 bg-slate-900 hover:bg-slate-800 text-white rounded-lg font-medium transition-colors",children:"Retour a l'accueil"})]})}):C?u.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-8 text-center",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-emerald-100 rounded-full mb-4",children:u.jsx(wr,{className:"w-8 h-8 text-emerald-600"})}),u.jsx("h1",{className:"text-xl font-bold text-slate-900 mb-2",children:"Appel termine"}),u.jsx("p",{className:"text-slate-600 mb-6",children:"Merci d'avoir participe a cet appel video."}),u.jsx("button",{onClick:()=>e("/"),className:"px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:"Retour a l'accueil"})]})}):v?u.jsxs("div",{className:"min-h-screen bg-slate-900 flex flex-col",children:[u.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:`w-3 h-3 rounded-full ${S<=60?"bg-red-500 animate-pulse":"bg-emerald-500"}`}),u.jsx("span",{className:"text-white font-medium",children:"Appel en cours"})]}),u.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${S<=60?"bg-red-600":"bg-slate-700"}`,children:[u.jsx(sr,{className:"w-4 h-4 text-white"}),u.jsx("span",{className:"text-white font-mono",children:U(S)})]})]}),u.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:u.jsx("div",{className:"bg-slate-800 rounded-2xl w-full max-w-4xl aspect-video flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(rr,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),u.jsx("p",{className:"text-slate-400 text-lg",children:"Zone video"}),u.jsx("p",{className:"text-slate-500 text-sm mt-2",children:"Votre implementation WebRTC sera integree ici"})]})})}),u.jsx("div",{className:"bg-slate-800 px-4 py-6",children:u.jsxs("div",{className:"flex items-center justify-center gap-4",children:[u.jsx("button",{onClick:()=>A(!M),className:`p-4 rounded-full transition-colors ${M?"bg-slate-700 hover:bg-slate-600":"bg-red-600 hover:bg-red-700"}`,children:M?u.jsx(gp,{className:"w-6 h-6 text-white"}):u.jsx(mp,{className:"w-6 h-6 text-white"})}),u.jsx("button",{onClick:()=>j(!k),className:`p-4 rounded-full transition-colors ${k?"bg-slate-700 hover:bg-slate-600":"bg-red-600 hover:bg-red-700"}`,children:k?u.jsx(rr,{className:"w-6 h-6 text-white"}):u.jsx(xp,{className:"w-6 h-6 text-white"})}),u.jsx("button",{onClick:z,className:"p-4 bg-red-600 hover:bg-red-700 rounded-full transition-colors",children:u.jsx(Fn,{className:"w-6 h-6 text-white rotate-[135deg]"})})]})})]}):u.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-8",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-sky-100 rounded-full mb-4",children:u.jsx(rr,{className:"w-8 h-8 text-sky-600"})}),u.jsx("h1",{className:"text-xl font-bold text-slate-900 mb-2",children:"Rejoindre l'appel video"}),u.jsx("p",{className:"text-slate-600",children:"Vous etes invite a un appel video avec le marchand"})]}),u.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx(sr,{className:"w-5 h-5 text-amber-600"}),u.jsx("span",{className:"font-medium text-slate-900",children:"Duree maximale: 5 minutes"})]}),u.jsx("p",{className:"text-sm text-slate-600",children:"L'appel se terminera automatiquement apres 5 minutes"})]}),u.jsx("div",{className:"mb-6",children:u.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:w,onChange:$=>x($.target.checked),className:"mt-1 w-4 h-4 text-sky-600 border-slate-300 rounded focus:ring-sky-500"}),u.jsx("span",{className:"text-sm text-slate-700",children:"J'accepte que cet appel puisse etre enregistre a des fins de qualite de service"})]})}),u.jsxs("button",{onClick:V,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold transition-colors",children:[u.jsx(rr,{className:"w-5 h-5"}),"Rejoindre l'appel"]})]})})}function _C(){const t=wt(),[e,r]=P.useState(""),[s,o]=P.useState(""),[l,f]=P.useState(!1),[g,w]=P.useState(""),x=async E=>{E.preventDefault(),f(!0),w("");try{const{data:S,error:I}=await ae.auth.signInWithPassword({email:e,password:s});if(I)throw I;S.user&&t("/merchant/dashboard")}catch(S){w(S.message||"Erreur de connexion")}finally{f(!1)}},v=async()=>{r("demo@merchant.com"),o("demo123456"),f(!0),w("");try{let{data:E,error:S}=await ae.auth.signInWithPassword({email:"demo@merchant.com",password:"demo123456"});if(S&&S.message.includes("Invalid login credentials")){const{data:I,error:k}=await ae.auth.signUp({email:"demo@merchant.com",password:"demo123456",options:{data:{name:"Boutique Demo",phone:"+216 70 000 000"}}});if(k)throw k;if(I.user){const j="11111111-1111-1111-1111-111111111111",{error:M}=await ae.from("merchants").update({id:I.user.id}).eq("id",j);M&&await ae.from("merchants").insert({id:I.user.id,email:"demo@merchant.com",name:"Boutique Demo",phone:"+216 70 000 000"}),t("/merchant/dashboard");return}}else if(S)throw S;E!=null&&E.user&&t("/merchant/dashboard")}catch(E){w(E.message||"Erreur de connexion. Veuillez crer le compte via Supabase Dashboard.")}finally{f(!1)}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 via-white to-emerald-50",children:u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("button",{onClick:()=>t("/"),className:"flex items-center text-slate-600 hover:text-slate-900 mb-6",children:[u.jsx(Zs,{className:"w-5 h-5 mr-2"}),"Retour  l'accueil"]}),u.jsxs("div",{className:"max-w-md mx-auto",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-sky-100 rounded-full mb-4",children:u.jsx(Qh,{className:"w-8 h-8 text-sky-600"})}),u.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Connexion E-Commerant"}),u.jsx("p",{className:"text-slate-600",children:"Accdez  votre tableau de bord"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[g&&u.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:g}),u.jsxs("form",{onSubmit:x,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",required:!0,value:e,onChange:E=>r(E.target.value),placeholder:"votre@email.com",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Mot de passe"}),u.jsx("input",{type:"password",required:!0,value:s,onChange:E=>o(E.target.value),placeholder:"",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"})]}),u.jsx("button",{type:"submit",disabled:l,className:"w-full py-3 bg-sky-600 hover:bg-sky-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors",children:l?"Connexion...":"Se connecter"})]}),u.jsxs("div",{className:"mt-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-0 flex items-center",children:u.jsx("div",{className:"w-full border-t border-slate-300"})}),u.jsx("div",{className:"relative flex justify-center text-sm",children:u.jsx("span",{className:"px-2 bg-white text-slate-500",children:"ou"})})]}),u.jsx("button",{onClick:v,disabled:l,className:"w-full mt-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-medium transition-colors",children:"Connexion Demo"})]}),u.jsxs("div",{className:"mt-6 p-4 bg-sky-50 rounded-lg",children:[u.jsx("p",{className:"text-sm text-sky-800 font-medium mb-2",children:"Compte de dmonstration:"}),u.jsxs("p",{className:"text-xs text-sky-700",children:["Email: demo@merchant.com",u.jsx("br",{}),"Mot de passe: demo123456"]})]})]})]})]})})}const SC=[{path:"/merchant/dashboard",icon:iC,label:"Dashboard"},{path:"/merchant/exchanges",icon:Kt,label:"changes"},{path:"/merchant/clients",icon:Ql,label:"Clients"},{path:"/merchant/reviews",icon:fs,label:"Avis Clients"},{path:"/merchant/video-calls",icon:rr,label:"Appels Video"},{path:"/merchant/chat",icon:jr,label:"Messagerie"},{path:"/merchant/simulation",icon:dC,label:"Simulation"}];function AC(){const t=un(),e=wt(),[r,s]=P.useState(!1),o=async()=>{await ae.auth.signOut(),e("/merchant/login")};return u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>s(!r),className:"lg:hidden fixed top-4 left-4 z-50 p-2 bg-white rounded-lg shadow-lg",children:r?u.jsx(ta,{className:"w-6 h-6"}):u.jsx(fp,{className:"w-6 h-6"})}),u.jsx("aside",{className:`fixed left-0 top-0 h-full bg-white border-r border-slate-200 z-40 transition-transform duration-300 ${r?"translate-x-0":"-translate-x-full"} lg:translate-x-0 w-64`,children:u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx("div",{className:"p-6 border-b border-slate-200",children:u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-10 h-10 bg-sky-100 rounded-lg flex items-center justify-center",children:u.jsx(Qh,{className:"w-6 h-6 text-sky-600"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"font-semibold text-slate-900",children:"E-Commerant"}),u.jsx("p",{className:"text-xs text-slate-500",children:"Espace Pro"})]})]})}),u.jsx("nav",{className:"flex-1 p-4",children:u.jsx("ul",{className:"space-y-2",children:SC.map(l=>{const f=l.icon,g=t.pathname===l.path;return u.jsx("li",{children:u.jsxs(qt,{to:l.path,onClick:()=>s(!1),className:`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${g?"bg-sky-50 text-sky-600":"text-slate-600 hover:bg-slate-50"}`,children:[u.jsx(f,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:l.label})]})},l.path)})})}),u.jsx("div",{className:"p-4 border-t border-slate-200",children:u.jsxs("button",{onClick:o,className:"flex items-center space-x-3 px-4 py-3 rounded-lg text-slate-600 hover:bg-red-50 hover:text-red-600 w-full transition-colors",children:[u.jsx(oC,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:"Dconnexion"})]})})]})}),r&&u.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30",onClick:()=>s(!1)})]})}function at({children:t}){return u.jsxs("div",{className:"flex min-h-screen bg-slate-50",children:[u.jsx(AC,{}),u.jsx("main",{className:"flex-1 lg:ml-64",children:u.jsx("div",{className:"p-6 lg:p-8",children:t})})]})}function IC(){const t=wt(),[e,r]=P.useState({total:0,pending:0,validated:0,rejected:0,completed:0,validationRate:0}),[s,o]=P.useState([]),[l,f]=P.useState(!0);P.useEffect(()=>{g(),w()},[]);const g=async()=>{const{data:{session:x}}=await ae.auth.getSession();x||t("/merchant/login")},w=async()=>{try{const{data:x}=await ae.from("exchanges").select("*");if(x){const v=x.length,E=x.filter(C=>C.status==="pending").length,S=x.filter(C=>C.status==="validated"||C.status==="preparing"||C.status==="in_transit"||C.status==="completed").length,I=x.filter(C=>C.status==="rejected").length,k=x.filter(C=>C.status==="completed").length,j=v>0?Math.round(S/v*100):0;r({total:v,pending:E,validated:S,rejected:I,completed:k,validationRate:j});const M={};x.forEach(C=>{M[C.reason]=(M[C.reason]||0)+1});const A=Object.entries(M).map(([C,T])=>({reason:C,count:T})).sort((C,T)=>T.count-C.count).slice(0,5);o(A)}}catch(x){console.error("Error fetching stats:",x)}finally{f(!1)}};return l?u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):u.jsx(at,{children:u.jsxs("div",{children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Vue d'ensemble"}),u.jsx("p",{className:"text-slate-600",children:"Statistiques et mtriques de vos changes"})]}),u.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:u.jsx(Kt,{className:"w-6 h-6 text-blue-600"})}),u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:e.total})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"Total des changes"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:u.jsx(sr,{className:"w-6 h-6 text-yellow-600"})}),u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:e.pending})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"En attente"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:u.jsx(wr,{className:"w-6 h-6 text-emerald-600"})}),u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:e.validated})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"Valids"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:u.jsx(oo,{className:"w-6 h-6 text-red-600"})}),u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:e.rejected})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"Rejets"})]})]}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Taux de validation"}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"flex-1",children:u.jsx("div",{className:"w-full bg-slate-200 rounded-full h-4",children:u.jsx("div",{className:"bg-emerald-600 h-4 rounded-full transition-all",style:{width:`${e.validationRate}%`}})})}),u.jsxs("span",{className:"text-2xl font-bold text-slate-900",children:[e.validationRate,"%"]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"changes complts"}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(wr,{className:"w-12 h-12 text-green-600"}),u.jsx("span",{className:"text-3xl font-bold text-slate-900",children:e.completed})]})]})]}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[u.jsx(Kl,{className:"w-5 h-5"}),"Raisons d'change principales"]}),s.length>0?u.jsx("div",{className:"space-y-3",children:s.map((x,v)=>u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[u.jsx("span",{className:"text-slate-700",children:x.reason}),u.jsx("span",{className:"font-medium text-slate-900",children:x.count})]}),u.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:u.jsx("div",{className:"bg-sky-600 h-2 rounded-full",style:{width:`${x.count/e.total*100}%`}})})]},v))}):u.jsx("p",{className:"text-slate-600 text-center py-8",children:"Aucune donne disponible"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Accs rapide"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs(qt,{to:"/merchant/exchanges",className:"flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors",children:[u.jsx(Kt,{className:"w-5 h-5 text-slate-600"}),u.jsx("span",{className:"font-medium text-slate-900",children:"Grer les changes"})]}),u.jsxs(qt,{to:"/merchant/clients",className:"flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors",children:[u.jsx(Ql,{className:"w-5 h-5 text-slate-600"}),u.jsx("span",{className:"font-medium text-slate-900",children:"Voir les clients"})]}),u.jsxs(qt,{to:"/merchant/simulation",className:"flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors",children:[u.jsx(Kl,{className:"w-5 h-5 text-slate-600"}),u.jsx("span",{className:"font-medium text-slate-900",children:"Mode simulation"})]})]})]})]})]})})}function TC(){wt();const[t,e]=P.useState([]),[r,s]=P.useState([]),[o,l]=P.useState(""),[f,g]=P.useState("all"),[w,x]=P.useState(!0);P.useEffect(()=>{v()},[]),P.useEffect(()=>{E()},[t,o,f]);const v=async()=>{try{const{data:I}=await ae.from("exchanges").select("*").order("created_at",{ascending:!1});e(I||[])}catch(I){console.error("Error fetching exchanges:",I)}finally{x(!1)}},E=()=>{let I=[...t];f!=="all"&&(I=I.filter(k=>k.status===f)),o&&(I=I.filter(k=>k.client_name.toLowerCase().includes(o.toLowerCase())||k.client_phone.includes(o)||k.exchange_code.toLowerCase().includes(o.toLowerCase()))),s(I)},S=I=>{switch(I){case"pending":return"bg-yellow-100 text-yellow-800";case"validated":return"bg-emerald-100 text-emerald-800";case"rejected":return"bg-red-100 text-red-800";case"completed":return"bg-green-100 text-green-800";default:return"bg-blue-100 text-blue-800"}};return w?u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):u.jsx(at,{children:u.jsxs("div",{children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Demandes d'change"}),u.jsx("p",{className:"text-slate-600",children:"Grez et validez les demandes de vos clients"})]}),u.jsx("div",{className:"bg-white rounded-xl shadow p-6 mb-6",children:u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(po,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),u.jsx("input",{type:"text",placeholder:"Rechercher par nom, tlphone ou code...",value:o,onChange:I=>l(I.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Yh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),u.jsxs("select",{value:f,onChange:I=>g(I.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[u.jsx("option",{value:"all",children:"Tous les statuts"}),u.jsx("option",{value:"pending",children:"En attente"}),u.jsx("option",{value:"validated",children:"Valid"}),u.jsx("option",{value:"preparing",children:"En prparation"}),u.jsx("option",{value:"in_transit",children:"En route"}),u.jsx("option",{value:"completed",children:"Complt"}),u.jsx("option",{value:"rejected",children:"Rejet"})]})]})]})}),r.length===0?u.jsx("div",{className:"bg-white rounded-xl shadow p-12 text-center",children:u.jsx("p",{className:"text-slate-600",children:"Aucun change trouv"})}):u.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Code"}),u.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Client"}),u.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Tlphone"}),u.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Raison"}),u.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Date"}),u.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Statut"}),u.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-700",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-slate-200",children:r.map(I=>u.jsxs("tr",{className:"hover:bg-slate-50",children:[u.jsx("td",{className:"px-6 py-4 text-sm font-medium text-slate-900",children:I.exchange_code}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:I.client_name}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:I.client_phone}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:I.reason}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:new Date(I.created_at).toLocaleDateString("fr-FR")}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-3 py-1 rounded-full text-xs ${S(I.status)}`,children:hs[I.status]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx(qt,{to:`/merchant/exchange/${I.id}`,className:"text-sky-600 hover:text-sky-700 text-sm font-medium",children:"Voir dtails"})})]},I.id))})]})})]})})}async function jC(t){const{clientPhone:e,clientName:r,videoCallLink:s,videoCallId:o}=t,l=`Bonjour ${r}, vous etes invite a un appel video.
Lien: ${s}
Duree max: 5 minutes. L'appel peut etre enregistre.`;console.log("=".repeat(50)),console.log("[SMS SIMULATION]"),console.log("=".repeat(50)),console.log(`To: ${e}`),console.log("Message:"),console.log(l),console.log("=".repeat(50));try{const{data:f,error:g}=await ae.from("sms_logs").insert({video_call_id:o,recipient_phone:e,message_content:l,status:"sent",sent_at:new Date().toISOString()}).select().single();return g?(console.error("Error saving SMS log:",g),{success:!1,message:"Erreur lors de l'envoi du SMS"}):(await ae.from("video_calls").update({sms_sent_at:new Date().toISOString()}).eq("id",o),{success:!0,message:"SMS envoye avec succes (simulation)",smsLogId:f==null?void 0:f.id})}catch(f){return console.error("SMS service error:",f),{success:!1,message:"Erreur technique lors de l'envoi"}}}function RC(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`room-${t}-${e}`}function OC(t){return`${typeof window<"u"?window.location.origin:"http://localhost:5173"}/call/${t}`}function kC({isOpen:t,onClose:e,clientName:r,clientPhone:s,exchangeId:o,onSuccess:l}){const[f,g]=P.useState(!1),[w,x]=P.useState(""),[v,E]=P.useState(!1),[S,I]=P.useState("");if(!t)return null;const k=async()=>{g(!0),x("");try{const M="11111111-1111-1111-1111-111111111111",A=RC(),C=OC(A),{data:T,error:O}=await ae.from("video_calls").insert({exchange_id:o||null,merchant_id:M,client_phone:s,client_name:r,room_id:A,status:"pending",max_duration_seconds:300,recording_consent:!1}).select().single();if(O)throw O;const V=await jC({clientPhone:s,clientName:r,videoCallLink:C,videoCallId:T.id});if(!V.success)throw new Error(V.message);I(C),E(!0),l&&l(T.id,A)}catch(M){console.error("Error sending invite:",M),x(M.message||"Erreur lors de l'envoi de l'invitation")}finally{g(!1)}},j=()=>{E(!1),x(""),I(""),e()};return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-sky-100 rounded-lg",children:u.jsx(rr,{className:"w-6 h-6 text-sky-600"})}),u.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Inviter a un appel video"})]}),u.jsx("button",{onClick:j,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:u.jsx(ta,{className:"w-5 h-5 text-slate-500"})})]}),v?u.jsxs("div",{className:"text-center py-6",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-emerald-100 rounded-full mb-4",children:u.jsx(ps,{className:"w-8 h-8 text-emerald-600"})}),u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Invitation envoyee !"}),u.jsxs("p",{className:"text-slate-600 mb-4",children:["Un SMS a ete envoye a ",r]}),u.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 mb-4",children:[u.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Lien de l'appel:"}),u.jsx("p",{className:"text-sm font-mono text-sky-600 break-all",children:S})]}),u.jsx("p",{className:"text-xs text-slate-500 mb-6",children:"Consultez la console du navigateur pour voir le SMS simule"}),u.jsx("button",{onClick:j,className:"px-6 py-2 bg-sky-600 hover:bg-sky-700 text-white rounded-lg font-medium transition-colors",children:"Fermer"})]}):u.jsxs(u.Fragment,{children:[w&&u.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[u.jsx(Nn,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),u.jsx("p",{className:"text-red-700 text-sm",children:w})]}),u.jsxs("div",{className:"space-y-4 mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-lg",children:[u.jsx(Gi,{className:"w-5 h-5 text-slate-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-slate-500",children:"Client"}),u.jsx("p",{className:"font-medium text-slate-900",children:r})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-lg",children:[u.jsx(Fn,{className:"w-5 h-5 text-slate-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-slate-500",children:"Telephone"}),u.jsx("p",{className:"font-medium text-slate-900",children:s})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-4 bg-amber-50 rounded-lg border border-amber-200",children:[u.jsx(sr,{className:"w-5 h-5 text-amber-600"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-amber-600",children:"Duree maximale"}),u.jsx("p",{className:"font-medium text-amber-700",children:"5 minutes"})]})]})]}),u.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Un SMS sera envoye au client avec un lien pour rejoindre l'appel video. L'appel peut etre enregistre avec le consentement du client."}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:j,className:"flex-1 px-6 py-3 border border-slate-300 hover:bg-slate-50 text-slate-700 rounded-lg font-medium transition-colors",children:"Annuler"}),u.jsxs("button",{onClick:k,disabled:f,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-sky-600 hover:bg-sky-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors",children:[u.jsx(ps,{className:"w-5 h-5"}),f?"Envoi...":"Envoyer SMS"]})]})]})]})})})}function MC(){const{id:t}=Qi(),e=wt(),[r,s]=P.useState(null),[o,l]=P.useState([]),[f,g]=P.useState([]),[w,x]=P.useState([]),[v,E]=P.useState([]),[S,I]=P.useState([]),[k,j]=P.useState(""),[M,A]=P.useState(!1),[C,T]=P.useState(!1),[O,V]=P.useState(""),[z,U]=P.useState(""),[$,G]=P.useState("0"),[te,be]=P.useState("free"),[ue,Ne]=P.useState(""),[We,Y]=P.useState(!0),[Ye,Ee]=P.useState(!1);P.useEffect(()=>{ie()},[t]);const ie=async()=>{try{const[Q,se,Mr,Ue]=await Promise.all([ae.from("exchanges").select("*").eq("id",t).maybeSingle(),ae.from("messages").select("*").eq("exchange_id",t).order("created_at",{ascending:!0}),ae.from("transporters").select("*"),ae.from("mini_depots").select("*")]);if(Q.data){s(Q.data);const[Gr,Es]=await Promise.all([ae.from("exchanges").select("*").eq("client_phone",Q.data.client_phone).neq("id",t).order("created_at",{ascending:!1}).limit(5),ae.from("delivery_attempts").select("*").eq("exchange_id",t).order("attempt_number",{ascending:!0})]);E(Gr.data||[]),I(Es.data||[])}l(se.data||[]),g(Mr.data||[]),x(Ue.data||[])}catch(Q){console.error("Error fetching data:",Q)}finally{Y(!1)}},xe=async Q=>{if(Q.preventDefault(),!!k.trim())try{await ae.from("messages").insert({exchange_id:t,sender_type:"merchant",message:k}),j(""),ie()}catch(se){console.error("Error sending message:",se)}},ye=async()=>{if(!O||!z){alert("Veuillez slectionner un transporteur et un mini-dpt");return}const Q=te==="free"?0:parseFloat($);try{await ae.from("exchanges").update({status:"validated",transporter_id:O,mini_depot_id:z,payment_amount:Q,payment_status:te==="free"?"free":"pending",updated_at:new Date().toISOString()}).eq("id",t),await ae.from("status_history").insert({exchange_id:t,status:"validated"});const se=te==="free"?"Votre change a t valid. Aucun paiement supplmentaire requis.":`Votre change a t valid. Montant  payer: ${Q.toFixed(2)} TND.`;await ae.from("messages").insert({exchange_id:t,sender_type:"merchant",message:se}),A(!1),ie()}catch(se){console.error("Error validating exchange:",se)}},qe=async()=>{if(!ue.trim()){alert("Veuillez fournir une raison pour le refus");return}try{await ae.from("exchanges").update({status:"rejected",rejection_reason:ue,updated_at:new Date().toISOString()}).eq("id",t),await ae.from("status_history").insert({exchange_id:t,status:"rejected"}),await ae.from("messages").insert({exchange_id:t,sender_type:"merchant",message:`Votre demande d'change a t refuse. Raison: ${ue}`}),T(!1),ie()}catch(Q){console.error("Error rejecting exchange:",Q)}},je=()=>{if(!r)return;const Q=w.find(Gr=>Gr.id===r.mini_depot_id),se=f.find(Gr=>Gr.id===r.transporter_id),Mr=`
      BORDEREAU D'CHANGE
      ====================

      Code: ${r.exchange_code}
      Date: ${new Date(r.created_at).toLocaleDateString("fr-FR")}

      CLIENT:
      ${r.client_name}
      ${r.client_phone}
      ${r.client_address||""}
      ${r.client_city||""} ${r.client_postal_code||""}

      MINI-DPT:
      ${Q==null?void 0:Q.name}
      ${Q==null?void 0:Q.address}
      ${Q==null?void 0:Q.city}
      Tl: ${Q==null?void 0:Q.phone}

      TRANSPORTEUR:
      ${se==null?void 0:se.name}
      Tl: ${se==null?void 0:se.phone}

      PRODUIT: ${r.product_name||"N/A"}
      RAISON: ${r.reason}

      PAIEMENT: ${r.payment_amount>0?`${r.payment_amount} TND`:"GRATUIT"}

      Statut: ${hs[r.status]}
    `,Ue=window.open("","","height=600,width=800");Ue&&(Ue.document.write("<html><head><title>Bordereau</title>"),Ue.document.write("<style>body { font-family: monospace; padding: 40px; } pre { white-space: pre-wrap; }</style>"),Ue.document.write("</head><body>"),Ue.document.write("<pre>"+Mr+"</pre>"),Ue.document.write("</body></html>"),Ue.document.close(),Ue.print())};if(We)return u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})});if(!r)return u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"change non trouv"}),u.jsx("button",{onClick:()=>e("/merchant/exchanges"),className:"px-6 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700",children:"Retour aux changes"})]})})});const Dt=r.status==="pending",Ie={total:v.length,validated:v.filter(Q=>Q.status==="validated"||Q.status==="completed").length,rejected:v.filter(Q=>Q.status==="rejected").length};return u.jsx(at,{children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("button",{onClick:()=>e("/merchant/exchanges"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 transition-colors mb-6",children:[u.jsx(Zs,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:"Retour aux changes"})]}),u.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:r.exchange_code}),u.jsxs("p",{className:"text-slate-600",children:["Cr le"," ",new Date(r.created_at).toLocaleDateString("fr-FR")]})]}),u.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-medium ${r.status==="pending"?"bg-amber-100 text-amber-800 border border-amber-200":r.status==="validated"?"bg-emerald-100 text-emerald-800 border border-emerald-200":r.status==="rejected"?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:hs[r.status]})]}),Dt&&u.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(eC,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-amber-900 mb-1",children:"Action requise"}),u.jsx("p",{className:"text-sm text-amber-700",children:"Cette demande attend votre validation. Examinez les dtails ci-dessous et dcidez de l'approuver ou de la refuser."})]})]})}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[u.jsxs("div",{className:"bg-slate-50 rounded-xl p-5 border border-slate-200",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(Gi,{className:"w-5 h-5 text-sky-600"}),u.jsx("h3",{className:"font-semibold text-slate-900",children:"Informations client"})]}),u.jsxs("div",{className:"space-y-3 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-slate-600",children:"Nom:"}),u.jsx("p",{className:"font-medium text-slate-900",children:r.client_name})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-slate-600",children:"Tlphone:"}),u.jsx("p",{className:"font-medium text-slate-900",children:u.jsx("a",{href:`tel:${r.client_phone}`,className:"text-sky-600 hover:text-sky-700",children:r.client_phone})})]})]})]}),u.jsxs("div",{className:"bg-slate-50 rounded-xl p-5 border border-slate-200",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(Kt,{className:"w-5 h-5 text-sky-600"}),u.jsx("h3",{className:"font-semibold text-slate-900",children:"Produit"})]}),u.jsxs("div",{className:"space-y-3 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-slate-600",children:"Nom:"}),u.jsx("p",{className:"font-medium text-slate-900",children:r.product_name||"Non spcifi"})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-slate-600",children:"Raison:"}),u.jsx("p",{className:"font-medium text-slate-900",children:r.reason})]})]})]})]}),u.jsxs("div",{className:"bg-gradient-to-br from-sky-50 to-blue-50 rounded-xl p-5 border border-sky-200 mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(qh,{className:"w-5 h-5 text-sky-700"}),u.jsx("h3",{className:"font-semibold text-slate-900",children:"Adresse de livraison"})]}),u.jsx("div",{className:"space-y-2 text-sm",children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(dp,{className:"w-4 h-4 text-sky-600 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-slate-900",children:r.client_address||"Non fournie"}),u.jsx("p",{className:"text-slate-700",children:r.client_city&&r.client_postal_code?`${r.client_city} ${r.client_postal_code}, ${r.client_country||"Tunisia"}`:"Informations incompltes"})]})]})})]}),r.photos&&r.photos.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-slate-900 mb-4",children:"Photos du produit"}),u.jsx("div",{className:"grid grid-cols-3 gap-4",children:r.photos.map((Q,se)=>u.jsx("img",{src:Q,alt:`Photo ${se+1}`,className:"w-full h-40 object-cover rounded-lg border border-slate-200 cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(Q,"_blank")},se))})]}),Dt&&u.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t border-slate-200",children:[u.jsxs("button",{onClick:()=>A(!0),className:"flex-1 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[u.jsx(wr,{className:"w-5 h-5"}),"Valider l'change"]}),u.jsxs("button",{onClick:()=>T(!0),className:"flex-1 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[u.jsx(oo,{className:"w-5 h-5"}),"Refuser"]})]}),!Dt&&r.status==="validated"&&u.jsxs("div",{className:"flex gap-3 mt-6",children:[u.jsxs("button",{onClick:je,className:"flex-1 py-3 bg-sky-600 hover:bg-sky-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[u.jsx(cC,{className:"w-5 h-5"}),"Imprimer le bordereau"]}),u.jsxs("button",{onClick:()=>Ee(!0),className:"flex-1 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[u.jsx(rr,{className:"w-5 h-5"}),"Appel video"]})]}),Dt&&u.jsxs("button",{onClick:()=>Ee(!0),className:"w-full mt-4 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[u.jsx(rr,{className:"w-5 h-5"}),"Inviter a un appel video"]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[u.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Messages"}),u.jsx("div",{className:"space-y-4 mb-4 max-h-96 overflow-y-auto",children:o.length===0?u.jsx("p",{className:"text-slate-600 text-center py-8",children:"Aucun message"}):o.map(Q=>u.jsxs("div",{className:`p-4 rounded-lg ${Q.sender_type==="merchant"?"bg-sky-50 ml-auto max-w-md border border-sky-200":"bg-slate-100 mr-auto max-w-md border border-slate-200"}`,children:[u.jsx("p",{className:"text-sm font-medium text-slate-900 mb-1",children:Q.sender_type==="merchant"?"Vous":r.client_name}),u.jsx("p",{className:"text-slate-700",children:Q.message}),u.jsx("p",{className:"text-xs text-slate-500 mt-2",children:new Date(Q.created_at).toLocaleString("fr-FR")})]},Q.id))}),u.jsxs("form",{onSubmit:xe,className:"flex gap-2",children:[u.jsx("input",{type:"text",value:k,onChange:Q=>j(Q.target.value),placeholder:"Votre message...",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition-colors",children:u.jsx(ps,{className:"w-5 h-5"})})]})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(Ba,{className:"w-5 h-5 text-sky-600"}),u.jsx("h3",{className:"font-semibold text-slate-900",children:"Historique de livraison du colis"})]}),S.length===0?u.jsxs("div",{className:"text-center py-8",children:[u.jsx(E1,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),u.jsx("p",{className:"text-sm text-slate-600 mb-2",children:"Aucune tentative de livraison enregistre"}),u.jsx("p",{className:"text-xs text-slate-500",children:"Le client dclare vouloir changer ce produit"})]}):u.jsxs("div",{className:"space-y-3",children:[r.delivery_accepted_on_attempt&&u.jsx("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3 mb-4",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(wr,{className:"w-4 h-4 text-emerald-600"}),u.jsxs("span",{className:"text-sm font-semibold text-emerald-900",children:["Colis accept  la tentative"," ",r.delivery_accepted_on_attempt]})]})}),S.map((Q,se)=>u.jsx("div",{className:`rounded-lg p-4 border ${Q.status==="successful"?"bg-emerald-50 border-emerald-200":"bg-red-50 border-red-200"}`,children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:`p-2 rounded-full ${Q.status==="successful"?"bg-emerald-100":"bg-red-100"}`,children:Q.status==="successful"?u.jsx(wr,{className:`w-4 h-4 ${Q.status==="successful"?"text-emerald-600":"text-red-600"}`}):u.jsx(oo,{className:"w-4 h-4 text-red-600"})}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsxs("span",{className:`font-semibold text-sm ${Q.status==="successful"?"text-emerald-900":"text-red-900"}`,children:["Tentative ",Q.attempt_number]}),u.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${Q.status==="successful"?"bg-emerald-100 text-emerald-700 border border-emerald-300":"bg-red-100 text-red-700 border border-red-300"}`,children:Q.status==="successful"?"Russie":"choue"})]}),u.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-600 mb-2",children:[u.jsx(Xh,{className:"w-3 h-3"}),u.jsx("span",{children:new Date(Q.attempt_date).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),Q.failure_reason&&u.jsxs("div",{className:"text-sm text-red-700 mb-1",children:[u.jsx("span",{className:"font-medium",children:"Raison: "}),Q.failure_reason]}),Q.notes&&u.jsxs("div",{className:"text-xs text-slate-600",children:[u.jsx("span",{className:"font-medium",children:"Notes: "}),Q.notes]})]})]})},Q.id)),S.length>0&&u.jsx("div",{className:`rounded-lg p-3 border mt-4 ${S.some(Q=>Q.status==="successful")?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200"}`,children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(Nn,{className:`w-4 h-4 mt-0.5 ${S.some(Q=>Q.status==="successful")?"text-amber-600":"text-red-600"}`}),u.jsx("div",{className:"text-xs",children:S.some(Q=>Q.status==="successful")?u.jsxs("p",{className:"text-amber-900",children:[u.jsx("span",{className:"font-semibold",children:"Attention:"})," ","Le client a accept le colis aprs"," ",S.filter(Q=>Q.status==="failed").length," ","tentative(s) choue(s), mais demande maintenant un change."]}):u.jsxs("p",{className:"text-red-900",children:[u.jsx("span",{className:"font-semibold",children:"Attention:"})," ","Toutes les tentatives de livraison ont chou (",S.length," tentative(s)). Le client demande maintenant un change."]})})]})})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(yc,{className:"w-5 h-5 text-sky-600"}),u.jsx("h3",{className:"font-semibold text-slate-900",children:"Historique du client"})]}),v.length===0?u.jsxs("div",{className:"text-center py-8",children:[u.jsx(E1,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),u.jsx("p",{className:"text-sm text-slate-600",children:"Premier change de ce client"})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[u.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 border border-slate-200",children:[u.jsx("div",{className:"text-2xl font-bold text-slate-900",children:Ie.total}),u.jsx("div",{className:"text-xs text-slate-600",children:"changes"})]}),u.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 border border-emerald-200",children:[u.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:Ie.validated}),u.jsx("div",{className:"text-xs text-emerald-700",children:"Valids"})]}),u.jsxs("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200",children:[u.jsx("div",{className:"text-2xl font-bold text-red-700",children:Ie.rejected}),u.jsx("div",{className:"text-xs text-red-700",children:"Refuss"})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Derniers changes"}),v.slice(0,3).map(Q=>u.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 border border-slate-200 text-sm",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1",children:[u.jsx("span",{className:"font-mono text-xs text-slate-600",children:Q.exchange_code}),u.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${Q.status==="validated"||Q.status==="completed"?"bg-emerald-100 text-emerald-700":Q.status==="rejected"?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:hs[Q.status]})]}),u.jsx("p",{className:"text-xs text-slate-600 truncate",children:Q.reason}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:new Date(Q.created_at).toLocaleDateString("fr-FR")})]},Q.id))]}),Ie.total>0&&u.jsx("div",{className:`rounded-lg p-3 border ${Ie.validated/Ie.total>=.7?"bg-emerald-50 border-emerald-200":Ie.validated/Ie.total>=.4?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200"}`,children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ao,{className:`w-4 h-4 ${Ie.validated/Ie.total>=.7?"text-emerald-600":Ie.validated/Ie.total>=.4?"text-amber-600":"text-red-600"}`}),u.jsxs("span",{className:"text-sm font-medium",children:["Taux de validation:"," ",Math.round(Ie.validated/Ie.total*100),"%"]})]})})]})]})]})]}),M&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Valider l'change"}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-sky-50 border border-sky-200 rounded-xl p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[u.jsx(tC,{className:"w-5 h-5 text-sky-700"}),u.jsx("h4",{className:"font-semibold text-slate-900",children:"Options de paiement"})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-slate-300 cursor-pointer hover:border-sky-500 transition-colors",children:[u.jsx("input",{type:"radio",name:"paymentType",value:"free",checked:te==="free",onChange:Q=>be(Q.target.value),className:"w-4 h-4 text-sky-600"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-900",children:"change gratuit"}),u.jsx("div",{className:"text-sm text-slate-600",children:"Pas de frais supplmentaires"})]})]}),u.jsxs("label",{className:"flex items-start gap-3 p-3 bg-white rounded-lg border border-slate-300 cursor-pointer hover:border-sky-500 transition-colors",children:[u.jsx("input",{type:"radio",name:"paymentType",value:"paid",checked:te==="paid",onChange:Q=>be(Q.target.value),className:"w-4 h-4 text-sky-600 mt-1"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"font-medium text-slate-900 mb-2",children:"change payant"}),te==="paid"&&u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-sm text-slate-700",children:"Montant  payer (TND)"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:$,onChange:Q=>G(Q.target.value),placeholder:"0.00",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"}),u.jsx("p",{className:"text-xs text-slate-600",children:"Pour diffrence de prix ou frais de livraison"})]})]})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Mini-Dpt *"}),u.jsxs("select",{value:z,onChange:Q=>U(Q.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[u.jsx("option",{value:"",children:"Slectionnez un dpt"}),w.map(Q=>u.jsxs("option",{value:Q.id,children:[Q.name," - ",Q.city]},Q.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Transporteur *"}),u.jsxs("select",{value:O,onChange:Q=>V(Q.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[u.jsx("option",{value:"",children:"Slectionnez un transporteur"}),f.map(Q=>u.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]})]}),u.jsxs("div",{className:"flex gap-3 mt-6",children:[u.jsx("button",{onClick:()=>A(!1),className:"flex-1 px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium transition-colors",children:"Annuler"}),u.jsx("button",{onClick:ye,className:"flex-1 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:"Confirmer la validation"})]})]})})}),C&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-2xl shadow-xl max-w-lg w-full",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Refuser l'change"}),u.jsx("p",{className:"text-slate-600 mb-6",children:"Veuillez expliquer la raison du refus au client"}),u.jsx("textarea",{value:ue,onChange:Q=>Ne(Q.target.value),placeholder:"Expliquez pourquoi l'change est refus...",rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"}),u.jsxs("div",{className:"flex gap-3 mt-6",children:[u.jsx("button",{onClick:()=>T(!1),className:"flex-1 px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium transition-colors",children:"Annuler"}),u.jsx("button",{onClick:qe,className:"flex-1 px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"Confirmer le refus"})]})]})})}),u.jsx(kC,{isOpen:Ye,onClose:()=>Ee(!1),clientName:(r==null?void 0:r.client_name)||"",clientPhone:(r==null?void 0:r.client_phone)||"",exchangeId:t})]})})}function DC(){const t=wt(),[e,r]=P.useState([]),[s,o]=P.useState(!0),[l,f]=P.useState(""),[g,w]=P.useState("exchanges"),[x,v]=P.useState("all");P.useEffect(()=>{E(),S()},[]);const E=async()=>{const{data:{session:j}}=await ae.auth.getSession();j||t("/merchant/login")},S=async()=>{try{const{data:j}=await ae.from("exchanges").select("*").order("created_at",{ascending:!1});if(j){const M=new Map;j.forEach(C=>{const T=C.client_phone;M.has(T)||M.set(T,{name:C.client_name,phone:C.client_phone,email:`${C.client_name.toLowerCase().replace(/\s/g,"")}@example.com`,exchanges:[],firstExchange:C.created_at,lastExchange:C.created_at});const O=M.get(T);O.exchanges.push(C),new Date(C.created_at)<new Date(O.firstExchange)&&(O.firstExchange=C.created_at),new Date(C.created_at)>new Date(O.lastExchange)&&(O.lastExchange=C.created_at)});const A=Array.from(M.values()).map(C=>{const T=C.exchanges.filter(te=>te.status==="validated"||te.status==="completed").length,O=C.exchanges.filter(te=>te.status==="pending").length,V=C.exchanges.filter(te=>te.status==="rejected").length,z=C.exchanges.length,U=z>0?Math.round(T/z*100):0,$=Math.floor((Date.now()-new Date(C.lastExchange).getTime())/(1e3*60*60*24)),G=$<=30;return{...C,totalExchanges:z,acceptanceRate:U,validated:T,pending:O,rejected:V,daysSinceLastExchange:$,isActive:G}});r(A)}}catch(j){console.error("Error fetching clients:",j)}finally{o(!1)}},I=e.filter(j=>{const M=j.name.toLowerCase().includes(l.toLowerCase())||j.phone.includes(l)||j.email.toLowerCase().includes(l.toLowerCase()),A=x==="all"?!0:x==="active"?j.isActive:!j.isActive;return M&&A}).sort((j,M)=>{switch(g){case"exchanges":return M.totalExchanges-j.totalExchanges;case"rate":return M.acceptanceRate-j.acceptanceRate;case"recent":return new Date(M.lastExchange).getTime()-new Date(j.lastExchange).getTime();default:return 0}}),k={total:e.length,active:e.filter(j=>j.isActive).length,avgRate:e.length>0?Math.round(e.reduce((j,M)=>j+M.acceptanceRate,0)/e.length):0,recurring:e.filter(j=>j.totalExchanges>1).length,totalExchanges:e.reduce((j,M)=>j+M.totalExchanges,0)};return s?u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):u.jsx(at,{children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Gestion des Clients"}),u.jsx("p",{className:"text-slate-600",children:"Vue d'ensemble de vos clients et de leur activit"})]}),u.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6",children:[u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-5",children:u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("div",{className:"p-2 bg-sky-100 rounded-lg",children:u.jsx(Ql,{className:"w-5 h-5 text-sky-600"})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-slate-900",children:k.total}),u.jsx("div",{className:"text-xs text-slate-600",children:"Clients uniques"})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-5",children:u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:u.jsx(yc,{className:"w-5 h-5 text-emerald-600"})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-slate-900",children:k.active}),u.jsx("div",{className:"text-xs text-slate-600",children:"Clients actifs"})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-5",children:u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:u.jsx(Md,{className:"w-5 h-5 text-blue-600"})}),u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-slate-900",children:[k.avgRate,"%"]}),u.jsx("div",{className:"text-xs text-slate-600",children:"Taux d'acceptation"})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-5",children:u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:u.jsx(Kt,{className:"w-5 h-5 text-amber-600"})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-slate-900",children:k.totalExchanges}),u.jsx("div",{className:"text-xs text-slate-600",children:"changes totaux"})]})]})})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 mb-6",children:u.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(po,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Rechercher par nom, tlphone ou email...",value:l,onChange:j=>f(j.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Yh,{className:"w-4 h-4 text-slate-500"}),u.jsx("span",{className:"text-sm text-slate-600",children:"Statut:"})]}),u.jsxs("select",{value:x,onChange:j=>v(j.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[u.jsxs("option",{value:"all",children:["Tous (",k.total,")"]}),u.jsxs("option",{value:"active",children:["Actifs (",k.active,")"]}),u.jsxs("option",{value:"inactive",children:["Inactifs (",k.total-k.active,")"]})]}),u.jsxs("select",{value:g,onChange:j=>w(j.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[u.jsx("option",{value:"exchanges",children:"Plus d'changes"}),u.jsx("option",{value:"rate",children:"Meilleur taux"}),u.jsx("option",{value:"recent",children:"Plus rcents"})]})]})]})}),I.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12 text-center",children:[u.jsx(Ql,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Aucun client trouv"}),u.jsx("p",{className:"text-slate-600",children:l?"Essayez de modifier votre recherche":"Les clients apparatront ici aprs leur premier change"})]}):u.jsx("div",{className:"space-y-3",children:I.map((j,M)=>u.jsx(qt,{to:`/merchant/client/${encodeURIComponent(j.phone)}`,className:"block bg-white rounded-xl shadow-sm border border-slate-200 hover:shadow-md hover:border-sky-200 transition-all p-5 group",children:u.jsxs("div",{className:"flex items-center justify-between gap-4",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-sky-100 to-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:u.jsx("span",{className:"text-lg font-bold text-sky-700",children:j.name.charAt(0).toUpperCase()})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("h3",{className:"font-semibold text-slate-900 text-lg truncate",children:j.name}),j.isActive&&u.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-medium rounded-full",children:"Actif"}),j.totalExchanges>5&&u.jsx(Md,{className:"w-4 h-4 text-amber-500"})]}),u.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-600",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Fn,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:j.phone})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(hp,{className:"w-3.5 h-3.5"}),u.jsx("span",{className:"truncate",children:j.email})]})]})]})]}),u.jsxs("div",{className:"grid grid-cols-4 gap-4 pl-15",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"changes"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Kt,{className:"w-4 h-4 text-sky-600"}),u.jsx("span",{className:"font-semibold text-slate-900",children:j.totalExchanges})]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Taux acceptation"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"flex-1 bg-slate-200 rounded-full h-1.5 max-w-[60px]",children:u.jsx("div",{className:`h-1.5 rounded-full ${j.acceptanceRate>=80?"bg-emerald-500":j.acceptanceRate>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${j.acceptanceRate}%`}})}),u.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[j.acceptanceRate,"%"]})]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Statuts"}),u.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[j.pending>0&&u.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 rounded",children:[j.pending," en attente"]}),j.validated>0&&u.jsxs("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded",children:[j.validated," valids"]})]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Dernire activit"}),u.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-700",children:[u.jsx(sr,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:j.daysSinceLastExchange===0?"Aujourd'hui":j.daysSinceLastExchange===1?"Hier":`Il y a ${j.daysSinceLastExchange}j`})]})]})]})]}),u.jsx(up,{className:"w-5 h-5 text-slate-400 group-hover:text-sky-600 transition-colors flex-shrink-0"})]})},M))})]})})}function LC(){const{phone:t}=Qi(),e=wt(),[r,s]=P.useState(null),[o,l]=P.useState([]),[f,g]=P.useState([]),[w,x]=P.useState(!0),[v,E]=P.useState("overview");P.useEffect(()=>{S(),t&&I(decodeURIComponent(t))},[t]);const S=async()=>{const{data:{session:M}}=await ae.auth.getSession();M||e("/merchant/login")},I=async M=>{try{const{data:A}=await ae.from("exchanges").select("*").eq("client_phone",M).order("created_at",{ascending:!1});if(A&&A.length>0){l(A);const C=A.filter(Y=>Y.status==="validated"||Y.status==="completed").length,T=A.filter(Y=>Y.status==="pending").length,O=A.filter(Y=>Y.status==="rejected").length,V=A.length,z=V>0?Math.round(C/V*100):0,U=A[A.length-1],$=A[0],G=Math.floor((Date.now()-new Date(U.created_at).getTime())/(1e3*60*60*24)),te=Math.floor((Date.now()-new Date($.created_at).getTime())/(1e3*60*60*24)),be=new Map;A.forEach(Y=>{be.set(Y.reason,(be.get(Y.reason)||0)+1)});const ue=Array.from(be.entries()).sort((Y,Ye)=>Ye[1]-Y[1]).slice(0,3);s({name:U.client_name,phone:M,email:`${U.client_name.toLowerCase().replace(/\s/g,"")}@example.com`,firstExchange:U.created_at,lastExchange:$.created_at,daysSinceFirst:G,daysSinceLast:te,totalExchanges:V,validated:C,pending:T,rejected:O,acceptanceRate:z,isActive:te<=30,topReasons:ue});const Ne=A.map(Y=>Y.id),{data:We}=await ae.from("messages").select("*").in("exchange_id",Ne).order("created_at",{ascending:!1});g(We||[])}}catch(A){console.error("Error fetching client:",A)}finally{x(!1)}},k=M=>{switch(M){case"pending":return u.jsx(sr,{className:"w-4 h-4 text-amber-600"});case"validated":case"completed":return u.jsx(wr,{className:"w-4 h-4 text-emerald-600"});case"rejected":return u.jsx(oo,{className:"w-4 h-4 text-red-600"});default:return u.jsx(Nn,{className:"w-4 h-4 text-slate-600"})}},j=M=>{switch(M){case"pending":return"bg-amber-100 text-amber-800 border-amber-200";case"validated":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";default:return"bg-slate-100 text-slate-800 border-slate-200"}};return w?u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):r?u.jsx(at,{children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("button",{onClick:()=>e("/merchant/clients"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 transition-colors mb-6",children:[u.jsx(Zs,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:"Retour aux clients"})]}),u.jsx("div",{className:"bg-gradient-to-r from-sky-50 to-blue-50 rounded-2xl border border-sky-200 p-6 mb-6",children:u.jsxs("div",{className:"flex items-start gap-6",children:[u.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-sky-400 to-blue-500 rounded-2xl flex items-center justify-center flex-shrink-0 shadow-lg",children:u.jsx("span",{className:"text-3xl font-bold text-white",children:r.name.charAt(0).toUpperCase()})}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:r.name}),r.isActive&&u.jsx("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-700 text-sm font-medium rounded-full border border-emerald-200",children:"Client actif"}),r.totalExchanges>5&&u.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-amber-100 text-amber-700 text-sm font-medium rounded-full border border-amber-200",children:[u.jsx(Md,{className:"w-4 h-4"}),u.jsx("span",{children:"Client fidle"})]})]}),u.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[u.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[u.jsx(Fn,{className:"w-4 h-4 text-sky-600"}),u.jsx("a",{href:`tel:${r.phone}`,className:"hover:text-sky-600",children:r.phone})]}),u.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[u.jsx(hp,{className:"w-4 h-4 text-sky-600"}),u.jsx("a",{href:`mailto:${r.email}`,className:"hover:text-sky-600",children:r.email})]}),u.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[u.jsx(Xh,{className:"w-4 h-4 text-sky-600"}),u.jsxs("span",{children:["Client depuis ",new Date(r.firstExchange).toLocaleDateString("fr-FR",{month:"long",year:"numeric"})]})]})]})]}),u.jsxs(qt,{to:"/merchant/chat",className:"px-5 py-2.5 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition-colors font-medium flex items-center gap-2",children:[u.jsx(jr,{className:"w-4 h-4"}),"Envoyer un message"]})]})}),u.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6",children:[u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-5",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-sky-100 rounded-lg",children:u.jsx(Kt,{className:"w-5 h-5 text-sky-600"})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-slate-900",children:r.totalExchanges}),u.jsx("div",{className:"text-xs text-slate-600",children:"changes totaux"})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-5",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:u.jsx(yc,{className:"w-5 h-5 text-emerald-600"})}),u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-slate-900",children:[r.acceptanceRate,"%"]}),u.jsx("div",{className:"text-xs text-slate-600",children:"Taux acceptation"})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-5",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:u.jsx(wr,{className:"w-5 h-5 text-blue-600"})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-slate-900",children:r.validated}),u.jsx("div",{className:"text-xs text-slate-600",children:"Valids"})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-5",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:u.jsx(sr,{className:"w-5 h-5 text-amber-600"})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-slate-900",children:r.pending}),u.jsx("div",{className:"text-xs text-slate-600",children:"En attente"})]})]})})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[u.jsx("div",{className:"border-b border-slate-200",children:u.jsxs("div",{className:"flex gap-1 p-2",children:[u.jsx("button",{onClick:()=>E("overview"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${v==="overview"?"bg-sky-100 text-sky-700":"text-slate-600 hover:bg-slate-50"}`,children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Kl,{className:"w-4 h-4"}),u.jsx("span",{children:"Vue d'ensemble"})]})}),u.jsx("button",{onClick:()=>E("exchanges"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${v==="exchanges"?"bg-sky-100 text-sky-700":"text-slate-600 hover:bg-slate-50"}`,children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Kt,{className:"w-4 h-4"}),u.jsxs("span",{children:["Historique (",o.length,")"]})]})}),u.jsx("button",{onClick:()=>E("messages"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${v==="messages"?"bg-sky-100 text-sky-700":"text-slate-600 hover:bg-slate-50"}`,children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(jr,{className:"w-4 h-4"}),u.jsxs("span",{children:["Messages (",f.length,")"]})]})})]})}),u.jsxs("div",{className:"p-6",children:[v==="overview"&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Statistiques comportementales"}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-slate-50 rounded-xl p-5 border border-slate-200",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"font-medium text-slate-900",children:"Rpartition des statuts"}),u.jsx(Kl,{className:"w-5 h-5 text-slate-400"})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[u.jsx("span",{className:"text-slate-600",children:"Valids"}),u.jsxs("span",{className:"font-semibold text-emerald-600",children:[r.validated," (",Math.round(r.validated/r.totalExchanges*100),"%)"]})]}),u.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:`${r.validated/r.totalExchanges*100}%`}})})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[u.jsx("span",{className:"text-slate-600",children:"En attente"}),u.jsxs("span",{className:"font-semibold text-amber-600",children:[r.pending," (",Math.round(r.pending/r.totalExchanges*100),"%)"]})]}),u.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-amber-500 rounded-full",style:{width:`${r.pending/r.totalExchanges*100}%`}})})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[u.jsx("span",{className:"text-slate-600",children:"Refuss"}),u.jsxs("span",{className:"font-semibold text-red-600",children:[r.rejected," (",Math.round(r.rejected/r.totalExchanges*100),"%)"]})]}),u.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-red-500 rounded-full",style:{width:`${r.rejected/r.totalExchanges*100}%`}})})]})]})]}),u.jsxs("div",{className:"bg-slate-50 rounded-xl p-5 border border-slate-200",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"font-medium text-slate-900",children:"Motifs d'change principaux"}),u.jsx(fs,{className:"w-5 h-5 text-slate-400"})]}),u.jsx("div",{className:"space-y-3",children:r.topReasons.map(([M,A],C)=>u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[u.jsx("span",{className:"text-slate-700 truncate",children:M}),u.jsxs("span",{className:"font-semibold text-slate-900",children:[A,"x"]})]}),u.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-sky-500 rounded-full",style:{width:`${A/r.totalExchanges*100}%`}})})]},C))})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Informations temporelles"}),u.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"bg-slate-50 rounded-xl p-5 border border-slate-200",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Premier change"}),u.jsx("div",{className:"font-semibold text-slate-900",children:new Date(r.firstExchange).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}),u.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Il y a ",r.daysSinceFirst," jours"]})]}),u.jsxs("div",{className:"bg-slate-50 rounded-xl p-5 border border-slate-200",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Dernier change"}),u.jsx("div",{className:"font-semibold text-slate-900",children:new Date(r.lastExchange).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}),u.jsx("div",{className:"text-xs text-slate-500 mt-1",children:r.daysSinceLast===0?"Aujourd'hui":r.daysSinceLast===1?"Hier":`Il y a ${r.daysSinceLast} jours`})]}),u.jsxs("div",{className:"bg-slate-50 rounded-xl p-5 border border-slate-200",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Frquence moyenne"}),u.jsx("div",{className:"font-semibold text-slate-900",children:r.totalExchanges>1?`${Math.round(r.daysSinceFirst/(r.totalExchanges-1))} jours`:"N/A"}),u.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Entre les changes"})]})]})]})]}),v==="exchanges"&&u.jsx("div",{className:"space-y-3",children:o.map(M=>u.jsx(qt,{to:`/merchant/exchange/${M.id}`,className:"block bg-slate-50 rounded-xl p-4 hover:bg-slate-100 transition-colors border border-slate-200 group",children:u.jsxs("div",{className:"flex items-center justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[u.jsx("div",{className:`p-2 rounded-lg border ${j(M.status)}`,children:k(M.status)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("h4",{className:"font-semibold text-slate-900",children:M.exchange_code}),u.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${j(M.status)}`,children:hs[M.status]})]}),u.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-600",children:[u.jsx("span",{className:"truncate",children:M.reason}),u.jsx("span",{children:""}),u.jsx("span",{children:new Date(M.created_at).toLocaleDateString("fr-FR")})]})]})]}),u.jsx(nC,{className:"w-5 h-5 text-slate-400 group-hover:text-sky-600 transition-colors flex-shrink-0"})]})},M.id))}),v==="messages"&&u.jsx("div",{className:"space-y-4",children:f.length===0?u.jsxs("div",{className:"text-center py-12",children:[u.jsx(jr,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Aucun message"}),u.jsx("p",{className:"text-slate-600",children:"Aucune conversation avec ce client pour le moment"})]}):f.map(M=>u.jsx("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:`p-2 rounded-lg ${M.sender_type==="merchant"?"bg-sky-100":"bg-emerald-100"}`,children:M.sender_type==="merchant"?u.jsx(Gi,{className:"w-4 h-4 text-sky-600"}):u.jsx(Gi,{className:"w-4 h-4 text-emerald-600"})}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("span",{className:"font-semibold text-slate-900",children:M.sender_type==="merchant"?"Vous":r.name}),u.jsx("span",{className:"text-xs text-slate-500",children:new Date(M.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),u.jsx("p",{className:"text-slate-700",children:M.message})]})]})},M.id))})]})]})]})}):u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Nn,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Client non trouv"}),u.jsx("button",{onClick:()=>e("/merchant/clients"),className:"mt-4 px-6 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700",children:"Retour aux clients"})]})})})}function PC(){wt();const[t,e]=P.useState([]),[r,s]=P.useState(""),[o,l]=P.useState(""),[f,g]=P.useState(!0),[w,x]=P.useState(!1);P.useEffect(()=>{v()},[]);const v=async()=>{try{const{data:I}=await ae.from("exchanges").select("*").order("created_at",{ascending:!1});e(I||[])}catch(I){console.error("Error fetching exchanges:",I)}finally{g(!1)}},E=async()=>{if(!r||!o){alert("Veuillez slectionner un change et un statut");return}x(!0);try{await ae.from("exchanges").update({status:o,updated_at:new Date().toISOString()}).eq("id",r),await ae.from("status_history").insert({exchange_id:r,status:o}),alert("Statut mis  jour avec succs"),v(),s(""),l("")}catch(I){console.error("Error updating status:",I),alert("Erreur lors de la mise  jour")}finally{x(!1)}},S=async()=>{if(!r){alert("Veuillez slectionner un change");return}x(!0);const I=["validated","preparing","in_transit","completed"];try{for(const k of I)await ae.from("exchanges").update({status:k,updated_at:new Date().toISOString()}).eq("id",r),await ae.from("status_history").insert({exchange_id:r,status:k}),await new Promise(j=>setTimeout(j,500));alert("Workflow complet simul avec succs"),v(),s("")}catch(k){console.error("Error simulating workflow:",k),alert("Erreur lors de la simulation")}finally{x(!1)}};return f?u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):u.jsx(at,{children:u.jsxs("div",{children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Mode Simulation"}),u.jsx("p",{className:"text-slate-600",children:"Testez les diffrents statuts d'changes"})]}),u.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Mettre  jour un statut"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Slectionner un change"}),u.jsxs("select",{value:r,onChange:I=>s(I.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[u.jsx("option",{value:"",children:"-- Choisir un change --"}),t.map(I=>u.jsxs("option",{value:I.id,children:[I.exchange_code," - ",I.client_name," (",hs[I.status],")"]},I.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nouveau statut"}),u.jsxs("select",{value:o,onChange:I=>l(I.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[u.jsx("option",{value:"",children:"-- Choisir un statut --"}),u.jsx("option",{value:"pending",children:"En attente"}),u.jsx("option",{value:"validated",children:"Valid"}),u.jsx("option",{value:"preparing",children:"Prparation mini-dpt"}),u.jsx("option",{value:"in_transit",children:"En route"}),u.jsx("option",{value:"completed",children:"change effectu"}),u.jsx("option",{value:"returned",children:"Produit retourn"}),u.jsx("option",{value:"rejected",children:"Rejet"})]})]}),u.jsxs("button",{onClick:E,disabled:w||!r||!o,className:"w-full flex items-center justify-center gap-2 py-3 bg-sky-600 hover:bg-sky-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors",children:[u.jsx(uC,{className:`w-5 h-5 ${w?"animate-spin":""}`}),w?"Mise  jour...":"Mettre  jour le statut"]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Simuler un workflow complet"}),u.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Cette action simulera automatiquement tous les statuts de l'change slectionn: Valid  Prparation  En route  Complt"}),u.jsxs("button",{onClick:S,disabled:w||!r,className:"w-full flex items-center justify-center gap-2 py-3 bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors",children:[u.jsx(lC,{className:"w-5 h-5"}),w?"Simulation en cours...":"Lancer la simulation complte"]})]}),u.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6",children:[u.jsx("h4",{className:"font-bold text-amber-900 mb-2",children:"Note importante"}),u.jsxs("ul",{className:"text-sm text-amber-800 space-y-1",children:[u.jsx("li",{children:" Ce mode est destin aux tests uniquement"}),u.jsx("li",{children:" Les changements de statut sont irrversibles"}),u.jsx("li",{children:" Utilisez des changes de test pour vos simulations"}),u.jsx("li",{children:" Les notifications et l'historique seront mis  jour"})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"tats disponibles"}),u.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[u.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[u.jsx("p",{className:"font-medium text-yellow-900",children:"En attente"}),u.jsx("p",{className:"text-yellow-700 text-xs",children:"Demande soumise"})]}),u.jsxs("div",{className:"p-3 bg-emerald-50 border border-emerald-200 rounded-lg",children:[u.jsx("p",{className:"font-medium text-emerald-900",children:"Valid"}),u.jsx("p",{className:"text-emerald-700 text-xs",children:"change accept"})]}),u.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[u.jsx("p",{className:"font-medium text-blue-900",children:"Prparation"}),u.jsx("p",{className:"text-blue-700 text-xs",children:"Au mini-dpt"})]}),u.jsxs("div",{className:"p-3 bg-indigo-50 border border-indigo-200 rounded-lg",children:[u.jsx("p",{className:"font-medium text-indigo-900",children:"En route"}),u.jsx("p",{className:"text-indigo-700 text-xs",children:"Vers le client"})]}),u.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[u.jsx("p",{className:"font-medium text-green-900",children:"Complt"}),u.jsx("p",{className:"text-green-700 text-xs",children:"change finalis"})]}),u.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[u.jsx("p",{className:"font-medium text-red-900",children:"Rejet"}),u.jsx("p",{className:"text-red-700 text-xs",children:"Demande refuse"})]})]})]})]})]})})}function BC(){const t=wt(),[e,r]=P.useState([]),[s,o]=P.useState(null),[l,f]=P.useState([]),[g,w]=P.useState(""),[x,v]=P.useState(""),[E,S]=P.useState(!0);P.useEffect(()=>{I(),k()},[]),P.useEffect(()=>{s&&j(s.id)},[s]);const I=async()=>{const{data:{session:O}}=await ae.auth.getSession();O||t("/merchant/login")},k=async()=>{try{const{data:O}=await ae.from("exchanges").select("*, messages(count)").order("created_at",{ascending:!1});O&&(r(O),O.length>0&&!s&&o(O[0]))}catch(O){console.error("Error:",O)}finally{S(!1)}},j=async O=>{try{const{data:V}=await ae.from("messages").select("*").eq("exchange_id",O).order("created_at",{ascending:!0});f(V||[])}catch(V){console.error("Error:",V)}},M=async O=>{if(O.preventDefault(),!(!g.trim()||!s))try{const{error:V}=await ae.from("messages").insert({exchange_id:s.id,sender_type:"merchant",message:g});V||(w(""),j(s.id))}catch(V){console.error("Error:",V)}},A=e.filter(O=>O.client_name.toLowerCase().includes(x.toLowerCase())||O.exchange_code.toLowerCase().includes(x.toLowerCase())||O.client_phone.includes(x)),C=O=>new Date(O).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),T=O=>{const V=new Date(O),z=new Date,U=new Date(z);return U.setDate(U.getDate()-1),V.toDateString()===z.toDateString()?"Aujourd'hui":V.toDateString()===U.toDateString()?"Hier":V.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})};return E?u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"text-slate-600",children:"Chargement..."})})}):u.jsxs(at,{children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Messagerie"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Communiquez avec vos clients"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-[calc(100vh-200px)] flex overflow-hidden",children:[u.jsxs("div",{className:"w-1/3 border-r border-slate-200 flex flex-col",children:[u.jsx("div",{className:"p-4 border-b border-slate-200",children:u.jsxs("div",{className:"relative",children:[u.jsx(po,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Rechercher un change...",value:x,onChange:O=>v(O.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:A.length===0?u.jsxs("div",{className:"p-8 text-center text-slate-500",children:[u.jsx(jr,{className:"w-12 h-12 mx-auto mb-3 text-slate-300"}),u.jsx("p",{children:"Aucune conversation"})]}):A.map(O=>{var V,z;return u.jsxs("div",{onClick:()=>o(O),className:`p-4 border-b border-slate-100 cursor-pointer transition-colors ${(s==null?void 0:s.id)===O.id?"bg-blue-50 border-l-4 border-l-blue-500":"hover:bg-slate-50"}`,children:[u.jsxs("div",{className:"flex items-start justify-between mb-1",children:[u.jsx("h3",{className:"font-semibold text-slate-900",children:O.client_name}),u.jsx("span",{className:"text-xs text-slate-500",children:T(O.created_at)})]}),u.jsx("p",{className:"text-sm text-slate-600 mb-1",children:O.exchange_code}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${O.status==="pending"?"bg-yellow-100 text-yellow-800":O.status==="validated"?"bg-green-100 text-green-800":O.status==="rejected"?"bg-red-100 text-red-800":"bg-slate-100 text-slate-800"}`,children:O.status}),((z=(V=O.messages)==null?void 0:V[0])==null?void 0:z.count)>0&&u.jsxs("span",{className:"text-xs text-slate-500",children:[O.messages[0].count," message(s)"]})]})]},O.id)})})]}),u.jsx("div",{className:"flex-1 flex flex-col",children:s?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[u.jsx("h2",{className:"font-bold text-slate-900",children:s.client_name}),u.jsx("p",{className:"text-sm text-slate-600",children:s.exchange_code})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:l.length===0?u.jsxs("div",{className:"text-center text-slate-500 py-12",children:[u.jsx(jr,{className:"w-16 h-16 mx-auto mb-4 text-slate-300"}),u.jsx("p",{className:"text-lg font-medium",children:"Aucun message"}),u.jsx("p",{className:"text-sm",children:"Dmarrez la conversation avec votre client"})]}):l.map(O=>u.jsx("div",{className:`flex ${O.sender_type==="merchant"?"justify-end":"justify-start"}`,children:u.jsxs("div",{className:`max-w-[70%] ${O.sender_type==="merchant"?"bg-blue-500 text-white":"bg-slate-100 text-slate-900"} rounded-2xl px-4 py-2`,children:[u.jsx("p",{className:"text-sm",children:O.message}),u.jsxs("div",{className:`flex items-center gap-1 mt-1 ${O.sender_type==="merchant"?"text-blue-100":"text-slate-500"}`,children:[u.jsx(sr,{className:"w-3 h-3"}),u.jsx("span",{className:"text-xs",children:C(O.created_at)})]})]})},O.id))}),u.jsx("form",{onSubmit:M,className:"p-4 border-t border-slate-200 bg-slate-50",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",placeholder:"Tapez votre message...",value:g,onChange:O=>w(O.target.value),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),u.jsxs("button",{type:"submit",disabled:!g.trim(),className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[u.jsx(ps,{className:"w-4 h-4"}),"Envoyer"]})]})})]}):u.jsx("div",{className:"flex-1 flex items-center justify-center text-slate-500",children:u.jsxs("div",{className:"text-center",children:[u.jsx(jr,{className:"w-16 h-16 mx-auto mb-4 text-slate-300"}),u.jsx("p",{className:"text-lg",children:"Slectionnez une conversation"})]})})})]})]})}function FC(){const t=wt(),[e,r]=P.useState([]),[s,o]=P.useState(null),[l,f]=P.useState(!0),[g,w]=P.useState(""),[x,v]=P.useState(null),[E,S]=P.useState(""),[I,k]=P.useState(!1),[j,M]=P.useState({total:0,averageRating:0,responseRate:0});P.useEffect(()=>{A(),C()},[]);const A=async()=>{const{data:{session:z}}=await ae.auth.getSession();z||t("/merchant/login")},C=async()=>{try{const{data:z,error:U}=await ae.from("reviews").select("*").order("created_at",{ascending:!1});if(U)throw U;const $=z||[];r($);const G=$.length,te=G>0?$.reduce((Ne,We)=>Ne+We.rating,0)/G:0,be=$.filter(Ne=>Ne.merchant_response).length,ue=G>0?Math.round(be/G*100):0;M({total:G,averageRating:Math.round(te*10)/10,responseRate:ue}),$.length>0&&!s&&o($[0])}catch(z){console.error("Error fetching reviews:",z)}finally{f(!1)}},T=async()=>{if(!(!s||!E.trim())){k(!0);try{const{error:z}=await ae.from("reviews").update({merchant_response:E.trim(),merchant_response_at:new Date().toISOString()}).eq("id",s.id);if(z)throw z;r(e.map(U=>U.id===s.id?{...U,merchant_response:E.trim(),merchant_response_at:new Date().toISOString()}:U)),o({...s,merchant_response:E.trim(),merchant_response_at:new Date().toISOString()}),S("")}catch(z){console.error("Error submitting response:",z)}finally{k(!1)}}},O=e.filter(z=>{const U=z.client_name.toLowerCase().includes(g.toLowerCase())||z.client_phone.includes(g),$=x===null||z.rating===x;return U&&$}),V=z=>new Date(z).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return l?u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):u.jsx(at,{children:u.jsxs("div",{children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Avis Clients"}),u.jsx("p",{className:"text-slate-600",children:"Gerez les avis et retours de vos clients"})]}),u.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:u.jsx(fs,{className:"w-6 h-6 text-amber-600"})}),u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:j.total})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"Total des avis"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:u.jsx(yc,{className:"w-6 h-6 text-emerald-600"})}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:j.averageRating}),u.jsx(fs,{className:"w-5 h-5 fill-amber-400 text-amber-400"})]})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"Note moyenne"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-sky-100 rounded-lg",children:u.jsx(jr,{className:"w-6 h-6 text-sky-600"})}),u.jsxs("span",{className:"text-2xl font-bold text-slate-900",children:[j.responseRate,"%"]})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"Taux de reponse"})]})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 mb-6",children:u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsx("div",{className:"flex-1 min-w-[200px]",children:u.jsxs("div",{className:"relative",children:[u.jsx(po,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Rechercher par nom ou telephone...",value:g,onChange:z=>w(z.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"})]})}),u.jsx("div",{children:u.jsxs("select",{value:x===null?"":x,onChange:z=>v(z.target.value?Number(z.target.value):null),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[u.jsx("option",{value:"",children:"Toutes les notes"}),u.jsx("option",{value:"5",children:"5 etoiles"}),u.jsx("option",{value:"4",children:"4 etoiles"}),u.jsx("option",{value:"3",children:"3 etoiles"}),u.jsx("option",{value:"2",children:"2 etoiles"}),u.jsx("option",{value:"1",children:"1 etoile"})]})})]})}),O.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12 text-center",children:[u.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx(fs,{className:"w-8 h-8 text-slate-400"})}),u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Aucun avis"}),u.jsx("p",{className:"text-slate-600",children:g||x!==null?"Aucun avis ne correspond a vos criteres":"Vous n'avez pas encore recu d'avis clients"})]}):u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-[calc(100vh-400px)] min-h-[400px] flex overflow-hidden",children:[u.jsxs("div",{className:"w-1/3 border-r border-slate-200 flex flex-col",children:[u.jsx("div",{className:"p-4 border-b border-slate-200",children:u.jsxs("h3",{className:"font-semibold text-slate-900",children:[O.length," avis"]})}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:O.map(z=>u.jsxs("button",{onClick:()=>{o(z),S("")},className:`w-full p-4 text-left border-b border-slate-100 hover:bg-slate-50 transition-colors ${(s==null?void 0:s.id)===z.id?"bg-sky-50 border-l-4 border-l-sky-600":""}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"font-medium text-slate-900",children:z.client_name}),u.jsx(Zl,{rating:z.rating,readonly:!0,size:"sm"})]}),u.jsx("p",{className:"text-sm text-slate-600 truncate",children:z.comment||"Pas de commentaire"}),u.jsxs("div",{className:"flex items-center justify-between mt-2",children:[u.jsx("span",{className:"text-xs text-slate-500",children:V(z.created_at)}),z.merchant_response&&u.jsx("span",{className:"text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full",children:"Repondu"})]})]},z.id))})]}),u.jsx("div",{className:"flex-1 flex flex-col",children:s?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-6 border-b border-slate-200",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-bold text-slate-900",children:s.client_name}),u.jsx("p",{className:"text-sm text-slate-600",children:s.client_phone})]}),u.jsx(Zl,{rating:s.rating,readonly:!0,size:"lg"})]}),s.exchange_code&&u.jsxs("p",{className:"text-sm text-slate-600",children:["Code d'echange: ",u.jsx("span",{className:"font-mono font-medium",children:s.exchange_code})]}),u.jsx("p",{className:"text-sm text-slate-500 mt-2",children:V(s.created_at)})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Commentaire du client"}),u.jsx("div",{className:"bg-slate-50 rounded-lg p-4",children:u.jsx("p",{className:"text-slate-700",children:s.comment||"Aucun commentaire"})})]}),s.merchant_response&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Votre reponse"}),u.jsxs("div",{className:"bg-sky-50 rounded-lg p-4 border border-sky-200",children:[u.jsx("p",{className:"text-slate-700",children:s.merchant_response}),s.merchant_response_at&&u.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["Repondu le ",V(s.merchant_response_at)]})]})]})]}),!s.merchant_response&&u.jsx("div",{className:"p-4 border-t border-slate-200",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("textarea",{value:E,onChange:z=>S(z.target.value),placeholder:"Ecrire une reponse...",rows:2,className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500 resize-none"}),u.jsx("button",{onClick:T,disabled:!E.trim()||I,className:"px-4 py-2 bg-sky-600 hover:bg-sky-700 disabled:bg-slate-300 text-white rounded-lg transition-colors",children:u.jsx(ps,{className:"w-5 h-5"})})]})})]}):u.jsx("div",{className:"flex-1 flex items-center justify-center text-slate-500",children:"Selectionnez un avis pour voir les details"})})]})]})})}function UC(){const{roomId:t}=Qi(),e=wt(),[r,s]=P.useState(null),[o,l]=P.useState(!0),[f,g]=P.useState(""),[w,x]=P.useState(!1),[v,E]=P.useState(300),[S,I]=P.useState(!0),[k,j]=P.useState(!0),[M,A]=P.useState(!1),[C,T]=P.useState(!1);P.useEffect(()=>{O(),V()},[t]),P.useEffect(()=>{let te;return w&&v>0&&(te=setInterval(()=>{E(be=>be<=1?(U(),0):be-1)},1e3)),()=>clearInterval(te)},[w,v]);const O=async()=>{const{data:{session:te}}=await ae.auth.getSession();te||e("/merchant/login")},V=async()=>{try{const{data:te,error:be}=await ae.from("video_calls").select("*").eq("room_id",t).single();if(be)throw be;if(!te){g("Appel video non trouve");return}if(s(te),te.status==="active"&&te.started_at){const ue=new Date(te.started_at).getTime(),Ne=Math.floor((Date.now()-ue)/1e3);E(Math.max(0,300-Ne)),x(!0)}}catch(te){console.error("Error fetching video call:",te),g("Erreur lors du chargement de l'appel")}finally{l(!1)}},z=async()=>{if(r)try{r.status==="pending"&&await ae.from("video_calls").update({status:"active",started_at:new Date().toISOString()}).eq("id",r.id),x(!0)}catch(te){console.error("Error joining call:",te)}},U=async()=>{if(!r)return;const te=300-v;try{await ae.from("video_calls").update({status:"completed",ended_at:new Date().toISOString(),duration_seconds:te}).eq("id",r.id),T(!0),x(!1)}catch(be){console.error("Error ending call:",be)}},$=()=>{A(!M),console.log(M?"Stopping recording...":"Starting recording...")},G=te=>{const be=Math.floor(te/60),ue=te%60;return`${be}:${ue.toString().padStart(2,"0")}`};return o?u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):f?u.jsx(at,{children:u.jsxs("div",{className:"max-w-md mx-auto text-center py-12",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4",children:u.jsx(Nn,{className:"w-8 h-8 text-red-600"})}),u.jsx("h1",{className:"text-xl font-bold text-slate-900 mb-2",children:"Erreur"}),u.jsx("p",{className:"text-slate-600 mb-6",children:f}),u.jsx("button",{onClick:()=>e("/merchant/video-calls"),className:"px-6 py-3 bg-sky-600 hover:bg-sky-700 text-white rounded-lg font-medium transition-colors",children:"Retour aux appels"})]})}):C?u.jsx(at,{children:u.jsxs("div",{className:"max-w-md mx-auto text-center py-12",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-emerald-100 rounded-full mb-4",children:u.jsx(wr,{className:"w-8 h-8 text-emerald-600"})}),u.jsx("h1",{className:"text-xl font-bold text-slate-900 mb-2",children:"Appel termine"}),u.jsxs("p",{className:"text-slate-600 mb-6",children:["L'appel avec ",r==null?void 0:r.client_name," est termine."]}),u.jsx("button",{onClick:()=>e("/merchant/video-calls"),className:"px-6 py-3 bg-sky-600 hover:bg-sky-700 text-white rounded-lg font-medium transition-colors",children:"Retour aux appels"})]})}):w?u.jsxs("div",{className:"min-h-screen bg-slate-900 flex flex-col",children:[u.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:`w-3 h-3 rounded-full ${v<=60?"bg-red-500 animate-pulse":"bg-emerald-500"}`}),u.jsxs("span",{className:"text-white font-medium",children:["Appel avec ",r==null?void 0:r.client_name]})]}),M&&u.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-red-600 rounded-full",children:[u.jsx(Cu,{className:"w-3 h-3 text-white fill-white animate-pulse"}),u.jsx("span",{className:"text-white text-sm font-medium",children:"Enregistrement"})]})]}),u.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${v<=60?"bg-red-600":"bg-slate-700"}`,children:[u.jsx(sr,{className:"w-4 h-4 text-white"}),u.jsx("span",{className:"text-white font-mono",children:G(v)})]})]}),u.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:u.jsx("div",{className:"bg-slate-800 rounded-2xl w-full max-w-4xl aspect-video flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(rr,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),u.jsx("p",{className:"text-slate-400 text-lg",children:"Zone video"}),u.jsx("p",{className:"text-slate-500 text-sm mt-2",children:"Votre implementation WebRTC sera integree ici"})]})})}),u.jsx("div",{className:"bg-slate-800 px-4 py-6",children:u.jsxs("div",{className:"flex items-center justify-center gap-4",children:[u.jsx("button",{onClick:()=>j(!k),className:`p-4 rounded-full transition-colors ${k?"bg-slate-700 hover:bg-slate-600":"bg-red-600 hover:bg-red-700"}`,title:k?"Couper le micro":"Activer le micro",children:k?u.jsx(gp,{className:"w-6 h-6 text-white"}):u.jsx(mp,{className:"w-6 h-6 text-white"})}),u.jsx("button",{onClick:()=>I(!S),className:`p-4 rounded-full transition-colors ${S?"bg-slate-700 hover:bg-slate-600":"bg-red-600 hover:bg-red-700"}`,title:S?"Couper la video":"Activer la video",children:S?u.jsx(rr,{className:"w-6 h-6 text-white"}):u.jsx(xp,{className:"w-6 h-6 text-white"})}),(r==null?void 0:r.recording_consent)&&u.jsx("button",{onClick:$,className:`p-4 rounded-full transition-colors ${M?"bg-red-600 hover:bg-red-700":"bg-slate-700 hover:bg-slate-600"}`,title:M?"Arreter l'enregistrement":"Demarrer l'enregistrement",children:u.jsx(Cu,{className:`w-6 h-6 text-white ${M?"fill-white":""}`})}),u.jsx("button",{onClick:U,className:"p-4 bg-red-600 hover:bg-red-700 rounded-full transition-colors",title:"Terminer l'appel",children:u.jsx(Fn,{className:"w-6 h-6 text-white rotate-[135deg]"})})]})})]}):u.jsx(at,{children:u.jsx("div",{className:"max-w-lg mx-auto",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-sky-100 rounded-full mb-4",children:u.jsx(rr,{className:"w-8 h-8 text-sky-600"})}),u.jsxs("h1",{className:"text-xl font-bold text-slate-900 mb-2",children:["Appel video avec ",r==null?void 0:r.client_name]}),u.jsx("p",{className:"text-slate-600",children:"Rejoignez l'appel pour discuter avec le client"})]}),u.jsxs("div",{className:"space-y-4 mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-lg",children:[u.jsx(Gi,{className:"w-5 h-5 text-slate-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-slate-500",children:"Client"}),u.jsx("p",{className:"font-medium text-slate-900",children:r==null?void 0:r.client_name})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-lg",children:[u.jsx(Fn,{className:"w-5 h-5 text-slate-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-slate-500",children:"Telephone"}),u.jsx("p",{className:"font-medium text-slate-900",children:r==null?void 0:r.client_phone})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-4 bg-amber-50 rounded-lg border border-amber-200",children:[u.jsx(sr,{className:"w-5 h-5 text-amber-600"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-amber-600",children:"Duree maximale"}),u.jsx("p",{className:"font-medium text-amber-700",children:"5 minutes"})]})]}),(r==null?void 0:r.recording_consent)&&u.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-50 rounded-lg border border-emerald-200",children:[u.jsx(Cu,{className:"w-5 h-5 text-emerald-600"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-emerald-600",children:"Enregistrement"}),u.jsx("p",{className:"font-medium text-emerald-700",children:"Le client a consenti a l'enregistrement"})]})]})]}),u.jsxs("button",{onClick:z,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold transition-colors",children:[u.jsx(rr,{className:"w-5 h-5"}),"Rejoindre l'appel"]})]})})})}function zC(){const t=wt(),[e,r]=P.useState([]),[s,o]=P.useState(!0),[l,f]=P.useState(""),[g,w]=P.useState("");P.useEffect(()=>{x(),v()},[]);const x=async()=>{const{data:{session:j}}=await ae.auth.getSession();j||t("/merchant/login")},v=async()=>{try{const{data:j,error:M}=await ae.from("video_calls").select("*").order("created_at",{ascending:!1});if(M)throw M;r(j||[])}catch(j){console.error("Error fetching video calls:",j)}finally{o(!1)}},E=e.filter(j=>{const M=j.client_name.toLowerCase().includes(l.toLowerCase())||j.client_phone.includes(l)||j.room_id.includes(l),A=!g||j.status===g;return M&&A}),S=j=>{switch(j){case"pending":return"bg-amber-100 text-amber-800";case"active":return"bg-emerald-100 text-emerald-800";case"completed":return"bg-sky-100 text-sky-800";case"expired":return"bg-slate-100 text-slate-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-slate-100 text-slate-800"}},I=j=>new Date(j).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),k=j=>{if(!j)return"-";const M=Math.floor(j/60),A=j%60;return`${M}m ${A}s`};return s?u.jsx(at,{children:u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})})}):u.jsx(at,{children:u.jsxs("div",{children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Appels Video"}),u.jsx("p",{className:"text-slate-600",children:"Historique et gestion des appels video avec vos clients"})]}),u.jsxs("div",{className:"grid md:grid-cols-4 gap-6 mb-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-sky-100 rounded-lg",children:u.jsx(rr,{className:"w-6 h-6 text-sky-600"})}),u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:e.length})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"Total des appels"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:u.jsx(sr,{className:"w-6 h-6 text-amber-600"})}),u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:e.filter(j=>j.status==="pending").length})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"En attente"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:u.jsx(rr,{className:"w-6 h-6 text-emerald-600"})}),u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:e.filter(j=>j.status==="active").length})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"En cours"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"p-2 bg-slate-100 rounded-lg",children:u.jsx(Fn,{className:"w-6 h-6 text-slate-600"})}),u.jsx("span",{className:"text-2xl font-bold text-slate-900",children:e.filter(j=>j.status==="completed").length})]}),u.jsx("h3",{className:"text-slate-600 text-sm",children:"Termines"})]})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 mb-6",children:u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsx("div",{className:"flex-1 min-w-[200px]",children:u.jsxs("div",{className:"relative",children:[u.jsx(po,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Rechercher par nom, telephone ou room ID...",value:l,onChange:j=>f(j.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500"})]})}),u.jsx("div",{children:u.jsxs("select",{value:g,onChange:j=>w(j.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500",children:[u.jsx("option",{value:"",children:"Tous les statuts"}),u.jsx("option",{value:"pending",children:"En attente"}),u.jsx("option",{value:"active",children:"En cours"}),u.jsx("option",{value:"completed",children:"Termine"}),u.jsx("option",{value:"expired",children:"Expire"}),u.jsx("option",{value:"cancelled",children:"Annule"})]})})]})}),E.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12 text-center",children:[u.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx(rr,{className:"w-8 h-8 text-slate-400"})}),u.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Aucun appel video"}),u.jsx("p",{className:"text-slate-600",children:l||g?"Aucun appel ne correspond a vos criteres":"Vous n'avez pas encore d'appels video"})]}):u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-slate-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Client"}),u.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Room ID"}),u.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),u.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Duree"}),u.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Statut"}),u.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-slate-200",children:E.map(j=>u.jsxs("tr",{className:"hover:bg-slate-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center",children:u.jsx(Gi,{className:"w-5 h-5 text-slate-500"})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-slate-900",children:j.client_name}),u.jsx("p",{className:"text-sm text-slate-500",children:j.client_phone})]})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:"font-mono text-sm text-slate-600",children:j.room_id})}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:I(j.created_at)}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:k(j.duration_seconds)}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${S(j.status)}`,children:f3[j.status]||j.status})}),u.jsx("td",{className:"px-6 py-4",children:(j.status==="pending"||j.status==="active")&&u.jsxs("button",{onClick:()=>t(`/merchant/call/${j.room_id}`),className:"flex items-center gap-1 px-3 py-1.5 bg-sky-600 hover:bg-sky-700 text-white text-sm rounded-lg transition-colors",children:[u.jsx(rC,{className:"w-4 h-4"}),"Rejoindre"]})})]},j.id))})]})})]})})}function VC(){return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-sky-50",children:u.jsxs("div",{className:"container mx-auto px-4 py-16",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h1",{className:"text-5xl font-bold text-slate-900 mb-4",children:"Plateforme d'change"}),u.jsx("p",{className:"text-xl text-slate-600",children:"Grez vos changes de produits facilement et rapidement"})]}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto",children:[u.jsxs(qt,{to:"/client/scan",className:"group bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all p-8 border-2 border-transparent hover:border-emerald-500",children:[u.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-emerald-100 rounded-xl mb-6 group-hover:bg-emerald-500 transition-colors",children:u.jsx(Kt,{className:"w-8 h-8 text-emerald-600 group-hover:text-white transition-colors"})}),u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-3",children:"Espace Client"}),u.jsx("p",{className:"text-slate-600 mb-4",children:"Scanner votre QR code pour effectuer un change"}),u.jsxs("ul",{className:"space-y-2 text-sm text-slate-500",children:[u.jsx("li",{children:" Scanner le code QR du colis"}),u.jsx("li",{children:" Soumettre une demande d'change"}),u.jsx("li",{children:" Suivre votre change en temps rel"}),u.jsx("li",{children:" Communiquer avec le commerant"})]})]}),u.jsxs(qt,{to:"/merchant/login",className:"group bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all p-8 border-2 border-transparent hover:border-sky-500",children:[u.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-sky-100 rounded-xl mb-6 group-hover:bg-sky-500 transition-colors",children:u.jsx(Qh,{className:"w-8 h-8 text-sky-600 group-hover:text-white transition-colors"})}),u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-3",children:"Espace E-Commerant"}),u.jsx("p",{className:"text-slate-600 mb-4",children:"Grer et valider les demandes d'change"}),u.jsxs("ul",{className:"space-y-2 text-sm text-slate-500",children:[u.jsx("li",{children:" Tableau de bord avec statistiques"}),u.jsx("li",{children:" Validation et rejet des changes"}),u.jsx("li",{children:" Gestion des transporteurs et dpts"}),u.jsx("li",{children:" Gnration de bordereaux"})]})]})]}),u.jsx("div",{className:"mt-16 text-center",children:u.jsx("p",{className:"text-slate-500 text-sm",children:"Plateforme MVP - Simplifiez la gestion de vos changes de produits"})})]})})}function HC(){const[t,e]=P.useState(null),[r,s]=P.useState(!0);return P.useEffect(()=>{ae.auth.getSession().then(({data:{session:l}})=>{e((l==null?void 0:l.user)??null),s(!1)});const{data:{subscription:o}}=ae.auth.onAuthStateChange((l,f)=>{e((f==null?void 0:f.user)??null)});return()=>o.unsubscribe()},[]),r?u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):u.jsx(Lv,{children:u.jsxs(hv,{children:[u.jsx(vt,{path:"/",element:u.jsx(VC,{})}),u.jsx(vt,{path:"/client/scan",element:u.jsx(gC,{})}),u.jsx(vt,{path:"/client/exchange/new",element:u.jsx(pC,{})}),u.jsx(vt,{path:"/client/tracking/:code",element:u.jsx(wC,{})}),u.jsx(vt,{path:"/client/exchanges",element:u.jsx(yC,{})}),u.jsx(vt,{path:"/client/exchange/:id",element:u.jsx(vC,{})}),u.jsx(vt,{path:"/client/chat",element:u.jsx(bC,{})}),u.jsx(vt,{path:"/client/review/new",element:u.jsx(CC,{})}),u.jsx(vt,{path:"/call/:roomId",element:u.jsx(NC,{})}),u.jsx(vt,{path:"/merchant/login",element:t?u.jsx(Kr,{to:"/merchant/dashboard"}):u.jsx(_C,{})}),u.jsx(vt,{path:"/merchant/dashboard",element:t?u.jsx(IC,{}):u.jsx(Kr,{to:"/merchant/login"})}),u.jsx(vt,{path:"/merchant/exchanges",element:t?u.jsx(TC,{}):u.jsx(Kr,{to:"/merchant/login"})}),u.jsx(vt,{path:"/merchant/exchange/:id",element:t?u.jsx(MC,{}):u.jsx(Kr,{to:"/merchant/login"})}),u.jsx(vt,{path:"/merchant/clients",element:t?u.jsx(DC,{}):u.jsx(Kr,{to:"/merchant/login"})}),u.jsx(vt,{path:"/merchant/client/:phone",element:t?u.jsx(LC,{}):u.jsx(Kr,{to:"/merchant/login"})}),u.jsx(vt,{path:"/merchant/chat",element:t?u.jsx(BC,{}):u.jsx(Kr,{to:"/merchant/login"})}),u.jsx(vt,{path:"/merchant/simulation",element:t?u.jsx(PC,{}):u.jsx(Kr,{to:"/merchant/login"})}),u.jsx(vt,{path:"/merchant/reviews",element:t?u.jsx(FC,{}):u.jsx(Kr,{to:"/merchant/login"})}),u.jsx(vt,{path:"/merchant/video-calls",element:t?u.jsx(zC,{}):u.jsx(Kr,{to:"/merchant/login"})}),u.jsx(vt,{path:"/merchant/call/:roomId",element:t?u.jsx(UC,{}):u.jsx(Kr,{to:"/merchant/login"})})]})})}Pg(document.getElementById("root")).render(u.jsx(P.StrictMode,{children:u.jsx(HC,{})}));
